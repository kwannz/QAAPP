(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[983],{10355:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>z});var a=s(95688),t=s(42086),l=s(27100),n=s(46942),i=s(97068),o=s(79288),c=s(52856),d=s(52872),u=s(90789),m=s(85210),h=s.n(m),x=s(87983),p=s(67396),f=s(15240),g=s(3706),b=s(54980),j=s(4389),v=s(63186),w=s(32887),y=s(37811);function N(e){let{className:r,disabled:s,onSuccess:t,onError:l}=e,[n,i]=(0,p.useState)(!1),{setUser:o,setTokens:c}=(0,w.nc)(),d=async()=>{i(!0);try{if(!window.google)throw Error("Google SDK 未加载");window.google.accounts.id.initialize({client_id:y.env.NEXT_PUBLIC_GOOGLE_CLIENT_ID||"",callback:async e=>{try{let r=await fetch("/api/auth/google",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e.credential})});if(!r.ok){let e=await r.json();throw Error(e.message||"Google登录失败")}let s=await r.json();o(s.user),c(s.accessToken,s.refreshToken),j.oR.success("Google登录成功！"),null==t||t()}catch(r){let e=r instanceof Error?r.message:"Google登录失败";j.oR.error(e),null==l||l(e)}finally{i(!1)}}}),window.google.accounts.id.prompt()}catch(r){let e=r instanceof Error?r.message:"Google登录失败";j.oR.error(e),null==l||l(e),i(!1)}};return(0,a.jsx)(v.$n,{variant:"outline",className:"w-full ".concat(r),onClick:d,disabled:s||n,children:n?(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-primary"}),(0,a.jsx)("span",{children:"登录中..."})]}):(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[(0,a.jsx)("path",{fill:"currentColor",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),(0,a.jsx)("path",{fill:"currentColor",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),(0,a.jsx)("path",{fill:"currentColor",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),(0,a.jsx)("path",{fill:"currentColor",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),(0,a.jsx)("span",{children:"使用 Google 登录"})]})})}var C=s(55340),k=s(55771);function A(e){let{isRegister:r=!1,referralCode:s}=e,t=(0,b.G)(),[l,n]=(0,p.useState)(!1),{address:i,isConnected:o}=(0,k.yu)(),c=async e=>{try{if(!o||!i)throw Error("请先连接钱包");if(window.ethereum){let{message:r}=e;return await window.ethereum.request({method:"personal_sign",params:[r,i]})}throw Error("未找到Web3钱包")}catch(e){throw Error("钱包签名失败: ".concat(e instanceof Error?e.message:"未知错误"))}},d=(0,x.useRouter)(),{setUser:u,setTokens:m}=(0,w.nc)(),h=async()=>{if(!i||!o)return void t.error("请先连接钱包");n(!0);try{let{challenge:e}=(await C.authApi.getWeb3Challenge(i)).data,a=await c({message:e,account:i}),l={address:i,signature:a,...s&&{referralCode:s}},{user:n,accessToken:o,refreshToken:h}=(r?await C.authApi.web3Register(l):await C.authApi.web3Login(l)).data;u(n),m(o,h),t.success(r?"注册成功！":"登录成功！");let x=new URLSearchParams(window.location.search).get("redirect")||"/dashboard";d.push(x)}catch(s){var e,a,l,h;(null==(e=s.response)?void 0:e.status)===409?r?t.error("该钱包地址已被注册，请直接登录"):t.error("该钱包地址未注册，请先注册"):(null==(a=s.response)?void 0:a.status)===400?t.error("签名验证失败，请重试"):t.error((null==(h=s.response)||null==(l=h.data)?void 0:l.message)||"".concat(r?"注册":"登录","失败"))}finally{n(!1)}};return o?(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)(v.$n,{onClick:h,loading:l,variant:"outline",className:"w-full",size:"lg",children:[(0,a.jsx)("span",{className:"mr-2",children:"\uD83D\uDD17"}),r?"Web3注册":"Web3登录"]}),(0,a.jsxs)("div",{className:"flex items-center justify-center space-x-2 text-xs text-muted-foreground",children:[(0,a.jsx)("span",{children:"已连接:"}),(0,a.jsxs)("span",{className:"font-mono bg-gray-100 px-2 py-1 rounded",children:[null==i?void 0:i.slice(0,6),"...",null==i?void 0:i.slice(-4)]})]})]}):(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)(v.$n,{variant:"outline",disabled:!0,className:"w-full",children:"连接钱包 (开发中)"})}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground text-center",children:["Web3功能正在开发中，请使用邮箱",r?"注册":"登录"]})]})}let S=g.Ik({email:g.Yj().email("请输入有效的邮箱地址"),password:g.Yj().min(8,"密码至少8位").regex(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[!$%&*?@])[\d!$%&*?@A-Za-z]/,"密码必须包含大小写字母、数字和特殊字符"),confirmPassword:g.Yj(),referralCode:g.Yj().optional(),agreeTerms:g.zM().refine(e=>!0===e,"请同意服务条款")}).refine(e=>e.password===e.confirmPassword,{message:"两次输入的密码不一致",path:["confirmPassword"]});function E(){var e,r,s,m;let[g,j]=(0,p.useState)(!1),[y,k]=(0,p.useState)(!1),[E,z]=(0,p.useState)(!1),I=(0,x.useRouter)(),P=(0,x.useSearchParams)(),{setUser:T,setTokens:R}=(0,w.nc)(),_=(0,b.G)(),D=P.get("ref"),{register:G,handleSubmit:W,formState:{errors:M},setValue:$}=(0,f.mN)({resolver:(0,t.u)(S),defaultValues:{referralCode:D||""}}),L=async e=>{j(!0);try{let{confirmPassword:r,agreeTerms:s,...a}=e,{user:t,accessToken:l,refreshToken:n}=(await C.authApi.register({email:a.email,password:a.password,referralCode:a.referralCode})).data;T(t),R(l,n),_.success("注册成功！欢迎加入QA App"),I.push("/dashboard")}catch(e){var r,s;_.error((null==(s=e.response)||null==(r=s.data)?void 0:r.message)||"注册失败，请稍后重试")}finally{j(!1)}};return(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 flex items-center justify-center p-4",children:[(0,a.jsxs)("div",{className:"absolute inset-0 overflow-hidden",children:[(0,a.jsx)("div",{className:"absolute -top-40 -right-40 h-80 w-80 rounded-full bg-gradient-to-br from-blue-400/20 to-purple-400/20 blur-3xl"}),(0,a.jsx)("div",{className:"absolute -bottom-40 -left-40 h-80 w-80 rounded-full bg-gradient-to-br from-indigo-400/20 to-blue-400/20 blur-3xl"})]}),(0,a.jsxs)("div",{className:"relative z-10 w-full max-w-md",children:[(0,a.jsx)(l.P.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"mb-6",children:(0,a.jsxs)(h(),{href:"/",className:"inline-flex items-center text-sm text-muted-foreground hover:text-foreground transition-colors",children:[(0,a.jsx)(n.A,{className:"w-4 h-4 mr-1"}),"返回首页"]})}),(0,a.jsx)(l.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:(0,a.jsxs)(v.Zp,{className:"shadow-2xl border-0 bg-white/80 backdrop-blur-sm",children:[(0,a.jsxs)(v.aR,{className:"text-center pb-8",children:[(0,a.jsx)("div",{className:"flex justify-center mb-4",children:(0,a.jsx)("div",{className:"h-12 w-12 rounded-xl bg-gradient-to-br from-primary to-primary/80 flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white font-bold text-lg",children:"QA"})})}),(0,a.jsx)(v.ZB,{className:"text-2xl font-bold",children:"创建账户"}),(0,a.jsx)("p",{className:"text-muted-foreground mt-2",children:"加入QA App，开始您的Web3投资之旅"}),(0,a.jsx)("div",{className:"mt-4 p-3 bg-green-50 border border-green-200 rounded-lg",children:(0,a.jsxs)("p",{className:"text-sm text-green-800",children:["\uD83C\uDF89 新用户注册即获得 ",(0,a.jsx)("strong",{children:"$10 USDT"})," 体验金"]})})]}),(0,a.jsxs)(v.Wu,{className:"space-y-6",children:[(0,a.jsxs)("form",{onSubmit:W(L),className:"space-y-4",children:[(0,a.jsx)(v.pd,{...G("email"),type:"email",label:"邮箱地址",placeholder:"请输入邮箱地址",error:null==(e=M.email)?void 0:e.message,leftIcon:(0,a.jsx)(i.A,{className:"h-4 w-4"}),loading:g,autoComplete:"email"}),(0,a.jsx)(v.pd,{...G("password"),type:y?"text":"password",label:"密码",placeholder:"请输入密码",error:null==(r=M.password)?void 0:r.message,helper:"密码必须包含大小写字母、数字和特殊字符",leftIcon:(0,a.jsx)(o.A,{className:"h-4 w-4"}),rightIcon:(0,a.jsx)("button",{type:"button",onClick:()=>k(!y),className:"text-muted-foreground hover:text-foreground transition-colors",children:y?(0,a.jsx)(c.A,{className:"h-4 w-4"}):(0,a.jsx)(d.A,{className:"h-4 w-4"})}),loading:g,autoComplete:"new-password"}),(0,a.jsx)(v.pd,{...G("confirmPassword"),type:E?"text":"password",label:"确认密码",placeholder:"请再次输入密码",error:null==(s=M.confirmPassword)?void 0:s.message,leftIcon:(0,a.jsx)(o.A,{className:"h-4 w-4"}),rightIcon:(0,a.jsx)("button",{type:"button",onClick:()=>z(!E),className:"text-muted-foreground hover:text-foreground transition-colors",children:E?(0,a.jsx)(c.A,{className:"h-4 w-4"}):(0,a.jsx)(d.A,{className:"h-4 w-4"})}),loading:g,autoComplete:"new-password"}),(0,a.jsx)(v.pd,{...G("referralCode"),type:"text",label:"推荐码（可选）",placeholder:"输入推荐码享受额外奖励",error:null==(m=M.referralCode)?void 0:m.message,leftIcon:(0,a.jsx)(u.A,{className:"h-4 w-4"}),loading:g}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("label",{className:"flex items-start space-x-2 text-sm",children:[(0,a.jsx)("input",{type:"checkbox",...G("agreeTerms"),className:"mt-0.5 rounded border-gray-300 text-primary focus:ring-primary",disabled:g}),(0,a.jsxs)("span",{className:"text-muted-foreground",children:["我已阅读并同意"," ",(0,a.jsx)(h(),{href:"/terms",className:"text-primary hover:text-primary/80 underline",children:"服务条款"})," ","和"," ",(0,a.jsx)(h(),{href:"/privacy",className:"text-primary hover:text-primary/80 underline",children:"隐私政策"})]})]}),M.agreeTerms&&(0,a.jsx)("p",{className:"text-sm text-red-600",children:M.agreeTerms.message})]}),(0,a.jsx)(v.$n,{type:"submit",className:"w-full",size:"lg",loading:g,children:"创建账户"})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,a.jsx)("div",{className:"w-full border-t border-gray-200"})}),(0,a.jsx)("div",{className:"relative flex justify-center text-sm",children:(0,a.jsx)("span",{className:"bg-white px-4 text-muted-foreground",children:"或者"})})]}),(0,a.jsx)(N,{onSuccess:()=>{_.success("注册成功！欢迎加入QA App"),I.push("/dashboard")}}),(0,a.jsx)(A,{isRegister:!0,referralCode:D||void 0}),(0,a.jsxs)("div",{className:"text-center text-sm",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"已有账户？"})," ",(0,a.jsx)(h(),{href:"/auth/login",className:"font-medium text-primary hover:text-primary/80 transition-colors",children:"立即登录"})]}),(0,a.jsx)("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3",children:(0,a.jsxs)("p",{className:"text-xs text-amber-800",children:[(0,a.jsx)("strong",{children:"风险提示："}),"数字资产投资存在风险，请您谨慎投资，注意保护个人信息和资产安全。"]})})]})]})})]})]})}function z(){return(0,a.jsx)(p.Suspense,{fallback:(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 flex items-center justify-center",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}),children:(0,a.jsx)(E,{})})}},52858:(e,r,s)=>{Promise.resolve().then(s.bind(s,10355))},54980:(e,r,s)=>{"use strict";s.d(r,{G:()=>n});var a=s(67396),t=s(38276),l=s(16350);function n(){let[e,r]=(0,a.useState)(null),[n,i]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{(async()=>{if(!(0,t.Iz)())return i(!0);try{let e=await s.e(4078).then(s.bind(s,84078));r(e.default),i(!0)}catch(e){l.vF.warn("SafeToast","Failed to load react-hot-toast, toasts disabled",{error:e}),i(!0)}})()},[]),{success:(0,a.useCallback)(r=>{n&&e&&e.success(r)},[n,e]),error:(0,a.useCallback)(r=>{n&&e?e.error(r):l.vF.error("SafeToast","Toast Error (fallback)",{message:r})},[n,e]),loading:(0,a.useCallback)(r=>{if(n&&e)return e.loading(r)},[n,e]),dismiss:(0,a.useCallback)(()=>{n&&e&&e.dismiss()},[n,e])}}},55771:(e,r,s)=>{"use strict";s.d(r,{Dm:()=>w,Ki:()=>C,Rh:()=>N,hK:()=>y,ir:()=>A,se:()=>j,tV:()=>b,yu:()=>v,z:()=>S,zw:()=>k});var a=s(93979),t=s(98444),l=s(88433),n=s(45274),i=s(40769),o=s(13264),c=s(56448),d=s(67566),u=s(66640),m=s(23824);let h={address:void 0,addresses:void 0,chain:void 0,chainId:void 0,connector:void 0,isConnected:!1,isConnecting:!1,isDisconnected:!0,isReconnecting:!1,status:"disconnected"},x={data:void 0,error:null,isError:!1,isLoading:!1,isSuccess:!1,refetch:async()=>({})},p={connect:()=>{},connectAsync:async()=>{throw Error("Web3 not initialized")},connectors:[],error:null,isError:!1,isIdle:!0,isPending:!1,isSuccess:!1,reset:()=>{},status:"idle",variables:void 0},f={disconnect:()=>{},disconnectAsync:async()=>{throw Error("Web3 not initialized")},error:null,isError:!1,isIdle:!0,isPending:!1,isSuccess:!1,reset:()=>{},status:"idle",variables:void 0};function g(){try{return!!document.querySelector("[data-wagmi-provider]")}catch(e){return!1}}function b(){return(0,a.i)()}function j(){return(0,t.R)()}function v(){let e=(0,l.F)();return g()?e:{...h,...e}}function w(e){let r=(0,n.A)({address:null==e?void 0:e.address,query:{enabled:!!(null==e?void 0:e.address),refetchInterval:1e4}});return(null==e?void 0:e.address)&&g()?r:{...x,...r}}function y(){let e=(0,i.e)();return g()?e:{...p,...e}}function N(){let e=(0,o.u)();return g()?e:{...f,...e}}function C(e){return(0,c.v)(e)}function k(e){return(0,d.Q)(e)}function A(){return(0,u.x)()}function S(e){return(0,m.g)(e)}},90789:(e,r,s)=>{"use strict";s.d(r,{A:()=>a});let a=(0,s(61200).A)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])}},e=>{e.O(0,[4104,9086,896,2683,1284,8735,6905,7701,5560,3668,4389,2039,2202,5340,4171,7172,7358],()=>e(e.s=52858)),_N_E=e.O()}]);