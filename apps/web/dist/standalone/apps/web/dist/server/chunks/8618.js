exports.id=8618,exports.ids=[8618],exports.modules={1006:a=>{"use strict";a.exports=function(a){return a instanceof Date&&!Number.isNaN(a.getTime())}},4353:a=>{"use strict";a.exports=function a(d){if(!(d instanceof Error))return d;d[c]=void 0;let f=Object.create(e);for(let e in f.type="[object Function]"===b.call(d.constructor)?d.constructor.name:d.name,f.message=d.message,f.stack=d.stack,d)if(void 0===f[e]){let b=d[e];b instanceof Error?b.hasOwnProperty(c)||(f[e]=a(b)):f[e]=b}return delete d[c],f.raw=d,f};let{toString:b}=Object.prototype,c=Symbol("circular-ref-tag"),d=Symbol("pino-raw-err-ref"),e=Object.create({},{type:{enumerable:!0,writable:!0,value:void 0},message:{enumerable:!0,writable:!0,value:void 0},stack:{enumerable:!0,writable:!0,value:void 0},raw:{enumerable:!1,get:function(){return this[d]},set:function(a){this[d]=a}}});Object.defineProperty(e,d,{writable:!0,value:{}})},4904:(a,b,c)=>{"use strict";let d=c(8386),e=c(71827),f=c(92166),g=c(71658),{groupRedact:h,nestedRedact:i}=c(91466),j=c(9733),k=c(61864),l=d(),m=a=>a;function o(a={}){let b=Array.from(new Set(a.paths||[])),c="serialize"in a&&(!1===a.serialize||"function"==typeof a.serialize)?a.serialize:JSON.stringify,d=a.remove;if(!0===d&&c!==JSON.stringify)throw Error("fast-redact – remove option may only be set when serializer is JSON.stringify");let k=!0===d?void 0:"censor"in a?a.censor:"[REDACTED]",p="function"==typeof k,q=p&&k.length>1;if(0===b.length)return c||m;l({paths:b,serialize:c,censor:k});let{wildcards:r,wcLen:s,secret:t}=e({paths:b,censor:k}),u=g();return f({secret:t,wcLen:s,serialize:c,strict:!("strict"in a)||a.strict,isCensorFct:p,censorFctTakesPath:q},j({secret:t,censor:k,compileRestore:u,serialize:c,groupRedact:h,nestedRedact:i,wildcards:r,wcLen:s}))}m.restore=m,o.rx=k,o.validator=d,a.exports=o},5697:a=>{"use strict";class b{constructor(a,b){this.target=b,this.type=a}}class c extends b{constructor(a,b){super("message",b),this.data=a}}class d extends b{constructor(a,b,c){super("close",c),this.wasClean=c._closeFrameReceived&&c._closeFrameSent,this.reason=b,this.code=a}}class e extends b{constructor(a){super("open",a)}}class f extends b{constructor(a,b){super("error",b),this.message=a.message,this.error=a}}a.exports={addEventListener(a,b,g){if("function"!=typeof b)return;function h(a){b.call(this,new c(a,this))}function i(a,c){b.call(this,new d(a,c,this))}function j(a){b.call(this,new f(a,this))}function k(){b.call(this,new e(this))}let l=g&&g.once?"once":"on";"message"===a?(h._listener=b,this[l](a,h)):"close"===a?(i._listener=b,this[l](a,i)):"error"===a?(j._listener=b,this[l](a,j)):"open"===a?(k._listener=b,this[l](a,k)):this[l](a,b)},removeEventListener(a,b){let c=this.listeners(a);for(let d=0;d<c.length;d++)(c[d]===b||c[d]._listener===b)&&this.removeListener(a,c[d])}}},5703:(a,b,c)=>{"use strict";a.exports=function({log:a,context:b}){let{EOL:c,IDENT:h,errorProps:i,messageKey:j}=b,k=f({input:a.stack,ident:h,eol:c}),l=`${h}${k}${c}`;if(i.length>0){let f,k=d.concat(j,"type","stack");f="*"===i[0]?Object.keys(a).filter(a=>!1===k.includes(a)):i.filter(a=>!1===k.includes(a));for(let d=0;d<f.length;d+=1){let i=f[d];if(i in a!=!1){if(e(a[i])){let d=g({log:a[i],excludeLoggerKeys:!1,context:{...b,IDENT:h+h}});l=`${l}${h}${i}: {${c}${d}${h}}${c}`;continue}l=`${l}${h}${i}: ${a[i]}${c}`}}}return l};let{LOGGER_KEYS:d}=c(70219),e=c(83604),f=c(98459),g=c(15367)},5831:(a,b)=>{"use strict";let{hasOwnProperty:c}=Object.prototype,d=m();d.configure=m,d.stringify=d,d.default=d,b.stringify=d,b.configure=m,a.exports=d;let e=/[\u0000-\u001f\u0022\u005c\ud800-\udfff]/;function f(a){return a.length<5e3&&!e.test(a)?`"${a}"`:JSON.stringify(a)}function g(a,b){if(a.length>200||b)return a.sort(b);for(let b=1;b<a.length;b++){let c=a[b],d=b;for(;0!==d&&a[d-1]>c;)a[d]=a[d-1],d--;a[d]=c}return a}let h=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(Object.getPrototypeOf(new Int8Array)),Symbol.toStringTag).get;function i(a){return void 0!==h.call(a)&&0!==a.length}function j(a,b,c){a.length<c&&(c=a.length);let d=","===b?"":" ",e=`"0":${d}${a[0]}`;for(let f=1;f<c;f++)e+=`${b}"${f}":${d}${a[f]}`;return e}function k(a,b){let d;if(c.call(a,b)){if("number"!=typeof(d=a[b]))throw TypeError(`The "${b}" argument must be of type number`);if(!Number.isInteger(d))throw TypeError(`The "${b}" argument must be an integer`);if(d<1)throw RangeError(`The "${b}" argument must be >= 1`)}return void 0===d?1/0:d}function l(a){return 1===a?"1 item":`${a} items`}function m(a){let b=function(a){if(c.call(a,"strict")){let b=a.strict;if("boolean"!=typeof b)throw TypeError('The "strict" argument must be of type boolean');if(b)return a=>{let b=`Object can not safely be stringified. Received type ${typeof a}`;throw"function"!=typeof a&&(b+=` (${a.toString()})`),Error(b)}}}(a={...a});b&&(void 0===a.bigint&&(a.bigint=!1),"circularValue"in a||(a.circularValue=Error));let d=function(a){if(c.call(a,"circularValue")){let b=a.circularValue;if("string"==typeof b)return`"${b}"`;if(null==b)return b;if(b===Error||b===TypeError)return{toString(){throw TypeError("Converting circular structure to JSON")}};throw TypeError('The "circularValue" argument must be of type string or the value null or undefined')}return'"[Circular]"'}(a),e=function(a,b){let d;if(c.call(a,b)&&"boolean"!=typeof(d=a[b]))throw TypeError(`The "${b}" argument must be of type boolean`);return void 0===d||d}(a,"bigint"),h=function(a){let b;if(c.call(a,"deterministic")&&"boolean"!=typeof(b=a.deterministic)&&"function"!=typeof b)throw TypeError('The "deterministic" argument must be of type boolean or comparator function');return void 0===b||b}(a),m="function"==typeof h?h:void 0,o=k(a,"maximumDepth"),p=k(a,"maximumBreadth");return function(a,c,k){if(arguments.length>1){let q="";if("number"==typeof k?q=" ".repeat(Math.min(k,10)):"string"==typeof k&&(q=k.slice(0,10)),null!=c){if("function"==typeof c)return function a(c,j,k,q,r,s){let t=j[c];switch("object"==typeof t&&null!==t&&"function"==typeof t.toJSON&&(t=t.toJSON(c)),typeof(t=q.call(j,c,t))){case"string":return f(t);case"object":{if(null===t)return"null";if(-1!==k.indexOf(t))return d;let b="",c=",",e=s;if(Array.isArray(t)){if(0===t.length)return"[]";if(o<k.length+1)return'"[Array]"';k.push(t),""!==r&&(s+=r,b+=`
${s}`,c=`,
${s}`);let d=Math.min(t.length,p),f=0;for(;f<d-1;f++){let d=a(String(f),t,k,q,r,s);b+=void 0!==d?d:"null",b+=c}let g=a(String(f),t,k,q,r,s);if(b+=void 0!==g?g:"null",t.length-1>p){let a=t.length-p-1;b+=`${c}"... ${l(a)} not stringified"`}return""!==r&&(b+=`
${e}`),k.pop(),`[${b}]`}let j=Object.keys(t),u=j.length;if(0===u)return"{}";if(o<k.length+1)return'"[Object]"';let v="",w="";""!==r&&(s+=r,c=`,
${s}`,v=" ");let x=Math.min(u,p);h&&!i(t)&&(j=g(j,m)),k.push(t);for(let d=0;d<x;d++){let e=j[d],g=a(e,t,k,q,r,s);void 0!==g&&(b+=`${w}${f(e)}:${v}${g}`,w=c)}return u>p&&(b+=`${w}"...":${v}"${l(u-p)} not stringified"`,w=c),""!==r&&w.length>1&&(b=`
${s}${b}
${e}`),k.pop(),`{${b}}`}case"number":return isFinite(t)?String(t):b?b(t):"null";case"boolean":return!0===t?"true":"false";case"undefined":return;case"bigint":if(e)return String(t);default:return b?b(t):void 0}}("",{"":a},[],c,q,"");if(Array.isArray(c))return function a(c,g,h,i,j,k){switch("object"==typeof g&&null!==g&&"function"==typeof g.toJSON&&(g=g.toJSON(c)),typeof g){case"string":return f(g);case"object":{if(null===g)return"null";if(-1!==h.indexOf(g))return d;let b=k,c="",e=",";if(Array.isArray(g)){if(0===g.length)return"[]";if(o<h.length+1)return'"[Array]"';h.push(g),""!==j&&(k+=j,c+=`
${k}`,e=`,
${k}`);let d=Math.min(g.length,p),f=0;for(;f<d-1;f++){let b=a(String(f),g[f],h,i,j,k);c+=void 0!==b?b:"null",c+=e}let m=a(String(f),g[f],h,i,j,k);if(c+=void 0!==m?m:"null",g.length-1>p){let a=g.length-p-1;c+=`${e}"... ${l(a)} not stringified"`}return""!==j&&(c+=`
${b}`),h.pop(),`[${c}]`}h.push(g);let m="";""!==j&&(k+=j,e=`,
${k}`,m=" ");let q="";for(let b of i){let d=a(b,g[b],h,i,j,k);void 0!==d&&(c+=`${q}${f(b)}:${m}${d}`,q=e)}return""!==j&&q.length>1&&(c=`
${k}${c}
${b}`),h.pop(),`{${c}}`}case"number":return isFinite(g)?String(g):b?b(g):"null";case"boolean":return!0===g?"true":"false";case"undefined":return;case"bigint":if(e)return String(g);default:return b?b(g):void 0}}("",a,[],function(a){let b=new Set;for(let c of a)("string"==typeof c||"number"==typeof c)&&b.add(String(c));return b}(c),q,"")}if(0!==q.length)return function a(c,k,q,r,s){switch(typeof k){case"string":return f(k);case"object":{if(null===k)return"null";if("function"==typeof k.toJSON){if("object"!=typeof(k=k.toJSON(c)))return a(c,k,q,r,s);if(null===k)return"null"}if(-1!==q.indexOf(k))return d;let b=s;if(Array.isArray(k)){if(0===k.length)return"[]";if(o<q.length+1)return'"[Array]"';q.push(k),s+=r;let c=`
${s}`,d=`,
${s}`,e=Math.min(k.length,p),f=0;for(;f<e-1;f++){let b=a(String(f),k[f],q,r,s);c+=void 0!==b?b:"null",c+=d}let g=a(String(f),k[f],q,r,s);if(c+=void 0!==g?g:"null",k.length-1>p){let a=k.length-p-1;c+=`${d}"... ${l(a)} not stringified"`}return c+=`
${b}`,q.pop(),`[${c}]`}let e=Object.keys(k),t=e.length;if(0===t)return"{}";if(o<q.length+1)return'"[Object]"';s+=r;let u=`,
${s}`,v="",w="",x=Math.min(t,p);i(k)&&(v+=j(k,u,p),e=e.slice(k.length),x-=k.length,w=u),h&&(e=g(e,m)),q.push(k);for(let b=0;b<x;b++){let c=e[b],d=a(c,k[c],q,r,s);void 0!==d&&(v+=`${w}${f(c)}: ${d}`,w=u)}return t>p&&(v+=`${w}"...": "${l(t-p)} not stringified"`,w=u),""!==w&&(v=`
${s}${v}
${b}`),q.pop(),`{${v}}`}case"number":return isFinite(k)?String(k):b?b(k):"null";case"boolean":return!0===k?"true":"false";case"undefined":return;case"bigint":if(e)return String(k);default:return b?b(k):void 0}}("",a,[],q,"")}return function a(c,k,q){switch(typeof k){case"string":return f(k);case"object":{if(null===k)return"null";if("function"==typeof k.toJSON){if("object"!=typeof(k=k.toJSON(c)))return a(c,k,q);if(null===k)return"null"}if(-1!==q.indexOf(k))return d;let b="",e=void 0!==k.length;if(e&&Array.isArray(k)){if(0===k.length)return"[]";if(o<q.length+1)return'"[Array]"';q.push(k);let c=Math.min(k.length,p),d=0;for(;d<c-1;d++){let c=a(String(d),k[d],q);b+=void 0!==c?c:"null",b+=","}let e=a(String(d),k[d],q);if(b+=void 0!==e?e:"null",k.length-1>p){let a=k.length-p-1;b+=`,"... ${l(a)} not stringified"`}return q.pop(),`[${b}]`}let r=Object.keys(k),s=r.length;if(0===s)return"{}";if(o<q.length+1)return'"[Object]"';let t="",u=Math.min(s,p);e&&i(k)&&(b+=j(k,",",p),r=r.slice(k.length),u-=k.length,t=","),h&&(r=g(r,m)),q.push(k);for(let c=0;c<u;c++){let d=r[c],e=a(d,k[d],q);void 0!==e&&(b+=`${t}${f(d)}:${e}`,t=",")}return s>p&&(b+=`${t}"...":"${l(s-p)} not stringified"`),q.pop(),`{${b}}`}case"number":return isFinite(k)?String(k):b?b(k):"null";case"boolean":return!0===k?"true":"false";case"undefined":return;case"bigint":if(e)return String(k);default:return b?b(k):void 0}}("",a,[])}}},6442:a=>{"use strict";a.exports={nullTime:()=>"",epochTime:()=>`,"time":${Date.now()}`,unixTime:()=>`,"time":${Math.round(Date.now()/1e3)}`,isoTime:()=>`,"time":"${new Date(Date.now()).toISOString()}"`}},7376:(a,b,c)=>{"use strict";c.d(b,{eF:()=>h,mE:()=>e,rI:()=>g,vG:()=>f});var d=c(58703);function e(a){return d.jf.includes(a)}function f(a){return Object.keys(d.Uf).includes(a)?d.Uf[a]:d.Uf[d.XW]}function g(a){let b=Object.values(d.Uf).find(b=>b.code===a);return b||d.Uf[d.XW]}function h(a,b,c){return a.message.includes("getaddrinfo ENOTFOUND")||a.message.includes("connect ECONNREFUSED")?Error(`Unavailable ${c} RPC url at ${b}`):a}},7877:(a,b,c)=>{"use strict";c.d(b,{Cq:()=>bv,FA:()=>bx,TZ:()=>bw,UF:()=>bu});var d=c(94965),e=c(25080);function f(a,...b){if(!(a instanceof Uint8Array||ArrayBuffer.isView(a)&&"Uint8Array"===a.constructor.name))throw Error("Uint8Array expected");if(b.length>0&&!b.includes(a.length))throw Error("Uint8Array expected of length "+b+", got length="+a.length)}function g(a,b=!0){if(a.destroyed)throw Error("Hash instance has been destroyed");if(b&&a.finished)throw Error("Hash#digest() has already been called")}let h="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,i=a=>new DataView(a.buffer,a.byteOffset,a.byteLength);function j(a){return"string"==typeof a&&(a=function(a){if("string"!=typeof a)throw Error("utf8ToBytes expected string, got "+typeof a);return new Uint8Array(new TextEncoder().encode(a))}(a)),f(a),a}class k{clone(){return this._cloneInto()}}function l(a=32){if(h&&"function"==typeof h.getRandomValues)return h.getRandomValues(new Uint8Array(a));if(h&&"function"==typeof h.randomBytes)return h.randomBytes(a);throw Error("crypto.getRandomValues must be defined")}class m extends k{constructor(a,b,c,d){super(),this.blockLen=a,this.outputLen=b,this.padOffset=c,this.isLE=d,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(a),this.view=i(this.buffer)}update(a){g(this);let{view:b,buffer:c,blockLen:d}=this,e=(a=j(a)).length;for(let f=0;f<e;){let g=Math.min(d-this.pos,e-f);if(g===d){let b=i(a);for(;d<=e-f;f+=d)this.process(b,f);continue}c.set(a.subarray(f,f+g),this.pos),this.pos+=g,f+=g,this.pos===d&&(this.process(b,0),this.pos=0)}return this.length+=a.length,this.roundClean(),this}digestInto(a){g(this),function(a,b){f(a);let c=b.outputLen;if(a.length<c)throw Error("digestInto() expects output buffer of length at least "+c)}(a,this),this.finished=!0;let{buffer:b,view:c,blockLen:d,isLE:e}=this,{pos:h}=this;b[h++]=128,this.buffer.subarray(h).fill(0),this.padOffset>d-h&&(this.process(c,0),h=0);for(let a=h;a<d;a++)b[a]=0;(function(a,b,c,d){if("function"==typeof a.setBigUint64)return a.setBigUint64(b,c,d);let e=BigInt(32),f=BigInt(0xffffffff),g=Number(c>>e&f),h=Number(c&f),i=4*!!d,j=4*!d;a.setUint32(b+i,g,d),a.setUint32(b+j,h,d)})(c,d-8,BigInt(8*this.length),e),this.process(c,0);let j=i(a),k=this.outputLen;if(k%4)throw Error("_sha2: outputLen should be aligned to 32bit");let l=k/4,m=this.get();if(l>m.length)throw Error("_sha2: outputLen bigger than state");for(let a=0;a<l;a++)j.setUint32(4*a,m[a],e)}digest(){let{buffer:a,outputLen:b}=this;this.digestInto(a);let c=a.slice(0,b);return this.destroy(),c}_cloneInto(a){a||(a=new this.constructor),a.set(...this.get());let{blockLen:b,buffer:c,length:d,finished:e,destroyed:f,pos:g}=this;return a.length=d,a.pos=g,a.finished=e,a.destroyed=f,d%b&&a.buffer.set(c),a}}let o=BigInt(0x100000000-1),p=BigInt(32),q={split:function(a,b=!1){let c=new Uint32Array(a.length),d=new Uint32Array(a.length);for(let e=0;e<a.length;e++){let{h:f,l:g}=function(a,b=!1){return b?{h:Number(a&o),l:Number(a>>p&o)}:{h:0|Number(a>>p&o),l:0|Number(a&o)}}(a[e],b);[c[e],d[e]]=[f,g]}return[c,d]},shrSH:(a,b,c)=>a>>>c,shrSL:(a,b,c)=>a<<32-c|b>>>c,rotrSH:(a,b,c)=>a>>>c|b<<32-c,rotrSL:(a,b,c)=>a<<32-c|b>>>c,rotrBH:(a,b,c)=>a<<64-c|b>>>c-32,rotrBL:(a,b,c)=>a>>>c-32|b<<64-c,add:function(a,b,c,d){let e=(b>>>0)+(d>>>0);return{h:a+c+(e/0x100000000|0)|0,l:0|e}},add3L:(a,b,c)=>(a>>>0)+(b>>>0)+(c>>>0),add3H:(a,b,c,d)=>b+c+d+(a/0x100000000|0)|0,add4L:(a,b,c,d)=>(a>>>0)+(b>>>0)+(c>>>0)+(d>>>0),add4H:(a,b,c,d,e)=>b+c+d+e+(a/0x100000000|0)|0,add5H:(a,b,c,d,e,f)=>b+c+d+e+f+(a/0x100000000|0)|0,add5L:(a,b,c,d,e)=>(a>>>0)+(b>>>0)+(c>>>0)+(d>>>0)+(e>>>0)},[r,s]=q.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(a=>BigInt(a))),t=new Uint32Array(80),u=new Uint32Array(80);class v extends m{constructor(){super(128,64,16,!1),this.Ah=0x6a09e667,this.Al=-0xc4336f8,this.Bh=-0x4498517b,this.Bl=-0x7b3558c5,this.Ch=0x3c6ef372,this.Cl=-0x16b07d5,this.Dh=-0x5ab00ac6,this.Dl=0x5f1d36f1,this.Eh=0x510e527f,this.El=-0x52197d2f,this.Fh=-0x64fa9774,this.Fl=0x2b3e6c1f,this.Gh=0x1f83d9ab,this.Gl=-0x4be4295,this.Hh=0x5be0cd19,this.Hl=0x137e2179}get(){let{Ah:a,Al:b,Bh:c,Bl:d,Ch:e,Cl:f,Dh:g,Dl:h,Eh:i,El:j,Fh:k,Fl:l,Gh:m,Gl:o,Hh:p,Hl:q}=this;return[a,b,c,d,e,f,g,h,i,j,k,l,m,o,p,q]}set(a,b,c,d,e,f,g,h,i,j,k,l,m,o,p,q){this.Ah=0|a,this.Al=0|b,this.Bh=0|c,this.Bl=0|d,this.Ch=0|e,this.Cl=0|f,this.Dh=0|g,this.Dl=0|h,this.Eh=0|i,this.El=0|j,this.Fh=0|k,this.Fl=0|l,this.Gh=0|m,this.Gl=0|o,this.Hh=0|p,this.Hl=0|q}process(a,b){for(let c=0;c<16;c++,b+=4)t[c]=a.getUint32(b),u[c]=a.getUint32(b+=4);for(let a=16;a<80;a++){let b=0|t[a-15],c=0|u[a-15],d=q.rotrSH(b,c,1)^q.rotrSH(b,c,8)^q.shrSH(b,c,7),e=q.rotrSL(b,c,1)^q.rotrSL(b,c,8)^q.shrSL(b,c,7),f=0|t[a-2],g=0|u[a-2],h=q.rotrSH(f,g,19)^q.rotrBH(f,g,61)^q.shrSH(f,g,6),i=q.rotrSL(f,g,19)^q.rotrBL(f,g,61)^q.shrSL(f,g,6),j=q.add4L(e,i,u[a-7],u[a-16]),k=q.add4H(j,d,h,t[a-7],t[a-16]);t[a]=0|k,u[a]=0|j}let{Ah:c,Al:d,Bh:e,Bl:f,Ch:g,Cl:h,Dh:i,Dl:j,Eh:k,El:l,Fh:m,Fl:o,Gh:p,Gl:v,Hh:w,Hl:x}=this;for(let a=0;a<80;a++){let b=q.rotrSH(k,l,14)^q.rotrSH(k,l,18)^q.rotrBH(k,l,41),y=q.rotrSL(k,l,14)^q.rotrSL(k,l,18)^q.rotrBL(k,l,41),z=k&m^~k&p,A=l&o^~l&v,B=q.add5L(x,y,A,s[a],u[a]),C=q.add5H(B,w,b,z,r[a],t[a]),D=0|B,E=q.rotrSH(c,d,28)^q.rotrBH(c,d,34)^q.rotrBH(c,d,39),F=q.rotrSL(c,d,28)^q.rotrBL(c,d,34)^q.rotrBL(c,d,39),G=c&e^c&g^e&g,H=d&f^d&h^f&h;w=0|p,x=0|v,p=0|m,v=0|o,m=0|k,o=0|l,({h:k,l:l}=q.add(0|i,0|j,0|C,0|D)),i=0|g,j=0|h,g=0|e,h=0|f,e=0|c,f=0|d;let I=q.add3L(D,F,H);c=q.add3H(I,C,E,G),d=0|I}({h:c,l:d}=q.add(0|this.Ah,0|this.Al,0|c,0|d)),({h:e,l:f}=q.add(0|this.Bh,0|this.Bl,0|e,0|f)),({h:g,l:h}=q.add(0|this.Ch,0|this.Cl,0|g,0|h)),({h:i,l:j}=q.add(0|this.Dh,0|this.Dl,0|i,0|j)),({h:k,l:l}=q.add(0|this.Eh,0|this.El,0|k,0|l)),({h:m,l:o}=q.add(0|this.Fh,0|this.Fl,0|m,0|o)),({h:p,l:v}=q.add(0|this.Gh,0|this.Gl,0|p,0|v)),({h:w,l:x}=q.add(0|this.Hh,0|this.Hl,0|w,0|x)),this.set(c,d,e,f,g,h,i,j,k,l,m,o,p,v,w,x)}roundClean(){t.fill(0),u.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}let w=function(a){let b=b=>a().update(j(b)).digest(),c=a();return b.outputLen=c.outputLen,b.blockLen=c.blockLen,b.create=()=>a(),b}(()=>new v),x=BigInt(0),y=BigInt(1),z=BigInt(2);function A(a){return a instanceof Uint8Array||ArrayBuffer.isView(a)&&"Uint8Array"===a.constructor.name}function B(a){if(!A(a))throw Error("Uint8Array expected")}function C(a,b){if("boolean"!=typeof b)throw Error(a+" boolean expected, got "+b)}let D=Array.from({length:256},(a,b)=>b.toString(16).padStart(2,"0"));function E(a){B(a);let b="";for(let c=0;c<a.length;c++)b+=D[a[c]];return b}function F(a){if("string"!=typeof a)throw Error("hex string expected, got "+typeof a);return""===a?x:BigInt("0x"+a)}let G={_0:48,_9:57,A:65,F:70,a:97,f:102};function H(a){return a>=G._0&&a<=G._9?a-G._0:a>=G.A&&a<=G.F?a-(G.A-10):a>=G.a&&a<=G.f?a-(G.a-10):void 0}function I(a){if("string"!=typeof a)throw Error("hex string expected, got "+typeof a);let b=a.length,c=b/2;if(b%2)throw Error("hex string expected, got unpadded hex of length "+b);let d=new Uint8Array(c);for(let b=0,e=0;b<c;b++,e+=2){let c=H(a.charCodeAt(e)),f=H(a.charCodeAt(e+1));if(void 0===c||void 0===f)throw Error('hex string expected, got non-hex character "'+(a[e]+a[e+1])+'" at index '+e);d[b]=16*c+f}return d}function J(a){return B(a),F(E(Uint8Array.from(a).reverse()))}function K(a,b){return I(a.toString(16).padStart(2*b,"0"))}function L(a,b){return K(a,b).reverse()}function M(a,b,c){let d;if("string"==typeof b)try{d=I(b)}catch(b){throw Error(a+" must be hex string or Uint8Array, cause: "+b)}else if(A(b))d=Uint8Array.from(b);else throw Error(a+" must be hex string or Uint8Array");let e=d.length;if("number"==typeof c&&e!==c)throw Error(a+" of length "+c+" expected, got "+e);return d}function N(...a){let b=0;for(let c=0;c<a.length;c++){let d=a[c];B(d),b+=d.length}let c=new Uint8Array(b);for(let b=0,d=0;b<a.length;b++){let e=a[b];c.set(e,d),d+=e.length}return c}let O=a=>"bigint"==typeof a&&x<=a;function P(a,b,c,d){if(!(O(b)&&O(c)&&O(d))||!(c<=b)||!(b<d))throw Error("expected valid "+a+": "+c+" <= n < "+d+", got "+b)}let Q={bigint:a=>"bigint"==typeof a,function:a=>"function"==typeof a,boolean:a=>"boolean"==typeof a,string:a=>"string"==typeof a,stringOrUint8Array:a=>"string"==typeof a||A(a),isSafeInteger:a=>Number.isSafeInteger(a),array:a=>Array.isArray(a),field:(a,b)=>b.Fp.isValid(a),hash:a=>"function"==typeof a&&Number.isSafeInteger(a.outputLen)};function R(a,b,c={}){let d=(b,c,d)=>{let e=Q[c];if("function"!=typeof e)throw Error("invalid validator function");let f=a[b];if(!(d&&void 0===f)&&!e(f,a))throw Error("param "+String(b)+" is invalid. Expected "+c+", got "+f)};for(let[a,c]of Object.entries(b))d(a,c,!1);for(let[a,b]of Object.entries(c))d(a,b,!0);return a}function S(a){let b=new WeakMap;return(c,...d)=>{let e=b.get(c);if(void 0!==e)return e;let f=a(c,...d);return b.set(c,f),f}}let T=BigInt(0),U=BigInt(1),V=BigInt(2),W=BigInt(3),X=BigInt(4),Y=BigInt(5),Z=BigInt(8);function $(a,b){let c=a%b;return c>=T?c:b+c}function _(a,b,c){let d=a;for(;b-- >T;)d*=d,d%=c;return d}function aa(a,b){if(a===T)throw Error("invert: expected non-zero number");if(b<=T)throw Error("invert: expected positive modulus, got "+b);let c=$(a,b),d=b,e=T,f=U;for(;c!==T;){let a=d/c,b=d%c,g=e-f*a;d=c,c=b,e=f,f=g}if(d!==U)throw Error("invert: does not exist");return $(e,b)}let ab=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function ac(a,b){let c=void 0!==b?b:a.toString(2).length,d=Math.ceil(c/8);return{nBitLength:c,nByteLength:d}}function ad(a,b,c=!1,d={}){let e;if(a<=T)throw Error("invalid field: expected ORDER > 0, got "+a);let{nBitLength:f,nByteLength:g}=ac(a,b);if(g>2048)throw Error("invalid field: expected ORDER of <= 2048 bytes");let h=Object.freeze({ORDER:a,isLE:c,BITS:f,BYTES:g,MASK:(z<<BigInt(f-1))-y,ZERO:T,ONE:U,create:b=>$(b,a),isValid:b=>{if("bigint"!=typeof b)throw Error("invalid field element: expected bigint, got "+typeof b);return T<=b&&b<a},is0:a=>a===T,isOdd:a=>(a&U)===U,neg:b=>$(-b,a),eql:(a,b)=>a===b,sqr:b=>$(b*b,a),add:(b,c)=>$(b+c,a),sub:(b,c)=>$(b-c,a),mul:(b,c)=>$(b*c,a),pow:(a,b)=>(function(a,b,c){if(c<T)throw Error("invalid exponent, negatives unsupported");if(c===T)return a.ONE;if(c===U)return b;let d=a.ONE,e=b;for(;c>T;)c&U&&(d=a.mul(d,e)),e=a.sqr(e),c>>=U;return d})(h,a,b),div:(b,c)=>$(b*aa(c,a),a),sqrN:a=>a*a,addN:(a,b)=>a+b,subN:(a,b)=>a-b,mulN:(a,b)=>a*b,inv:b=>aa(b,a),sqrt:d.sqrt||(b=>(e||(e=function(a){if(a%X===W){let b=(a+U)/X;return function(a,c){let d=a.pow(c,b);if(!a.eql(a.sqr(d),c))throw Error("Cannot find square root");return d}}if(a%Z===Y){let b=(a-Y)/Z;return function(a,c){let d=a.mul(c,V),e=a.pow(d,b),f=a.mul(c,e),g=a.mul(a.mul(f,V),e),h=a.mul(f,a.sub(g,a.ONE));if(!a.eql(a.sqr(h),c))throw Error("Cannot find square root");return h}}return function(a){let b,c,d,e=(a-U)/V;for(b=a-U,c=0;b%V===T;b/=V,c++);for(d=V;d<a&&function(a,b,c){if(b<T)throw Error("invalid exponent, negatives unsupported");if(c<=T)throw Error("invalid modulus");if(c===U)return T;let d=U;for(;b>T;)b&U&&(d=d*a%c),a=a*a%c,b>>=U;return d}(d,e,a)!==a-U;d++)if(d>1e3)throw Error("Cannot find square root: likely non-prime P");if(1===c){let b=(a+U)/X;return function(a,c){let d=a.pow(c,b);if(!a.eql(a.sqr(d),c))throw Error("Cannot find square root");return d}}let f=(b+U)/V;return function(a,g){if(a.pow(g,e)===a.neg(a.ONE))throw Error("Cannot find square root");let h=c,i=a.pow(a.mul(a.ONE,d),b),j=a.pow(g,f),k=a.pow(g,b);for(;!a.eql(k,a.ONE);){if(a.eql(k,a.ZERO))return a.ZERO;let b=1;for(let c=a.sqr(k);b<h&&!a.eql(c,a.ONE);b++)c=a.sqr(c);let c=a.pow(i,U<<BigInt(h-b-1));i=a.sqr(c),j=a.mul(j,c),k=a.mul(k,i),h=b}return j}}(a)}(a)),e(h,b))),invertBatch:a=>(function(a,b){let c=Array(b.length),d=b.reduce((b,d,e)=>a.is0(d)?b:(c[e]=b,a.mul(b,d)),a.ONE),e=a.inv(d);return b.reduceRight((b,d,e)=>a.is0(d)?b:(c[e]=a.mul(b,c[e]),a.mul(b,d)),e),c})(h,a),cmov:(a,b,c)=>c?b:a,toBytes:a=>c?L(a,g):K(a,g),fromBytes:a=>{if(a.length!==g)throw Error("Field.fromBytes: expected "+g+" bytes, got "+a.length);return c?J(a):F(E(a))}});return Object.freeze(h)}let ae=BigInt(0),af=BigInt(1);function ag(a,b){let c=b.negate();return a?c:b}function ah(a,b){if(!Number.isSafeInteger(a)||a<=0||a>b)throw Error("invalid window size, expected [1.."+b+"], got W="+a)}function ai(a,b){return ah(a,b),{windows:Math.ceil(b/a)+1,windowSize:2**(a-1)}}let aj=new WeakMap,ak=new WeakMap;function al(a){return ak.get(a)||1}let am=BigInt(0),an=BigInt(1),ao=BigInt(2),ap=BigInt(8),aq={zip215:!0};BigInt(0),BigInt(1);let ar=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),as=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);let at=BigInt(1),au=BigInt(2);BigInt(3);let av=BigInt(5),aw=BigInt(8),ax=ad(ar,void 0,!0),ay=function(a){var b;let c=function(a){let b=(R(a.Fp,ab.reduce((a,b)=>(a[b]="function",a),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"})),R(a,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...ac(a.n,a.nBitLength),...a,p:a.Fp.ORDER}));return R(a,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...b})}(a),{Fp:d,n:e,prehash:f,hash:g,randomBytes:h,nByteLength:i,h:j}=c,k=ao<<BigInt(8*i)-an,l=d.create,m=ad(c.n,c.nBitLength),o=c.uvRatio||((a,b)=>{try{return{isValid:!0,value:d.sqrt(a*d.inv(b))}}catch{return{isValid:!1,value:am}}}),p=c.adjustScalarBytes||(a=>a),q=c.domain||((a,b,c)=>{if(C("phflag",c),b.length||c)throw Error("Contexts/pre-hash are not supported");return a});function r(a,b){P("coordinate "+a,b,am,k)}function s(a){if(!(a instanceof v))throw Error("ExtendedPoint expected")}let t=S((a,b)=>{let{ex:c,ey:e,ez:f}=a,g=a.is0();null==b&&(b=g?ap:d.inv(f));let h=l(c*b),i=l(e*b),j=l(f*b);if(g)return{x:am,y:an};if(j!==an)throw Error("invZ was invalid");return{x:h,y:i}}),u=S(a=>{let{a:b,d:d}=c;if(a.is0())throw Error("bad point: ZERO");let{ex:e,ey:f,ez:g,et:h}=a,i=l(e*e),j=l(f*f),k=l(g*g),m=l(k*k),o=l(i*b);if(l(k*l(o+j))!==l(m+l(d*l(i*j))))throw Error("bad point: equation left != right (1)");if(l(e*f)!==l(g*h))throw Error("bad point: equation left != right (2)");return!0});class v{constructor(a,b,c,d){this.ex=a,this.ey=b,this.ez=c,this.et=d,r("x",a),r("y",b),r("z",c),r("t",d),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(a){if(a instanceof v)throw Error("extended point not allowed");let{x:b,y:c}=a||{};return r("x",b),r("y",c),new v(b,c,an,l(b*c))}static normalizeZ(a){let b=d.invertBatch(a.map(a=>a.ez));return a.map((a,c)=>a.toAffine(b[c])).map(v.fromAffine)}static msm(a,b){return function(a,b,c,d){if(function(a,b){if(!Array.isArray(a))throw Error("array expected");a.forEach((a,c)=>{if(!(a instanceof b))throw Error("invalid point at index "+c)})}(c,a),function(a,b){if(!Array.isArray(a))throw Error("array of scalars expected");a.forEach((a,c)=>{if(!b.isValid(a))throw Error("invalid scalar at index "+c)})}(d,b),c.length!==d.length)throw Error("arrays of points and scalars must have equal length");let e=a.ZERO,f=function(a){let b;for(b=0;a>x;a>>=y,b+=1);return b}(BigInt(c.length)),g=f>12?f-3:f>4?f-2:f?2:1,h=(1<<g)-1,i=Array(h+1).fill(e),j=Math.floor((b.BITS-1)/g)*g,k=e;for(let a=j;a>=0;a-=g){i.fill(e);for(let b=0;b<d.length;b++){let e=Number(d[b]>>BigInt(a)&BigInt(h));i[e]=i[e].add(c[b])}let b=e;for(let a=i.length-1,c=e;a>0;a--)c=c.add(i[a]),b=b.add(c);if(k=k.add(b),0!==a)for(let a=0;a<g;a++)k=k.double()}return k}(v,m,a,b)}_setWindowSize(a){A.setWindowSize(this,a)}assertValidity(){u(this)}equals(a){s(a);let{ex:b,ey:c,ez:d}=this,{ex:e,ey:f,ez:g}=a,h=l(b*g),i=l(e*d),j=l(c*g),k=l(f*d);return h===i&&j===k}is0(){return this.equals(v.ZERO)}negate(){return new v(l(-this.ex),this.ey,this.ez,l(-this.et))}double(){let{a:a}=c,{ex:b,ey:d,ez:e}=this,f=l(b*b),g=l(d*d),h=l(ao*l(e*e)),i=l(a*f),j=b+d,k=l(l(j*j)-f-g),m=i+g,o=m-h,p=i-g,q=l(k*o),r=l(m*p),s=l(k*p);return new v(q,r,l(o*m),s)}add(a){s(a);let{a:b,d:d}=c,{ex:e,ey:f,ez:g,et:h}=this,{ex:i,ey:j,ez:k,et:m}=a;if(b===BigInt(-1)){let a=l((f-e)*(j+i)),b=l((f+e)*(j-i)),c=l(b-a);if(c===am)return this.double();let d=l(g*ao*m),o=l(h*ao*k),p=o+d,q=b+a,r=o-d,s=l(p*c),t=l(q*r),u=l(p*r);return new v(s,t,l(c*q),u)}let o=l(e*i),p=l(f*j),q=l(h*d*m),r=l(g*k),t=l((e+f)*(i+j)-o-p),u=r-q,w=r+q,x=l(p-b*o),y=l(t*u),z=l(w*x),A=l(t*x);return new v(y,z,l(u*w),A)}subtract(a){return this.add(a.negate())}wNAF(a){return A.wNAFCached(this,a,v.normalizeZ)}multiply(a){P("scalar",a,an,e);let{p:b,f:c}=this.wNAF(a);return v.normalizeZ([b,c])[0]}multiplyUnsafe(a,b=v.ZERO){return P("scalar",a,am,e),a===am?z:this.is0()||a===an?this:A.wNAFCachedUnsafe(this,a,v.normalizeZ,b)}isSmallOrder(){return this.multiplyUnsafe(j).is0()}isTorsionFree(){return A.unsafeLadder(this,e).is0()}toAffine(a){return t(this,a)}clearCofactor(){let{h:a}=c;return a===an?this:this.multiplyUnsafe(a)}static fromHex(a,b=!1){let{d:e,a:f}=c,g=d.BYTES;a=M("pointHex",a,g),C("zip215",b);let h=a.slice(),i=a[g-1];h[g-1]=-129&i;let j=J(h);P("pointHex.y",j,am,b?k:d.ORDER);let m=l(j*j),{isValid:p,value:q}=o(l(m-an),l(e*m-f));if(!p)throw Error("Point.fromHex: invalid y coordinate");let r=(q&an)===an,s=(128&i)!=0;if(!b&&q===am&&s)throw Error("Point.fromHex: x=0 and x_0=1");return s!==r&&(q=l(-q)),v.fromAffine({x:q,y:j})}static fromPrivateKey(a){return B(a).point}toRawBytes(){let{x:a,y:b}=this.toAffine(),c=L(b,d.BYTES);return c[c.length-1]|=a&an?128:0,c}toHex(){return E(this.toRawBytes())}}v.BASE=new v(c.Gx,c.Gy,an,l(c.Gx*c.Gy)),v.ZERO=new v(am,an,an,am);let{BASE:w,ZERO:z}=v,A=(b=8*i,{constTimeNegate:ag,hasPrecomputes:a=>1!==al(a),unsafeLadder(a,b,c=v.ZERO){let d=a;for(;b>ae;)b&af&&(c=c.add(d)),d=d.double(),b>>=af;return c},precomputeWindow(a,c){let{windows:d,windowSize:e}=ai(c,b),f=[],g=a,h=g;for(let a=0;a<d;a++){h=g,f.push(h);for(let a=1;a<e;a++)h=h.add(g),f.push(h);g=h.double()}return f},wNAF(a,c,d){let{windows:e,windowSize:f}=ai(a,b),g=v.ZERO,h=v.BASE,i=BigInt(2**a-1),j=2**a,k=BigInt(a);for(let a=0;a<e;a++){let b=a*f,e=Number(d&i);d>>=k,e>f&&(e-=j,d+=af);let l=b+Math.abs(e)-1,m=a%2!=0,o=e<0;0===e?h=h.add(ag(m,c[b])):g=g.add(ag(o,c[l]))}return{p:g,f:h}},wNAFUnsafe(a,c,d,e=v.ZERO){let{windows:f,windowSize:g}=ai(a,b),h=BigInt(2**a-1),i=2**a,j=BigInt(a);for(let a=0;a<f;a++){let b=a*g;if(d===ae)break;let f=Number(d&h);if(d>>=j,f>g&&(f-=i,d+=af),0===f)continue;let k=c[b+Math.abs(f)-1];f<0&&(k=k.negate()),e=e.add(k)}return e},getPrecomputes(a,b,c){let d=aj.get(b);return d||(d=this.precomputeWindow(b,a),1!==a&&aj.set(b,c(d))),d},wNAFCached(a,b,c){let d=al(a);return this.wNAF(d,this.getPrecomputes(d,a,c),b)},wNAFCachedUnsafe(a,b,c,d){let e=al(a);return 1===e?this.unsafeLadder(a,b,d):this.wNAFUnsafe(e,this.getPrecomputes(e,a,c),b,d)},setWindowSize(a,c){ah(c,b),ak.set(a,c),aj.delete(a)}});function B(a){let b=d.BYTES;a=M("private key",a,b);let c=M("hashed private key",g(a),2*b),f=p(c.slice(0,b)),h=c.slice(b,2*b),i=$(J(f),e),j=w.multiply(i),k=j.toRawBytes();return{head:f,prefix:h,scalar:i,point:j,pointBytes:k}}function D(a=new Uint8Array,...b){return $(J(g(q(N(...b),M("context",a),!!f))),e)}return w._setWindowSize(8),{CURVE:c,getPublicKey:function(a){return B(a).pointBytes},sign:function(a,b,c={}){a=M("message",a),f&&(a=f(a));let{prefix:g,scalar:h,pointBytes:i}=B(b),j=D(c.context,g,a),k=w.multiply(j).toRawBytes(),l=$(j+D(c.context,k,i,a)*h,e);return P("signature.s",l,am,e),M("result",N(k,L(l,d.BYTES)),2*d.BYTES)},verify:function(a,b,c,e=aq){let g,h,i,{context:j,zip215:k}=e,l=d.BYTES;a=M("signature",a,2*l),b=M("message",b),c=M("publicKey",c,l),void 0!==k&&C("zip215",k),f&&(b=f(b));let m=J(a.slice(l,2*l));try{g=v.fromHex(c,k),h=v.fromHex(a.slice(0,l),k),i=w.multiplyUnsafe(m)}catch{return!1}if(!k&&g.isSmallOrder())return!1;let o=D(j,h.toRawBytes(),g.toRawBytes(),b);return h.add(g.multiplyUnsafe(o)).subtract(i).clearCofactor().equals(v.ZERO)},ExtendedPoint:v,utils:{getExtendedPublicKey:B,randomPrivateKey:()=>h(d.BYTES),precompute:(a=8,b=v.BASE)=>(b._setWindowSize(a),b.multiply(BigInt(3)),b)}}}({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:ax,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:aw,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:w,randomBytes:l,adjustScalarBytes:function(a){return a[0]&=248,a[31]&=127,a[31]|=64,a},uvRatio:function(a,b){let c=$(b*b*b,ar),d=function(a){let b=BigInt(10),c=BigInt(20),d=BigInt(40),e=BigInt(80),f=a*a%ar*a%ar,g=_(f,au,ar)*f%ar,h=_(g,at,ar)*a%ar,i=_(h,av,ar)*h%ar,j=_(i,b,ar)*i%ar,k=_(j,c,ar)*j%ar,l=_(k,d,ar)*k%ar,m=_(l,e,ar)*l%ar,o=_(m,e,ar)*l%ar,p=_(o,b,ar)*i%ar;return{pow_p_5_8:_(p,au,ar)*a%ar,b2:f}}(a*$(c*c*b,ar)).pow_p_5_8,e=$(a*c*d,ar),f=$(b*e*e,ar),g=e,h=$(e*as,ar),i=f===a,j=f===$(-a,ar),k=f===$(-a*as,ar);return i&&(e=g),(j||k)&&(e=h),($(e,ar)&U)===U&&(e=$(-e,ar)),{isValid:i||j,value:e}}}),az="base64url",aA="utf8",aB="utf8",aC="base58btc";function aD(a){return null!=globalThis.Buffer?new Uint8Array(a.buffer,a.byteOffset,a.byteLength):a}function aE(a=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?aD(globalThis.Buffer.allocUnsafe(a)):new Uint8Array(a)}function aF(a,b){b||(b=a.reduce((a,b)=>a+b.length,0));let c=aE(b),d=0;for(let b of a)c.set(b,d),d+=b.length;return aD(c)}var aG=function(a,b){if(a.length>=255)throw TypeError("Alphabet too long");for(var c=new Uint8Array(256),d=0;d<c.length;d++)c[d]=255;for(var e=0;e<a.length;e++){var f=a.charAt(e),g=f.charCodeAt(0);if(255!==c[g])throw TypeError(f+" is ambiguous");c[g]=e}var h=a.length,i=a.charAt(0),j=Math.log(h)/Math.log(256),k=Math.log(256)/Math.log(h);function l(a){if("string"!=typeof a)throw TypeError("Expected String");if(0===a.length)return new Uint8Array;var b=0;if(" "!==a[0]){for(var d=0,e=0;a[b]===i;)d++,b++;for(var f=(a.length-b)*j+1>>>0,g=new Uint8Array(f);a[b];){var k=c[a.charCodeAt(b)];if(255===k)return;for(var l=0,m=f-1;(0!==k||l<e)&&-1!==m;m--,l++)k+=h*g[m]>>>0,g[m]=k%256>>>0,k=k/256>>>0;if(0!==k)throw Error("Non-zero carry");e=l,b++}if(" "!==a[b]){for(var o=f-e;o!==f&&0===g[o];)o++;for(var p=new Uint8Array(d+(f-o)),q=d;o!==f;)p[q++]=g[o++];return p}}}return{encode:function(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw TypeError("Expected Uint8Array");if(0===b.length)return"";for(var c=0,d=0,e=0,f=b.length;e!==f&&0===b[e];)e++,c++;for(var g=(f-e)*k+1>>>0,j=new Uint8Array(g);e!==f;){for(var l=b[e],m=0,o=g-1;(0!==l||m<d)&&-1!==o;o--,m++)l+=256*j[o]>>>0,j[o]=l%h>>>0,l=l/h>>>0;if(0!==l)throw Error("Non-zero carry");d=m,e++}for(var p=g-d;p!==g&&0===j[p];)p++;for(var q=i.repeat(c);p<g;++p)q+=a.charAt(j[p]);return q},decodeUnsafe:l,decode:function(a){var c=l(a);if(c)return c;throw Error(`Non-${b} character`)}}};let aH=a=>{if(a instanceof Uint8Array&&"Uint8Array"===a.constructor.name)return a;if(a instanceof ArrayBuffer)return new Uint8Array(a);if(ArrayBuffer.isView(a))return new Uint8Array(a.buffer,a.byteOffset,a.byteLength);throw Error("Unknown type, must be binary type")};class aI{constructor(a,b,c){this.name=a,this.prefix=b,this.baseEncode=c}encode(a){if(a instanceof Uint8Array)return`${this.prefix}${this.baseEncode(a)}`;throw Error("Unknown type, must be binary type")}}class aJ{constructor(a,b,c){if(this.name=a,this.prefix=b,void 0===b.codePointAt(0))throw Error("Invalid prefix character");this.prefixCodePoint=b.codePointAt(0),this.baseDecode=c}decode(a){if("string"==typeof a){if(a.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(a)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(a.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(a){return aL(this,a)}}class aK{constructor(a){this.decoders=a}or(a){return aL(this,a)}decode(a){let b=a[0],c=this.decoders[b];if(c)return c.decode(a);throw RangeError(`Unable to decode multibase string ${JSON.stringify(a)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}let aL=(a,b)=>new aK({...a.decoders||{[a.prefix]:a},...b.decoders||{[b.prefix]:b}});class aM{constructor(a,b,c,d){this.name=a,this.prefix=b,this.baseEncode=c,this.baseDecode=d,this.encoder=new aI(a,b,c),this.decoder=new aJ(a,b,d)}encode(a){return this.encoder.encode(a)}decode(a){return this.decoder.decode(a)}}let aN=({name:a,prefix:b,encode:c,decode:d})=>new aM(a,b,c,d),aO=({prefix:a,name:b,alphabet:c})=>{let{encode:d,decode:e}=aG(c,b);return aN({prefix:a,name:b,encode:d,decode:a=>aH(e(a))})},aP=({name:a,prefix:b,bitsPerChar:c,alphabet:d})=>aN({prefix:b,name:a,encode:a=>((a,b,c)=>{let d="="===b[b.length-1],e=(1<<c)-1,f="",g=0,h=0;for(let d=0;d<a.length;++d)for(h=h<<8|a[d],g+=8;g>c;)g-=c,f+=b[e&h>>g];if(g&&(f+=b[e&h<<c-g]),d)for(;f.length*c&7;)f+="=";return f})(a,d,c),decode:b=>((a,b,c,d)=>{let e={};for(let a=0;a<b.length;++a)e[b[a]]=a;let f=a.length;for(;"="===a[f-1];)--f;let g=new Uint8Array(f*c/8|0),h=0,i=0,j=0;for(let b=0;b<f;++b){let f=e[a[b]];if(void 0===f)throw SyntaxError(`Non-${d} character`);i=i<<c|f,(h+=c)>=8&&(h-=8,g[j++]=255&i>>h)}if(h>=c||255&i<<8-h)throw SyntaxError("Unexpected end of data");return g})(b,d,c,a)});var aQ=Object.freeze({__proto__:null,identity:aN({prefix:"\0",name:"identity",encode:a=>new TextDecoder().decode(a),decode:a=>new TextEncoder().encode(a)})}),aR=Object.freeze({__proto__:null,base2:aP({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1})}),aS=Object.freeze({__proto__:null,base8:aP({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3})}),aT=Object.freeze({__proto__:null,base10:aO({prefix:"9",name:"base10",alphabet:"0123456789"})}),aU=Object.freeze({__proto__:null,base16:aP({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),base16upper:aP({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4})});let aV=aP({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),aW=aP({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),aX=aP({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),aY=aP({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),aZ=aP({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),a$=aP({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),a_=aP({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5});var a0=Object.freeze({__proto__:null,base32:aV,base32upper:aW,base32pad:aX,base32padupper:aY,base32hex:aZ,base32hexupper:a$,base32hexpad:a_,base32hexpadupper:aP({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),base32z:aP({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})}),a1=Object.freeze({__proto__:null,base36:aO({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),base36upper:aO({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})}),a2=Object.freeze({__proto__:null,base58btc:aO({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),base58flickr:aO({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})});let a3=aP({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),a4=aP({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6});var a5=Object.freeze({__proto__:null,base64:a3,base64pad:a4,base64url:aP({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),base64urlpad:aP({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})});let a6=Array.from("\uD83D\uDE80\uD83E\uDE90☄\uD83D\uDEF0\uD83C\uDF0C\uD83C\uDF11\uD83C\uDF12\uD83C\uDF13\uD83C\uDF14\uD83C\uDF15\uD83C\uDF16\uD83C\uDF17\uD83C\uDF18\uD83C\uDF0D\uD83C\uDF0F\uD83C\uDF0E\uD83D\uDC09☀\uD83D\uDCBB\uD83D\uDDA5\uD83D\uDCBE\uD83D\uDCBF\uD83D\uDE02❤\uD83D\uDE0D\uD83E\uDD23\uD83D\uDE0A\uD83D\uDE4F\uD83D\uDC95\uD83D\uDE2D\uD83D\uDE18\uD83D\uDC4D\uD83D\uDE05\uD83D\uDC4F\uD83D\uDE01\uD83D\uDD25\uD83E\uDD70\uD83D\uDC94\uD83D\uDC96\uD83D\uDC99\uD83D\uDE22\uD83E\uDD14\uD83D\uDE06\uD83D\uDE44\uD83D\uDCAA\uD83D\uDE09☺\uD83D\uDC4C\uD83E\uDD17\uD83D\uDC9C\uD83D\uDE14\uD83D\uDE0E\uD83D\uDE07\uD83C\uDF39\uD83E\uDD26\uD83C\uDF89\uD83D\uDC9E✌✨\uD83E\uDD37\uD83D\uDE31\uD83D\uDE0C\uD83C\uDF38\uD83D\uDE4C\uD83D\uDE0B\uD83D\uDC97\uD83D\uDC9A\uD83D\uDE0F\uD83D\uDC9B\uD83D\uDE42\uD83D\uDC93\uD83E\uDD29\uD83D\uDE04\uD83D\uDE00\uD83D\uDDA4\uD83D\uDE03\uD83D\uDCAF\uD83D\uDE48\uD83D\uDC47\uD83C\uDFB6\uD83D\uDE12\uD83E\uDD2D❣\uD83D\uDE1C\uD83D\uDC8B\uD83D\uDC40\uD83D\uDE2A\uD83D\uDE11\uD83D\uDCA5\uD83D\uDE4B\uD83D\uDE1E\uD83D\uDE29\uD83D\uDE21\uD83E\uDD2A\uD83D\uDC4A\uD83E\uDD73\uD83D\uDE25\uD83E\uDD24\uD83D\uDC49\uD83D\uDC83\uD83D\uDE33✋\uD83D\uDE1A\uD83D\uDE1D\uD83D\uDE34\uD83C\uDF1F\uD83D\uDE2C\uD83D\uDE43\uD83C\uDF40\uD83C\uDF37\uD83D\uDE3B\uD83D\uDE13⭐✅\uD83E\uDD7A\uD83C\uDF08\uD83D\uDE08\uD83E\uDD18\uD83D\uDCA6✔\uD83D\uDE23\uD83C\uDFC3\uD83D\uDC90☹\uD83C\uDF8A\uD83D\uDC98\uD83D\uDE20☝\uD83D\uDE15\uD83C\uDF3A\uD83C\uDF82\uD83C\uDF3B\uD83D\uDE10\uD83D\uDD95\uD83D\uDC9D\uD83D\uDE4A\uD83D\uDE39\uD83D\uDDE3\uD83D\uDCAB\uD83D\uDC80\uD83D\uDC51\uD83C\uDFB5\uD83E\uDD1E\uD83D\uDE1B\uD83D\uDD34\uD83D\uDE24\uD83C\uDF3C\uD83D\uDE2B⚽\uD83E\uDD19☕\uD83C\uDFC6\uD83E\uDD2B\uD83D\uDC48\uD83D\uDE2E\uD83D\uDE46\uD83C\uDF7B\uD83C\uDF43\uD83D\uDC36\uD83D\uDC81\uD83D\uDE32\uD83C\uDF3F\uD83E\uDDE1\uD83C\uDF81⚡\uD83C\uDF1E\uD83C\uDF88❌✊\uD83D\uDC4B\uD83D\uDE30\uD83E\uDD28\uD83D\uDE36\uD83E\uDD1D\uD83D\uDEB6\uD83D\uDCB0\uD83C\uDF53\uD83D\uDCA2\uD83E\uDD1F\uD83D\uDE41\uD83D\uDEA8\uD83D\uDCA8\uD83E\uDD2C✈\uD83C\uDF80\uD83C\uDF7A\uD83E\uDD13\uD83D\uDE19\uD83D\uDC9F\uD83C\uDF31\uD83D\uDE16\uD83D\uDC76\uD83E\uDD74▶➡❓\uD83D\uDC8E\uD83D\uDCB8⬇\uD83D\uDE28\uD83C\uDF1A\uD83E\uDD8B\uD83D\uDE37\uD83D\uDD7A⚠\uD83D\uDE45\uD83D\uDE1F\uD83D\uDE35\uD83D\uDC4E\uD83E\uDD32\uD83E\uDD20\uD83E\uDD27\uD83D\uDCCC\uD83D\uDD35\uD83D\uDC85\uD83E\uDDD0\uD83D\uDC3E\uD83C\uDF52\uD83D\uDE17\uD83E\uDD11\uD83C\uDF0A\uD83E\uDD2F\uD83D\uDC37☎\uD83D\uDCA7\uD83D\uDE2F\uD83D\uDC86\uD83D\uDC46\uD83C\uDFA4\uD83D\uDE47\uD83C\uDF51❄\uD83C\uDF34\uD83D\uDCA3\uD83D\uDC38\uD83D\uDC8C\uD83D\uDCCD\uD83E\uDD40\uD83E\uDD22\uD83D\uDC45\uD83D\uDCA1\uD83D\uDCA9\uD83D\uDC50\uD83D\uDCF8\uD83D\uDC7B\uD83E\uDD10\uD83E\uDD2E\uD83C\uDFBC\uD83E\uDD75\uD83D\uDEA9\uD83C\uDF4E\uD83C\uDF4A\uD83D\uDC7C\uD83D\uDC8D\uD83D\uDCE3\uD83E\uDD42"),a7=a6.reduce((a,b,c)=>(a[c]=b,a),[]),a8=a6.reduce((a,b,c)=>(a[b.codePointAt(0)]=c,a),[]);var a9=Object.freeze({__proto__:null,base256emoji:aN({prefix:"\uD83D\uDE80",name:"base256emoji",encode:function(a){return a.reduce((a,b)=>a+=a7[b],"")},decode:function(a){let b=[];for(let c of a){let a=a8[c.codePointAt(0)];if(void 0===a)throw Error(`Non-base256emoji character: ${c}`);b.push(a)}return new Uint8Array(b)}})});function ba(a,b,c){b=b||[],c=c||0;for(var d=c;a>=0x80000000;)b[c++]=255&a|128,a/=128;for(;-128&a;)b[c++]=255&a|128,a>>>=7;return b[c]=0|a,ba.bytes=c-d+1,b}var bb={encode:ba,encodingLength:function(a){return a<128?1:a<16384?2:a<2097152?3:a<0x10000000?4:a<0x800000000?5:a<0x40000000000?6:a<0x2000000000000?7:a<0x100000000000000?8:a<0x8000000000000000?9:10}};let bc=(a,b,c=0)=>(bb.encode(a,b,c),b),bd=a=>bb.encodingLength(a),be=(a,b)=>{let c=b.byteLength,d=bd(a),e=d+bd(c),f=new Uint8Array(e+c);return bc(a,f,0),bc(c,f,d),f.set(b,e),new bf(a,c,b,f)};class bf{constructor(a,b,c,d){this.code=a,this.size=b,this.digest=c,this.bytes=d}}let bg=({name:a,code:b,encode:c})=>new bh(a,b,c);class bh{constructor(a,b,c){this.name=a,this.code=b,this.encode=c}digest(a){if(a instanceof Uint8Array){let b=this.encode(a);return b instanceof Uint8Array?be(this.code,b):b.then(a=>be(this.code,a))}throw Error("Unknown type, must be binary type")}}let bi=a=>async b=>new Uint8Array(await crypto.subtle.digest(a,b));var bj=Object.freeze({__proto__:null,sha256:bg({name:"sha2-256",code:18,encode:bi("SHA-256")}),sha512:bg({name:"sha2-512",code:19,encode:bi("SHA-512")})}),bk=Object.freeze({__proto__:null,identity:{code:0,name:"identity",encode:aH,digest:a=>be(0,aH(a))}});new TextEncoder,new TextDecoder;let bl={...aQ,...aR,...aS,...aT,...aU,...a0,...a1,...a2,...a5,...a9};function bm(a,b,c,d){return{name:a,prefix:b,encoder:{name:a,prefix:b,encode:c},decoder:{decode:d}}}({...bj,...bk});let bn=bm("utf8","u",a=>"u"+new TextDecoder("utf8").decode(a),a=>new TextEncoder().encode(a.substring(1))),bo=bm("ascii","a",a=>{let b="a";for(let c=0;c<a.length;c++)b+=String.fromCharCode(a[c]);return b},a=>{let b=aE((a=a.substring(1)).length);for(let c=0;c<a.length;c++)b[c]=a.charCodeAt(c);return b}),bp={utf8:bn,"utf-8":bn,hex:bl.base16,latin1:bo,ascii:bo,binary:bo,...bl};function bq(a,b="utf8"){let c=bp[b];if(!c)throw Error(`Unsupported encoding "${b}"`);return("utf8"===b||"utf-8"===b)&&null!=globalThis.Buffer&&null!=globalThis.Buffer.from?globalThis.Buffer.from(a.buffer,a.byteOffset,a.byteLength).toString("utf8"):c.encoder.encode(a).substring(1)}function br(a,b="utf8"){let c=bp[b];if(!c)throw Error(`Unsupported encoding "${b}"`);return("utf8"===b||"utf-8"===b)&&null!=globalThis.Buffer&&null!=globalThis.Buffer.from?aD(globalThis.Buffer.from(a,"utf-8")):c.decoder.decode(`${c.prefix}${a}`)}function bs(a){return(0,e.j)(bq(br(a,az),aA))}function bt(a){return bq(br((0,e.h)(a),aA),az)}function bu(a){return["did:key","z"+bq(aF([br("K36",aC),a]),aC)].join(":")}function bv(a){let b=a.split("."),c=bs(b[0]),d=bs(b[1]);return{header:c,payload:d,signature:br(b[2],az),data:br(b.slice(0,2).join("."),aB)}}function bw(a=l(32)){let b=ay.getPublicKey(a);return{secretKey:aF([a,b]),publicKey:b}}async function bx(a,b,c,e,f=(0,d.fromMiliseconds)(Date.now())){let g={alg:"EdDSA",typ:"JWT"},h={iss:bu(e.publicKey),sub:a,aud:b,iat:f,exp:f+c},i=br([bt((j={header:g,payload:h}).header),bt(j.payload)].join("."),aB);var j,k={header:g,payload:h,signature:ay.sign(i,e.secretKey.slice(0,32))};return[bt(k.header),bt(k.payload),bq(k.signature,az)].join(".")}},8286:(a,b,c)=>{"use strict";c.d(b,{xW:()=>t,sH:()=>aS,dI:()=>aT});var d={};c.r(d),c.d(d,{identity:()=>E});var e={};c.r(e),c.d(e,{base2:()=>F});var f={};c.r(f),c.d(f,{base8:()=>G});var g={};c.r(g),c.d(g,{base10:()=>H});var h={};c.r(h),c.d(h,{base16:()=>I,base16upper:()=>J});var i={};c.r(i),c.d(i,{base32:()=>K,base32hex:()=>O,base32hexpad:()=>Q,base32hexpadupper:()=>R,base32hexupper:()=>P,base32pad:()=>M,base32padupper:()=>N,base32upper:()=>L,base32z:()=>S});var j={};c.r(j),c.d(j,{base36:()=>T,base36upper:()=>U});var k={};c.r(k),c.d(k,{base58btc:()=>V,base58flickr:()=>W});var l={};c.r(l),c.d(l,{base64:()=>X,base64pad:()=>Y,base64url:()=>Z,base64urlpad:()=>$});var m={};c.r(m),c.d(m,{base256emoji:()=>ac});var o={};c.r(o),c.d(o,{sha256:()=>ao,sha512:()=>ap});var p={};c.r(p),c.d(p,{identity:()=>aq});var q={};c.r(q),c.d(q,{code:()=>as,decode:()=>au,encode:()=>at,name:()=>ar});var r={};function s(a=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?globalThis.Buffer.allocUnsafe(a):new Uint8Array(a)}function t(a,b){b||(b=a.reduce((a,b)=>a+b.length,0));let c=s(b),d=0;for(let b of a)c.set(b,d),d+=b.length;return c}c.r(r),c.d(r,{code:()=>ay,decode:()=>aA,encode:()=>az,name:()=>ax});let u=function(a,b){if(a.length>=255)throw TypeError("Alphabet too long");for(var c=new Uint8Array(256),d=0;d<c.length;d++)c[d]=255;for(var e=0;e<a.length;e++){var f=a.charAt(e),g=f.charCodeAt(0);if(255!==c[g])throw TypeError(f+" is ambiguous");c[g]=e}var h=a.length,i=a.charAt(0),j=Math.log(h)/Math.log(256),k=Math.log(256)/Math.log(h);function l(a){if("string"!=typeof a)throw TypeError("Expected String");if(0===a.length)return new Uint8Array;var b=0;if(" "!==a[0]){for(var d=0,e=0;a[b]===i;)d++,b++;for(var f=(a.length-b)*j+1>>>0,g=new Uint8Array(f);a[b];){var k=c[a.charCodeAt(b)];if(255===k)return;for(var l=0,m=f-1;(0!==k||l<e)&&-1!==m;m--,l++)k+=h*g[m]>>>0,g[m]=k%256>>>0,k=k/256>>>0;if(0!==k)throw Error("Non-zero carry");e=l,b++}if(" "!==a[b]){for(var o=f-e;o!==f&&0===g[o];)o++;for(var p=new Uint8Array(d+(f-o)),q=d;o!==f;)p[q++]=g[o++];return p}}}return{encode:function(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw TypeError("Expected Uint8Array");if(0===b.length)return"";for(var c=0,d=0,e=0,f=b.length;e!==f&&0===b[e];)e++,c++;for(var g=(f-e)*k+1>>>0,j=new Uint8Array(g);e!==f;){for(var l=b[e],m=0,o=g-1;(0!==l||m<d)&&-1!==o;o--,m++)l+=256*j[o]>>>0,j[o]=l%h>>>0,l=l/h>>>0;if(0!==l)throw Error("Non-zero carry");d=m,e++}for(var p=g-d;p!==g&&0===j[p];)p++;for(var q=i.repeat(c);p<g;++p)q+=a.charAt(j[p]);return q},decodeUnsafe:l,decode:function(a){var c=l(a);if(c)return c;throw Error(`Non-${b} character`)}}};new Uint8Array(0);let v=a=>{if(a instanceof Uint8Array&&"Uint8Array"===a.constructor.name)return a;if(a instanceof ArrayBuffer)return new Uint8Array(a);if(ArrayBuffer.isView(a))return new Uint8Array(a.buffer,a.byteOffset,a.byteLength);throw Error("Unknown type, must be binary type")};class w{constructor(a,b,c){this.name=a,this.prefix=b,this.baseEncode=c}encode(a){if(a instanceof Uint8Array)return`${this.prefix}${this.baseEncode(a)}`;throw Error("Unknown type, must be binary type")}}class x{constructor(a,b,c){if(this.name=a,this.prefix=b,void 0===b.codePointAt(0))throw Error("Invalid prefix character");this.prefixCodePoint=b.codePointAt(0),this.baseDecode=c}decode(a){if("string"==typeof a){if(a.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(a)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(a.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(a){return z(this,a)}}class y{constructor(a){this.decoders=a}or(a){return z(this,a)}decode(a){let b=a[0],c=this.decoders[b];if(c)return c.decode(a);throw RangeError(`Unable to decode multibase string ${JSON.stringify(a)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}let z=(a,b)=>new y({...a.decoders||{[a.prefix]:a},...b.decoders||{[b.prefix]:b}});class A{constructor(a,b,c,d){this.name=a,this.prefix=b,this.baseEncode=c,this.baseDecode=d,this.encoder=new w(a,b,c),this.decoder=new x(a,b,d)}encode(a){return this.encoder.encode(a)}decode(a){return this.decoder.decode(a)}}let B=({name:a,prefix:b,encode:c,decode:d})=>new A(a,b,c,d),C=({prefix:a,name:b,alphabet:c})=>{let{encode:d,decode:e}=u(c,b);return B({prefix:a,name:b,encode:d,decode:a=>v(e(a))})},D=({name:a,prefix:b,bitsPerChar:c,alphabet:d})=>B({prefix:b,name:a,encode:a=>((a,b,c)=>{let d="="===b[b.length-1],e=(1<<c)-1,f="",g=0,h=0;for(let d=0;d<a.length;++d)for(h=h<<8|a[d],g+=8;g>c;)g-=c,f+=b[e&h>>g];if(g&&(f+=b[e&h<<c-g]),d)for(;f.length*c&7;)f+="=";return f})(a,d,c),decode:b=>((a,b,c,d)=>{let e={};for(let a=0;a<b.length;++a)e[b[a]]=a;let f=a.length;for(;"="===a[f-1];)--f;let g=new Uint8Array(f*c/8|0),h=0,i=0,j=0;for(let b=0;b<f;++b){let f=e[a[b]];if(void 0===f)throw SyntaxError(`Non-${d} character`);i=i<<c|f,(h+=c)>=8&&(h-=8,g[j++]=255&i>>h)}if(h>=c||255&i<<8-h)throw SyntaxError("Unexpected end of data");return g})(b,d,c,a)}),E=B({prefix:"\0",name:"identity",encode:a=>new TextDecoder().decode(a),decode:a=>new TextEncoder().encode(a)}),F=D({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),G=D({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),H=C({prefix:"9",name:"base10",alphabet:"0123456789"}),I=D({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),J=D({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),K=D({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),L=D({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),M=D({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),N=D({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),O=D({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),P=D({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Q=D({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),R=D({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),S=D({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),T=C({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),U=C({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),V=C({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),W=C({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),X=D({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Y=D({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Z=D({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),$=D({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),_=Array.from("\uD83D\uDE80\uD83E\uDE90☄\uD83D\uDEF0\uD83C\uDF0C\uD83C\uDF11\uD83C\uDF12\uD83C\uDF13\uD83C\uDF14\uD83C\uDF15\uD83C\uDF16\uD83C\uDF17\uD83C\uDF18\uD83C\uDF0D\uD83C\uDF0F\uD83C\uDF0E\uD83D\uDC09☀\uD83D\uDCBB\uD83D\uDDA5\uD83D\uDCBE\uD83D\uDCBF\uD83D\uDE02❤\uD83D\uDE0D\uD83E\uDD23\uD83D\uDE0A\uD83D\uDE4F\uD83D\uDC95\uD83D\uDE2D\uD83D\uDE18\uD83D\uDC4D\uD83D\uDE05\uD83D\uDC4F\uD83D\uDE01\uD83D\uDD25\uD83E\uDD70\uD83D\uDC94\uD83D\uDC96\uD83D\uDC99\uD83D\uDE22\uD83E\uDD14\uD83D\uDE06\uD83D\uDE44\uD83D\uDCAA\uD83D\uDE09☺\uD83D\uDC4C\uD83E\uDD17\uD83D\uDC9C\uD83D\uDE14\uD83D\uDE0E\uD83D\uDE07\uD83C\uDF39\uD83E\uDD26\uD83C\uDF89\uD83D\uDC9E✌✨\uD83E\uDD37\uD83D\uDE31\uD83D\uDE0C\uD83C\uDF38\uD83D\uDE4C\uD83D\uDE0B\uD83D\uDC97\uD83D\uDC9A\uD83D\uDE0F\uD83D\uDC9B\uD83D\uDE42\uD83D\uDC93\uD83E\uDD29\uD83D\uDE04\uD83D\uDE00\uD83D\uDDA4\uD83D\uDE03\uD83D\uDCAF\uD83D\uDE48\uD83D\uDC47\uD83C\uDFB6\uD83D\uDE12\uD83E\uDD2D❣\uD83D\uDE1C\uD83D\uDC8B\uD83D\uDC40\uD83D\uDE2A\uD83D\uDE11\uD83D\uDCA5\uD83D\uDE4B\uD83D\uDE1E\uD83D\uDE29\uD83D\uDE21\uD83E\uDD2A\uD83D\uDC4A\uD83E\uDD73\uD83D\uDE25\uD83E\uDD24\uD83D\uDC49\uD83D\uDC83\uD83D\uDE33✋\uD83D\uDE1A\uD83D\uDE1D\uD83D\uDE34\uD83C\uDF1F\uD83D\uDE2C\uD83D\uDE43\uD83C\uDF40\uD83C\uDF37\uD83D\uDE3B\uD83D\uDE13⭐✅\uD83E\uDD7A\uD83C\uDF08\uD83D\uDE08\uD83E\uDD18\uD83D\uDCA6✔\uD83D\uDE23\uD83C\uDFC3\uD83D\uDC90☹\uD83C\uDF8A\uD83D\uDC98\uD83D\uDE20☝\uD83D\uDE15\uD83C\uDF3A\uD83C\uDF82\uD83C\uDF3B\uD83D\uDE10\uD83D\uDD95\uD83D\uDC9D\uD83D\uDE4A\uD83D\uDE39\uD83D\uDDE3\uD83D\uDCAB\uD83D\uDC80\uD83D\uDC51\uD83C\uDFB5\uD83E\uDD1E\uD83D\uDE1B\uD83D\uDD34\uD83D\uDE24\uD83C\uDF3C\uD83D\uDE2B⚽\uD83E\uDD19☕\uD83C\uDFC6\uD83E\uDD2B\uD83D\uDC48\uD83D\uDE2E\uD83D\uDE46\uD83C\uDF7B\uD83C\uDF43\uD83D\uDC36\uD83D\uDC81\uD83D\uDE32\uD83C\uDF3F\uD83E\uDDE1\uD83C\uDF81⚡\uD83C\uDF1E\uD83C\uDF88❌✊\uD83D\uDC4B\uD83D\uDE30\uD83E\uDD28\uD83D\uDE36\uD83E\uDD1D\uD83D\uDEB6\uD83D\uDCB0\uD83C\uDF53\uD83D\uDCA2\uD83E\uDD1F\uD83D\uDE41\uD83D\uDEA8\uD83D\uDCA8\uD83E\uDD2C✈\uD83C\uDF80\uD83C\uDF7A\uD83E\uDD13\uD83D\uDE19\uD83D\uDC9F\uD83C\uDF31\uD83D\uDE16\uD83D\uDC76\uD83E\uDD74▶➡❓\uD83D\uDC8E\uD83D\uDCB8⬇\uD83D\uDE28\uD83C\uDF1A\uD83E\uDD8B\uD83D\uDE37\uD83D\uDD7A⚠\uD83D\uDE45\uD83D\uDE1F\uD83D\uDE35\uD83D\uDC4E\uD83E\uDD32\uD83E\uDD20\uD83E\uDD27\uD83D\uDCCC\uD83D\uDD35\uD83D\uDC85\uD83E\uDDD0\uD83D\uDC3E\uD83C\uDF52\uD83D\uDE17\uD83E\uDD11\uD83C\uDF0A\uD83E\uDD2F\uD83D\uDC37☎\uD83D\uDCA7\uD83D\uDE2F\uD83D\uDC86\uD83D\uDC46\uD83C\uDFA4\uD83D\uDE47\uD83C\uDF51❄\uD83C\uDF34\uD83D\uDCA3\uD83D\uDC38\uD83D\uDC8C\uD83D\uDCCD\uD83E\uDD40\uD83E\uDD22\uD83D\uDC45\uD83D\uDCA1\uD83D\uDCA9\uD83D\uDC50\uD83D\uDCF8\uD83D\uDC7B\uD83E\uDD10\uD83E\uDD2E\uD83C\uDFBC\uD83E\uDD75\uD83D\uDEA9\uD83C\uDF4E\uD83C\uDF4A\uD83D\uDC7C\uD83D\uDC8D\uD83D\uDCE3\uD83E\uDD42"),aa=_.reduce((a,b,c)=>(a[c]=b,a),[]),ab=_.reduce((a,b,c)=>(a[b.codePointAt(0)]=c,a),[]),ac=B({prefix:"\uD83D\uDE80",name:"base256emoji",encode:function(a){return a.reduce((a,b)=>a+=aa[b],"")},decode:function(a){let b=[];for(let c of a){let a=ab[c.codePointAt(0)];if(void 0===a)throw Error(`Non-base256emoji character: ${c}`);b.push(a)}return new Uint8Array(b)}});var ad=c(55511);function ae(a,b,c){b=b||[];for(var d=c=c||0;a>=0x80000000;)b[c++]=255&a|128,a/=128;for(;-128&a;)b[c++]=255&a|128,a>>>=7;return b[c]=0|a,ae.bytes=c-d+1,b}function af(a,b){var c,d=0,b=b||0,e=0,f=b,g=a.length;do{if(f>=g)throw af.bytes=0,RangeError("Could not decode varint");c=a[f++],d+=e<28?(127&c)<<e:(127&c)*Math.pow(2,e),e+=7}while(c>=128);return af.bytes=f-b,d}let ag={encode:ae,decode:af,encodingLength:function(a){return a<128?1:a<16384?2:a<2097152?3:a<0x10000000?4:a<0x800000000?5:a<0x40000000000?6:a<0x2000000000000?7:a<0x100000000000000?8:a<0x8000000000000000?9:10}},ah=(a,b=0)=>[ag.decode(a,b),ag.decode.bytes],ai=(a,b,c=0)=>(ag.encode(a,b,c),b),aj=a=>ag.encodingLength(a),ak=(a,b)=>{let c=b.byteLength,d=aj(a),e=d+aj(c),f=new Uint8Array(e+c);return ai(a,f,0),ai(c,f,d),f.set(b,e),new al(a,c,b,f)};class al{constructor(a,b,c,d){this.code=a,this.size=b,this.digest=c,this.bytes=d}}let am=({name:a,code:b,encode:c})=>new an(a,b,c);class an{constructor(a,b,c){this.name=a,this.code=b,this.encode=c}digest(a){if(a instanceof Uint8Array){let b=this.encode(a);return b instanceof Uint8Array?ak(this.code,b):b.then(a=>ak(this.code,a))}throw Error("Unknown type, must be binary type")}}let ao=am({name:"sha2-256",code:18,encode:a=>v(ad.createHash("sha256").update(a).digest())}),ap=am({name:"sha2-512",code:19,encode:a=>v(ad.createHash("sha512").update(a).digest())}),aq={code:0,name:"identity",encode:v,digest:a=>ak(0,v(a))},ar="raw",as=85,at=a=>v(a),au=a=>v(a),av=new TextEncoder,aw=new TextDecoder,ax="json",ay=512,az=a=>av.encode(JSON.stringify(a)),aA=a=>JSON.parse(aw.decode(a));class aB{constructor(a,b,c,d){this.code=b,this.version=a,this.multihash=c,this.bytes=d,this.byteOffset=d.byteOffset,this.byteLength=d.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:aK,byteLength:aK,code:aJ,version:aJ,multihash:aJ,bytes:aJ,_baseCache:aK,asCID:aK})}toV0(){if(0===this.version)return this;{let{code:a,multihash:b}=this;if(a!==aF)throw Error("Cannot convert a non dag-pb CID to CIDv0");if(b.code!==aG)throw Error("Cannot convert non sha2-256 multihash CID to CIDv0");return aB.createV0(b)}}toV1(){switch(this.version){case 0:{let{code:a,digest:b}=this.multihash,c=ak(a,b);return aB.createV1(this.code,c)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(a){var b,c;return a&&this.code===a.code&&this.version===a.version&&((b=this.multihash)===(c=a.multihash)||b.code===c.code&&b.size===c.size&&((a,b)=>{if(a===b)return!0;if(a.byteLength!==b.byteLength)return!1;for(let c=0;c<a.byteLength;c++)if(a[c]!==b[c])return!1;return!0})(b.bytes,c.bytes))}toString(a){let{bytes:b,version:c,_baseCache:d}=this;return 0===c?aD(b,d,a||V.encoder):aE(b,d,a||K.encoder)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(a){return aL(/^0\.0/,aM),!!(a&&(a[aI]||a.asCID===a))}get toBaseEncodedString(){throw Error("Deprecated, use .toString()")}get codec(){throw Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw Error('"multibaseName" property is deprecated')}get prefix(){throw Error('"prefix" property is deprecated')}static asCID(a){if(a instanceof aB)return a;if(null!=a&&a.asCID===a){let{version:b,code:c,multihash:d,bytes:e}=a;return new aB(b,c,d,e||aH(b,c,d.bytes))}if(null==a||!0!==a[aI])return null;{let{version:b,multihash:c,code:d}=a,e=(a=>{let b=v(a),[c,d]=ah(b),[e,f]=ah(b.subarray(d)),g=b.subarray(d+f);if(g.byteLength!==e)throw Error("Incorrect length");return new al(c,e,g,b)})(c);return aB.create(b,d,e)}}static create(a,b,c){if("number"!=typeof b)throw Error("String codecs are no longer supported");switch(a){case 0:if(b===aF)return new aB(a,b,c,c.bytes);throw Error(`Version 0 CID must use dag-pb (code: ${aF}) block encoding`);case 1:{let d=aH(a,b,c.bytes);return new aB(a,b,c,d)}default:throw Error("Invalid version")}}static createV0(a){return aB.create(0,aF,a)}static createV1(a,b){return aB.create(1,a,b)}static decode(a){let[b,c]=aB.decodeFirst(a);if(c.length)throw Error("Incorrect length");return b}static decodeFirst(a){let b=aB.inspectBytes(a),c=b.size-b.multihashSize,d=v(a.subarray(c,c+b.multihashSize));if(d.byteLength!==b.multihashSize)throw Error("Incorrect length");let e=d.subarray(b.multihashSize-b.digestSize),f=new al(b.multihashCode,b.digestSize,e,d);return[0===b.version?aB.createV0(f):aB.createV1(b.codec,f),a.subarray(b.size)]}static inspectBytes(a){let b=0,c=()=>{let[c,d]=ah(a.subarray(b));return b+=d,c},d=c(),e=aF;if(18===d?(d=0,b=0):1===d&&(e=c()),0!==d&&1!==d)throw RangeError(`Invalid CID version ${d}`);let f=b,g=c(),h=c(),i=b+h;return{version:d,codec:e,multihashCode:g,digestSize:h,multihashSize:i-f,size:i}}static parse(a,b){let[c,d]=aC(a,b),e=aB.decode(d);return e._baseCache.set(c,a),e}}let aC=(a,b)=>{switch(a[0]){case"Q":{let c=b||V;return[V.prefix,c.decode(`${V.prefix}${a}`)]}case V.prefix:{let c=b||V;return[V.prefix,c.decode(a)]}case K.prefix:{let c=b||K;return[K.prefix,c.decode(a)]}default:if(null==b)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[a[0],b.decode(a)]}},aD=(a,b,c)=>{let{prefix:d}=c;if(d!==V.prefix)throw Error(`Cannot string encode V0 in ${c.name} encoding`);let e=b.get(d);if(null!=e)return e;{let e=c.encode(a).slice(1);return b.set(d,e),e}},aE=(a,b,c)=>{let{prefix:d}=c,e=b.get(d);if(null!=e)return e;{let e=c.encode(a);return b.set(d,e),e}},aF=112,aG=18,aH=(a,b,c)=>{let d=aj(a),e=d+aj(b),f=new Uint8Array(e+c.byteLength);return ai(a,f,0),ai(b,f,d),f.set(c,e),f},aI=Symbol.for("@ipld/js-cid/CID"),aJ={writable:!1,configurable:!1,enumerable:!0},aK={writable:!1,enumerable:!1,configurable:!1},aL=(a,b)=>{if(a.test("0.0.0-dev"))console.warn(b);else throw Error(b)},aM=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`,aN={...d,...e,...f,...g,...h,...i,...j,...k,...l,...m};function aO(a,b,c,d){return{name:a,prefix:b,encoder:{name:a,prefix:b,encode:c},decoder:{decode:d}}}({...o,...p});let aP=aO("utf8","u",a=>"u"+new TextDecoder("utf8").decode(a),a=>new TextEncoder().encode(a.substring(1))),aQ=aO("ascii","a",a=>{let b="a";for(let c=0;c<a.length;c++)b+=String.fromCharCode(a[c]);return b},a=>{let b=s((a=a.substring(1)).length);for(let c=0;c<a.length;c++)b[c]=a.charCodeAt(c);return b}),aR={utf8:aP,"utf-8":aP,hex:aN.base16,latin1:aQ,ascii:aQ,binary:aQ,...aN};function aS(a,b="utf8"){let c=aR[b];if(!c)throw Error(`Unsupported encoding "${b}"`);return("utf8"===b||"utf-8"===b)&&null!=globalThis.Buffer&&null!=globalThis.Buffer.from?globalThis.Buffer.from(a,"utf8"):c.decoder.decode(`${c.prefix}${a}`)}function aT(a,b="utf8"){let c=aR[b];if(!c)throw Error(`Unsupported encoding "${b}"`);return("utf8"===b||"utf-8"===b)&&null!=globalThis.Buffer&&null!=globalThis.Buffer.from?globalThis.Buffer.from(a.buffer,a.byteOffset,a.byteLength).toString("utf8"):c.encoder.encode(a).substring(1)}},8386:a=>{"use strict";a.exports=function(a={}){let{ERR_PATHS_MUST_BE_STRINGS:b=()=>"fast-redact - Paths must be (non-empty) strings",ERR_INVALID_PATH:c=a=>`fast-redact – Invalid path (${a})`}=a;return function({paths:a}){a.forEach(a=>{if("string"!=typeof a)throw Error(b());try{if(/〇/.test(a))throw Error();let b=("["===a[0]?"":".")+a.replace(/^\*/,"〇").replace(/\.\*/g,".〇").replace(/\[\*\]/g,"[〇]");if(/\n|\r|;/.test(b)||/\/\*/.test(b))throw Error();Function(`
            'use strict'
            const o = new Proxy({}, { get: () => o, set: () => { throw Error() } });
            const 〇 = null;
            o${b}
            if ([o${b}].length !== 1) throw Error()`)()}catch(b){throw Error(c(a))}})}}},8401:(a,b,c)=>{"use strict";a.exports=function({log:a,context:b}){let{timestampKey:c,translateTime:e}=b,f=b.customPrettifiers?.time,g=null;if(c in a?g=a[c]:"timestamp"in a&&(g=a.timestamp),null===g)return;let h=e?d(g,e):g;return f?f(h):`[${h}]`};let d=c(57943)},9733:a=>{"use strict";a.exports=function(a){let{secret:b,censor:c,compileRestore:d,serialize:e,groupRedact:f,nestedRedact:g,wildcards:h,wcLen:i}=a,j=[{secret:b,censor:c,compileRestore:d}];return!1!==e&&j.push({serialize:e}),i>0&&j.push({groupRedact:f,nestedRedact:g,wildcards:h,wcLen:i}),Object.assign(...j)}},10152:(a,b,c)=>{"use strict";let d=c(29021),e=c(94735),f=c(28354).inherits,g=c(33873),h=c(83369);function i(a,b){function c(c,d){if(c){b._reopening=!1,b._writing=!1,b._opening=!1,b.sync?process.nextTick(()=>{b.listenerCount("error")>0&&b.emit("error",c)}):b.emit("error",c);return}b.fd=d,b.file=a,b._reopening=!1,b._opening=!1,b._writing=!1,b.sync?process.nextTick(()=>b.emit("ready")):b.emit("ready"),!b._reopening&&(b._writing||!(b._len>b.minLength)||b.destroyed||l(b))}b._opening=!0,b._writing=!0,b._asyncDrainScheduled=!1;let e=b.append?"a":"w",f=b.mode;if(b.sync)try{b.mkdir&&d.mkdirSync(g.dirname(a),{recursive:!0});let h=d.openSync(a,e,f);c(null,h)}catch(a){throw c(a),a}else b.mkdir?d.mkdir(g.dirname(a),{recursive:!0},b=>{if(b)return c(b);d.open(a,e,f,c)}):d.open(a,e,f,c)}function j(a){if(!(this instanceof j))return new j(a);let{fd:b,dest:c,minLength:e,maxLength:f,maxWrite:g,sync:o,append:p=!0,mode:q,mkdir:r,retryEAGAIN:s}=a||{};if(b=b||c,this._bufs=[],this._len=0,this.fd=-1,this._writing=!1,this._writingBuf="",this._ending=!1,this._reopening=!1,this._asyncDrainScheduled=!1,this._hwm=Math.max(e||0,16387),this.file=null,this.destroyed=!1,this.minLength=e||0,this.maxLength=f||0,this.maxWrite=g||16384,this.sync=o||!1,this.append=p||!1,this.mode=q,this.retryEAGAIN=s||(()=>!0),this.mkdir=r||!1,"number"==typeof b)this.fd=b,process.nextTick(()=>this.emit("ready"));else if("string"==typeof b)i(b,this);else throw Error("SonicBoom supports only file descriptors and files");if(this.minLength>=this.maxWrite)throw Error(`minLength should be smaller than maxWrite (${this.maxWrite})`);this.release=(a,b)=>{if(a){if("EAGAIN"===a.code&&this.retryEAGAIN(a,this._writingBuf.length,this._len-this._writingBuf.length))if(this.sync)try{h(100),this.release(void 0,0)}catch(a){this.release(a)}else setTimeout(()=>{d.write(this.fd,this._writingBuf,"utf8",this.release)},100);else this._writing=!1,this.emit("error",a);return}if(this.emit("write",b),this._len-=b,this._writingBuf=this._writingBuf.slice(b),this._writingBuf.length){if(!this.sync)return void d.write(this.fd,this._writingBuf,"utf8",this.release);try{do{let a=d.writeSync(this.fd,this._writingBuf,"utf8");this._len-=a,this._writingBuf=this._writingBuf.slice(a)}while(this._writingBuf)}catch(a){this.release(a);return}}let c=this._len;this._reopening?(this._writing=!1,this._reopening=!1,this.reopen()):c>this.minLength?l(this):this._ending?c>0?l(this):(this._writing=!1,m(this)):(this._writing=!1,this.sync?this._asyncDrainScheduled||(this._asyncDrainScheduled=!0,process.nextTick(k,this)):this.emit("drain"))},this.on("newListener",function(a){"drain"===a&&(this._asyncDrainScheduled=!1)})}function k(a){a.listenerCount("drain")>0&&(a._asyncDrainScheduled=!1,a.emit("drain"))}function l(a){let b=a.release;if(a._writing=!0,a._writingBuf=a._writingBuf||a._bufs.shift()||"",a.sync)try{let c=d.writeSync(a.fd,a._writingBuf,"utf8");b(null,c)}catch(a){b(a)}else d.write(a.fd,a._writingBuf,"utf8",b)}function m(a){if(-1===a.fd)return void a.once("ready",m.bind(null,a));function b(b){if(b)return void a.emit("error",b);a._ending&&!a._writing&&a.emit("finish"),a.emit("close")}a.destroyed=!0,a._bufs=[],1!==a.fd&&2!==a.fd?d.close(a.fd,b):setImmediate(b)}f(j,e),j.prototype.write=function(a){if(this.destroyed)throw Error("SonicBoom destroyed");let b=this._len+a.length,c=this._bufs;return this.maxLength&&b>this.maxLength?this.emit("drop",a):(0===c.length||c[c.length-1].length+a.length>this.maxWrite?c.push(""+a):c[c.length-1]+=a,this._len=b,!this._writing&&this._len>=this.minLength&&l(this)),this._len<this._hwm},j.prototype.flush=function(){if(this.destroyed)throw Error("SonicBoom destroyed");this._writing||this.minLength<=0||(0===this._bufs.length&&this._bufs.push(""),l(this))},j.prototype.reopen=function(a){if(this.destroyed)throw Error("SonicBoom destroyed");if(this._opening)return void this.once("ready",()=>{this.reopen(a)});if(this._ending)return;if(!this.file)throw Error("Unable to reopen a file descriptor, you must pass a file to SonicBoom");if(this._reopening=!0,this._writing)return;let b=this.fd;this.once("ready",()=>{b!==this.fd&&d.close(b,a=>{if(a)return this.emit("error",a)})}),i(a||this.file,this)},j.prototype.end=function(){if(this.destroyed)throw Error("SonicBoom destroyed");if(this._opening)return void this.once("ready",()=>{this.end()});!this._ending&&(this._ending=!0,this._writing||(this._len>0&&this.fd>=0?l(this):m(this)))},j.prototype.flushSync=function(){if(this.destroyed)throw Error("SonicBoom destroyed");if(this.fd<0)throw Error("sonic boom is not ready yet");for(!this._writing&&this._writingBuf.length>0&&(this._bufs.unshift(this._writingBuf),this._writingBuf="");this._bufs.length;){let a=this._bufs[0];try{this._len-=d.writeSync(this.fd,a,"utf8"),this._bufs.shift()}catch(b){if("EAGAIN"!==b.code||!this.retryEAGAIN(b,a.length,this._len-a.length))throw b;h(100)}}},j.prototype.destroy=function(){this.destroyed||m(this)},j.SonicBoom=j,j.default=j,a.exports=j},10576:(a,b,c)=>{"use strict";c.d(b,{D5:()=>A,U5:()=>z,h6:()=>e.a,iP:()=>x,oI:()=>y});var d=c(36247),e=c.n(d),f=c(25080);let g={level:"info"},h="custom_context";class i{constructor(a){this.nodeValue=a,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}}class j{constructor(a){this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=a,this.sizeInBytes=0}append(a){let b=new i(a);if(b.size>this.maxSizeInBytes)throw Error(`[LinkedList] Value too big to insert into list: ${a} with size ${b.size}`);for(;this.size+b.size>this.maxSizeInBytes;)this.shift();this.head?this.tail&&(this.tail.next=b):this.head=b,this.tail=b,this.lengthInNodes++,this.sizeInBytes+=b.size}shift(){if(!this.head)return;let a=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=a.size}toArray(){let a=[],b=this.head;for(;null!==b;)a.push(b.value),b=b.next;return a}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let a=this.head;return{next:()=>{if(!a)return{done:!0,value:null};let b=a.value;return a=a.next,{done:!1,value:b}}}}}class k{constructor(a,b=1024e3){this.level=a??"error",this.levelValue=d.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=b,this.logs=new j(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(a,b){b===d.levels.values.error?console.error(a):b===d.levels.values.warn?console.warn(a):b===d.levels.values.debug?console.debug(a):b===d.levels.values.trace?console.trace(a):console.log(a)}appendToLogs(a){this.logs.append((0,f.h)({timestamp:new Date().toISOString(),log:a}));let b="string"==typeof a?JSON.parse(a).level:a.level;b>=this.levelValue&&this.forwardToConsole(a,b)}getLogs(){return this.logs}clearLogs(){this.logs=new j(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(a){let b=this.getLogArray();return b.push((0,f.h)({extraMetadata:a})),new Blob(b,{type:"application/json"})}}class l{constructor(a,b=1024e3){this.baseChunkLogger=new k(a,b)}write(a){this.baseChunkLogger.appendToLogs(a)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(a){return this.baseChunkLogger.logsToBlob(a)}downloadLogsBlobInBrowser(a){let b=URL.createObjectURL(this.logsToBlob(a)),c=document.createElement("a");c.href=b,c.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(b)}}class m{constructor(a,b=1024e3){this.baseChunkLogger=new k(a,b)}write(a){this.baseChunkLogger.appendToLogs(a)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(a){return this.baseChunkLogger.logsToBlob(a)}}var o=Object.defineProperty,p=Object.defineProperties,q=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,u=(a,b,c)=>b in a?o(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,v=(a,b)=>{for(var c in b||(b={}))s.call(b,c)&&u(a,c,b[c]);if(r)for(var c of r(b))t.call(b,c)&&u(a,c,b[c]);return a},w=(a,b)=>p(a,q(b));function x(a){return w(v({},a),{level:a?.level||g.level})}function y(a,b=h){return typeof a.bindings>"u"?function(a,b=h){return a[b]||""}(a,b):a.bindings().context||""}function z(a,b,c=h){let d=function(a,b,c=h){let d=y(a,c);return d.trim()?`${d}/${b}`:b}(a,b,c);return function(a,b,c=h){return a[c]=b,a}(a.child({context:d}),d,c)}function A(a){return"u">typeof a.loggerOverride&&"string"!=typeof a.loggerOverride?{logger:a.loggerOverride,chunkLoggerController:null}:"u">typeof window?function(a){var b,c;let d=new l(null==(b=a.opts)?void 0:b.level,a.maxSizeInBytes);return{logger:e()(w(v({},a.opts),{level:"trace",browser:w(v({},null==(c=a.opts)?void 0:c.browser),{write:a=>d.write(a)})})),chunkLoggerController:d}}(a):function(a){var b;let c=new m(null==(b=a.opts)?void 0:b.level,a.maxSizeInBytes);return{logger:e()(w(v({},a.opts),{level:"trace"}),c),chunkLoggerController:c}}(a)}},11428:(a,b,c)=>{let d=c(17258),e=d.default||d,f=function(a,b){return/^\/\//.test(a)&&(a="https:"+a),e.call(this,a,b)};f.ponyfill=!0,a.exports=b=f,b.fetch=f,b.Headers=d.Headers,b.Request=d.Request,b.Response=d.Response,b.default=f},13738:(a,b,c)=>{"use strict";let{EMPTY_BUFFER:d}=c(78006);function e(a,b){if(0===a.length)return d;if(1===a.length)return a[0];let c=Buffer.allocUnsafe(b),e=0;for(let b=0;b<a.length;b++){let d=a[b];c.set(d,e),e+=d.length}return e<b?c.slice(0,e):c}function f(a,b,c,d,e){for(let f=0;f<e;f++)c[d+f]=a[f]^b[3&f]}function g(a,b){let c=a.length;for(let d=0;d<c;d++)a[d]^=b[3&d]}function h(a){return a.byteLength===a.buffer.byteLength?a.buffer:a.buffer.slice(a.byteOffset,a.byteOffset+a.byteLength)}function i(a){let b;return(i.readOnly=!0,Buffer.isBuffer(a))?a:(a instanceof ArrayBuffer?b=Buffer.from(a):ArrayBuffer.isView(a)?b=Buffer.from(a.buffer,a.byteOffset,a.byteLength):(b=Buffer.from(a),i.readOnly=!1),b)}try{let b=c(63569),d=b.BufferUtil||b;a.exports={concat:e,mask(a,b,c,e,g){g<48?f(a,b,c,e,g):d.mask(a,b,c,e,g)},toArrayBuffer:h,toBuffer:i,unmask(a,b){a.length<32?g(a,b):d.unmask(a,b)}}}catch(b){a.exports={concat:e,mask:f,toArrayBuffer:h,toBuffer:i,unmask:g}}},13753:(a,b,c)=>{"use strict";a.exports=function(a){let b=new e(a);return b.on("error",function a(c){if("EPIPE"===c.code){b.write=f,b.end=f,b.flushSync=f,b.destroy=f;return}b.removeListener("error",a)}),!a.sync&&d&&function(a){if(global.WeakRef&&global.WeakMap&&global.FinalizationRegistry){let b=c(20605);b.register(a,g),a.on("close",function(){b.unregister(a)})}}(b),b};let{isMainThread:d}=c(75919),e=c(82956),f=c(25858);function g(a,b){a.destroyed||("beforeExit"===b?(a.flush(),a.on("drain",function(){a.end()})):a.flushSync())}},15050:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Watch=void 0;class c{constructor(){this.timestamps=new Map}start(a){if(this.timestamps.has(a))throw Error(`Watch already started for label: ${a}`);this.timestamps.set(a,{started:Date.now()})}stop(a){let b=this.get(a);if(void 0!==b.elapsed)throw Error(`Watch already stopped for label: ${a}`);let c=Date.now()-b.started;this.timestamps.set(a,{started:b.started,elapsed:c})}get(a){let b=this.timestamps.get(a);if(void 0===b)throw Error(`No timestamp found for label: ${a}`);return b}elapsed(a){let b=this.get(a);return b.elapsed||Date.now()-b.started}}b.Watch=c,b.default=c},15367:(a,b,c)=>{"use strict";a.exports=function({log:a,excludeLoggerKeys:b=!0,skipKeys:c=[],context:h}){let{EOL:i,IDENT:j,customPrettifiers:k,errorLikeObjectKeys:l,objectColorizer:m,singleLine:o,colorizer:p}=h,q=[].concat(c);!0===b&&Array.prototype.push.apply(q,d);let r="",{plain:s,errors:t}=Object.entries(a).reduce(({plain:b,errors:c},[d,e])=>{if(!1===q.includes(d)){let f="function"==typeof k[d]?k[d](e,d,a,{colors:p.colors}):e;l.includes(d)?c[d]=f:b[d]=f}return{plain:b,errors:c}},{plain:{},errors:{}});return o?(Object.keys(s).length>0&&(r+=m.greyMessage(e(s))),r+=i,r=r.replace(/\\\\/gi,"\\")):Object.entries(s).forEach(([a,b])=>{let c="function"==typeof k[a]?b:e(b,null,2);if(void 0===c)return;let d=f({input:c=c.replace(/\\\\/gi,"\\"),ident:j,eol:i});r+=`${j}${m.property(a)}:${d.startsWith(i)?"":" "}${d}${i}`}),Object.entries(t).forEach(([a,b])=>{let c="function"==typeof k[a]?b:e(b,null,2);void 0!==c&&(r+=g({keyName:a,lines:c,eol:i,ident:j}))}),r};let{LOGGER_KEYS:d}=c(70219),e=c(44944),f=c(98459),g=c(22084)},15975:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0});let d=c(40671);d.__exportStar(c(69067),b),d.__exportStar(c(38438),b)},16807:a=>{"use strict";let b=Symbol("kDone"),c=Symbol("kRun");class d{constructor(a){this[b]=()=>{this.pending--,this[c]()},this.concurrency=a||1/0,this.jobs=[],this.pending=0}add(a){this.jobs.push(a),this[c]()}[c](){if(this.pending!==this.concurrency&&this.jobs.length){let a=this.jobs.shift();this.pending++,a(this[b])}}}a.exports=d},17550:(a,b,c)=>{"use strict";let d=c(4904),{redactFmtSym:e,wildcardFirstSym:f}=c(49094),{rx:g,validator:h}=d,i=h({ERR_PATHS_MUST_BE_STRINGS:()=>"pino – redacted paths must be strings",ERR_INVALID_PATH:a=>`pino – redact paths array contains an invalid path (${a})`}),j="[Redacted]";a.exports=function(a,b){let{paths:c,censor:h}=function(a){if(Array.isArray(a))return i(a={paths:a,censor:j}),a;let{paths:b,censor:c=j,remove:d}=a;if(!1===Array.isArray(b))throw Error("pino – redact must contain an array of strings");return!0===d&&(c=void 0),i({paths:b,censor:c}),{paths:b,censor:c}}(a),k=c.reduce((a,b)=>{g.lastIndex=0;let c=g.exec(b),d=g.exec(b),e=void 0!==c[1]?c[1].replace(/^(?:"|'|`)(.*)(?:"|'|`)$/,"$1"):c[0];if("*"===e&&(e=f),null===d)return a[e]=null,a;if(null===a[e])return a;let{index:h}=d,i=`${b.substr(h,b.length-1)}`;return a[e]=a[e]||[],e!==f&&0===a[e].length&&a[e].push(...a[f]||[]),e===f&&Object.keys(a).forEach(function(b){a[b]&&a[b].push(i)}),a[e].push(i),a},{}),l={[e]:d({paths:c,censor:h,serialize:b,strict:!1})};return[...Object.keys(k),...Object.getOwnPropertySymbols(k)].reduce((a,c)=>{if(null===k[c])a[c]=a=>((...a)=>"function"==typeof h?b(h(...a)):b(h))(a,[c]);else{let e="function"==typeof h?(a,b)=>h(a,[c,...b]):h;a[c]=d({paths:k[c],censor:e,serialize:b,strict:!1})}return a},l)}},18118:a=>{"use strict";a.exports={mapHttpRequest:function(a){return{req:d(a)}},reqSerializer:d};let b=Symbol("pino-raw-req-ref"),c=Object.create({},{id:{enumerable:!0,writable:!0,value:""},method:{enumerable:!0,writable:!0,value:""},url:{enumerable:!0,writable:!0,value:""},query:{enumerable:!0,writable:!0,value:""},params:{enumerable:!0,writable:!0,value:""},headers:{enumerable:!0,writable:!0,value:{}},remoteAddress:{enumerable:!0,writable:!0,value:""},remotePort:{enumerable:!0,writable:!0,value:""},raw:{enumerable:!1,get:function(){return this[b]},set:function(a){this[b]=a}}});function d(a){let b=a.info||a.socket,d=Object.create(c);return d.id="function"==typeof a.id?a.id():a.id||(a.info?a.info.id:void 0),d.method=a.method,a.originalUrl?(d.url=a.originalUrl,d.query=a.query,d.params=a.params):d.url=a.path||(a.url?a.url.path||a.url:void 0),d.headers=a.headers,d.remoteAddress=b&&b.remoteAddress,d.remotePort=b&&b.remotePort,d.raw=a.raw||a,d}Object.defineProperty(c,b,{writable:!0,value:{}})},18519:(a,b,c)=>{"use strict";function d(a){return"object"==typeof a&&"id"in a&&"jsonrpc"in a&&"2.0"===a.jsonrpc}function e(a){return d(a)&&"method"in a}function f(a){return d(a)&&(g(a)||h(a))}function g(a){return"result"in a}function h(a){return"error"in a}c.d(b,{U$:()=>h,p3:()=>e,tq:()=>f,xT:()=>g})},18947:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0});let d=c(40671);d.__exportStar(c(77632),b),d.__exportStar(c(44448),b)},20031:(a,b,c)=>{"use strict";function d(a,b){let c=function(a){let b=a.match(RegExp(/^\w+:/,"gi"));if(b&&b.length)return b[0]}(a);return void 0!==c&&new RegExp(b).test(c)}function e(a){return d(a,"^https?:")}function f(a){return d(a,"^wss?:")}function g(a){return RegExp("wss?://localhost(:d{2,5})?").test(a)}c.d(b,{A1:()=>f,q$:()=>e,z:()=>g})},20605:a=>{"use strict";let b,c={exit:[],beforeExit:[]},d={exit:function(){f("exit")},beforeExit:function(){f("beforeExit")}};function e(a){c[a].length>0||(process.removeListener(a,d[a]),0===c.exit.length&&0===c.beforeExit.length&&(b=void 0))}function f(a){for(let b of c[a]){let c=b.deref(),d=b.fn;void 0!==c&&d(c,a)}c[a]=[]}function g(a){for(let b of["exit","beforeExit"]){let d=c[b].indexOf(a);c[b].splice(d,d+1),e(b)}}function h(a,e,f){if(void 0===e)throw Error("the object can't be undefined");c[a].length>0||process.on(a,d[a]);let h=new WeakRef(e);h.fn=f,void 0===b&&(b=new FinalizationRegistry(g)),b.register(e,h),c[a].push(h)}a.exports={register:function(a,b){h("exit",a,b)},registerBeforeExit:function(a,b){h("beforeExit",a,b)},unregister:function(a){if(void 0!==b)for(let d of(b.unregister(a),["exit","beforeExit"]))c[d]=c[d].filter(b=>{let c=b.deref();return c&&c!==a}),e(d)}}},22084:(a,b,c)=>{"use strict";a.exports=function({keyName:a,lines:b,eol:c,ident:e}){let f="",g=d({input:b,ident:e,eol:c}),h=`${e}${a}: ${g}${c}`.split(c);for(let a=0;a<h.length;a+=1){0!==a&&(f+=c);let b=h[a];if(/^\s*"stack"/.test(b)){let a=/^(\s*"stack":)\s*(".*"),?$/.exec(b);if(a&&3===a.length){let d=/^\s*/.exec(b)[0].length+4,e=" ".repeat(d),g=a[2];f+=a[1]+c+e+JSON.parse(g).replace(/\n/g,c+e)}else f+=b}else f+=b}return f};let d=c(98459)},23316:a=>{"use strict";a.exports=function(a){return a?"string"==typeof a?a.split(",").reduce((a,b,c)=>{let[d,e=c]=b.split(":");return a[d.toLowerCase()]=e,a},{}):"[object Object]"===Object.prototype.toString.call(a)?Object.keys(a).reduce((b,c)=>(b[c.toLowerCase()]=a[c],b),{}):{}:{}}},24662:(a,b,c)=>{var d=c(93700),e=function(){},f=global.Bare?queueMicrotask:process.nextTick.bind(process),g=function(a,b,c){if("function"==typeof b)return g(a,null,b);b||(b={}),c=d(c||e);var h=a._writableState,i=a._readableState,j=b.readable||!1!==b.readable&&a.readable,k=b.writable||!1!==b.writable&&a.writable,l=!1,m=function(){a.writable||o()},o=function(){k=!1,j||c.call(a)},p=function(){j=!1,k||c.call(a)},q=function(b){c.call(a,b?Error("exited with error code: "+b):null)},r=function(b){c.call(a,b)},s=function(){f(t)},t=function(){if(!l&&(j&&!(i&&i.ended&&!i.destroyed)||k&&!(h&&h.ended&&!h.destroyed)))return c.call(a,Error("premature close"))},u=function(){a.req.on("finish",o)};return a.setHeader&&"function"==typeof a.abort?(a.on("complete",o),a.on("abort",s),a.req?u():a.on("request",u)):k&&!h&&(a.on("end",m),a.on("close",m)),a.stdio&&Array.isArray(a.stdio)&&3===a.stdio.length&&a.on("exit",q),a.on("end",p),a.on("finish",o),!1!==b.error&&a.on("error",r),a.on("close",s),function(){l=!0,a.removeListener("complete",o),a.removeListener("abort",s),a.removeListener("request",u),a.req&&a.req.removeListener("finish",o),a.removeListener("end",m),a.removeListener("close",m),a.removeListener("finish",o),a.removeListener("exit",q),a.removeListener("end",p),a.removeListener("error",r),a.removeListener("close",s)}};a.exports=g},24856:a=>{"use strict";a.exports=JSON.parse('{"name":"pino","version":"7.11.0","description":"super fast, all natural json logger","main":"pino.js","type":"commonjs","types":"pino.d.ts","browser":"./browser.js","files":["pino.js","file.js","pino.d.ts","bin.js","browser.js","pretty.js","usage.txt","test","docs","example.js","lib"],"scripts":{"docs":"docsify serve","browser-test":"airtap --local 8080 test/browser*test.js","lint":"eslint .","test":"npm run lint && npm run transpile && tap --ts && jest test/jest && npm run test-types","test-ci":"npm run lint && npm run transpile && tap --ts --no-check-coverage --coverage-report=lcovonly && npm run test-types","test-ci-pnpm":"pnpm run lint && npm run transpile && tap --ts --no-coverage --no-check-coverage && pnpm run test-types","test-ci-yarn-pnp":"yarn run lint && npm run transpile && tap --ts --no-check-coverage --coverage-report=lcovonly","test-types":"tsc && tsd && ts-node test/types/pino.ts","transpile":"node ./test/fixtures/ts/transpile.cjs","cov-ui":"tap --ts --coverage-report=html","bench":"node benchmarks/utils/runbench all","bench-basic":"node benchmarks/utils/runbench basic","bench-object":"node benchmarks/utils/runbench object","bench-deep-object":"node benchmarks/utils/runbench deep-object","bench-multi-arg":"node benchmarks/utils/runbench multi-arg","bench-longs-tring":"node benchmarks/utils/runbench long-string","bench-child":"node benchmarks/utils/runbench child","bench-child-child":"node benchmarks/utils/runbench child-child","bench-child-creation":"node benchmarks/utils/runbench child-creation","bench-formatters":"node benchmarks/utils/runbench formatters","update-bench-doc":"node benchmarks/utils/generate-benchmark-doc > docs/benchmarks.md"},"bin":{"pino":"./bin.js"},"precommit":"test","repository":{"type":"git","url":"git+https://github.com/pinojs/pino.git"},"keywords":["fast","logger","stream","json"],"author":"Matteo Collina <hello@matteocollina.com>","contributors":["David Mark Clements <huperekchuno@googlemail.com>","James Sumners <james.sumners@gmail.com>","Thomas Watson Steen <w@tson.dk> (https://twitter.com/wa7son)"],"license":"MIT","bugs":{"url":"https://github.com/pinojs/pino/issues"},"homepage":"http://getpino.io","devDependencies":{"@types/flush-write-stream":"^1.0.0","@types/node":"^17.0.0","@types/tap":"^15.0.6","airtap":"4.0.4","benchmark":"^2.1.4","bole":"^4.0.0","bunyan":"^1.8.14","docsify-cli":"^4.4.1","eslint":"^7.17.0","eslint-config-standard":"^16.0.3","eslint-plugin-import":"^2.22.1","eslint-plugin-node":"^11.1.0","eslint-plugin-promise":"^5.1.0","execa":"^5.0.0","fastbench":"^1.0.1","flush-write-stream":"^2.0.0","import-fresh":"^3.2.1","jest":"^27.3.1","log":"^6.0.0","loglevel":"^1.6.7","pino-pretty":"^v7.6.0","pre-commit":"^1.2.2","proxyquire":"^2.1.3","pump":"^3.0.0","rimraf":"^3.0.2","semver":"^7.0.0","split2":"^4.0.0","steed":"^1.1.3","strip-ansi":"^6.0.0","tap":"^16.0.0","tape":"^5.0.0","through2":"^4.0.0","ts-node":"^10.7.0","tsd":"^0.20.0","typescript":"^4.4.4","winston":"^3.3.3"},"dependencies":{"atomic-sleep":"^1.0.0","fast-redact":"^3.0.0","on-exit-leak-free":"^0.2.0","pino-abstract-transport":"v0.5.0","pino-std-serializers":"^4.0.0","process-warning":"^1.0.0","quick-format-unescaped":"^4.0.3","real-require":"^0.1.0","safe-stable-stringify":"^2.1.0","sonic-boom":"^2.2.1","thread-stream":"^0.15.1"},"tsd":{"directory":"test/types"}}')},24858:(a,b,c)=>{"use strict";function d(a){if(!Number.isSafeInteger(a)||a<0)throw Error("positive integer expected, got "+a)}function e(a,...b){if(!(a instanceof Uint8Array||ArrayBuffer.isView(a)&&"Uint8Array"===a.constructor.name))throw Error("Uint8Array expected");if(b.length>0&&!b.includes(a.length))throw Error("Uint8Array expected of length "+b+", got length="+a.length)}function f(a){if("function"!=typeof a||"function"!=typeof a.create)throw Error("Hash should be wrapped by utils.wrapConstructor");d(a.outputLen),d(a.blockLen)}function g(a,b=!0){if(a.destroyed)throw Error("Hash instance has been destroyed");if(b&&a.finished)throw Error("Hash#digest() has already been called")}function h(a,b){e(a);let c=b.outputLen;if(a.length<c)throw Error("digestInto() expects output buffer of length at least "+c)}c.d(b,{CC:()=>g,DO:()=>e,Fe:()=>d,Ht:()=>h,sd:()=>f})},25080:(a,b,c)=>{"use strict";function d(a){if("string"!=typeof a)throw Error(`Cannot safe json parse value of type ${typeof a}`);try{return JSON.parse(a.replace(/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,'$1"$2n"$3'),(a,b)=>"string"==typeof b&&b.match(/^\d+n$/)?BigInt(b.substring(0,b.length-1)):b)}catch(b){return a}}function e(a){return"string"==typeof a?a:JSON.stringify(a,(a,b)=>"bigint"==typeof b?b.toString()+"n":b)||""}c.d(b,{h:()=>e,j:()=>d})},25758:a=>{"use strict";function b(a){try{return JSON.stringify(a)}catch(a){return'"[Circular]"'}}a.exports=function(a,c,d){var e=d&&d.stringify||b;if("object"==typeof a&&null!==a){var f=c.length+1;if(1===f)return a;var g=Array(f);g[0]=e(a);for(var h=1;h<f;h++)g[h]=e(c[h]);return g.join(" ")}if("string"!=typeof a)return a;var i=c.length;if(0===i)return a;for(var j="",k=0,l=-1,m=a&&a.length||0,o=0;o<m;){if(37===a.charCodeAt(o)&&o+1<m){switch(l=l>-1?l:0,a.charCodeAt(o+1)){case 100:case 102:if(k>=i||null==c[k])break;l<o&&(j+=a.slice(l,o)),j+=Number(c[k]),l=o+2,o++;break;case 105:if(k>=i||null==c[k])break;l<o&&(j+=a.slice(l,o)),j+=Math.floor(Number(c[k])),l=o+2,o++;break;case 79:case 111:case 106:if(k>=i||void 0===c[k])break;l<o&&(j+=a.slice(l,o));var p=typeof c[k];if("string"===p){j+="'"+c[k]+"'",l=o+2,o++;break}if("function"===p){j+=c[k].name||"<anonymous>",l=o+2,o++;break}j+=e(c[k]),l=o+2,o++;break;case 115:if(k>=i)break;l<o&&(j+=a.slice(l,o)),j+=String(c[k]),l=o+2,o++;break;case 37:l<o&&(j+=a.slice(l,o)),j+="%",l=o+2,o++,k--}++k}++o}return -1===l?a:(l<m&&(j+=a.slice(l)),j)}},25858:a=>{"use strict";a.exports=function(){}},27301:a=>{"use strict";a.exports=function({log:a,context:b}){let{customPrettifiers:c,colorizer:d}=b,e="";if(a.name||a.pid||a.hostname){if(e+="(",a.name&&(e+=c.name?c.name(a.name,"name",a,{colors:d.colors}):a.name),a.pid){let b=c.pid?c.pid(a.pid,"pid",a,{colors:d.colors}):a.pid;a.name&&a.pid?e+="/"+b:e+=b}if(a.hostname){let b=c.hostname?c.hostname(a.hostname,"hostname",a,{colors:d.colors}):a.hostname;e+=`${"("===e?"on":" on"} ${b}`}e+=")"}if(a.caller){let b=c.caller?c.caller(a.caller,"caller",a,{colors:d.colors}):a.caller;e+=`${""===e?"":" "}<${b}>`}if(""!==e)return e}},27710:(a,b,c)=>{"use strict";c.d(b,{VH:()=>j,li:()=>i});var d=c(94735),e=c(94965),f=c(44660);class g extends f.H{constructor(a){super()}}let h=e.FIVE_SECONDS,i={pulse:"heartbeat_pulse"};class j extends g{constructor(a){super(a),this.events=new d.EventEmitter,this.interval=h,this.interval=a?.interval||h}static async init(a){let b=new j(a);return await b.init(),b}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(a,b){this.events.on(a,b)}once(a,b){this.events.once(a,b)}off(a,b){this.events.off(a,b)}removeListener(a,b){this.events.removeListener(a,b)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),(0,e.toMiliseconds)(this.interval))}pulse(){this.events.emit(i.pulse)}}},29238:(a,b,c)=>{"use strict";let d=Symbol.for("pino.metadata"),{levels:e}=c(35248),f=Object.create(e);f.silent=1/0;let g=e.info;function h(a,b){return a.level-b.level}a.exports=function(a,b){let c=0;a=a||[];let e=f;(b=b||{dedupe:!1}).levels&&"object"==typeof b.levels&&(e=b.levels);let i={write:j,add:l,flushSync:k,end:function(){for(let{stream:a}of this.streams)"function"==typeof a.flushSync&&a.flushSync(),a.end()},minLevel:0,streams:[],clone:function a(b){let c=Array(this.streams.length);for(let a=0;a<c.length;a++)c[a]={level:b,stream:this.streams[a].stream};return{write:j,add:l,minLevel:b,streams:c,clone:a,flushSync:k,[d]:!0}},[d]:!0};return Array.isArray(a)?a.forEach(l,i):l.call(i,a),a=null,i;function j(a){let c,e,f=this.lastLevel,{streams:g}=this;for(let h=0;h<g.length;h++)if((c=g[h]).level<=f){if((e=c.stream)[d]){let{lastTime:a,lastMsg:b,lastObj:c,lastLogger:d}=this;e.lastLevel=f,e.lastTime=a,e.lastMsg=b,e.lastObj=c,e.lastLogger=d}b.dedupe&&c.level!==f||e.write(a)}else break}function k(){for(let{stream:a}of this.streams)"function"==typeof a.flushSync&&a.flushSync()}function l(a){if(!a)return i;let b="function"==typeof a.write||a.stream,d=a.write?a:a.stream;if(!b)throw Error("stream object needs to implement either StreamEntry or DestinationStream interface");let{streams:f}=this,j={stream:d,level:"number"==typeof a.levelVal?a.levelVal:"string"==typeof a.level?e[a.level]:"number"==typeof a.level?a.level:g,levelVal:void 0,id:c++};return f.unshift(j),f.sort(h),this.minLevel=f[0].level,i}}},29616:(a,b,c)=>{"use strict";a.exports=function(a){let b;if(e(a))b=a;else{let c=(a=>{try{return{value:d.parse(a,{protoAction:"remove"})}}catch(a){return{err:a}}})(a);if(c.err||!e(c.value))return a+this.EOL;b=c.value}if(this.minimumLevel){let a;if((a=(this.useOnlyCustomProps?this.customLevels:void 0!==this.customLevelNames[this.minimumLevel])?this.customLevelNames[this.minimumLevel]:p[this.minimumLevel])||(a="string"==typeof this.minimumLevel?p[this.minimumLevel]:p[m[this.minimumLevel].toLowerCase()]),b[void 0===this.levelKey?o:this.levelKey]<a)return}let c=h({log:b,context:this.context});(this.ignoreKeys||this.includeKeys)&&(b=l({log:b,context:this.context}));let q=g({log:b,context:{...this.context,...this.context.customProperties}}),r=i({log:b,context:this.context}),s=k({log:b,context:this.context}),t="";if(this.levelFirst&&q&&(t=`${q}`),s&&""===t?t=`${s}`:s&&(t=`${t} ${s}`),!this.levelFirst&&q&&(t=t.length>0?`${t} ${q}`:q),r&&(t=t.length>0?`${t} ${r}:`:r),!1===t.endsWith(":")&&""!==t&&(t+=":"),void 0!==c&&(t=t.length>0?`${t} ${c}`:c),t.length>0&&!this.singleLine&&(t+=this.EOL),"Error"===b.type&&"string"==typeof b.stack){let a=f({log:b,context:this.context});this.singleLine&&(t+=this.EOL),t+=a}else if(!1===this.hideObject){let a=[this.messageKey,this.levelKey,this.timestampKey].map(a=>a.replaceAll(/\\/g,"")).filter(a=>"string"==typeof b[a]||"number"==typeof b[a]||"boolean"==typeof b[a]),c=j({log:b,skipKeys:a,context:this.context});this.singleLine&&!/^\s$/.test(c)&&(t+=" "),t+=c}return t};let d=c(78970),e=c(83604),f=c(5703),g=c(80924),h=c(75809),i=c(27301),j=c(15367),k=c(8401),l=c(92887),{LEVELS:m,LEVEL_KEY:o,LEVEL_NAMES:p}=c(70219)},30366:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0});let d=c(40671);d.__exportStar(c(32549),b),d.__exportStar(c(43273),b)},32549:(a,b)=>{"use strict";function c(){return(null==global?void 0:global.crypto)||(null==global?void 0:global.msCrypto)||{}}function d(){let a=c();return a.subtle||a.webkitSubtle}Object.defineProperty(b,"__esModule",{value:!0}),b.isBrowserCryptoAvailable=b.getSubtleCrypto=b.getBrowerCrypto=void 0,b.getBrowerCrypto=c,b.getSubtleCrypto=d,b.isBrowserCryptoAvailable=function(){return!!c()&&!!d()}},35248:(a,b,c)=>{"use strict";let{lsCacheSym:d,levelValSym:e,useOnlyCustomLevelsSym:f,streamSym:g,formattersSym:h,hooksSym:i}=c(49094),{noop:j,genLog:k}=c(96988),l={trace:10,debug:20,info:30,warn:40,error:50,fatal:60},m={fatal:a=>{let b=k(l.fatal,a);return function(...a){let c=this[g];if(b.call(this,...a),"function"==typeof c.flushSync)try{c.flushSync()}catch(a){}}},error:a=>k(l.error,a),warn:a=>k(l.warn,a),info:a=>k(l.info,a),debug:a=>k(l.debug,a),trace:a=>k(l.trace,a)},o=Object.keys(l).reduce((a,b)=>(a[l[b]]=b,a),{});a.exports={initialLsCache:Object.keys(o).reduce((a,b)=>(a[b]='{"level":'+Number(b),a),{}),genLsCache:function(a){let b=a[h].level,{labels:c}=a.levels,e={};for(let a in c){let d=b(c[a],Number(a));e[a]=JSON.stringify(d).slice(0,-1)}return a[d]=e,a},levelMethods:m,getLevel:function(a){let{levels:b,levelVal:c}=this;return b&&b.labels?b.labels[c]:""},setLevel:function(a){let{labels:b,values:c}=this.levels;if("number"==typeof a){if(void 0===b[a])throw Error("unknown level value"+a);a=b[a]}if(void 0===c[a])throw Error("unknown level "+a);let d=this[e],g=this[e]=c[a],h=this[f],l=this[i].logMethod;for(let a in c){if(g>c[a]){this[a]=j;continue}this[a]=!function(a,b){if(b)return!1;switch(a){case"fatal":case"error":case"warn":case"info":case"debug":case"trace":return!0;default:return!1}}(a,h)?k(c[a],l):m[a](l)}this.emit("level-change",a,g,b[d],d)},isLevelEnabled:function(a){let{values:b}=this.levels,c=b[a];return void 0!==c&&c>=this[e]},mappings:function(a=null,b=!1){let c=a?Object.keys(a).reduce((b,c)=>(b[a[c]]=c,b),{}):null;return{labels:Object.assign(Object.create(Object.prototype,{Infinity:{value:"silent"}}),b?null:o,c),values:Object.assign(Object.create(Object.prototype,{silent:{value:1/0}}),b?null:l,a)}},levels:l,assertNoLevelCollisions:function(a,b){let{labels:c,values:d}=a;for(let a in b){if(a in d)throw Error("levels cannot be overridden");if(b[a]in c)throw Error("pre-existing level values cannot be used for new levels")}},assertDefaultLevelFound:function(a,b,c){if("number"==typeof a){if(![].concat(Object.keys(b||{}).map(a=>b[a]),c?[]:Object.keys(o).map(a=>+a),1/0).includes(a))throw Error(`default level:${a} must be included in custom levels`);return}if(!(a in Object.assign(Object.create(Object.prototype,{silent:{value:1/0}}),c?null:l,b)))throw Error(`default level:${a} must be included in custom levels`)}}},35783:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=function(a){if(a&&a.__esModule)return a;var b=Object.create(null);return a&&Object.keys(a).forEach(function(c){if("default"!==c){var d=Object.getOwnPropertyDescriptor(a,c);Object.defineProperty(b,c,d.get?d:{enumerable:!0,get:function(){return a[c]}})}}),b.default=a,Object.freeze(b)}(c(83997));let{env:e={},argv:f=[],platform:g=""}="undefined"==typeof process?{}:process,h="NO_COLOR"in e||f.includes("--no-color"),i="FORCE_COLOR"in e||f.includes("--color"),j="dumb"===e.TERM,k=d&&d.isatty&&d.isatty(1)&&e.TERM&&!j,l="CI"in e&&("GITHUB_ACTIONS"in e||"GITLAB_CI"in e||"CIRCLECI"in e),m=!h&&(i||"win32"===g&&!j||k||l),o=(a,b,c,d,e=b.substring(0,a)+d,f=b.substring(a+c.length),g=f.indexOf(c))=>e+(g<0?f:o(g,f,c,d)),p=(a,b,c)=>((a,b,c=a,d=a.length+1)=>e=>e||""!==e&&void 0!==e?((a,b,c,d,e)=>a<0?c+b+d:c+o(a,b,d,e)+d)((""+e).indexOf(b,d),e,a,b,c):"")(`\x1b[${a}m`,`\x1b[${b}m`,c),q={reset:p(0,0),bold:p(1,22,"\x1b[22m\x1b[1m"),dim:p(2,22,"\x1b[22m\x1b[2m"),italic:p(3,23),underline:p(4,24),inverse:p(7,27),hidden:p(8,28),strikethrough:p(9,29),black:p(30,39),red:p(31,39),green:p(32,39),yellow:p(33,39),blue:p(34,39),magenta:p(35,39),cyan:p(36,39),white:p(37,39),gray:p(90,39),bgBlack:p(40,49),bgRed:p(41,49),bgGreen:p(42,49),bgYellow:p(43,49),bgBlue:p(44,49),bgMagenta:p(45,49),bgCyan:p(46,49),bgWhite:p(47,49),blackBright:p(90,39),redBright:p(91,39),greenBright:p(92,39),yellowBright:p(93,39),blueBright:p(94,39),magentaBright:p(95,39),cyanBright:p(96,39),whiteBright:p(97,39),bgBlackBright:p(100,49),bgRedBright:p(101,49),bgGreenBright:p(102,49),bgYellowBright:p(103,49),bgBlueBright:p(104,49),bgMagentaBright:p(105,49),bgCyanBright:p(106,49),bgWhiteBright:p(107,49)},r=({useColor:a=m}={})=>a?q:Object.keys(q).reduce((a,b)=>({...a,[b]:String}),{}),{reset:s,bold:t,dim:u,italic:v,underline:w,inverse:x,hidden:y,strikethrough:z,black:A,red:B,green:C,yellow:D,blue:E,magenta:F,cyan:G,white:H,gray:I,bgBlack:J,bgRed:K,bgGreen:L,bgYellow:M,bgBlue:N,bgMagenta:O,bgCyan:P,bgWhite:Q,blackBright:R,redBright:S,greenBright:T,yellowBright:U,blueBright:V,magentaBright:W,cyanBright:X,whiteBright:Y,bgBlackBright:Z,bgRedBright:$,bgGreenBright:_,bgYellowBright:aa,bgBlueBright:ab,bgMagentaBright:ac,bgCyanBright:ad,bgWhiteBright:ae}=r();b.bgBlack=J,b.bgBlackBright=Z,b.bgBlue=N,b.bgBlueBright=ab,b.bgCyan=P,b.bgCyanBright=ad,b.bgGreen=L,b.bgGreenBright=_,b.bgMagenta=O,b.bgMagentaBright=ac,b.bgRed=K,b.bgRedBright=$,b.bgWhite=Q,b.bgWhiteBright=ae,b.bgYellow=M,b.bgYellowBright=aa,b.black=A,b.blackBright=R,b.blue=E,b.blueBright=V,b.bold=t,b.createColors=r,b.cyan=G,b.cyanBright=X,b.dim=u,b.gray=I,b.green=C,b.greenBright=T,b.hidden=y,b.inverse=x,b.isColorSupported=m,b.italic=v,b.magenta=F,b.magentaBright=W,b.red=B,b.redBright=S,b.reset=s,b.strikethrough=z,b.underline=w,b.white=H,b.whiteBright=Y,b.yellow=D,b.yellowBright=U},36247:(a,b,c)=>{"use strict";let d=c(21820),e=c(61226),f=c(84616),g=c(17550),h=c(6442),i=c(56197),j=c(49094),{configure:k}=c(5831),{assertDefaultLevelFound:l,mappings:m,genLsCache:o,levels:p}=c(35248),{createArgsNormalizer:q,asChindings:r,final:s,buildSafeSonicBoom:t,buildFormatters:u,stringify:v,normalizeDestFileDescriptor:w,noop:x}=c(96988),{version:y}=c(45510),{chindingsSym:z,redactFmtSym:A,serializersSym:B,timeSym:C,timeSliceIndexSym:D,streamSym:E,stringifySym:F,stringifySafeSym:G,stringifiersSym:H,setLevelSym:I,endSym:J,formatOptsSym:K,messageKeySym:L,nestedKeySym:M,mixinSym:N,useOnlyCustomLevelsSym:O,formattersSym:P,hooksSym:Q,nestedKeyStrSym:R,mixinMergeStrategySym:S}=j,{epochTime:T,nullTime:U}=h,{pid:V}=process,W=d.hostname(),X=e.err,Y=q({level:"info",levels:p,messageKey:"msg",nestedKey:null,enabled:!0,prettyPrint:!1,base:{pid:V,hostname:W},serializers:Object.assign(Object.create(null),{err:X}),formatters:Object.assign(Object.create(null),{bindings:a=>a,level:(a,b)=>({level:b})}),hooks:{logMethod:void 0},timestamp:T,name:void 0,redact:null,customLevels:null,useOnlyCustomLevels:!1,depthLimit:5,edgeLimit:100}),Z=Object.assign(Object.create(null),e);function $(...a){let b={},{opts:c,stream:d}=Y(b,f(),...a),{redact:e,crlf:h,serializers:j,timestamp:p,messageKey:q,nestedKey:s,base:t,name:w,level:y,customLevels:V,mixin:W,mixinMergeStrategy:X,useOnlyCustomLevels:Z,formatters:_,hooks:aa,depthLimit:ab,edgeLimit:ac}=c,ad=k({maximumDepth:ab,maximumBreadth:ac}),ae=u(_.level,_.bindings,_.log),af=e?g(e,v):{},ag=v.bind({[G]:ad}),ah=e?{stringify:af[A]}:{stringify:ag},ai=r.bind(null,{[z]:"",[B]:j,[H]:af,[F]:v,[G]:ad,[P]:ae}),aj="";null!==t&&(aj=ai(void 0===w?t:Object.assign({},t,{name:w})));let ak=p instanceof Function?p:p?T:U,al=ak().indexOf(":")+1;if(Z&&!V)throw Error("customLevels is required if useOnlyCustomLevels is set true");if(W&&"function"!=typeof W)throw Error(`Unknown mixin type "${typeof W}" - expected "function"`);return l(y,V,Z),Object.assign(b,{levels:m(V,Z),[O]:Z,[E]:d,[C]:ak,[D]:al,[F]:v,[G]:ad,[H]:af,[J]:"}"+(h?"\r\n":"\n"),[K]:ah,[L]:q,[M]:s,[R]:s?`,${JSON.stringify(s)}:{`:"",[B]:j,[N]:W,[S]:X,[z]:aj,[P]:ae,[Q]:aa,silent:x}),Object.setPrototypeOf(b,i()),o(b),b[I](y),b}a.exports=$,a.exports.destination=(a=process.stdout.fd)=>"object"==typeof a?(a.dest=w(a.dest||process.stdout.fd),t(a)):t({dest:w(a),minLength:0,sync:!0}),a.exports.transport=c(69238),a.exports.multistream=c(29238),a.exports.final=s,a.exports.levels=m(),a.exports.stdSerializers=Z,a.exports.stdTimeFunctions=Object.assign({},h),a.exports.symbols=j,a.exports.version=y,a.exports.default=$,a.exports.pino=$},37864:(a,b,c)=>{"use strict";a.exports=function(a,b){for(let c of Array.isArray(b)?b:d(b)){if(!Object.prototype.hasOwnProperty.call(a,c))return;a=a[c]}return a};let d=c(53162)},38438:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.ONE_YEAR=b.FOUR_WEEKS=b.THREE_WEEKS=b.TWO_WEEKS=b.ONE_WEEK=b.THIRTY_DAYS=b.SEVEN_DAYS=b.FIVE_DAYS=b.THREE_DAYS=b.ONE_DAY=b.TWENTY_FOUR_HOURS=b.TWELVE_HOURS=b.SIX_HOURS=b.THREE_HOURS=b.ONE_HOUR=b.SIXTY_MINUTES=b.THIRTY_MINUTES=b.TEN_MINUTES=b.FIVE_MINUTES=b.ONE_MINUTE=b.SIXTY_SECONDS=b.THIRTY_SECONDS=b.TEN_SECONDS=b.FIVE_SECONDS=b.ONE_SECOND=void 0,b.ONE_SECOND=1,b.FIVE_SECONDS=5,b.TEN_SECONDS=10,b.THIRTY_SECONDS=30,b.SIXTY_SECONDS=60,b.ONE_MINUTE=b.SIXTY_SECONDS,b.FIVE_MINUTES=5*b.ONE_MINUTE,b.TEN_MINUTES=10*b.ONE_MINUTE,b.THIRTY_MINUTES=30*b.ONE_MINUTE,b.SIXTY_MINUTES=60*b.ONE_MINUTE,b.ONE_HOUR=b.SIXTY_MINUTES,b.THREE_HOURS=3*b.ONE_HOUR,b.SIX_HOURS=6*b.ONE_HOUR,b.TWELVE_HOURS=12*b.ONE_HOUR,b.TWENTY_FOUR_HOURS=24*b.ONE_HOUR,b.ONE_DAY=b.TWENTY_FOUR_HOURS,b.THREE_DAYS=3*b.ONE_DAY,b.FIVE_DAYS=5*b.ONE_DAY,b.SEVEN_DAYS=7*b.ONE_DAY,b.THIRTY_DAYS=30*b.ONE_DAY,b.ONE_WEEK=b.SEVEN_DAYS,b.TWO_WEEKS=2*b.ONE_WEEK,b.THREE_WEEKS=3*b.ONE_WEEK,b.FOUR_WEEKS=4*b.ONE_WEEK,b.ONE_YEAR=365*b.ONE_DAY},38491:(a,b,c)=>{"use strict";c.d(b,{kF:()=>f});class d{}class e extends d{constructor(){super()}}class f extends e{constructor(a){super()}}},40671:(a,b,c)=>{"use strict";c.r(b),c.d(b,{__assign:()=>f,__asyncDelegator:()=>v,__asyncGenerator:()=>u,__asyncValues:()=>w,__await:()=>t,__awaiter:()=>k,__classPrivateFieldGet:()=>A,__classPrivateFieldSet:()=>B,__createBinding:()=>m,__decorate:()=>h,__exportStar:()=>o,__extends:()=>e,__generator:()=>l,__importDefault:()=>z,__importStar:()=>y,__makeTemplateObject:()=>x,__metadata:()=>j,__param:()=>i,__read:()=>q,__rest:()=>g,__spread:()=>r,__spreadArrays:()=>s,__values:()=>p});var d=function(a,b){return(d=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,b)};function e(a,b){function c(){this.constructor=a}d(a,b),a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}var f=function(){return(f=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)};function g(a,b){var c={};for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&0>b.indexOf(d)&&(c[d]=a[d]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols)for(var e=0,d=Object.getOwnPropertySymbols(a);e<d.length;e++)0>b.indexOf(d[e])&&Object.prototype.propertyIsEnumerable.call(a,d[e])&&(c[d[e]]=a[d[e]]);return c}function h(a,b,c,d){var e,f=arguments.length,g=f<3?b:null===d?d=Object.getOwnPropertyDescriptor(b,c):d;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)g=Reflect.decorate(a,b,c,d);else for(var h=a.length-1;h>=0;h--)(e=a[h])&&(g=(f<3?e(g):f>3?e(b,c,g):e(b,c))||g);return f>3&&g&&Object.defineProperty(b,c,g),g}function i(a,b){return function(c,d){b(c,d,a)}}function j(a,b){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(a,b)}function k(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(a){f(a)}}function h(a){try{i(d.throw(a))}catch(a){f(a)}}function i(a){var b;a.done?e(a.value):((b=a.value)instanceof c?b:new c(function(a){a(b)})).then(g,h)}i((d=d.apply(a,b||[])).next())})}function l(a,b){var c,d,e,f,g={label:0,sent:function(){if(1&e[0])throw e[1];return e[1]},trys:[],ops:[]};return f={next:h(0),throw:h(1),return:h(2)},"function"==typeof Symbol&&(f[Symbol.iterator]=function(){return this}),f;function h(f){return function(h){var i=[f,h];if(c)throw TypeError("Generator is already executing.");for(;g;)try{if(c=1,d&&(e=2&i[0]?d.return:i[0]?d.throw||((e=d.return)&&e.call(d),0):d.next)&&!(e=e.call(d,i[1])).done)return e;switch(d=0,e&&(i=[2&i[0],e.value]),i[0]){case 0:case 1:e=i;break;case 4:return g.label++,{value:i[1],done:!1};case 5:g.label++,d=i[1],i=[0];continue;case 7:i=g.ops.pop(),g.trys.pop();continue;default:if(!(e=(e=g.trys).length>0&&e[e.length-1])&&(6===i[0]||2===i[0])){g=0;continue}if(3===i[0]&&(!e||i[1]>e[0]&&i[1]<e[3])){g.label=i[1];break}if(6===i[0]&&g.label<e[1]){g.label=e[1],e=i;break}if(e&&g.label<e[2]){g.label=e[2],g.ops.push(i);break}e[2]&&g.ops.pop(),g.trys.pop();continue}i=b.call(a,g)}catch(a){i=[6,a],d=0}finally{c=e=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}}}function m(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}function o(a,b){for(var c in a)"default"===c||b.hasOwnProperty(c)||(b[c]=a[c])}function p(a){var b="function"==typeof Symbol&&Symbol.iterator,c=b&&a[b],d=0;if(c)return c.call(a);if(a&&"number"==typeof a.length)return{next:function(){return a&&d>=a.length&&(a=void 0),{value:a&&a[d++],done:!a}}};throw TypeError(b?"Object is not iterable.":"Symbol.iterator is not defined.")}function q(a,b){var c="function"==typeof Symbol&&a[Symbol.iterator];if(!c)return a;var d,e,f=c.call(a),g=[];try{for(;(void 0===b||b-- >0)&&!(d=f.next()).done;)g.push(d.value)}catch(a){e={error:a}}finally{try{d&&!d.done&&(c=f.return)&&c.call(f)}finally{if(e)throw e.error}}return g}function r(){for(var a=[],b=0;b<arguments.length;b++)a=a.concat(q(arguments[b]));return a}function s(){for(var a=0,b=0,c=arguments.length;b<c;b++)a+=arguments[b].length;for(var d=Array(a),e=0,b=0;b<c;b++)for(var f=arguments[b],g=0,h=f.length;g<h;g++,e++)d[e]=f[g];return d}function t(a){return this instanceof t?(this.v=a,this):new t(a)}function u(a,b,c){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var d,e=c.apply(a,b||[]),f=[];return d={},g("next"),g("throw"),g("return"),d[Symbol.asyncIterator]=function(){return this},d;function g(a){e[a]&&(d[a]=function(b){return new Promise(function(c,d){f.push([a,b,c,d])>1||h(a,b)})})}function h(a,b){try{var c;(c=e[a](b)).value instanceof t?Promise.resolve(c.value.v).then(i,j):k(f[0][2],c)}catch(a){k(f[0][3],a)}}function i(a){h("next",a)}function j(a){h("throw",a)}function k(a,b){a(b),f.shift(),f.length&&h(f[0][0],f[0][1])}}function v(a){var b,c;return b={},d("next"),d("throw",function(a){throw a}),d("return"),b[Symbol.iterator]=function(){return this},b;function d(d,e){b[d]=a[d]?function(b){return(c=!c)?{value:t(a[d](b)),done:"return"===d}:e?e(b):b}:e}}function w(a){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var b,c=a[Symbol.asyncIterator];return c?c.call(a):(a=p(a),b={},d("next"),d("throw"),d("return"),b[Symbol.asyncIterator]=function(){return this},b);function d(c){b[c]=a[c]&&function(b){return new Promise(function(d,e){var f,g,h;f=d,g=e,h=(b=a[c](b)).done,Promise.resolve(b.value).then(function(a){f({value:a,done:h})},g)})}}}function x(a,b){return Object.defineProperty?Object.defineProperty(a,"raw",{value:b}):a.raw=b,a}function y(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}function z(a){return a&&a.__esModule?a:{default:a}}function A(a,b){if(!b.has(a))throw TypeError("attempted to get private field on non-instance");return b.get(a)}function B(a,b,c){if(!b.has(a))throw TypeError("attempted to set private field on non-instance");return b.set(a,c),c}},41038:(a,b,c)=>{"use strict";let{EventEmitter:d}=c(94735),{Worker:e}=c(73566),{join:f}=c(33873),{pathToFileURL:g}=c(79551),{wait:h}=c(48425),{WRITE_INDEX:i,READ_INDEX:j}=c(67270),k=c(79428),l=c(12412),m=Symbol("kImpl"),o=k.constants.MAX_STRING_LENGTH;class p{constructor(a){this._value=a}deref(){return this._value}}let q=global.FinalizationRegistry||class{register(){}unregister(){}},r=global.WeakRef||p,s=new q(a=>{a.exited||a.terminate()});function t(a){l(!a[m].sync),a[m].needDrain&&(a[m].needDrain=!1,a.emit("drain"))}function u(a){let b=Atomics.load(a[m].state,i),c=a[m].data.length-b;if(c>0){if(0===a[m].buf.length){a[m].flushing=!1,a[m].ending?A(a):a[m].needDrain&&process.nextTick(t,a);return}let b=a[m].buf.slice(0,c),d=Buffer.byteLength(b);d<=c?(a[m].buf=a[m].buf.slice(c),z(a,b,u.bind(null,a))):a.flush(()=>{if(!a.destroyed){for(Atomics.store(a[m].state,j,0),Atomics.store(a[m].state,i,0);d>a[m].data.length;)c/=2,b=a[m].buf.slice(0,c),d=Buffer.byteLength(b);a[m].buf=a[m].buf.slice(c),z(a,b,u.bind(null,a))}})}else if(0===c){if(0===b&&0===a[m].buf.length)return;a.flush(()=>{Atomics.store(a[m].state,j,0),Atomics.store(a[m].state,i,0),u(a)})}else throw Error("overwritten")}function v(a){let b=this.stream.deref();if(void 0===b){this.exited=!0,this.terminate();return}switch(a.code){case"READY":this.stream=new r(b),b.flush(()=>{b[m].ready=!0,b.emit("ready")});break;case"ERROR":y(b,a.err);break;default:throw Error("this should not happen: "+a.code)}}function w(a){let b=this.stream.deref();void 0!==b&&(s.unregister(b),b.worker.exited=!0,b.worker.off("exit",w),y(b,0!==a?Error("The worker thread exited"):null))}class x extends d{constructor(a={}){if(super(),a.bufferSize<4)throw Error("bufferSize must at least fit a 4-byte utf-8 char");this[m]={},this[m].stateBuf=new SharedArrayBuffer(128),this[m].state=new Int32Array(this[m].stateBuf),this[m].dataBuf=new SharedArrayBuffer(a.bufferSize||4194304),this[m].data=Buffer.from(this[m].dataBuf),this[m].sync=a.sync||!1,this[m].ending=!1,this[m].ended=!1,this[m].needDrain=!1,this[m].destroyed=!1,this[m].flushing=!1,this[m].ready=!1,this[m].finished=!1,this[m].errored=null,this[m].closed=!1,this[m].buf="",this.worker=function(a,b){let{filename:c,workerData:d}=b,h=new e(("__bundlerPathsOverrides"in globalThis?globalThis.__bundlerPathsOverrides:{})["thread-stream-worker"]||f(__dirname,"lib","worker.js"),{...b.workerOpts,workerData:{filename:0===c.indexOf("file://")?c:g(c).href,dataBuf:a[m].dataBuf,stateBuf:a[m].stateBuf,workerData:d}});return h.stream=new p(a),h.on("message",v),h.on("exit",w),s.register(a,h),h}(this,a)}write(a){if(this[m].destroyed)throw Error("the worker has exited");if(this[m].ending)throw Error("the worker is ending");if(this[m].flushing&&this[m].buf.length+a.length>=o)try{B(this),this[m].flushing=!0}catch(a){return y(this,a),!1}if(this[m].buf+=a,this[m].sync)try{return B(this),!0}catch(a){return y(this,a),!1}return this[m].flushing||(this[m].flushing=!0,setImmediate(u,this)),this[m].needDrain=this[m].data.length-this[m].buf.length-Atomics.load(this[m].state,i)<=0,!this[m].needDrain}end(){this[m].destroyed||(this[m].ending=!0,A(this))}flush(a){if(this[m].destroyed){"function"==typeof a&&process.nextTick(a,Error("the worker has exited"));return}let b=Atomics.load(this[m].state,i);h(this[m].state,j,b,1/0,(b,c)=>{if(b){y(this,b),process.nextTick(a,b);return}if("not-equal"===c)return void this.flush(a);process.nextTick(a)})}flushSync(){this[m].destroyed||(B(this),C(this))}unref(){this.worker.unref()}ref(){this.worker.ref()}get ready(){return this[m].ready}get destroyed(){return this[m].destroyed}get closed(){return this[m].closed}get writable(){return!this[m].destroyed&&!this[m].ending}get writableEnded(){return this[m].ending}get writableFinished(){return this[m].finished}get writableNeedDrain(){return this[m].needDrain}get writableObjectMode(){return!1}get writableErrored(){return this[m].errored}}function y(a,b){a[m].destroyed||(a[m].destroyed=!0,b&&(a[m].errored=b,a.emit("error",b)),a.worker.exited?setImmediate(()=>{a[m].closed=!0,a.emit("close")}):a.worker.terminate().catch(()=>{}).then(()=>{a[m].closed=!0,a.emit("close")}))}function z(a,b,c){let d=Atomics.load(a[m].state,i),e=Buffer.byteLength(b);return a[m].data.write(b,d),Atomics.store(a[m].state,i,d+e),Atomics.notify(a[m].state,i),c(),!0}function A(a){if(!a[m].ended&&a[m].ending&&!a[m].flushing){a[m].ended=!0;try{a.flushSync();let b=Atomics.load(a[m].state,j);Atomics.store(a[m].state,i,-1),Atomics.notify(a[m].state,i);let c=0;for(;-1!==b;){if(Atomics.wait(a[m].state,j,b,1e3),b=Atomics.load(a[m].state,j),-2===b)throw Error("end() failed");if(10==++c)throw Error("end() took too long (10s)")}process.nextTick(()=>{a[m].finished=!0,a.emit("finish")})}catch(b){y(a,b)}}}function B(a){let b=()=>{a[m].ending?A(a):a[m].needDrain&&process.nextTick(t,a)};for(a[m].flushing=!1;0!==a[m].buf.length;){let c=Atomics.load(a[m].state,i),d=a[m].data.length-c;if(0===d){C(a),Atomics.store(a[m].state,j,0),Atomics.store(a[m].state,i,0);continue}if(d<0)throw Error("overwritten");let e=a[m].buf.slice(0,d),f=Buffer.byteLength(e);if(f<=d)a[m].buf=a[m].buf.slice(d),z(a,e,b);else{for(C(a),Atomics.store(a[m].state,j,0),Atomics.store(a[m].state,i,0);f>a[m].buf.length;)d/=2,e=a[m].buf.slice(0,d),f=Buffer.byteLength(e);a[m].buf=a[m].buf.slice(d),z(a,e,b)}}}function C(a){if(a[m].flushing)throw Error("unable to flush while flushing");let b=Atomics.load(a[m].state,i),c=0;for(;;){let d=Atomics.load(a[m].state,j);if(-2===d)throw Error("_flushSync failed");if(d!==b)Atomics.wait(a[m].state,j,d,1e3);else break;if(10==++c)throw Error("_flushSync took too long (10s)")}}a.exports=x},41040:a=>{"use strict";a.exports={mapHttpResponse:function(a){return{res:d(a)}},resSerializer:d};let b=Symbol("pino-raw-res-ref"),c=Object.create({},{statusCode:{enumerable:!0,writable:!0,value:0},headers:{enumerable:!0,writable:!0,value:""},raw:{enumerable:!1,get:function(){return this[b]},set:function(a){this[b]=a}}});function d(a){let b=Object.create(c);return b.statusCode=a.statusCode,b.headers=a.getHeaders?a.getHeaders():a._headers,b.raw=a,b}Object.defineProperty(c,b,{writable:!0,value:{}})},41064:(a,b,c)=>{"use strict";let d=c(86619)();a.exports=d;let e="PinoWarning";d.create(e,"PINODEP008","prettyPrint is deprecated, look at https://github.com/pinojs/pino-pretty for alternatives."),d.create(e,"PINODEP009","The use of pino.final is discouraged in Node.js v14+ and not required. It will be removed in the next major version")},42950:(a,b,c)=>{"use strict";b.g=void 0;let d=c(88492);b.g=function(){let a,b,c;try{a=d.getDocumentOrThrow(),b=d.getLocationOrThrow()}catch(a){return null}function e(...b){let c=a.getElementsByTagName("meta");for(let a=0;a<c.length;a++){let d=c[a],e=["itemprop","property","name"].map(a=>d.getAttribute(a)).filter(a=>!!a&&b.includes(a));if(e.length&&e){let a=d.getAttribute("content");if(a)return a}}return""}let f=((c=e("name","og:site_name","og:title","twitter:title"))||(c=a.title),c),g=e("description","og:description","twitter:description","keywords"),h=b.origin;return{description:g,url:h,icons:function(){let c=a.getElementsByTagName("link"),d=[];for(let a=0;a<c.length;a++){let e=c[a],f=e.getAttribute("rel");if(f&&f.toLowerCase().indexOf("icon")>-1){let a=e.getAttribute("href");if(a)if(-1===a.toLowerCase().indexOf("https:")&&-1===a.toLowerCase().indexOf("http:")&&0!==a.indexOf("//")){let c=b.protocol+"//"+b.host;if(0===a.indexOf("/"))c+=a;else{let d=b.pathname.split("/");d.pop(),c+=d.join("/")+"/"+a}d.push(c)}else if(0===a.indexOf("//")){let c=b.protocol+a;d.push(c)}else d.push(a)}}return d}(),name:f}}},43273:(a,b)=>{"use strict";function c(){return"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product}function d(){return"undefined"!=typeof process&&void 0!==process.versions&&void 0!==process.versions.node}Object.defineProperty(b,"__esModule",{value:!0}),b.isBrowser=b.isNode=b.isReactNative=void 0,b.isReactNative=c,b.isNode=d,b.isBrowser=function(){return!c()&&!d()}},43902:a=>{"use strict";function b(a,b,c,d){function e(){let a=b.deref();void 0!==a&&c(a,d)}a[d]=e,process.once(d,e)}let c=new FinalizationRegistry(e),d=new WeakMap;function e(a){process.removeListener("exit",a.exit),process.removeListener("beforeExit",a.beforeExit)}a.exports={register:function(a,e){if(void 0===a)throw Error("the object can't be undefined");let f=new WeakRef(a),g={};d.set(a,g),c.register(a,g),b(g,f,e,"exit"),b(g,f,e,"beforeExit")},unregister:function(a){let b=d.get(a);d.delete(a),b&&e(b),c.unregister(a)}}},44448:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.fromMiliseconds=b.toMiliseconds=void 0;let d=c(15975);b.toMiliseconds=function(a){return a*d.ONE_THOUSAND},b.fromMiliseconds=function(a){return Math.floor(a/d.ONE_THOUSAND)}},44450:(a,b,c)=>{"use strict";c.d(b,{A:()=>t,V:()=>t});var d=c(94735),e=c(11428),f=c.n(e),g=c(25080),h=c(44566),i=Object.defineProperty,j=Object.defineProperties,k=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,m=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,p=(a,b,c)=>b in a?i(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,q=(a,b)=>{for(var c in b||(b={}))m.call(b,c)&&p(a,c,b[c]);if(l)for(var c of l(b))o.call(b,c)&&p(a,c,b[c]);return a},r=(a,b)=>j(a,k(b));let s={headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST"};class t{constructor(a,b=!1){if(this.url=a,this.disableProviderPing=b,this.events=new d.EventEmitter,this.isAvailable=!1,this.registering=!1,!(0,h.isHttpUrl)(a))throw Error(`Provided URL is not compatible with HTTP connection: ${a}`);this.url=a,this.disableProviderPing=b}get connected(){return this.isAvailable}get connecting(){return this.registering}on(a,b){this.events.on(a,b)}once(a,b){this.events.once(a,b)}off(a,b){this.events.off(a,b)}removeListener(a,b){this.events.removeListener(a,b)}async open(a=this.url){await this.register(a)}async close(){if(!this.isAvailable)throw Error("Connection already closed");this.onClose()}async send(a){this.isAvailable||await this.register();try{let b=(0,g.h)(a),c=await (await f()(this.url,r(q({},s),{body:b}))).json();this.onPayload({data:c})}catch(b){this.onError(a.id,b)}}async register(a=this.url){if(!(0,h.isHttpUrl)(a))throw Error(`Provided URL is not compatible with HTTP connection: ${a}`);if(this.registering){let a=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=a||this.events.listenerCount("open")>=a)&&this.events.setMaxListeners(a+1),new Promise((a,b)=>{this.events.once("register_error",a=>{this.resetMaxListeners(),b(a)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return b(Error("HTTP connection is missing or invalid"));a()})})}this.url=a,this.registering=!0;try{if(!this.disableProviderPing){let b=(0,g.h)({id:1,jsonrpc:"2.0",method:"test",params:[]});await f()(a,r(q({},s),{body:b}))}this.onOpen()}catch(b){let a=this.parseError(b);throw this.events.emit("register_error",a),this.onClose(),a}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(a){if(typeof a.data>"u")return;let b="string"==typeof a.data?(0,g.j)(a.data):a.data;this.events.emit("payload",b)}onError(a,b){let c=this.parseError(b),d=c.message||c.toString(),e=(0,h.formatJsonRpcError)(a,d);this.events.emit("payload",e)}parseError(a,b=this.url){return(0,h.parseConnectionError)(a,b,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>10&&this.events.setMaxListeners(10)}}},44566:(a,b,c)=>{"use strict";c.d(b,{IJsonRpcProvider:()=>g.kF,formatJsonRpcError:()=>f.dZ,formatJsonRpcRequest:()=>f.e_,formatJsonRpcResult:()=>f.Im,getBigIntRpcId:()=>f.eX,isHttpUrl:()=>h.q$,isJsonRpcError:()=>i.U$,isJsonRpcRequest:()=>i.p3,isJsonRpcResponse:()=>i.tq,isJsonRpcResult:()=>i.xT,isLocalhostUrl:()=>h.z,isWsUrl:()=>h.A1,parseConnectionError:()=>d.eF,payloadId:()=>f.ER}),c(58703);var d=c(7376),e=c(71137);c.o(e,"IJsonRpcProvider")&&c.d(b,{IJsonRpcProvider:function(){return e.IJsonRpcProvider}}),c.o(e,"formatJsonRpcError")&&c.d(b,{formatJsonRpcError:function(){return e.formatJsonRpcError}}),c.o(e,"formatJsonRpcRequest")&&c.d(b,{formatJsonRpcRequest:function(){return e.formatJsonRpcRequest}}),c.o(e,"formatJsonRpcResult")&&c.d(b,{formatJsonRpcResult:function(){return e.formatJsonRpcResult}}),c.o(e,"getBigIntRpcId")&&c.d(b,{getBigIntRpcId:function(){return e.getBigIntRpcId}}),c.o(e,"isHttpUrl")&&c.d(b,{isHttpUrl:function(){return e.isHttpUrl}}),c.o(e,"isJsonRpcError")&&c.d(b,{isJsonRpcError:function(){return e.isJsonRpcError}}),c.o(e,"isJsonRpcRequest")&&c.d(b,{isJsonRpcRequest:function(){return e.isJsonRpcRequest}}),c.o(e,"isJsonRpcResponse")&&c.d(b,{isJsonRpcResponse:function(){return e.isJsonRpcResponse}}),c.o(e,"isJsonRpcResult")&&c.d(b,{isJsonRpcResult:function(){return e.isJsonRpcResult}}),c.o(e,"isLocalhostUrl")&&c.d(b,{isLocalhostUrl:function(){return e.isLocalhostUrl}}),c.o(e,"isReactNative")&&c.d(b,{isReactNative:function(){return e.isReactNative}}),c.o(e,"isWsUrl")&&c.d(b,{isWsUrl:function(){return e.isWsUrl}}),c.o(e,"payloadId")&&c.d(b,{payloadId:function(){return e.payloadId}});var f=c(48687),g=c(38491),h=c(20031),i=c(18519)},44660:(a,b,c)=>{"use strict";c.d(b,{H:()=>d});class d{}},44944:a=>{a.exports=g,g.default=g,g.stable=j,g.stableStringify=j;var b="[...]",c="[Circular]",d=[],e=[];function f(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function g(a,g,i,j){void 0===j&&(j=f()),function a(d,e,f,g,i,j,k){if(j+=1,"object"==typeof d&&null!==d){for(l=0;l<g.length;l++)if(g[l]===d)return void h(c,d,e,i);if(void 0!==k.depthLimit&&j>k.depthLimit||void 0!==k.edgesLimit&&f+1>k.edgesLimit)return void h(b,d,e,i);if(g.push(d),Array.isArray(d))for(l=0;l<d.length;l++)a(d[l],l,l,g,d,j,k);else{var l,m=Object.keys(d);for(l=0;l<m.length;l++){var o=m[l];a(d[o],o,l,g,d,j,k)}}g.pop()}}(a,"",0,[],void 0,0,j);try{l=0===e.length?JSON.stringify(a,g,i):JSON.stringify(a,k(g),i)}catch(a){return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;0!==d.length;){var l,m=d.pop();4===m.length?Object.defineProperty(m[0],m[1],m[3]):m[0][m[1]]=m[2]}}return l}function h(a,b,c,f){var g=Object.getOwnPropertyDescriptor(f,c);void 0!==g.get?g.configurable?(Object.defineProperty(f,c,{value:a}),d.push([f,c,b,g])):e.push([b,c,a]):(f[c]=a,d.push([f,c,b]))}function i(a,b){return a<b?-1:+(a>b)}function j(a,g,j,l){void 0===l&&(l=f());var m,o=function a(e,f,g,j,k,l,m){if(l+=1,"object"==typeof e&&null!==e){for(o=0;o<j.length;o++)if(j[o]===e)return void h(c,e,f,k);try{if("function"==typeof e.toJSON)return}catch(a){return}if(void 0!==m.depthLimit&&l>m.depthLimit||void 0!==m.edgesLimit&&g+1>m.edgesLimit)return void h(b,e,f,k);if(j.push(e),Array.isArray(e))for(o=0;o<e.length;o++)a(e[o],o,o,j,e,l,m);else{var o,p={},q=Object.keys(e).sort(i);for(o=0;o<q.length;o++){var r=q[o];a(e[r],r,o,j,e,l,m),p[r]=e[r]}if(void 0===k)return p;d.push([k,f,e]),k[f]=p}j.pop()}}(a,"",0,[],void 0,0,l)||a;try{m=0===e.length?JSON.stringify(o,g,j):JSON.stringify(o,k(g),j)}catch(a){return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;0!==d.length;){var p=d.pop();4===p.length?Object.defineProperty(p[0],p[1],p[3]):p[0][p[1]]=p[2]}}return m}function k(a){return a=void 0!==a?a:function(a,b){return b},function(b,c){if(e.length>0)for(var d=0;d<e.length;d++){var f=e[d];if(f[1]===b&&f[0]===c){c=f[2],e.splice(d,1);break}}return a.call(this,b,c)}}},45510:(a,b,c)=>{"use strict";let{version:d}=c(24856);a.exports={version:d}},46030:(a,b,c)=>{"use strict";let d=Symbol.for("pino.metadata"),e=c(70548),{Duplex:f}=c(27910),{parentPort:g,workerData:h}=c(73566);function i(a,b){process.nextTick(b,a)}a.exports=function(a,b={}){let c=!0===b.expectPinoConfig&&h?.workerData?.pinoWillSendConfig===!0,j="lines"===b.parse,k="function"==typeof b.parseLine?b.parseLine:JSON.parse,l=b.close||i,m=e(function(a){let b;try{b=k(a)}catch(b){this.emit("unknown",a,b);return}return null===b?void this.emit("unknown",a,"Null value ignored"):("object"!=typeof b&&(b={data:b,time:Date.now()}),m[d]&&(m.lastTime=b.time,m.lastLevel=b.level,m.lastObj=b),j)?a:b},{autoDestroy:!0});if(m._destroy=function(a,b){let c=l(a,b);c&&"function"==typeof c.then&&c.then(b,b)},!0===b.expectPinoConfig&&h?.workerData?.pinoWillSendConfig!==!0&&setImmediate(()=>{m.emit("error",Error("This transport is not compatible with the current version of pino. Please upgrade pino to the latest version."))}),!1!==b.metadata&&(m[d]=!0,m.lastTime=0,m.lastLevel=0,m.lastObj=null),c){let a={},b=function(){let a,b,c=new Promise((c,d)=>{a=c,b=d});return c.resolve=a,c.reject=b,c}();return g.on("message",function c(d){"PINO_CONFIG"===d.code&&(a=d.config,b.resolve(),g.off("message",c))}),Object.defineProperties(m,{levels:{get:()=>a.levels},messageKey:{get:()=>a.messageKey},errorKey:{get:()=>a.errorKey}}),b.then(o)}return o();function o(){let c=a(m);if(c&&"function"==typeof c.catch)c.catch(a=>{m.destroy(a)}),c=null;else if(b.enablePipelining&&c)return f.from({writable:m,readable:c});return m}}},46102:(a,b,c)=>{var d,e=c(93700),f=c(24662);try{d=c(29021)}catch(a){}var g=function(){},h="undefined"!=typeof process&&/^v?\.0/.test(process.version),i=function(a){return"function"==typeof a},j=function(a,b,c,j){j=e(j);var k=!1;a.on("close",function(){k=!0}),f(a,{readable:b,writable:c},function(a){if(a)return j(a);k=!0,j()});var l=!1;return function(b){if(!k&&!l){if(l=!0,h&&d&&(a instanceof(d.ReadStream||g)||a instanceof(d.WriteStream||g))&&i(a.close))return a.close(g);if(a.setHeader&&i(a.abort))return a.abort();if(i(a.destroy))return a.destroy();j(b||Error("stream was destroyed"))}}},k=function(a){a()},l=function(a,b){return a.pipe(b)};a.exports=function(){var a,b=Array.prototype.slice.call(arguments),c=i(b[b.length-1]||g)&&b.pop()||g;if(Array.isArray(b[0])&&(b=b[0]),b.length<2)throw Error("pump requires two streams per minimum");var d=b.map(function(e,f){var g=f<b.length-1;return j(e,g,f>0,function(b){a||(a=b),b&&d.forEach(k),g||(d.forEach(k),c(a))})});return b.reduce(l)}},46590:(a,b,c)=>{"use strict";let d;c.d(b,{A:()=>D});let e=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,f=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,g=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function h(a,b){var c;return"__proto__"===a||"constructor"===a&&b&&"object"==typeof b&&"prototype"in b?void(c=a,console.warn(`[destr] Dropping "${c}" key to prevent prototype pollution.`)):b}function i(a,b={}){if("string"!=typeof a)return a;if('"'===a[0]&&'"'===a[a.length-1]&&-1===a.indexOf("\\"))return a.slice(1,-1);let c=a.trim();if(c.length<=9)switch(c.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return NaN;case"infinity":return 1/0;case"-infinity":return-1/0}if(!g.test(a)){if(b.strict)throw SyntaxError("[destr] Invalid JSON");return a}try{if(e.test(a)||f.test(a)){if(b.strict)throw Error("[destr] Possible prototype pollution");return JSON.parse(a,h)}return JSON.parse(a)}catch(c){if(b.strict)throw c;return a}}function j(a,...b){try{var c;return(c=a(...b))&&"function"==typeof c.then?c:Promise.resolve(c)}catch(a){return Promise.reject(a)}}function k(a){if(function(a){let b=typeof a;return null===a||"object"!==b&&"function"!==b}(a))return String(a);if(function(a){let b=Object.getPrototypeOf(a);return!b||b.isPrototypeOf(Object)}(a)||Array.isArray(a))return JSON.stringify(a);if("function"==typeof a.toJSON)return k(a.toJSON());throw Error("[unstorage] Cannot stringify value!")}let l="base64:";function m(a){return a&&a.split("?")[0]?.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,"")||""}function o(a){return(a=m(a))?a+":":""}function p(a,b,c){return a.watch?a.watch((a,d)=>b(a,c+d)):()=>{}}async function q(a){"function"==typeof a.dispose&&await j(a.dispose)}function r(a){return new Promise((b,c)=>{a.oncomplete=a.onsuccess=()=>b(a.result),a.onabort=a.onerror=()=>c(a.error)})}function s(a,b){let c;return(d,e)=>(()=>{if(c)return c;let d=indexedDB.open(a);return d.onupgradeneeded=()=>d.result.createObjectStore(b),(c=r(d)).then(a=>{a.onclose=()=>c=void 0},()=>{}),c})().then(a=>e(a.transaction(b,d).objectStore(b)))}function t(){return d||(d=s("keyval-store","keyval")),d}function u(a,b=t()){return b("readonly",b=>r(b.get(a)))}var v=c(25080);class w{constructor(){this.indexedDb=function(a={}){let b={mounts:{"":a.driver||(()=>{let a=new Map;return{name:"memory",getInstance:()=>a,hasItem:b=>a.has(b),getItem:b=>a.get(b)??null,getItemRaw:b=>a.get(b)??null,setItem(b,c){a.set(b,c)},setItemRaw(b,c){a.set(b,c)},removeItem(b){a.delete(b)},getKeys:()=>[...a.keys()],clear(){a.clear()},dispose(){a.clear()}}})()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},c=a=>{for(let c of b.mountpoints)if(a.startsWith(c))return{base:c,relativeKey:a.slice(c.length),driver:b.mounts[c]};return{base:"",relativeKey:a,driver:b.mounts[""]}},d=(a,c)=>b.mountpoints.filter(b=>b.startsWith(a)||c&&a.startsWith(b)).map(c=>({relativeBase:a.length>c.length?a.slice(c.length):void 0,mountpoint:c,driver:b.mounts[c]})),e=(a,c)=>{if(b.watching)for(let d of(c=m(c),b.watchListeners))d(a,c)},f=async()=>{if(!b.watching)for(let a in b.watching=!0,b.mounts)b.unwatch[a]=await p(b.mounts[a],e,a)},g=async()=>{if(b.watching){for(let a in b.unwatch)await b.unwatch[a]();b.unwatch={},b.watching=!1}},h=(a,b,d)=>{let e=new Map,f=a=>{let b=e.get(a.base);return b||(b={driver:a.driver,base:a.base,items:[]},e.set(a.base,b)),b};for(let d of a){let a="string"==typeof d,e=m(a?d:d.key),g=a?void 0:d.value,h=a||!d.options?b:{...b,...d.options},i=c(e);f(i).items.push({key:e,value:g,relativeKey:i.relativeKey,options:h})}return Promise.all([...e.values()].map(a=>d(a))).then(a=>a.flat())},r={hasItem(a,b={}){let{relativeKey:d,driver:e}=c(a=m(a));return j(e.hasItem,d,b)},getItem(a,b={}){let{relativeKey:d,driver:e}=c(a=m(a));return j(e.getItem,d,b).then(a=>i(a))},getItems:(a,b={})=>h(a,b,a=>a.driver.getItems?j(a.driver.getItems,a.items.map(a=>({key:a.relativeKey,options:a.options})),b).then(b=>b.map(b=>({key:function(...a){return m(a.join(":"))}(a.base,b.key),value:i(b.value)}))):Promise.all(a.items.map(b=>j(a.driver.getItem,b.relativeKey,b.options).then(a=>({key:b.key,value:i(a)}))))),getItemRaw(a,b={}){let{relativeKey:d,driver:e}=c(a=m(a));return e.getItemRaw?j(e.getItemRaw,d,b):j(e.getItem,d,b).then(a=>{var b;return"string"==typeof a&&a.startsWith(l)?(b=a.slice(l.length),globalThis.Buffer?Buffer.from(b,"base64"):Uint8Array.from(globalThis.atob(b),a=>a.codePointAt(0))):a})},async setItem(a,b,d={}){if(void 0===b)return r.removeItem(a);let{relativeKey:f,driver:g}=c(a=m(a));g.setItem&&(await j(g.setItem,f,k(b),d),g.watch||e("update",a))},async setItems(a,b){await h(a,b,async a=>{if(a.driver.setItems)return j(a.driver.setItems,a.items.map(a=>({key:a.relativeKey,value:k(a.value),options:a.options})),b);a.driver.setItem&&await Promise.all(a.items.map(b=>j(a.driver.setItem,b.relativeKey,k(b.value),b.options)))})},async setItemRaw(a,b,d={}){if(void 0===b)return r.removeItem(a,d);let{relativeKey:f,driver:g}=c(a=m(a));if(g.setItemRaw)await j(g.setItemRaw,f,b,d);else{var h;if(!g.setItem)return;await j(g.setItem,f,"string"==typeof b?b:l+(h=b,globalThis.Buffer?Buffer.from(h).toString("base64"):globalThis.btoa(String.fromCodePoint(...h))),d)}g.watch||e("update",a)},async removeItem(a,b={}){"boolean"==typeof b&&(b={removeMeta:b});let{relativeKey:d,driver:f}=c(a=m(a));f.removeItem&&(await j(f.removeItem,d,b),(b.removeMeta||b.removeMata)&&await j(f.removeItem,d+"$",b),f.watch||e("remove",a))},async getMeta(a,b={}){"boolean"==typeof b&&(b={nativeOnly:b});let{relativeKey:d,driver:e}=c(a=m(a)),f=Object.create(null);if(e.getMeta&&Object.assign(f,await j(e.getMeta,d,b)),!b.nativeOnly){let a=await j(e.getItem,d+"$",b).then(a=>i(a));a&&"object"==typeof a&&("string"==typeof a.atime&&(a.atime=new Date(a.atime)),"string"==typeof a.mtime&&(a.mtime=new Date(a.mtime)),Object.assign(f,a))}return f},setMeta(a,b,c={}){return this.setItem(a+"$",b,c)},removeMeta(a,b={}){return this.removeItem(a+"$",b)},async getKeys(a,b={}){let c=d(a=o(a),!0),e=[],f=[],g=!0;for(let a of c){for(let c of(a.driver.flags?.maxDepth||(g=!1),await j(a.driver.getKeys,a.relativeBase,b))){let b=a.mountpoint+m(c);e.some(a=>b.startsWith(a))||f.push(b)}e=[a.mountpoint,...e.filter(b=>!b.startsWith(a.mountpoint))]}let h=void 0!==b.maxDepth&&!g;return f.filter(c=>{var d;return(!h||function(a,b){if(void 0===b)return!0;let c=0,d=a.indexOf(":");for(;d>-1;)c++,d=a.indexOf(":",d+1);return c<=b}(c,b.maxDepth))&&((d=a)?c.startsWith(d)&&"$"!==c[c.length-1]:"$"!==c[c.length-1])})},async clear(a,b={}){a=o(a),await Promise.all(d(a,!1).map(async a=>a.driver.clear?j(a.driver.clear,a.relativeBase,b):a.driver.removeItem?Promise.all((await a.driver.getKeys(a.relativeBase||"",b)).map(c=>a.driver.removeItem(c,b))):void 0))},async dispose(){await Promise.all(Object.values(b.mounts).map(a=>q(a)))},watch:async a=>(await f(),b.watchListeners.push(a),async()=>{b.watchListeners=b.watchListeners.filter(b=>b!==a),0===b.watchListeners.length&&await g()}),async unwatch(){b.watchListeners=[],await g()},mount(a,c){if((a=o(a))&&b.mounts[a])throw Error(`already mounted at ${a}`);return a&&(b.mountpoints.push(a),b.mountpoints.sort((a,b)=>b.length-a.length)),b.mounts[a]=c,b.watching&&Promise.resolve(p(c,e,a)).then(c=>{b.unwatch[a]=c}).catch(console.error),r},async unmount(a,c=!0){(a=o(a))&&b.mounts[a]&&(b.watching&&a in b.unwatch&&(b.unwatch[a]?.(),delete b.unwatch[a]),c&&await q(b.mounts[a]),b.mountpoints=b.mountpoints.filter(b=>b!==a),delete b.mounts[a])},getMount(a=""){let b=c(a=m(a)+":");return{driver:b.driver,base:b.base}},getMounts:(a="",b={})=>d(a=m(a),b.parents).map(a=>({driver:a.driver,base:a.mountpoint})),keys:(a,b={})=>r.getKeys(a,b),get:(a,b={})=>r.getItem(a,b),set:(a,b,c={})=>r.setItem(a,b,c),has:(a,b={})=>r.hasItem(a,b),del:(a,b={})=>r.removeItem(a,b),remove:(a,b={})=>r.removeItem(a,b)};return r}({driver:((a={})=>{let b,c=a.base&&a.base.length>0?`${a.base}:`:"";return a.dbName&&a.storeName&&(b=s(a.dbName,a.storeName)),{name:"idb-keyval",options:a,hasItem:async a=>!(typeof await u(c+a,b)>"u"),getItem:async a=>await u(c+a,b)??null,setItem:(a,d)=>(function(a,b,c=t()){return c("readwrite",c=>(c.put(b,a),r(c.transaction)))})(c+a,d,b),removeItem:a=>(function(a,b=t()){return b("readwrite",b=>(b.delete(a),r(b.transaction)))})(c+a,b),getKeys:()=>(function(a=t()){return a("readonly",a=>{var b;if(a.getAllKeys)return r(a.getAllKeys());let c=[];return(b=a=>c.push(a.key),a.openCursor().onsuccess=function(){this.result&&(b(this.result),this.result.continue())},r(a.transaction)).then(()=>c)})})(b),clear:()=>(function(a=t()){return a("readwrite",a=>(a.clear(),r(a.transaction)))})(b)}})({dbName:"WALLET_CONNECT_V2_INDEXED_DB",storeName:"keyvaluestorage"})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(a=>[a.key,a.value])}async getItem(a){let b=await this.indexedDb.getItem(a);if(null!==b)return b}async setItem(a,b){await this.indexedDb.setItem(a,(0,v.h)(b))}async removeItem(a){await this.indexedDb.removeItem(a)}}var x="u">typeof globalThis?globalThis:"u">typeof window?window:"u">typeof global?global:"u">typeof self?self:{},y={exports:{}};function z(a){var b;return[a[0],(0,v.j)(null!=(b=a[1])?b:"")]}!function(){function a(){}a.prototype.getItem=function(a){return this.hasOwnProperty(a)?String(this[a]):null},a.prototype.setItem=function(a,b){this[a]=String(b)},a.prototype.removeItem=function(a){delete this[a]},a.prototype.clear=function(){let a=this;Object.keys(a).forEach(function(b){a[b]=void 0,delete a[b]})},a.prototype.key=function(a){return a=a||0,Object.keys(this)[a]},a.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),"u">typeof x&&x.localStorage?y.exports=x.localStorage:"u">typeof window&&window.localStorage?y.exports=window.localStorage:y.exports=new a}();class A{constructor(){this.localStorage=y.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(z)}async getItem(a){let b=this.localStorage.getItem(a);if(null!==b)return(0,v.j)(b)}async setItem(a,b){this.localStorage.setItem(a,(0,v.h)(b))}async removeItem(a){this.localStorage.removeItem(a)}}let B=async(a,b,c)=>{let d="wc_storage_version",e=await b.getItem(d);if(e&&e>=1)return void c(b);let f=await a.getKeys();if(!f.length)return void c(b);let g=[];for(;f.length;){let c=f.shift();if(!c)continue;let d=c.toLowerCase();if(d.includes("wc@")||d.includes("walletconnect")||d.includes("wc_")||d.includes("wallet_connect")){let d=await a.getItem(c);await b.setItem(c,d),g.push(c)}}await b.setItem(d,1),c(b),C(a,g)},C=async(a,b)=>{b.length&&b.forEach(async b=>{await a.removeItem(b)})};class D{constructor(){this.initialized=!1,this.setInitialized=a=>{this.storage=a,this.initialized=!0};let a=new A;this.storage=a;try{let b=new w;B(a,b,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(a){return await this.initialize(),this.storage.getItem(a)}async setItem(a,b){return await this.initialize(),this.storage.setItem(a,b)}async removeItem(a){return await this.initialize(),this.storage.removeItem(a)}async initialize(){this.initialized||await new Promise(a=>{let b=setInterval(()=>{this.initialized&&(clearInterval(b),a())},20)})}}},48278:(a,b,c)=>{"use strict";let{isColorSupported:d}=c(35783),e=c(46102),{Transform:f}=c(57075),g=c(46030),h=c(52044),{ERROR_LIKE_KEYS:i,LEVEL_KEY:j,LEVEL_LABEL:k,MESSAGE_KEY:l,TIMESTAMP_KEY:m}=c(70219),{buildSafeSonicBoom:o,parseFactoryOptions:p}=c(66376),q=c(29616),r={colorize:d,colorizeObjects:!0,crlf:!1,customColors:null,customLevels:null,customPrettifiers:{},errorLikeObjectKeys:i,errorProps:"",hideObject:!1,ignore:"hostname",include:void 0,levelFirst:!1,levelKey:j,levelLabel:k,messageFormat:null,messageKey:l,minimumLevel:void 0,outputStream:process.stdout,singleLine:!1,timestampKey:m,translateTime:!0,useOnlyCustomProps:!0};function s(a){let b=p(Object.assign({},r,a));return q.bind({...b,context:b})}function t(a={}){let b,c=s(a);return g(function(d){d.on("message",function b(e){e&&"PINO_CONFIG"===e.code&&(Object.assign(a,{messageKey:e.config.messageKey,errorLikeObjectKeys:Array.from(new Set([...a.errorLikeObjectKeys||i,e.config.errorKey])),customLevels:e.config.levels.values}),c=s(a),d.off("message",b))});let g=new f({objectMode:!0,autoDestroy:!0,transform(a,b,d){d(null,c(a))}});return b="object"==typeof a.destination&&"function"==typeof a.destination.write?a.destination:o({dest:a.destination||1,append:a.append,mkdir:a.mkdir,sync:a.sync}),d.on("unknown",function(a){b.write(a+"\n")}),e(d,g,b),g},{parse:"lines",close(a,c){b.on("close",()=>{c(a)})}})}a.exports=t,a.exports.build=t,a.exports.PinoPretty=t,a.exports.prettyFactory=s,a.exports.colorizerFactory=h,a.exports.isColorSupported=d,a.exports.default=t},48424:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.IWatch=void 0;class c{}b.IWatch=c},48425:a=>{"use strict";a.exports={wait:function(a,b,c,d,e){let f=Date.now()+d,g=Atomics.load(a,b);if(g===c)return void e(null,"ok");let h=g,i=d=>{Date.now()>f?e(null,"timed-out"):setTimeout(()=>{h=g,(g=Atomics.load(a,b))===h?i(d>=1e3?1e3:2*d):g===c?e(null,"ok"):e(null,"not-equal")},d)};i(1)},waitDiff:function(a,b,c,d,e){let f=Date.now()+d,g=Atomics.load(a,b);if(g!==c)return void e(null,"ok");let h=d=>{Date.now()>f?e(null,"timed-out"):setTimeout(()=>{(g=Atomics.load(a,b))!==c?e(null,"ok"):h(d>=1e3?1e3:2*d)},d)};h(1)}}},48687:(a,b,c)=>{"use strict";c.d(b,{ER:()=>f,Im:()=>i,dZ:()=>j,eX:()=>g,e_:()=>h});var d=c(7376),e=c(58703);function f(a=3){return Date.now()*Math.pow(10,a)+Math.floor(Math.random()*Math.pow(10,a))}function g(a=6){return BigInt(f(a))}function h(a,b,c){return{id:c||f(),jsonrpc:"2.0",method:a,params:b}}function i(a,b){return{id:a,jsonrpc:"2.0",result:b}}function j(a,b,c){var f,g;return{id:a,jsonrpc:"2.0",error:(f=b,g=c,void 0===f?(0,d.vG)(e.zR):("string"==typeof f&&(f=Object.assign(Object.assign({},(0,d.vG)(e.fO)),{message:f})),void 0!==g&&(f.data=g),(0,d.mE)(f.code)&&(f=(0,d.rI)(f.code)),f))}}},49094:a=>{"use strict";let b=Symbol("pino.setLevel"),c=Symbol("pino.getLevel"),d=Symbol("pino.levelVal"),e=Symbol("pino.useLevelLabels"),f=Symbol("pino.useOnlyCustomLevels"),g=Symbol("pino.mixin"),h=Symbol("pino.lsCache"),i=Symbol("pino.chindings"),j=Symbol("pino.parsedChindings"),k=Symbol("pino.asJson"),l=Symbol("pino.write"),m=Symbol("pino.redactFmt"),o=Symbol("pino.time"),p=Symbol("pino.timeSliceIndex"),q=Symbol("pino.stream"),r=Symbol("pino.stringify"),s=Symbol("pino.stringifySafe"),t=Symbol("pino.stringifiers"),u=Symbol("pino.end"),v=Symbol("pino.formatOpts"),w=Symbol("pino.messageKey"),x=Symbol("pino.nestedKey"),y=Symbol("pino.nestedKeyStr"),z=Symbol("pino.mixinMergeStrategy"),A=Symbol("pino.wildcardFirst"),B=Symbol.for("pino.serializers"),C=Symbol.for("pino.formatters"),D=Symbol.for("pino.hooks");a.exports={setLevelSym:b,getLevelSym:c,levelValSym:d,useLevelLabelsSym:e,mixinSym:g,lsCacheSym:h,chindingsSym:i,parsedChindingsSym:j,asJsonSym:k,writeSym:l,serializersSym:B,redactFmtSym:m,timeSym:o,timeSliceIndexSym:p,streamSym:q,stringifySym:r,stringifySafeSym:s,stringifiersSym:t,endSym:u,formatOptsSym:v,messageKeySym:w,nestedKeySym:x,wildcardFirstSym:A,needsMetadataGsym:Symbol.for("pino.metadata"),useOnlyCustomLevelsSym:f,formattersSym:C,hooksSym:D,nestedKeyStrSym:y,mixinMergeStrategySym:z}},50283:(a,b,c)=>{"use strict";a.exports=function(a,b){return(a=(a=(a=a.replace(/{if (.*?)}(.*?){end}/g,function(a,c,e){let f=d(b,c);return f&&e.includes(c)?e.replace(RegExp("{"+c+"}","g"),f):""})).replace(/{if (.*?)}/g,"")).replace(/{end}/g,"")).replace(/\s+/g," ").trim()};let d=c(37864)},51438:(a,b,c)=>{"use strict";c.d(b,{CG:()=>d});let d={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}}},51635:(a,b,c)=>{"use strict";let d=c(52792);d.createWebSocketStream=c(89223),d.Server=c(79370),d.Receiver=c(54158),d.Sender=c(66234),a.exports=d},52044:(a,b,c)=>{"use strict";let d=a=>a,e={default:d,60:d,50:d,40:d,30:d,20:d,10:d,message:d,greyMessage:d,property:d},{createColors:f}=c(35783),g=c(86973),h=f({useColor:!0}),{white:i,bgRed:j,red:k,yellow:l,green:m,blue:o,gray:p,cyan:q,magenta:r}=h,s={default:i,60:j,50:k,40:l,30:m,20:o,10:p,message:q,greyMessage:p,property:r};function t(a){return function(b,c,{customLevels:d,customLevelNames:e}={}){let[f,h]=g(a,d,e)(b);return Object.prototype.hasOwnProperty.call(c,h)?c[h](f):c.default(f)}}a.exports=function(a=!1,b,c){if(a&&void 0!==b){let a=b.reduce(function(a,[b,c]){return a[b]="function"==typeof h[c]?h[c]:i,a},{default:i,message:q,greyMessage:p}),d=c?a:Object.assign({},s,a),e=t(c),f=function(a,b){return e(a,d,b)};return f.colors=h,f.message=f.message||d.message,f.greyMessage=f.greyMessage||d.greyMessage,f}if(a){let a=t(c),b=function(b,c){return a(b,s,c)};return b.message=s.message,b.property=s.property,b.greyMessage=s.greyMessage,b.colors=h,b}let d=t(c),g=function(a,b){return d(a,e,b)};return g.message=e.message,g.greyMessage=e.greyMessage,g.property=e.property,g.colors=f({useColor:!1}),g}},52792:(a,b,c)=>{"use strict";let d=c(94735),e=c(55591),f=c(81630),g=c(91645),h=c(34631),{randomBytes:i,createHash:j}=c(55511),{Readable:k}=c(27910),{URL:l}=c(79551),m=c(74811),o=c(54158),p=c(66234),{BINARY_TYPES:q,EMPTY_BUFFER:r,GUID:s,kStatusCode:t,kWebSocket:u,NOOP:v}=c(78006),{addEventListener:w,removeEventListener:x}=c(5697),{format:y,parse:z}=c(80526),{toBuffer:A}=c(13738),B=["CONNECTING","OPEN","CLOSING","CLOSED"],C=[8,13];class D extends d{constructor(a,b,c){super(),this._binaryType=q[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage="",this._closeTimer=null,this._extensions={},this._protocol="",this._readyState=D.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,null!==a?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,Array.isArray(b)?b=b.join(", "):"object"==typeof b&&null!==b&&(c=b,b=void 0),function a(b,c,d,g){let h,k,o={protocolVersion:C[1],maxPayload:0x6400000,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...g,createConnection:void 0,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:void 0,host:void 0,path:void 0,port:void 0};if(!C.includes(o.protocolVersion))throw RangeError(`Unsupported protocol version: ${o.protocolVersion} (supported versions: ${C.join(", ")})`);c instanceof l?(h=c,b._url=c.href):(h=new l(c),b._url=c);let p="ws+unix:"===h.protocol;if(!h.host&&(!p||!h.pathname)){let a=Error(`Invalid URL: ${b.url}`);if(0!==b._redirects)return void E(b,a);throw a}let q="wss:"===h.protocol||"https:"===h.protocol,r=q?443:80,t=i(16).toString("base64"),u=q?e.get:f.get;if(o.createConnection=q?G:F,o.defaultPort=o.defaultPort||r,o.port=h.port||r,o.host=h.hostname.startsWith("[")?h.hostname.slice(1,-1):h.hostname,o.headers={"Sec-WebSocket-Version":o.protocolVersion,"Sec-WebSocket-Key":t,Connection:"Upgrade",Upgrade:"websocket",...o.headers},o.path=h.pathname+h.search,o.timeout=o.handshakeTimeout,o.perMessageDeflate&&(k=new m(!0!==o.perMessageDeflate?o.perMessageDeflate:{},!1,o.maxPayload),o.headers["Sec-WebSocket-Extensions"]=y({[m.extensionName]:k.offer()})),d&&(o.headers["Sec-WebSocket-Protocol"]=d),o.origin&&(o.protocolVersion<13?o.headers["Sec-WebSocket-Origin"]=o.origin:o.headers.Origin=o.origin),(h.username||h.password)&&(o.auth=`${h.username}:${h.password}`),p){let a=o.path.split(":");o.socketPath=a[0],o.path=a[1]}if(o.followRedirects){if(0===b._redirects){b._originalUnixSocket=p,b._originalSecure=q,b._originalHostOrSocketPath=p?o.socketPath:h.host;let a=g&&g.headers;if(g={...g,headers:{}},a)for(let[b,c]of Object.entries(a))g.headers[b.toLowerCase()]=c}else{let a=p?!!b._originalUnixSocket&&o.socketPath===b._originalHostOrSocketPath:!b._originalUnixSocket&&h.host===b._originalHostOrSocketPath;a&&(!b._originalSecure||q)||(delete o.headers.authorization,delete o.headers.cookie,a||delete o.headers.host,o.auth=void 0)}o.auth&&!g.headers.authorization&&(g.headers.authorization="Basic "+Buffer.from(o.auth).toString("base64"))}let v=b._req=u(o);o.timeout&&v.on("timeout",()=>{H(b,v,"Opening handshake has timed out")}),v.on("error",a=>{null===v||v.aborted||(v=b._req=null,E(b,a))}),v.on("response",e=>{let f=e.headers.location,h=e.statusCode;if(f&&o.followRedirects&&h>=300&&h<400){let e;if(++b._redirects>o.maxRedirects)return void H(b,v,"Maximum redirects exceeded");v.abort();try{e=new l(f,c)}catch(a){E(b,a);return}a(b,e,d,g)}else b.emit("unexpected-response",v,e)||H(b,v,`Unexpected server response: ${e.statusCode}`)}),v.on("upgrade",(a,c,e)=>{let f;if(b.emit("upgrade",a),b.readyState!==D.CONNECTING)return;v=b._req=null;let g=a.headers.upgrade;if(void 0===g||"websocket"!==g.toLowerCase())return void H(b,c,"Invalid Upgrade header");let h=j("sha1").update(t+s).digest("base64");if(a.headers["sec-websocket-accept"]!==h)return void H(b,c,"Invalid Sec-WebSocket-Accept header");let i=a.headers["sec-websocket-protocol"],l=(d||"").split(/, */);if(!d&&i?f="Server sent a subprotocol but none was requested":d&&!i?f="Server sent no subprotocol":i&&!l.includes(i)&&(f="Server sent an invalid subprotocol"),f)return void H(b,c,f);i&&(b._protocol=i);let p=a.headers["sec-websocket-extensions"];if(void 0!==p){let a;if(!k)return void H(b,c,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");try{a=z(p)}catch(a){H(b,c,"Invalid Sec-WebSocket-Extensions header");return}let d=Object.keys(a);if(d.length){if(1!==d.length||d[0]!==m.extensionName)return void H(b,c,"Server indicated an extension that was not requested");try{k.accept(a[m.extensionName])}catch(a){H(b,c,"Invalid Sec-WebSocket-Extensions header");return}b._extensions[m.extensionName]=k}}b.setSocket(c,e,o.maxPayload)})}(this,a,b,c)):this._isServer=!0}get binaryType(){return this._binaryType}set binaryType(a){q.includes(a)&&(this._binaryType=a,this._receiver&&(this._receiver._binaryType=a))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get onclose(){}set onclose(a){}get onerror(){}set onerror(a){}get onopen(){}set onopen(a){}get onmessage(){}set onmessage(a){}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(a,b,c){let d=new o(this.binaryType,this._extensions,this._isServer,c);this._sender=new p(a,this._extensions),this._receiver=d,this._socket=a,d[u]=this,a[u]=this,d.on("conclude",J),d.on("drain",K),d.on("error",L),d.on("message",N),d.on("ping",O),d.on("pong",P),a.setTimeout(0),a.setNoDelay(),b.length>0&&a.unshift(b),a.on("close",R),a.on("data",S),a.on("end",T),a.on("error",U),this._readyState=D.OPEN,this.emit("open")}emitClose(){if(!this._socket){this._readyState=D.CLOSED,this.emit("close",this._closeCode,this._closeMessage);return}this._extensions[m.extensionName]&&this._extensions[m.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=D.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(a,b){if(this.readyState!==D.CLOSED){if(this.readyState===D.CONNECTING)return H(this,this._req,"WebSocket was closed before the connection was established");if(this.readyState===D.CLOSING){this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();return}this._readyState=D.CLOSING,this._sender.close(a,b,!this._isServer,a=>{!a&&(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())}),this._closeTimer=setTimeout(this._socket.destroy.bind(this._socket),3e4)}}ping(a,b,c){if(this.readyState===D.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof a?(c=a,a=b=void 0):"function"==typeof b&&(c=b,b=void 0),"number"==typeof a&&(a=a.toString()),this.readyState!==D.OPEN)return void I(this,a,c);void 0===b&&(b=!this._isServer),this._sender.ping(a||r,b,c)}pong(a,b,c){if(this.readyState===D.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof a?(c=a,a=b=void 0):"function"==typeof b&&(c=b,b=void 0),"number"==typeof a&&(a=a.toString()),this.readyState!==D.OPEN)return void I(this,a,c);void 0===b&&(b=!this._isServer),this._sender.pong(a||r,b,c)}send(a,b,c){if(this.readyState===D.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof b&&(c=b,b={}),"number"==typeof a&&(a=a.toString()),this.readyState!==D.OPEN)return void I(this,a,c);let d={binary:"string"!=typeof a,mask:!this._isServer,compress:!0,fin:!0,...b};this._extensions[m.extensionName]||(d.compress=!1),this._sender.send(a||r,d,c)}terminate(){if(this.readyState!==D.CLOSED){if(this.readyState===D.CONNECTING)return H(this,this._req,"WebSocket was closed before the connection was established");this._socket&&(this._readyState=D.CLOSING,this._socket.destroy())}}}function E(a,b){a._readyState=D.CLOSING,a.emit("error",b),a.emitClose()}function F(a){return a.path=a.socketPath,g.connect(a)}function G(a){return a.path=void 0,a.servername||""===a.servername||(a.servername=g.isIP(a.host)?"":a.host),h.connect(a)}function H(a,b,c){a._readyState=D.CLOSING;let d=Error(c);Error.captureStackTrace(d,H),b.setHeader?(b.abort(),b.socket&&!b.socket.destroyed&&b.socket.destroy(),b.once("abort",a.emitClose.bind(a)),a.emit("error",d)):(b.destroy(d),b.once("error",a.emit.bind(a,"error")),b.once("close",a.emitClose.bind(a)))}function I(a,b,c){if(b){let c=A(b).length;a._socket?a._sender._bufferedBytes+=c:a._bufferedAmount+=c}c&&c(Error(`WebSocket is not open: readyState ${a.readyState} (${B[a.readyState]})`))}function J(a,b){let c=this[u];c._closeFrameReceived=!0,c._closeMessage=b,c._closeCode=a,void 0!==c._socket[u]&&(c._socket.removeListener("data",S),process.nextTick(Q,c._socket),1005===a?c.close():c.close(a,b))}function K(){this[u]._socket.resume()}function L(a){let b=this[u];void 0!==b._socket[u]&&(b._socket.removeListener("data",S),process.nextTick(Q,b._socket),b.close(a[t])),b.emit("error",a)}function M(){this[u].emitClose()}function N(a){this[u].emit("message",a)}function O(a){let b=this[u];b.pong(a,!b._isServer,v),b.emit("ping",a)}function P(a){this[u].emit("pong",a)}function Q(a){a.resume()}function R(){let a,b=this[u];this.removeListener("close",R),this.removeListener("data",S),this.removeListener("end",T),b._readyState=D.CLOSING,this._readableState.endEmitted||b._closeFrameReceived||b._receiver._writableState.errorEmitted||null===(a=b._socket.read())||b._receiver.write(a),b._receiver.end(),this[u]=void 0,clearTimeout(b._closeTimer),b._receiver._writableState.finished||b._receiver._writableState.errorEmitted?b.emitClose():(b._receiver.on("error",M),b._receiver.on("finish",M))}function S(a){this[u]._receiver.write(a)||this.pause()}function T(){let a=this[u];a._readyState=D.CLOSING,a._receiver.end(),this.end()}function U(){let a=this[u];this.removeListener("error",U),this.on("error",v),a&&(a._readyState=D.CLOSING,this.destroy())}Object.defineProperty(D,"CONNECTING",{enumerable:!0,value:B.indexOf("CONNECTING")}),Object.defineProperty(D.prototype,"CONNECTING",{enumerable:!0,value:B.indexOf("CONNECTING")}),Object.defineProperty(D,"OPEN",{enumerable:!0,value:B.indexOf("OPEN")}),Object.defineProperty(D.prototype,"OPEN",{enumerable:!0,value:B.indexOf("OPEN")}),Object.defineProperty(D,"CLOSING",{enumerable:!0,value:B.indexOf("CLOSING")}),Object.defineProperty(D.prototype,"CLOSING",{enumerable:!0,value:B.indexOf("CLOSING")}),Object.defineProperty(D,"CLOSED",{enumerable:!0,value:B.indexOf("CLOSED")}),Object.defineProperty(D.prototype,"CLOSED",{enumerable:!0,value:B.indexOf("CLOSED")}),["binaryType","bufferedAmount","extensions","protocol","readyState","url"].forEach(a=>{Object.defineProperty(D.prototype,a,{enumerable:!0})}),["open","error","close","message"].forEach(a=>{Object.defineProperty(D.prototype,`on${a}`,{enumerable:!0,get(){let b=this.listeners(a);for(let a=0;a<b.length;a++)if(b[a]._listener)return b[a]._listener},set(b){let c=this.listeners(a);for(let b=0;b<c.length;b++)c[b]._listener&&this.removeListener(a,c[b]);this.addEventListener(a,b)}})}),D.prototype.addEventListener=w,D.prototype.removeEventListener=x,a.exports=D},53162:a=>{"use strict";a.exports=function(a){let b=[],c=!1,d="";for(let e=0;e<a.length;e++){let f=a.charAt(e);if("\\"===f){c=!0;continue}if(c){c=!1,d+=f;continue}if("."===f){b.push(d),d="";continue}d+=f}return d.length&&b.push(d),b}},54158:(a,b,c)=>{"use strict";let{Writable:d}=c(27910),e=c(74811),{BINARY_TYPES:f,EMPTY_BUFFER:g,kStatusCode:h,kWebSocket:i}=c(78006),{concat:j,toArrayBuffer:k,unmask:l}=c(13738),{isValidStatusCode:m,isValidUTF8:o}=c(68676);class p extends d{constructor(a,b,c,d){super(),this._binaryType=a||f[0],this[i]=void 0,this._extensions=b||{},this._isServer=!!c,this._maxPayload=0|d,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._state=0,this._loop=!1}_write(a,b,c){if(8===this._opcode&&0==this._state)return c();this._bufferedBytes+=a.length,this._buffers.push(a),this.startLoop(c)}consume(a){if(this._bufferedBytes-=a,a===this._buffers[0].length)return this._buffers.shift();if(a<this._buffers[0].length){let b=this._buffers[0];return this._buffers[0]=b.slice(a),b.slice(0,a)}let b=Buffer.allocUnsafe(a);do{let c=this._buffers[0],d=b.length-a;a>=c.length?b.set(this._buffers.shift(),d):(b.set(new Uint8Array(c.buffer,c.byteOffset,a),d),this._buffers[0]=c.slice(a)),a-=c.length}while(a>0);return b}startLoop(a){let b;this._loop=!0;do switch(this._state){case 0:b=this.getInfo();break;case 1:b=this.getPayloadLength16();break;case 2:b=this.getPayloadLength64();break;case 3:this.getMask();break;case 4:b=this.getData(a);break;default:this._loop=!1;return}while(this._loop);a(b)}getInfo(){if(this._bufferedBytes<2){this._loop=!1;return}let a=this.consume(2);if((48&a[0])!=0)return this._loop=!1,q(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3");let b=(64&a[0])==64;if(b&&!this._extensions[e.extensionName])return this._loop=!1,q(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._fin=(128&a[0])==128,this._opcode=15&a[0],this._payloadLength=127&a[1],0===this._opcode){if(b)return this._loop=!1,q(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(!this._fragmented)return this._loop=!1,q(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE");this._opcode=this._fragmented}else if(1===this._opcode||2===this._opcode){if(this._fragmented)return this._loop=!1,q(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");this._compressed=b}else{if(!(this._opcode>7)||!(this._opcode<11))return this._loop=!1,q(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");if(!this._fin)return this._loop=!1,q(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN");if(b)return this._loop=!1,q(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._payloadLength>125)return this._loop=!1,q(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH")}if(this._fin||this._fragmented||(this._fragmented=this._opcode),this._masked=(128&a[1])==128,this._isServer){if(!this._masked)return this._loop=!1,q(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK")}else if(this._masked)return this._loop=!1,q(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK");if(126===this._payloadLength)this._state=1;else{if(127!==this._payloadLength)return this.haveLength();this._state=2}}getPayloadLength16(){if(this._bufferedBytes<2){this._loop=!1;return}return this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength()}getPayloadLength64(){if(this._bufferedBytes<8){this._loop=!1;return}let a=this.consume(8),b=a.readUInt32BE(0);return b>2097151?(this._loop=!1,q(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH")):(this._payloadLength=0x100000000*b+a.readUInt32BE(4),this.haveLength())}haveLength(){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0))return this._loop=!1,q(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");this._masked?this._state=3:this._state=4}getMask(){if(this._bufferedBytes<4){this._loop=!1;return}this._mask=this.consume(4),this._state=4}getData(a){let b=g;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength){this._loop=!1;return}b=this.consume(this._payloadLength),this._masked&&l(b,this._mask)}if(this._opcode>7)return this.controlMessage(b);if(this._compressed){this._state=5,this.decompress(b,a);return}return b.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(b)),this.dataMessage()}decompress(a,b){this._extensions[e.extensionName].decompress(a,this._fin,(a,c)=>{if(a)return b(a);if(c.length){if(this._messageLength+=c.length,this._messageLength>this._maxPayload&&this._maxPayload>0)return b(q(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));this._fragments.push(c)}let d=this.dataMessage();if(d)return b(d);this.startLoop(b)})}dataMessage(){if(this._fin){let a=this._messageLength,b=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],2===this._opcode){let c;c="nodebuffer"===this._binaryType?j(b,a):"arraybuffer"===this._binaryType?k(j(b,a)):b,this.emit("message",c)}else{let c=j(b,a);if(!o(c))return this._loop=!1,q(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("message",c.toString())}}this._state=0}controlMessage(a){if(8===this._opcode)if(this._loop=!1,0===a.length)this.emit("conclude",1005,""),this.end();else{if(1===a.length)return q(RangeError,"invalid payload length 1",!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH");let b=a.readUInt16BE(0);if(!m(b))return q(RangeError,`invalid status code ${b}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");let c=a.slice(2);if(!o(c))return q(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("conclude",b,c.toString()),this.end()}else 9===this._opcode?this.emit("ping",a):this.emit("pong",a);this._state=0}}function q(a,b,c,d,e){let f=new a(c?`Invalid WebSocket frame: ${b}`:b);return Error.captureStackTrace(f,q),f.code=e,f[h]=d,f}a.exports=p},56197:(a,b,c)=>{"use strict";let{EventEmitter:d}=c(94735),{lsCacheSym:e,levelValSym:f,setLevelSym:g,getLevelSym:h,chindingsSym:i,parsedChindingsSym:j,mixinSym:k,asJsonSym:l,writeSym:m,mixinMergeStrategySym:o,timeSym:p,timeSliceIndexSym:q,streamSym:r,serializersSym:s,formattersSym:t,useOnlyCustomLevelsSym:u,needsMetadataGsym:v,redactFmtSym:w,stringifySym:x,formatOptsSym:y,stringifiersSym:z}=c(49094),{getLevel:A,setLevel:B,isLevelEnabled:C,mappings:D,initialLsCache:E,genLsCache:F,assertNoLevelCollisions:G}=c(35248),{asChindings:H,asJson:I,buildFormatters:J,stringify:K}=c(96988),{version:L}=c(45510),M=c(17550),N={constructor:class{},child:function(a,b){if(!a)throw Error("missing bindings for child Pino");b=b||{};let c=this[s],d=this[t],e=Object.create(this);if(!0===b.hasOwnProperty("serializers")){for(let a in e[s]=Object.create(null),c)e[s][a]=c[a];let a=Object.getOwnPropertySymbols(c);for(var f=0;f<a.length;f++){let b=a[f];e[s][b]=c[b]}for(let a in b.serializers)e[s][a]=b.serializers[a];let d=Object.getOwnPropertySymbols(b.serializers);for(var h=0;h<d.length;h++){let a=d[h];e[s][a]=b.serializers[a]}}else e[s]=c;if(b.hasOwnProperty("formatters")){let{level:a,bindings:c,log:f}=b.formatters;e[t]=J(a||d.level,c||O,f||d.log)}else e[t]=J(d.level,O,d.log);if(!0===b.hasOwnProperty("customLevels")&&(G(this.levels,b.customLevels),e.levels=D(b.customLevels,e[u]),F(e)),"object"==typeof b.redact&&null!==b.redact||Array.isArray(b.redact)){e.redact=b.redact;let a=M(e.redact,K),c={stringify:a[w]};e[x]=K,e[z]=a,e[y]=c}e[i]=H(e,a);let j=b.level||this.level;return e[g](j),e},bindings:function(){let a=this[i],b=JSON.parse(`{${a.substr(1)}}`);return delete b.pid,delete b.hostname,b},setBindings:function(a){let b=H(this,a);this[i]=b,delete this[j]},flush:function(){let a=this[r];"flush"in a&&a.flush(Q)},isLevelEnabled:C,version:L,get level(){return this[h]()},set level(lvl){this[g](lvl)},get levelVal(){return this[f]},set levelVal(n){throw Error("levelVal is read-only")},[e]:E,[m]:function(a,b,c){let d,e=this[p](),f=this[k],g=this[o]||P;null==a?d={}:a instanceof Error?(d={err:a},void 0===b&&(b=a.message)):(d=a,void 0===b&&a.err&&(b=a.err.message)),f&&(d=g(d,f(d,c)));let h=this[l](d,b,c,e),i=this[r];!0===i[v]&&(i.lastLevel=c,i.lastObj=d,i.lastMsg=b,i.lastTime=e.slice(this[q]),i.lastLogger=this),i.write(h)},[l]:I,[h]:A,[g]:B};Object.setPrototypeOf(N,d.prototype),a.exports=function(){return Object.create(N)};let O=a=>a;function P(a,b){return Object.assign(b,a)}function Q(){}},57943:(a,b,c)=>{"use strict";a.exports=function(a,b=!1){if(!1===b)return a;let c=g(a);if(!h(c))return a;if(!0===b)return f(c,e);let i=b.toUpperCase();if("SYS:STANDARD"===i)return f(c,d);let j=i.substr(0,4);return"SYS:"===j||"UTC:"===j?"UTC:"===j?f(c,b):f(c,b.slice(4)):f(c,`UTC:${b}`)};let{DATE_FORMAT:d,DATE_FORMAT_SIMPLE:e}=c(70219),f=c(81962),g=c(85671),h=c(1006)},58703:(a,b,c)=>{"use strict";c.d(b,{Uf:()=>g,XW:()=>h,fO:()=>e,jf:()=>f,zR:()=>d});let d="INTERNAL_ERROR",e="SERVER_ERROR",f=[-32700,-32600,-32601,-32602,-32603],g={PARSE_ERROR:{code:-32700,message:"Parse error"},INVALID_REQUEST:{code:-32600,message:"Invalid Request"},METHOD_NOT_FOUND:{code:-32601,message:"Method not found"},INVALID_PARAMS:{code:-32602,message:"Invalid params"},[d]:{code:-32603,message:"Internal error"},[e]:{code:-32e3,message:"Server error"}},h=e},59817:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=function(a){if(a.length>=255)throw TypeError("Alphabet too long");let b=new Uint8Array(256);for(let a=0;a<b.length;a++)b[a]=255;for(let c=0;c<a.length;c++){let d=a.charAt(c),e=d.charCodeAt(0);if(255!==b[e])throw TypeError(d+" is ambiguous");b[e]=c}let c=a.length,d=a.charAt(0),e=Math.log(c)/Math.log(256),f=Math.log(256)/Math.log(c);function g(a){if("string"!=typeof a)throw TypeError("Expected String");if(0===a.length)return new Uint8Array;let f=0,g=0,h=0;for(;a[f]===d;)g++,f++;let i=(a.length-f)*e+1>>>0,j=new Uint8Array(i);for(;f<a.length;){let d=a.charCodeAt(f);if(d>255)return;let e=b[d];if(255===e)return;let g=0;for(let a=i-1;(0!==e||g<h)&&-1!==a;a--,g++)e+=c*j[a]>>>0,j[a]=e%256>>>0,e=e/256>>>0;if(0!==e)throw Error("Non-zero carry");h=g,f++}let k=i-h;for(;k!==i&&0===j[k];)k++;let l=new Uint8Array(g+(i-k)),m=g;for(;k!==i;)l[m++]=j[k++];return l}return{encode:function(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw TypeError("Expected Uint8Array");if(0===b.length)return"";let e=0,g=0,h=0,i=b.length;for(;h!==i&&0===b[h];)h++,e++;let j=(i-h)*f+1>>>0,k=new Uint8Array(j);for(;h!==i;){let a=b[h],d=0;for(let b=j-1;(0!==a||d<g)&&-1!==b;b--,d++)a+=256*k[b]>>>0,k[b]=a%c>>>0,a=a/c>>>0;if(0!==a)throw Error("Non-zero carry");g=d,h++}let l=j-g;for(;l!==j&&0===k[l];)l++;let m=d.repeat(e);for(;l<j;++l)m+=a.charAt(k[l]);return m},decodeUnsafe:g,decode:function(a){let b=g(a);if(b)return b;throw Error("Non-base"+c+" character")}}}("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz")},61226:(a,b,c)=>{"use strict";let d=c(4353),e=c(18118),f=c(41040);a.exports={err:d,mapHttpRequest:e.mapHttpRequest,mapHttpResponse:f.mapHttpResponse,req:e.reqSerializer,res:f.resSerializer,wrapErrorSerializer:function(a){return a===d?a:function(b){return a(d(b))}},wrapRequestSerializer:function(a){return a===e.reqSerializer?a:function(b){return a(e.reqSerializer(b))}},wrapResponseSerializer:function(a){return a===f.resSerializer?a:function(b){return a(f.resSerializer(b))}}}},61864:a=>{"use strict";a.exports=/[^.[\]]+|\[((?:.)*?)\]/g},66163:(a,b,c)=>{"use strict";a.exports=function(a){let b,c=a.crlf?"\r\n":"\n",{customPrettifiers:i,errorLikeObjectKeys:j,hideObject:k,levelFirst:l,levelKey:m,levelLabel:o,messageFormat:p,messageKey:q,minimumLevel:r,singleLine:s,timestampKey:t,translateTime:u}=a,v=a.errorProps.split(","),w="boolean"==typeof a.useOnlyCustomProps?a.useOnlyCustomProps:"true"===a.useOnlyCustomProps,x=f(a.customLevels),y=g(a.customLevels),z=h(w,x,y);if(a.customColors)if("string"==typeof a.customColors)b=a.customColors.split(",").reduce((b,c)=>{let[e,f]=c.split(":"),g=(w?a.customLevels:void 0!==y[e])?y[e]:d[e];return b.push([void 0!==g?g:e,f]),b},[]);else if("object"==typeof a.customColors)b=Object.keys(a.customColors).reduce((b,c)=>{let[e,f]=[c,a.customColors[c]],g=(w?a.customLevels:void 0!==y[e])?y[e]:d[e];return b.push([void 0!==g?g:e,f]),b},[]);else throw Error("options.customColors must be of type string or object.");let A={customLevels:x,customLevelNames:y};!0!==w||a.customLevels||(A.customLevels=void 0,A.customLevelNames=void 0);let B=void 0!==a.include?new Set(a.include.split(",")):void 0,C=!B&&a.ignore?new Set(a.ignore.split(",")):void 0,D=e(a.colorize,b,w),E=a.colorizeObjects?D:e(!1,[],!1);return{EOL:c,IDENT:"    ",colorizer:D,customColors:b,customLevelNames:y,customLevels:x,customPrettifiers:i,customProperties:A,errorLikeObjectKeys:j,errorProps:v,getLevelLabelData:z,hideObject:k,ignoreKeys:C,includeKeys:B,levelFirst:l,levelKey:m,levelLabel:o,messageFormat:p,messageKey:q,minimumLevel:r,objectColorizer:E,singleLine:s,timestampKey:t,translateTime:u,useOnlyCustomProps:w}};let{LEVEL_NAMES:d}=c(70219),e=c(52044),f=c(97947),g=c(23316),h=c(86973)},66234:(a,b,c)=>{"use strict";c(91645),c(34631);let{randomFillSync:d}=c(55511),e=c(74811),{EMPTY_BUFFER:f}=c(78006),{isValidStatusCode:g}=c(68676),{mask:h,toBuffer:i}=c(13738),j=Buffer.alloc(4);class k{constructor(a,b){this._extensions=b||{},this._socket=a,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._deflating=!1,this._queue=[]}static frame(a,b){let c=b.mask&&b.readOnly,e=b.mask?6:2,f=a.length;a.length>=65536?(e+=8,f=127):a.length>125&&(e+=2,f=126);let g=Buffer.allocUnsafe(c?a.length+e:e);return(g[0]=b.fin?128|b.opcode:b.opcode,b.rsv1&&(g[0]|=64),g[1]=f,126===f?g.writeUInt16BE(a.length,2):127===f&&(g.writeUInt32BE(0,2),g.writeUInt32BE(a.length,6)),b.mask)?(d(j,0,4),g[1]|=128,g[e-4]=j[0],g[e-3]=j[1],g[e-2]=j[2],g[e-1]=j[3],c)?(h(a,j,g,e,a.length),[g]):(h(a,j,a,0,a.length),[g,a]):[g,a]}close(a,b,c,d){let e;if(void 0===a)e=f;else if("number"==typeof a&&g(a))if(void 0===b||""===b)(e=Buffer.allocUnsafe(2)).writeUInt16BE(a,0);else{let c=Buffer.byteLength(b);if(c>123)throw RangeError("The message must not be greater than 123 bytes");(e=Buffer.allocUnsafe(2+c)).writeUInt16BE(a,0),e.write(b,2)}else throw TypeError("First argument must be a valid error code number");this._deflating?this.enqueue([this.doClose,e,c,d]):this.doClose(e,c,d)}doClose(a,b,c){this.sendFrame(k.frame(a,{fin:!0,rsv1:!1,opcode:8,mask:b,readOnly:!1}),c)}ping(a,b,c){let d=i(a);if(d.length>125)throw RangeError("The data size must not be greater than 125 bytes");this._deflating?this.enqueue([this.doPing,d,b,i.readOnly,c]):this.doPing(d,b,i.readOnly,c)}doPing(a,b,c,d){this.sendFrame(k.frame(a,{fin:!0,rsv1:!1,opcode:9,mask:b,readOnly:c}),d)}pong(a,b,c){let d=i(a);if(d.length>125)throw RangeError("The data size must not be greater than 125 bytes");this._deflating?this.enqueue([this.doPong,d,b,i.readOnly,c]):this.doPong(d,b,i.readOnly,c)}doPong(a,b,c,d){this.sendFrame(k.frame(a,{fin:!0,rsv1:!1,opcode:10,mask:b,readOnly:c}),d)}send(a,b,c){let d=i(a),f=this._extensions[e.extensionName],g=b.binary?2:1,h=b.compress;if(this._firstFragment?(this._firstFragment=!1,h&&f&&(h=d.length>=f._threshold),this._compress=h):(h=!1,g=0),b.fin&&(this._firstFragment=!0),f){let a={fin:b.fin,rsv1:h,opcode:g,mask:b.mask,readOnly:i.readOnly};this._deflating?this.enqueue([this.dispatch,d,this._compress,a,c]):this.dispatch(d,this._compress,a,c)}else this.sendFrame(k.frame(d,{fin:b.fin,rsv1:!1,opcode:g,mask:b.mask,readOnly:i.readOnly}),c)}dispatch(a,b,c,d){if(!b)return void this.sendFrame(k.frame(a,c),d);let f=this._extensions[e.extensionName];this._bufferedBytes+=a.length,this._deflating=!0,f.compress(a,c.fin,(b,e)=>{if(this._socket.destroyed){let a=Error("The socket was closed while data was being compressed");"function"==typeof d&&d(a);for(let b=0;b<this._queue.length;b++){let c=this._queue[b][4];"function"==typeof c&&c(a)}return}this._bufferedBytes-=a.length,this._deflating=!1,c.readOnly=!1,this.sendFrame(k.frame(e,c),d),this.dequeue()})}dequeue(){for(;!this._deflating&&this._queue.length;){let a=this._queue.shift();this._bufferedBytes-=a[1].length,Reflect.apply(a[0],this,a.slice(1))}}enqueue(a){this._bufferedBytes+=a[1].length,this._queue.push(a)}sendFrame(a,b){2===a.length?(this._socket.cork(),this._socket.write(a[0]),this._socket.write(a[1],b),this._socket.uncork()):this._socket.write(a[0],b)}}a.exports=k},66376:(a,b,c)=>{"use strict";a.exports={buildSafeSonicBoom:c(13753),createDate:c(85671),deleteLogProperty:c(69866),filterLog:c(92887),formatTime:c(57943),getPropertyValue:c(37864),handleCustomLevelsNamesOpts:c(23316),handleCustomLevelsOpts:c(97947),interpretConditionals:c(50283),isObject:c(83604),isValidDate:c(1006),joinLinesWithIndentation:c(98459),noop:c(25858),parseFactoryOptions:c(66163),prettifyErrorLog:c(5703),prettifyError:c(22084),prettifyLevel:c(80924),prettifyMessage:c(75809),prettifyMetadata:c(27301),prettifyObject:c(15367),prettifyTime:c(8401),splitPropertyKey:c(53162),getLevelLabelData:c(86973)}},67270:a=>{"use strict";a.exports={WRITE_INDEX:4,READ_INDEX:8}},68316:a=>{a.exports=function a(b,c){if(b&&c)return a(b)(c);if("function"!=typeof b)throw TypeError("need wrapper function");return Object.keys(b).forEach(function(a){d[a]=b[a]}),d;function d(){for(var a=Array(arguments.length),c=0;c<a.length;c++)a[c]=arguments[c];var d=b.apply(this,a),e=a[a.length-1];return"function"==typeof d&&d!==e&&Object.keys(e).forEach(function(a){d[a]=e[a]}),d}}},68676:(a,b,c)=>{"use strict";function d(a){return a>=1e3&&a<=1014&&1004!==a&&1005!==a&&1006!==a||a>=3e3&&a<=4999}function e(a){let b=a.length,c=0;for(;c<b;)if((128&a[c])==0)c++;else if((224&a[c])==192){if(c+1===b||(192&a[c+1])!=128||(254&a[c])==192)return!1;c+=2}else if((240&a[c])==224){if(c+2>=b||(192&a[c+1])!=128||(192&a[c+2])!=128||224===a[c]&&(224&a[c+1])==128||237===a[c]&&(224&a[c+1])==160)return!1;c+=3}else{if((248&a[c])!=240||c+3>=b||(192&a[c+1])!=128||(192&a[c+2])!=128||(192&a[c+3])!=128||240===a[c]&&(240&a[c+1])==128||244===a[c]&&a[c+1]>143||a[c]>244)return!1;c+=4}return!0}try{let b=c(49408);"object"==typeof b&&(b=b.Validation.isValidUTF8),a.exports={isValidStatusCode:d,isValidUTF8:a=>a.length<150?e(a):b(a)}}catch(b){a.exports={isValidStatusCode:d,isValidUTF8:e}}},68879:(a,b,c)=>{"use strict";c.d(b,{A:()=>i});var d=c(94735),e=c(25080),f=c(44566);let g=a=>a.split("?")[0],h="u">typeof WebSocket?WebSocket:"u">typeof global&&"u">typeof global.WebSocket?global.WebSocket:"u">typeof window&&"u">typeof window.WebSocket?window.WebSocket:"u">typeof self&&"u">typeof self.WebSocket?self.WebSocket:c(51635);class i{constructor(a){if(this.url=a,this.events=new d.EventEmitter,this.registering=!1,!(0,f.isWsUrl)(a))throw Error(`Provided URL is not compatible with WebSocket connection: ${a}`);this.url=a}get connected(){return"u">typeof this.socket}get connecting(){return this.registering}on(a,b){this.events.on(a,b)}once(a,b){this.events.once(a,b)}off(a,b){this.events.off(a,b)}removeListener(a,b){this.events.removeListener(a,b)}async open(a=this.url){await this.register(a)}async close(){return new Promise((a,b)=>{if(typeof this.socket>"u")return void b(Error("Connection already closed"));this.socket.onclose=b=>{this.onClose(b),a()},this.socket.close()})}async send(a){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send((0,e.h)(a))}catch(b){this.onError(a.id,b)}}register(a=this.url){if(!(0,f.isWsUrl)(a))throw Error(`Provided URL is not compatible with WebSocket connection: ${a}`);if(this.registering){let a=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=a||this.events.listenerCount("open")>=a)&&this.events.setMaxListeners(a+1),new Promise((a,b)=>{this.events.once("register_error",a=>{this.resetMaxListeners(),b(a)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return b(Error("WebSocket connection is missing or invalid"));a(this.socket)})})}return this.url=a,this.registering=!0,new Promise((b,c)=>{let d=(0,f.isReactNative)()?void 0:{rejectUnauthorized:!(0,f.isLocalhostUrl)(a)},e=new h(a,[],d);"u">typeof WebSocket||"u">typeof global&&"u">typeof global.WebSocket||"u">typeof window&&"u">typeof window.WebSocket||"u">typeof self&&"u">typeof self.WebSocket?e.onerror=a=>{c(this.emitError(a.error))}:e.on("error",a=>{c(this.emitError(a))}),e.onopen=()=>{this.onOpen(e),b(e)}})}onOpen(a){a.onmessage=a=>this.onPayload(a),a.onclose=a=>this.onClose(a),this.socket=a,this.registering=!1,this.events.emit("open")}onClose(a){this.socket=void 0,this.registering=!1,this.events.emit("close",a)}onPayload(a){if(typeof a.data>"u")return;let b="string"==typeof a.data?(0,e.j)(a.data):a.data;this.events.emit("payload",b)}onError(a,b){let c=this.parseError(b),d=c.message||c.toString(),e=(0,f.formatJsonRpcError)(a,d);this.events.emit("payload",e)}parseError(a,b=this.url){return(0,f.parseConnectionError)(a,g(b),"WS")}resetMaxListeners(){this.events.getMaxListeners()>10&&this.events.setMaxListeners(10)}emitError(a){let b=this.parseError(Error(a?.message||`WebSocket connection failed for host: ${g(this.url)}`));return this.events.emit("register_error",b),b}}},69067:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.ONE_THOUSAND=b.ONE_HUNDRED=void 0,b.ONE_HUNDRED=100,b.ONE_THOUSAND=1e3},69238:(a,b,c)=>{"use strict";let d,{createRequire:e}=c(8086),f=c(84616),{join:g,isAbsolute:h}=c(33873),i=c(83369);global.WeakRef&&global.WeakMap&&global.FinalizationRegistry&&(d=c(43902));let j=c(41038);function k(a){a.ref(),a.flushSync(),a.end(),a.once("close",function(){a.unref()})}a.exports=function(a){let{pipeline:b,targets:c,levels:l,options:m={},worker:o={},caller:p=f()}=a,q="string"==typeof p?[p]:p,r="__bundlerPathsOverrides"in globalThis?globalThis.__bundlerPathsOverrides:{},s=a.target;if(s&&c)throw Error("only one of target or targets can be specified");c?(s=r["pino-worker"]||g(__dirname,"worker.js"),m.targets=c.map(a=>({...a,target:v(a.target)}))):b&&(s=r["pino-pipeline-worker"]||g(__dirname,"worker-pipeline.js"),m.targets=b.map(a=>({...a,target:v(a.target)}))),l&&(m.levels=l);let t=new j({filename:v(s),workerData:m,workerOpts:o});function u(){t.closed||(t.flushSync(),i(100),t.end())}return t.on("ready",function(){process.removeListener("exit",u),t.unref(),!1!==o.autoEnd&&function(a){if(d)d.register(a,k),a.on("close",function(){d.unregister(a)});else{let b=k.bind(null,a);process.once("beforeExit",b),process.once("exit",b),a.on("close",function(){process.removeListener("beforeExit",b),process.removeListener("exit",b)})}}(t)}),t.on("close",function(){process.removeListener("exit",u)}),process.on("exit",u),t;function v(a){let b;if(h(a=r[a]||a)||0===a.indexOf("file://"))return a;if("pino/file"===a)return g(__dirname,"..","file.js");for(let c of q)try{b=e(c).resolve(a);break}catch(a){continue}if(!b)throw Error(`unable to determine transport target for "${a}"`);return b}}},69866:(a,b,c)=>{"use strict";a.exports=function(a,b){let c=e(b),f=c.pop();null!==(a=d(a,c))&&"object"==typeof a&&Object.prototype.hasOwnProperty.call(a,f)&&delete a[f]};let d=c(37864),e=c(53162)},70219:a=>{"use strict";a.exports={DATE_FORMAT:"yyyy-mm-dd HH:MM:ss.l o",DATE_FORMAT_SIMPLE:"HH:MM:ss.l",ERROR_LIKE_KEYS:["err","error"],MESSAGE_KEY:"msg",LEVEL_KEY:"level",LEVEL_LABEL:"levelLabel",TIMESTAMP_KEY:"time",LEVELS:{default:"USERLVL",60:"FATAL",50:"ERROR",40:"WARN",30:"INFO",20:"DEBUG",10:"TRACE"},LEVEL_NAMES:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},LOGGER_KEYS:["pid","hostname","name","level","time","timestamp","caller"]}},70548:(a,b,c)=>{"use strict";let{Transform:d}=c(27910),{StringDecoder:e}=c(41204),f=Symbol("last"),g=Symbol("decoder");function h(a,b,c){let d;if(this.overflow){if(1===(d=this[g].write(a).split(this.matcher)).length)return c();d.shift(),this.overflow=!1}else this[f]+=this[g].write(a),d=this[f].split(this.matcher);this[f]=d.pop();for(let a=0;a<d.length;a++)try{j(this,this.mapper(d[a]))}catch(a){return c(a)}if(this.overflow=this[f].length>this.maxLength,this.overflow&&!this.skipOverflow)return void c(Error("maximum buffer reached"));c()}function i(a){if(this[f]+=this[g].end(),this[f])try{j(this,this.mapper(this[f]))}catch(b){return a(b)}a()}function j(a,b){void 0!==b&&a.push(b)}function k(a){return a}a.exports=function(a,b,c){switch(a=a||/\r?\n/,b=b||k,c=c||{},arguments.length){case 1:"function"==typeof a?(b=a,a=/\r?\n/):"object"!=typeof a||a instanceof RegExp||a[Symbol.split]||(c=a,a=/\r?\n/);break;case 2:"function"==typeof a?(c=b,b=a,a=/\r?\n/):"object"==typeof b&&(c=b,b=k)}(c=Object.assign({},c)).autoDestroy=!0,c.transform=h,c.flush=i,c.readableObjectMode=!0;let j=new d(c);return j[f]="",j[g]=new e("utf8"),j.matcher=a,j.mapper=b,j.maxLength=c.maxLength,j.skipOverflow=c.skipOverflow||!1,j.overflow=!1,j._destroy=function(a,b){this._writableState.errorEmitted=!1,b(a)},j}},71137:(a,b,c)=>{"use strict";var d=c(30366);c.o(d,"IJsonRpcProvider")&&c.d(b,{IJsonRpcProvider:function(){return d.IJsonRpcProvider}}),c.o(d,"formatJsonRpcError")&&c.d(b,{formatJsonRpcError:function(){return d.formatJsonRpcError}}),c.o(d,"formatJsonRpcRequest")&&c.d(b,{formatJsonRpcRequest:function(){return d.formatJsonRpcRequest}}),c.o(d,"formatJsonRpcResult")&&c.d(b,{formatJsonRpcResult:function(){return d.formatJsonRpcResult}}),c.o(d,"getBigIntRpcId")&&c.d(b,{getBigIntRpcId:function(){return d.getBigIntRpcId}}),c.o(d,"isHttpUrl")&&c.d(b,{isHttpUrl:function(){return d.isHttpUrl}}),c.o(d,"isJsonRpcError")&&c.d(b,{isJsonRpcError:function(){return d.isJsonRpcError}}),c.o(d,"isJsonRpcRequest")&&c.d(b,{isJsonRpcRequest:function(){return d.isJsonRpcRequest}}),c.o(d,"isJsonRpcResponse")&&c.d(b,{isJsonRpcResponse:function(){return d.isJsonRpcResponse}}),c.o(d,"isJsonRpcResult")&&c.d(b,{isJsonRpcResult:function(){return d.isJsonRpcResult}}),c.o(d,"isLocalhostUrl")&&c.d(b,{isLocalhostUrl:function(){return d.isLocalhostUrl}}),c.o(d,"isReactNative")&&c.d(b,{isReactNative:function(){return d.isReactNative}}),c.o(d,"isWsUrl")&&c.d(b,{isWsUrl:function(){return d.isWsUrl}}),c.o(d,"payloadId")&&c.d(b,{payloadId:function(){return d.payloadId}})},71658:(a,b,c)=>{"use strict";let{groupRestore:d,nestedRestore:e}=c(91466);a.exports=function(){return function(){var a;if(this.restore){this.restore.state.secret=this.secret;return}let{secret:b,wcLen:c}=this,f=Object.keys(b),g=(a=b,f.map(b=>{let{circle:c,escPath:d,leadingBracket:e}=a[b],f=c?`o.${c} = secret[${d}].val`:`o${e?"":"."}${b} = secret[${d}].val`,g=`secret[${d}].val = undefined`;return`
      if (secret[${d}].val !== undefined) {
        try { ${f} } catch (e) {}
        ${g}
      }
    `}).join("")),h=c>0,i=h?{secret:b,groupRestore:d,nestedRestore:e}:{secret:b};this.restore=Function("o",function(a,b,c){let d=!0===c?`
    const keys = Object.keys(secret)
    const len = keys.length
    for (var i = len - 1; i >= ${b.length}; i--) {
      const k = keys[i]
      const o = secret[k]
      if (o) {
        if (o.flat === true) this.groupRestore(o)
        else this.nestedRestore(o)
        secret[k] = null
      }
    }
  `:"";return`
    const secret = this.secret
    ${d}
    ${a}
    return o
  `}(g,f,h)).bind(i),this.restore.state=i}}},71827:(a,b,c)=>{"use strict";let d=c(61864);a.exports=function({paths:a}){let b=[];var c=0;let e=a.reduce(function(a,e,f){var g=e.match(d).map(a=>a.replace(/'|"|`/g,""));let h="["===e[0],i=(g=g.map(a=>"["===a[0]?a.substr(1,a.length-2):a)).indexOf("*");if(i>-1){let a=g.slice(0,i),d=a.join("."),e=g.slice(i+1,g.length),f=e.length>0;c++,b.push({before:a,beforeStr:d,after:e,nested:f})}else a[e]={path:g,val:void 0,precensored:!1,circle:"",escPath:JSON.stringify(e),leadingBracket:h};return a},{});return{wildcards:b,wcLen:c,secret:e}}},72759:(a,b,c)=>{"use strict";c.d(b,{Vw:()=>p,Fc:()=>l,Id:()=>o,O8:()=>i,qv:()=>k,po:()=>r,Ow:()=>j,ZJ:()=>m,DH:()=>h,ld:()=>q});var d=c(77598),e=c.t(d,2);let f=e&&"object"==typeof e&&"webcrypto"in e?d.webcrypto:e&&"object"==typeof e&&"randomBytes"in e?e:void 0;var g=c(24858);function h(a){return new Uint32Array(a.buffer,a.byteOffset,Math.floor(a.byteLength/4))}function i(a){return new DataView(a.buffer,a.byteOffset,a.byteLength)}function j(a,b){return a<<32-b|a>>>b}let k=68===new Uint8Array(new Uint32Array([0x11223344]).buffer)[0];function l(a){for(let c=0;c<a.length;c++){var b;a[c]=(b=a[c])<<24&0xff000000|b<<8&0xff0000|b>>>8&65280|b>>>24&255}}function m(a){return"string"==typeof a&&(a=function(a){if("string"!=typeof a)throw Error("utf8ToBytes expected string, got "+typeof a);return new Uint8Array(new TextEncoder().encode(a))}(a)),(0,g.DO)(a),a}function o(...a){let b=0;for(let c=0;c<a.length;c++){let d=a[c];(0,g.DO)(d),b+=d.length}let c=new Uint8Array(b);for(let b=0,d=0;b<a.length;b++){let e=a[b];c.set(e,d),d+=e.length}return c}class p{clone(){return this._cloneInto()}}function q(a){let b=b=>a().update(m(b)).digest(),c=a();return b.outputLen=c.outputLen,b.blockLen=c.blockLen,b.create=()=>a(),b}function r(a=32){if(f&&"function"==typeof f.getRandomValues)return f.getRandomValues(new Uint8Array(a));if(f&&"function"==typeof f.randomBytes)return f.randomBytes(a);throw Error("crypto.getRandomValues must be defined")}},74811:(a,b,c)=>{"use strict";let d,e=c(74075),f=c(13738),g=c(16807),{kStatusCode:h,NOOP:i}=c(78006),j=Buffer.from([0,0,255,255]),k=Symbol("permessage-deflate"),l=Symbol("total-length"),m=Symbol("callback"),o=Symbol("buffers"),p=Symbol("error");class q{constructor(a,b,c){this._maxPayload=0|c,this._options=a||{},this._threshold=void 0!==this._options.threshold?this._options.threshold:1024,this._isServer=!!b,this._deflate=null,this._inflate=null,this.params=null,d||(d=new g(void 0!==this._options.concurrencyLimit?this._options.concurrencyLimit:10))}static get extensionName(){return"permessage-deflate"}offer(){let a={};return this._options.serverNoContextTakeover&&(a.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(a.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(a.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?a.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(a.client_max_window_bits=!0),a}accept(a){return a=this.normalizeParams(a),this.params=this._isServer?this.acceptAsServer(a):this.acceptAsClient(a),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){let a=this._deflate[m];this._deflate.close(),this._deflate=null,a&&a(Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(a){let b=this._options,c=a.find(a=>(!1!==b.serverNoContextTakeover||!a.server_no_context_takeover)&&(!a.server_max_window_bits||!1!==b.serverMaxWindowBits&&("number"!=typeof b.serverMaxWindowBits||!(b.serverMaxWindowBits>a.server_max_window_bits)))&&("number"!=typeof b.clientMaxWindowBits||!!a.client_max_window_bits));if(!c)throw Error("None of the extension offers can be accepted");return b.serverNoContextTakeover&&(c.server_no_context_takeover=!0),b.clientNoContextTakeover&&(c.client_no_context_takeover=!0),"number"==typeof b.serverMaxWindowBits&&(c.server_max_window_bits=b.serverMaxWindowBits),"number"==typeof b.clientMaxWindowBits?c.client_max_window_bits=b.clientMaxWindowBits:(!0===c.client_max_window_bits||!1===b.clientMaxWindowBits)&&delete c.client_max_window_bits,c}acceptAsClient(a){let b=a[0];if(!1===this._options.clientNoContextTakeover&&b.client_no_context_takeover)throw Error('Unexpected parameter "client_no_context_takeover"');if(b.client_max_window_bits){if(!1===this._options.clientMaxWindowBits||"number"==typeof this._options.clientMaxWindowBits&&b.client_max_window_bits>this._options.clientMaxWindowBits)throw Error('Unexpected or invalid parameter "client_max_window_bits"')}else"number"==typeof this._options.clientMaxWindowBits&&(b.client_max_window_bits=this._options.clientMaxWindowBits);return b}normalizeParams(a){return a.forEach(a=>{Object.keys(a).forEach(b=>{let c=a[b];if(c.length>1)throw Error(`Parameter "${b}" must have only a single value`);if(c=c[0],"client_max_window_bits"===b){if(!0!==c){let a=+c;if(!Number.isInteger(a)||a<8||a>15)throw TypeError(`Invalid value for parameter "${b}": ${c}`);c=a}else if(!this._isServer)throw TypeError(`Invalid value for parameter "${b}": ${c}`)}else if("server_max_window_bits"===b){let a=+c;if(!Number.isInteger(a)||a<8||a>15)throw TypeError(`Invalid value for parameter "${b}": ${c}`);c=a}else if("client_no_context_takeover"===b||"server_no_context_takeover"===b){if(!0!==c)throw TypeError(`Invalid value for parameter "${b}": ${c}`)}else throw Error(`Unknown parameter "${b}"`);a[b]=c})}),a}decompress(a,b,c){d.add(d=>{this._decompress(a,b,(a,b)=>{d(),c(a,b)})})}compress(a,b,c){d.add(d=>{this._compress(a,b,(a,b)=>{d(),c(a,b)})})}_decompress(a,b,c){let d=this._isServer?"client":"server";if(!this._inflate){let a=`${d}_max_window_bits`,b="number"!=typeof this.params[a]?e.Z_DEFAULT_WINDOWBITS:this.params[a];this._inflate=e.createInflateRaw({...this._options.zlibInflateOptions,windowBits:b}),this._inflate[k]=this,this._inflate[l]=0,this._inflate[o]=[],this._inflate.on("error",t),this._inflate.on("data",s)}this._inflate[m]=c,this._inflate.write(a),b&&this._inflate.write(j),this._inflate.flush(()=>{let a=this._inflate[p];if(a){this._inflate.close(),this._inflate=null,c(a);return}let e=f.concat(this._inflate[o],this._inflate[l]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[l]=0,this._inflate[o]=[],b&&this.params[`${d}_no_context_takeover`]&&this._inflate.reset()),c(null,e)})}_compress(a,b,c){let d=this._isServer?"server":"client";if(!this._deflate){let a=`${d}_max_window_bits`,b="number"!=typeof this.params[a]?e.Z_DEFAULT_WINDOWBITS:this.params[a];this._deflate=e.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:b}),this._deflate[l]=0,this._deflate[o]=[],this._deflate.on("error",i),this._deflate.on("data",r)}this._deflate[m]=c,this._deflate.write(a),this._deflate.flush(e.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let a=f.concat(this._deflate[o],this._deflate[l]);b&&(a=a.slice(0,a.length-4)),this._deflate[m]=null,this._deflate[l]=0,this._deflate[o]=[],b&&this.params[`${d}_no_context_takeover`]&&this._deflate.reset(),c(null,a)})}}function r(a){this[o].push(a),this[l]+=a.length}function s(a){if(this[l]+=a.length,this[k]._maxPayload<1||this[l]<=this[k]._maxPayload)return void this[o].push(a);this[p]=RangeError("Max payload size exceeded"),this[p].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[p][h]=1009,this.removeListener("data",s),this.reset()}function t(a){this[k]._inflate=null,a[h]=1007,this[m](a)}a.exports=q},75809:(a,b,c)=>{"use strict";a.exports=function({log:a,context:b}){let{colorizer:c,customLevels:g,levelKey:h,levelLabel:i,messageFormat:j,messageKey:k,useOnlyCustomProps:l}=b;if(j&&"string"==typeof j){let b=String(f(j,a)).replace(/{([^{}]+)}/g,function(b,c){let f;return c===i&&void 0!==(f=e(a,h))?(l?void 0===g:void 0===g[f])?d[f]:g[f]:e(a,c)||""});return c.message(b)}if(j&&"function"==typeof j){let b=j(a,k,i,{colors:c.colors});return c.message(b)}if(k in a!=!1&&("string"==typeof a[k]||"number"==typeof a[k]||"boolean"==typeof a[k]))return c.message(a[k])};let{LEVELS:d}=c(70219),e=c(37864),f=c(50283)},77632:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.delay=void 0,b.delay=function(a){return new Promise(b=>{setTimeout(()=>{b(!0)},a)})}},78006:a=>{"use strict";a.exports={BINARY_TYPES:["nodebuffer","arraybuffer","fragments"],GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),EMPTY_BUFFER:Buffer.alloc(0),NOOP:()=>{}}},78970:a=>{"use strict";let b="undefined"!=typeof Buffer,c=/"(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])"\s*:/,d=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/;function e(a,e,g){null==g&&null!==e&&"object"==typeof e&&(g=e,e=void 0),b&&Buffer.isBuffer(a)&&(a=a.toString()),a&&65279===a.charCodeAt(0)&&(a=a.slice(1));let h=JSON.parse(a,e);if(null===h||"object"!=typeof h)return h;let i=g&&g.protoAction||"error",j=g&&g.constructorAction||"error";if("ignore"===i&&"ignore"===j)return h;if("ignore"!==i&&"ignore"!==j){if(!1===c.test(a)&&!1===d.test(a))return h}else if("ignore"!==i&&"ignore"===j){if(!1===c.test(a))return h}else if(!1===d.test(a))return h;return f(h,{protoAction:i,constructorAction:j,safe:g&&g.safe})}function f(a,{protoAction:b="error",constructorAction:c="error",safe:d}={}){let e=[a];for(;e.length;){let a=e;for(let f of(e=[],a)){if("ignore"!==b&&Object.prototype.hasOwnProperty.call(f,"__proto__")){if(!0===d)return null;if("error"===b)throw SyntaxError("Object contains forbidden prototype property");delete f.__proto__}if("ignore"!==c&&Object.prototype.hasOwnProperty.call(f,"constructor")&&Object.prototype.hasOwnProperty.call(f.constructor,"prototype")){if(!0===d)return null;if("error"===c)throw SyntaxError("Object contains forbidden prototype property");delete f.constructor}for(let a in f){let b=f[a];b&&"object"==typeof b&&e.push(b)}}}return a}function g(a,b,c){let{stackTraceLimit:d}=Error;Error.stackTraceLimit=0;try{return e(a,b,c)}finally{Error.stackTraceLimit=d}}a.exports=g,a.exports.default=g,a.exports.parse=g,a.exports.safeParse=function(a,b){let{stackTraceLimit:c}=Error;Error.stackTraceLimit=0;try{return e(a,b,{safe:!0})}catch{return}finally{Error.stackTraceLimit=c}},a.exports.scan=f},79370:(a,b,c)=>{"use strict";let d=c(94735),e=c(81630);c(55591),c(91645),c(34631);let{createHash:f}=c(55511),g=c(74811),h=c(52792),{format:i,parse:j}=c(80526),{GUID:k,kWebSocket:l}=c(78006),m=/^[+/0-9A-Za-z]{22}==$/;class o extends d{constructor(a,b){if(super(),null==(a={maxPayload:0x6400000,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,...a}).port&&!a.server&&!a.noServer||null!=a.port&&(a.server||a.noServer)||a.server&&a.noServer)throw TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(null!=a.port?(this._server=e.createServer((a,b)=>{let c=e.STATUS_CODES[426];b.writeHead(426,{"Content-Length":c.length,"Content-Type":"text/plain"}),b.end(c)}),this._server.listen(a.port,a.host,a.backlog,b)):a.server&&(this._server=a.server),this._server){let a=this.emit.bind(this,"connection");this._removeListeners=function(a,b){for(let c of Object.keys(b))a.on(c,b[c]);return function(){for(let c of Object.keys(b))a.removeListener(c,b[c])}}(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(b,c,d)=>{this.handleUpgrade(b,c,d,a)}})}!0===a.perMessageDeflate&&(a.perMessageDeflate={}),a.clientTracking&&(this.clients=new Set),this.options=a,this._state=0}address(){if(this.options.noServer)throw Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(a){if(a&&this.once("close",a),2===this._state)return void process.nextTick(p,this);if(1===this._state)return;if(this._state=1,this.clients)for(let a of this.clients)a.terminate();let b=this._server;if(b&&(this._removeListeners(),this._removeListeners=this._server=null,null!=this.options.port))return void b.close(p.bind(void 0,this));process.nextTick(p,this)}shouldHandle(a){if(this.options.path){let b=a.url.indexOf("?");if((-1!==b?a.url.slice(0,b):a.url)!==this.options.path)return!1}return!0}handleUpgrade(a,b,c,d){b.on("error",q);let e=void 0!==a.headers["sec-websocket-key"]&&a.headers["sec-websocket-key"].trim(),f=a.headers.upgrade,h=+a.headers["sec-websocket-version"],i={};if("GET"!==a.method||void 0===f||"websocket"!==f.toLowerCase()||!e||!m.test(e)||8!==h&&13!==h||!this.shouldHandle(a))return r(b,400);if(this.options.perMessageDeflate){let c=new g(this.options.perMessageDeflate,!0,this.options.maxPayload);try{let b=j(a.headers["sec-websocket-extensions"]);b[g.extensionName]&&(c.accept(b[g.extensionName]),i[g.extensionName]=c)}catch(a){return r(b,400)}}if(this.options.verifyClient){let f={origin:a.headers[`${8===h?"sec-websocket-origin":"origin"}`],secure:!!(a.socket.authorized||a.socket.encrypted),req:a};if(2===this.options.verifyClient.length)return void this.options.verifyClient(f,(f,g,h,j)=>{if(!f)return r(b,g||401,h,j);this.completeUpgrade(e,i,a,b,c,d)});if(!this.options.verifyClient(f))return r(b,401)}this.completeUpgrade(e,i,a,b,c,d)}completeUpgrade(a,b,c,d,e,j){if(!d.readable||!d.writable)return d.destroy();if(d[l])throw Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>0)return r(d,503);let m=f("sha1").update(a+k).digest("base64"),o=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${m}`],p=new h(null),t=c.headers["sec-websocket-protocol"];if(t&&(t=t.split(",").map(s),(t=this.options.handleProtocols?this.options.handleProtocols(t,c):t[0])&&(o.push(`Sec-WebSocket-Protocol: ${t}`),p._protocol=t)),b[g.extensionName]){let a=b[g.extensionName].params,c=i({[g.extensionName]:[a]});o.push(`Sec-WebSocket-Extensions: ${c}`),p._extensions=b}this.emit("headers",o,c),d.write(o.concat("\r\n").join("\r\n")),d.removeListener("error",q),p.setSocket(d,e,this.options.maxPayload),this.clients&&(this.clients.add(p),p.on("close",()=>this.clients.delete(p))),j(p,c)}}function p(a){a._state=2,a.emit("close")}function q(){this.destroy()}function r(a,b,c,d){a.writable&&(c=c||e.STATUS_CODES[b],d={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(c),...d},a.write(`HTTP/1.1 ${b} ${e.STATUS_CODES[b]}\r
`+Object.keys(d).map(a=>`${a}: ${d[a]}`).join("\r\n")+"\r\n\r\n"+c)),a.removeListener("error",q),a.destroy()}function s(a){return a.trim()}a.exports=o},80526:a=>{"use strict";let b=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0];function c(a,b,c){void 0===a[b]?a[b]=[c]:a[b].push(c)}a.exports={format:function(a){return Object.keys(a).map(b=>{let c=a[b];return Array.isArray(c)||(c=[c]),c.map(a=>[b].concat(Object.keys(a).map(b=>{let c=a[b];return Array.isArray(c)||(c=[c]),c.map(a=>!0===a?b:`${b}=${a}`).join("; ")})).join("; ")).join(", ")}).join(", ")},parse:function(a){let d,e,f=Object.create(null);if(void 0===a||""===a)return f;let g=Object.create(null),h=!1,i=!1,j=!1,k=-1,l=-1,m=0;for(;m<a.length;m++){let o=a.charCodeAt(m);if(void 0===d)if(-1===l&&1===b[o])-1===k&&(k=m);else if(32===o||9===o)-1===l&&-1!==k&&(l=m);else if(59===o||44===o){if(-1===k)throw SyntaxError(`Unexpected character at index ${m}`);-1===l&&(l=m);let b=a.slice(k,l);44===o?(c(f,b,g),g=Object.create(null)):d=b,k=l=-1}else throw SyntaxError(`Unexpected character at index ${m}`);else if(void 0===e)if(-1===l&&1===b[o])-1===k&&(k=m);else if(32===o||9===o)-1===l&&-1!==k&&(l=m);else if(59===o||44===o){if(-1===k)throw SyntaxError(`Unexpected character at index ${m}`);-1===l&&(l=m),c(g,a.slice(k,l),!0),44===o&&(c(f,d,g),g=Object.create(null),d=void 0),k=l=-1}else if(61===o&&-1!==k&&-1===l)e=a.slice(k,m),k=l=-1;else throw SyntaxError(`Unexpected character at index ${m}`);else if(i){if(1!==b[o])throw SyntaxError(`Unexpected character at index ${m}`);-1===k?k=m:h||(h=!0),i=!1}else if(j)if(1===b[o])-1===k&&(k=m);else if(34===o&&-1!==k)j=!1,l=m;else if(92===o)i=!0;else throw SyntaxError(`Unexpected character at index ${m}`);else if(34===o&&61===a.charCodeAt(m-1))j=!0;else if(-1===l&&1===b[o])-1===k&&(k=m);else if(-1!==k&&(32===o||9===o))-1===l&&(l=m);else if(59===o||44===o){if(-1===k)throw SyntaxError(`Unexpected character at index ${m}`);-1===l&&(l=m);let b=a.slice(k,l);h&&(b=b.replace(/\\/g,""),h=!1),c(g,e,b),44===o&&(c(f,d,g),g=Object.create(null),d=void 0),e=void 0,k=l=-1}else throw SyntaxError(`Unexpected character at index ${m}`)}if(-1===k||j)throw SyntaxError("Unexpected end of input");-1===l&&(l=m);let o=a.slice(k,l);return void 0===d?c(f,o,g):(void 0===e?c(g,o,!0):h?c(g,e,o.replace(/\\/g,"")):c(g,e,o),c(f,d,g)),f}}},80924:(a,b,c)=>{"use strict";a.exports=function({log:a,context:b}){let{colorizer:c,customLevels:e,customLevelNames:f,levelKey:g,getLevelLabelData:h}=b,i=b.customPrettifiers?.level,j=d(a,g);if(void 0===j)return;let k=c(j,{customLevels:e,customLevelNames:f});if(i){let[b]=h(j);return i(j,g,a,{label:b,labelColorized:k,colors:c.colors})}return k};let d=c(37864)},81962:(a,b,c)=>{"use strict";var d;function e(a){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}!function(f){var g,h,i,j=arguments,k=(g=/d{1,4}|D{3,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|W{1,2}|[LlopSZN]|"[^"]*"|'[^']*'/g,h=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,i=/[^-+\dA-Z]/g,function(a,b,c,d){if(1!==j.length||"string"!==q(a)||/\d/.test(a)||(b=a,a=void 0),(a=a||0===a?a:new Date)instanceof Date||(a=new Date(a)),isNaN(a))throw TypeError("Invalid date");var e=(b=String(k.masks[b]||b||k.masks.default)).slice(0,4);("UTC:"===e||"GMT:"===e)&&(b=b.slice(4),c=!0,"GMT:"===e&&(d=!0));var f=function(){return c?"getUTC":"get"},r=function(){return a[f()+"Date"]()},s=function(){return a[f()+"Day"]()},t=function(){return a[f()+"Month"]()},u=function(){return a[f()+"FullYear"]()},v=function(){return a[f()+"Hours"]()},w=function(){return a[f()+"Minutes"]()},x=function(){return a[f()+"Seconds"]()},y=function(){return a[f()+"Milliseconds"]()},z=function(){return c?0:a.getTimezoneOffset()},A=function(){return o(a)},B={d:function(){return r()},dd:function(){return l(r())},ddd:function(){return k.i18n.dayNames[s()]},DDD:function(){return m({y:u(),m:t(),d:r(),_:f(),dayName:k.i18n.dayNames[s()],short:!0})},dddd:function(){return k.i18n.dayNames[s()+7]},DDDD:function(){return m({y:u(),m:t(),d:r(),_:f(),dayName:k.i18n.dayNames[s()+7]})},m:function(){return t()+1},mm:function(){return l(t()+1)},mmm:function(){return k.i18n.monthNames[t()]},mmmm:function(){return k.i18n.monthNames[t()+12]},yy:function(){return String(u()).slice(2)},yyyy:function(){return l(u(),4)},h:function(){return v()%12||12},hh:function(){return l(v()%12||12)},H:function(){return v()},HH:function(){return l(v())},M:function(){return w()},MM:function(){return l(w())},s:function(){return x()},ss:function(){return l(x())},l:function(){return l(y(),3)},L:function(){return l(Math.floor(y()/10))},t:function(){return 12>v()?k.i18n.timeNames[0]:k.i18n.timeNames[1]},tt:function(){return 12>v()?k.i18n.timeNames[2]:k.i18n.timeNames[3]},T:function(){return 12>v()?k.i18n.timeNames[4]:k.i18n.timeNames[5]},TT:function(){return 12>v()?k.i18n.timeNames[6]:k.i18n.timeNames[7]},Z:function(){return d?"GMT":c?"UTC":(String(a).match(h)||[""]).pop().replace(i,"").replace(/GMT\+0000/g,"UTC")},o:function(){return(z()>0?"-":"+")+l(100*Math.floor(Math.abs(z())/60)+Math.abs(z())%60,4)},p:function(){return(z()>0?"-":"+")+l(Math.floor(Math.abs(z())/60),2)+":"+l(Math.floor(Math.abs(z())%60),2)},S:function(){return["th","st","nd","rd"][r()%10>3?0:(r()%100-r()%10!=10)*r()%10]},W:function(){return A()},WW:function(){return l(A())},N:function(){return p(a)}};return b.replace(g,function(a){return a in B?B[a]():a.slice(1,a.length-1)})});k.masks={default:"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",paddedShortDate:"mm/dd/yyyy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:sso",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'",expiresHeaderFormat:"ddd, dd mmm yyyy HH:MM:ss Z"},k.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"],timeNames:["a","p","am","pm","A","P","AM","PM"]};var l=function(a,b){for(a=String(a),b=b||2;a.length<b;)a="0"+a;return a},m=function(a){var b=a.y,c=a.m,d=a.d,e=a._,f=a.dayName,g=a.short,h=void 0!==g&&g,i=new Date,j=new Date;j.setDate(j[e+"Date"]()-1);var k=new Date;return(k.setDate(k[e+"Date"]()+1),i[e+"FullYear"]()===b&&i[e+"Month"]()===c&&i[e+"Date"]()===d)?h?"Tdy":"Today":j[e+"FullYear"]()===b&&j[e+"Month"]()===c&&j[e+"Date"]()===d?h?"Ysd":"Yesterday":k[e+"FullYear"]()===b&&k[e+"Month"]()===c&&k[e+"Date"]()===d?h?"Tmw":"Tomorrow":f},o=function(a){var b=new Date(a.getFullYear(),a.getMonth(),a.getDate());b.setDate(b.getDate()-(b.getDay()+6)%7+3);var c=new Date(b.getFullYear(),0,4);c.setDate(c.getDate()-(c.getDay()+6)%7+3);var d=b.getTimezoneOffset()-c.getTimezoneOffset();return b.setHours(b.getHours()-d),1+Math.floor((b-c)/(864e5*7))},p=function(a){var b=a.getDay();return 0===b&&(b=7),b},q=function(a){return null===a?"null":void 0===a?"undefined":"object"!==e(a)?e(a):Array.isArray(a)?"array":({}).toString.call(a).slice(8,-1).toLowerCase()};void 0===(d=(function(){return k}).call(b,c,b,a))||(a.exports=d)}(void 0)},82839:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),c(40671).__exportStar(c(48424),b)},82956:(a,b,c)=>{"use strict";let d=c(29021),e=c(94735),f=c(28354).inherits,g=c(33873),h=c(83369),i=c(12412),j=Buffer.allocUnsafe(0),k="buffer",l="utf8",[m,o]=(process.versions.node||"0.0").split(".").map(Number),p=m>=22&&o>=7;function q(a,b){function c(c,d){if(c){b._reopening=!1,b._writing=!1,b._opening=!1,b.sync?process.nextTick(()=>{b.listenerCount("error")>0&&b.emit("error",c)}):b.emit("error",c);return}let e=b._reopening;b.fd=d,b.file=a,b._reopening=!1,b._opening=!1,b._writing=!1,b.sync?process.nextTick(()=>b.emit("ready")):b.emit("ready"),!b.destroyed&&(!b._writing&&b._len>b.minLength||b._flushPending?b._actualWrite():e&&process.nextTick(()=>b.emit("drain")))}b._opening=!0,b._writing=!0,b._asyncDrainScheduled=!1;let e=b.append?"a":"w",f=b.mode;if(b.sync)try{b.mkdir&&d.mkdirSync(g.dirname(a),{recursive:!0});let h=d.openSync(a,e,f);c(null,h)}catch(a){throw c(a),a}else b.mkdir?d.mkdir(g.dirname(a),{recursive:!0},b=>{if(b)return c(b);d.open(a,e,f,c)}):d.open(a,e,f,c)}function r(a){let b,c;if(!(this instanceof r))return new r(a);let{fd:e,dest:f,minLength:g,maxLength:i,maxWrite:m,periodicFlush:o,sync:p,append:u=!0,mkdir:x,retryEAGAIN:F,fsync:G,contentMode:H,mode:I}=a||{};if(e=e||f,this._len=0,this.fd=-1,this._bufs=[],this._lens=[],this._writing=!1,this._ending=!1,this._reopening=!1,this._asyncDrainScheduled=!1,this._flushPending=!1,this._hwm=Math.max(g||0,16387),this.file=null,this.destroyed=!1,this.minLength=g||0,this.maxLength=i||0,this.maxWrite=m||16384,this._periodicFlush=o||0,this._periodicFlushTimer=void 0,this.sync=p||!1,this.writable=!0,this._fsync=G||!1,this.append=u||!1,this.mode=I,this.retryEAGAIN=F||(()=>!0),this.mkdir=x||!1,H===k)this._writingBuf=j,this.write=w,this.flush=z,this.flushSync=B,this._actualWrite=D,b=()=>d.writeSync(this.fd,this._writingBuf),c=()=>d.write(this.fd,this._writingBuf,this.release);else if(void 0===H||H===l)this._writingBuf="",this.write=v,this.flush=y,this.flushSync=A,this._actualWrite=C,b=()=>d.writeSync(this.fd,this._writingBuf,"utf8"),c=()=>d.write(this.fd,this._writingBuf,"utf8",this.release);else throw Error(`SonicBoom supports "${l}" and "${k}", but passed ${H}`);if("number"==typeof e)this.fd=e,process.nextTick(()=>this.emit("ready"));else if("string"==typeof e)q(e,this);else throw Error("SonicBoom supports only file descriptors and files");if(this.minLength>=this.maxWrite)throw Error(`minLength should be smaller than maxWrite (${this.maxWrite})`);this.release=(a,e)=>{if(a){if(("EAGAIN"===a.code||"EBUSY"===a.code)&&this.retryEAGAIN(a,this._writingBuf.length,this._len-this._writingBuf.length))if(this.sync)try{h(100),this.release(void 0,0)}catch(a){this.release(a)}else setTimeout(c,100);else this._writing=!1,this.emit("error",a);return}this.emit("write",e);let f=s(this._writingBuf,this._len,e);if(this._len=f.len,this._writingBuf=f.writingBuf,this._writingBuf.length){if(!this.sync)return void c();try{do{let a=b(),c=s(this._writingBuf,this._len,a);this._len=c.len,this._writingBuf=c.writingBuf}while(this._writingBuf.length)}catch(a){this.release(a);return}}this._fsync&&d.fsyncSync(this.fd);let g=this._len;this._reopening?(this._writing=!1,this._reopening=!1,this.reopen()):g>this.minLength?this._actualWrite():this._ending?g>0?this._actualWrite():(this._writing=!1,E(this)):(this._writing=!1,this.sync?this._asyncDrainScheduled||(this._asyncDrainScheduled=!0,process.nextTick(t,this)):this.emit("drain"))},this.on("newListener",function(a){"drain"===a&&(this._asyncDrainScheduled=!1)}),0!==this._periodicFlush&&(this._periodicFlushTimer=setInterval(()=>this.flush(null),this._periodicFlush),this._periodicFlushTimer.unref())}function s(a,b,c){return"string"==typeof a&&Buffer.byteLength(a)!==c&&(c=Buffer.from(a).subarray(0,c).toString().length),b=Math.max(b-c,0),{writingBuf:a=a.slice(c),len:b}}function t(a){a.listenerCount("drain")>0&&(a._asyncDrainScheduled=!1,a.emit("drain"))}function u(a,b){return 0===a.length?j:1===a.length?a[0]:Buffer.concat(a,b)}function v(a){if(this.destroyed)throw Error("SonicBoom destroyed");let b=this._len+a.length,c=this._bufs;return this.maxLength&&b>this.maxLength?this.emit("drop",a):(0===c.length||c[c.length-1].length+a.length>this.maxWrite?c.push(""+a):c[c.length-1]+=a,this._len=b,!this._writing&&this._len>=this.minLength&&this._actualWrite()),this._len<this._hwm}function w(a){if(this.destroyed)throw Error("SonicBoom destroyed");let b=this._len+a.length,c=this._bufs,d=this._lens;return this.maxLength&&b>this.maxLength?this.emit("drop",a):(0===c.length||d[d.length-1]+a.length>this.maxWrite?(c.push([a]),d.push(a.length)):(c[c.length-1].push(a),d[d.length-1]+=a.length),this._len=b,!this._writing&&this._len>=this.minLength&&this._actualWrite()),this._len<this._hwm}function x(a){this._flushPending=!0;let b=()=>{if(this._fsync)this._flushPending=!1,a();else try{d.fsync(this.fd,b=>{this._flushPending=!1,a(b)})}catch(b){a(b)}this.off("error",c)},c=c=>{this._flushPending=!1,a(c),this.off("drain",b)};this.once("drain",b),this.once("error",c)}function y(a){if(null!=a&&"function"!=typeof a)throw Error("flush cb must be a function");if(this.destroyed){let b=Error("SonicBoom destroyed");if(a)return void a(b);throw b}if(this.minLength<=0)return void a?.();a&&x.call(this,a),this._writing||(0===this._bufs.length&&this._bufs.push(""),this._actualWrite())}function z(a){if(null!=a&&"function"!=typeof a)throw Error("flush cb must be a function");if(this.destroyed){let b=Error("SonicBoom destroyed");if(a)return void a(b);throw b}if(this.minLength<=0)return void a?.();a&&x.call(this,a),this._writing||(0===this._bufs.length&&(this._bufs.push([]),this._lens.push(0)),this._actualWrite())}function A(){if(this.destroyed)throw Error("SonicBoom destroyed");if(this.fd<0)throw Error("sonic boom is not ready yet");!this._writing&&this._writingBuf.length>0&&(this._bufs.unshift(this._writingBuf),this._writingBuf="");let a="";for(;this._bufs.length||a;){a.length<=0&&(a=this._bufs[0]);try{let b=d.writeSync(this.fd,a,"utf8"),c=s(a,this._len,b);a=c.writingBuf,this._len=c.len,a.length<=0&&this._bufs.shift()}catch(b){if(("EAGAIN"===b.code||"EBUSY"===b.code)&&!this.retryEAGAIN(b,a.length,this._len-a.length))throw b;h(100)}}try{d.fsyncSync(this.fd)}catch{}}function B(){if(this.destroyed)throw Error("SonicBoom destroyed");if(this.fd<0)throw Error("sonic boom is not ready yet");!this._writing&&this._writingBuf.length>0&&(this._bufs.unshift([this._writingBuf]),this._writingBuf=j);let a=j;for(;this._bufs.length||a.length;){a.length<=0&&(a=u(this._bufs[0],this._lens[0]));try{let b=d.writeSync(this.fd,a);a=a.subarray(b),this._len=Math.max(this._len-b,0),a.length<=0&&(this._bufs.shift(),this._lens.shift())}catch(b){if(("EAGAIN"===b.code||"EBUSY"===b.code)&&!this.retryEAGAIN(b,a.length,this._len-a.length))throw b;h(100)}}}function C(){let a=this.release;if(this._writing=!0,this._writingBuf=this._writingBuf||this._bufs.shift()||"",this.sync)try{let b=d.writeSync(this.fd,this._writingBuf,"utf8");a(null,b)}catch(b){a(b)}else d.write(this.fd,this._writingBuf,"utf8",a)}function D(){let a=this.release;if(this._writing=!0,this._writingBuf=this._writingBuf.length?this._writingBuf:u(this._bufs.shift(),this._lens.shift()),this.sync)try{let b=d.writeSync(this.fd,this._writingBuf);a(null,b)}catch(b){a(b)}else p&&(this._writingBuf=Buffer.from(this._writingBuf)),d.write(this.fd,this._writingBuf,a)}function E(a){if(-1===a.fd)return void a.once("ready",E.bind(null,a));void 0!==a._periodicFlushTimer&&clearInterval(a._periodicFlushTimer),a.destroyed=!0,a._bufs=[],a._lens=[],i("number"==typeof a.fd,`sonic.fd must be a number, got ${typeof a.fd}`);try{d.fsync(a.fd,function(){1!==a.fd&&2!==a.fd?d.close(a.fd,b):b()})}catch{}function b(b){if(b)return void a.emit("error",b);a._ending&&!a._writing&&a.emit("finish"),a.emit("close")}}f(r,e),r.prototype.reopen=function(a){if(this.destroyed)throw Error("SonicBoom destroyed");if(this._opening)return void this.once("ready",()=>{this.reopen(a)});if(this._ending)return;if(!this.file)throw Error("Unable to reopen a file descriptor, you must pass a file to SonicBoom");if(a&&(this.file=a),this._reopening=!0,this._writing)return;let b=this.fd;this.once("ready",()=>{b!==this.fd&&d.close(b,a=>{if(a)return this.emit("error",a)})}),q(this.file,this)},r.prototype.end=function(){if(this.destroyed)throw Error("SonicBoom destroyed");if(this._opening)return void this.once("ready",()=>{this.end()});!this._ending&&(this._ending=!0,this._writing||(this._len>0&&this.fd>=0?this._actualWrite():E(this)))},r.prototype.destroy=function(){this.destroyed||E(this)},r.SonicBoom=r,r.default=r,a.exports=r},83369:a=>{"use strict";if("undefined"!=typeof SharedArrayBuffer&&"undefined"!=typeof Atomics){let b=new Int32Array(new SharedArrayBuffer(4));a.exports=function(a){if(!1==(a>0&&a<1/0)){if("number"!=typeof a&&"bigint"!=typeof a)throw TypeError("sleep: ms must be a number");throw RangeError("sleep: ms must be a number that is greater than 0 but less than Infinity")}Atomics.wait(b,0,0,Number(a))}}else a.exports=function(a){if(!1==(a>0&&a<1/0)){if("number"!=typeof a&&"bigint"!=typeof a)throw TypeError("sleep: ms must be a number");throw RangeError("sleep: ms must be a number that is greater than 0 but less than Infinity")}let b=Date.now()+Number(a);for(;b>Date.now(););}},83604:a=>{"use strict";a.exports=function(a){return"[object Object]"===Object.prototype.toString.apply(a)}},84616:a=>{"use strict";function b(a,b){return b}a.exports=function(){let a=Error.prepareStackTrace;Error.prepareStackTrace=b;let c=Error().stack;if(Error.prepareStackTrace=a,!Array.isArray(c))return;let d=c.slice(2),e=[];for(let a of d)a&&e.push(a.getFileName());return e}},85671:(a,b,c)=>{"use strict";a.exports=function(a){let b=new Date(a);return d(b)?b:b=new Date(+a)};let d=c(1006)},86017:(a,b,c)=>{"use strict";c.d(b,{o0:()=>m});var d=function(a,b,c){if(c||2==arguments.length)for(var d,e=0,f=b.length;e<f;e++)!d&&e in b||(d||(d=Array.prototype.slice.call(b,0,e)),d[e]=b[e]);return a.concat(d||Array.prototype.slice.call(b))},e=function(a,b,c){this.name=a,this.version=b,this.os=c,this.type="browser"},f=function(a){this.version=a,this.type="node",this.name="node",this.os=process.platform},g=function(a,b,c,d){this.name=a,this.version=b,this.os=c,this.bot=d,this.type="bot-device"},h=function(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null},i=function(){this.type="react-native",this.name="react-native",this.version=null,this.os=null},j=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,k=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],l=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function m(a){return a?o(a):"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product?new i:"undefined"!=typeof navigator?o(navigator.userAgent):"undefined"!=typeof process&&process.version?new f(process.version.slice(1)):null}function o(a){var b=""!==a&&k.reduce(function(b,c){var d=c[0],e=c[1];if(b)return b;var f=e.exec(a);return!!f&&[d,f]},!1);if(!b)return null;var c=b[0],f=b[1];if("searchbot"===c)return new h;var i=f[1]&&f[1].split(".").join("_").split("_").slice(0,3);i?i.length<3&&(i=d(d([],i,!0),function(a){for(var b=[],c=0;c<a;c++)b.push("0");return b}(3-i.length),!0)):i=[];var m=i.join("."),o=function(a){for(var b=0,c=l.length;b<c;b++){var d=l[b],e=d[0];if(d[1].exec(a))return e}return null}(a),p=j.exec(a);return p&&p[1]?new g(c,m,o,p[1]):new e(c,m,o)}},86619:(a,b,c)=>{"use strict";let{format:d}=c(28354);a.exports=function(){let a={},b=new Map;return{create:function(c,e,f){if(!c)throw Error("Warning name must not be empty");if(!e)throw Error("Warning code must not be empty");if(!f)throw Error("Warning message must not be empty");if(void 0!==a[e=e.toUpperCase()])throw Error(`The code '${e}' already exist`);return b.set(e,!1),a[e]=function(a,b,g){let h;return h=a&&b&&g?d(f,a,b,g):a&&b?d(f,a,b):a?d(f,a):f,{code:e,name:c,message:h}},a[e]},emit:function(c,d,e,f){if(void 0===a[c])throw Error(`The code '${c}' does not exist`);if(!0===b.get(c))return;b.set(c,!0);let g=a[c](d,e,f);process.emitWarning(g.message,g.name,g.code)},emitted:b}}},86973:(a,b,c)=>{"use strict";a.exports=function(a,b,c){let f=a?b||d:Object.assign({},d,b),g=a?c||e:Object.assign({},e,c);return function(a){let b="default";return b=Number.isInteger(+a)?Object.prototype.hasOwnProperty.call(f,a)?a:b:Object.prototype.hasOwnProperty.call(g,a.toLowerCase())?g[a.toLowerCase()]:b,[f[b],b]}};let{LEVELS:d,LEVEL_NAMES:e}=c(70219)},88492:(a,b)=>{"use strict";function c(a){let b;return"undefined"!=typeof window&&void 0!==window[a]&&(b=window[a]),b}function d(a){let b=c(a);if(!b)throw Error(`${a} is not defined in Window`);return b}Object.defineProperty(b,"__esModule",{value:!0}),b.getLocalStorage=b.getLocalStorageOrThrow=b.getCrypto=b.getCryptoOrThrow=b.getLocation=b.getLocationOrThrow=b.getNavigator=b.getNavigatorOrThrow=b.getDocument=b.getDocumentOrThrow=b.getFromWindowOrThrow=b.getFromWindow=void 0,b.getFromWindow=c,b.getFromWindowOrThrow=d,b.getDocumentOrThrow=function(){return d("document")},b.getDocument=function(){return c("document")},b.getNavigatorOrThrow=function(){return d("navigator")},b.getNavigator=function(){return c("navigator")},b.getLocationOrThrow=function(){return d("location")},b.getLocation=function(){return c("location")},b.getCryptoOrThrow=function(){return d("crypto")},b.getCrypto=function(){return c("crypto")},b.getLocalStorageOrThrow=function(){return d("localStorage")},b.getLocalStorage=function(){return c("localStorage")}},88618:(a,b,c)=>{"use strict";c.d(b,{EthereumProvider:()=>i_});var d=c(94735),e=c.n(d),f=c(86017),g=c(94965),h=c(88492),i=c(42950),j=c(96921),k=c(59817),l=c(7877),m=c(8286),o=c(51438);function p(a){let[b,c]=a.split(":");return{namespace:b,reference:c}}function q(a,b=[]){let c=[];return Object.keys(a).forEach(d=>{if(b.length&&!b.includes(d))return;let e=a[d];c.push(...e.accounts)}),c}function r(a,b){return a.includes(":")?[a]:b.chains||[]}var s=Object.defineProperty,t=Object.defineProperties,u=Object.getOwnPropertyDescriptors,v=Object.getOwnPropertySymbols,w=Object.prototype.hasOwnProperty,x=Object.prototype.propertyIsEnumerable,y=(a,b,c)=>b in a?s(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,z=(a,b)=>{for(var c in b||(b={}))w.call(b,c)&&y(a,c,b[c]);if(v)for(var c of v(b))x.call(b,c)&&y(a,c,b[c]);return a};let A={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"};function B(){return"u">typeof process&&"u">typeof process.versions&&"u">typeof process.versions.node}function C(){return!(0,h.getDocument)()&&!!(0,h.getNavigator)()&&"ReactNative"===navigator.product}function D(){return!B()&&!!(0,h.getNavigator)()&&!!(0,h.getDocument)()}function E(){return C()?A.reactNative:B()?A.node:D()?A.browser:A.unknown}function F(){var a;try{return C()&&"u">typeof global&&"u">typeof(null==global?void 0:global.Application)?null==(a=global.Application)?void 0:a.applicationId:void 0}catch{return}}function G(){return(0,i.g)()||{name:"",description:"",url:"",icons:[""]}}function H(a,b,c){let d=function(){if(E()===A.reactNative&&"u">typeof global&&"u">typeof(null==global?void 0:global.Platform)){let{OS:a,Version:b}=global.Platform;return[a,b].join("-")}let a=(0,f.o0)();if(null===a)return"unknown";let b=a.os?a.os.replace(" ","").toLowerCase():"unknown";return"browser"===a.type?[b,a.name,a.version].join("-"):[b,a.version].join("-")}(),e=function(){var a;let b=E();return b===A.browser?[b,(null==(a=(0,h.getLocation)())?void 0:a.host)||"unknown"].join(":"):b}();return[[a,b].join("-"),["js",c].join("-"),d,e].join("/")}function I(a,b){return a.filter(a=>b.includes(a)).length===a.length}function J(a){return Object.fromEntries(a.entries())}function K(a){return new Map(Object.entries(a))}function L(a=g.FIVE_MINUTES,b){let c,d,e,f,h=(0,g.toMiliseconds)(a||g.FIVE_MINUTES);return{resolve:a=>{e&&c&&(clearTimeout(e),c(a),f=Promise.resolve(a))},reject:a=>{e&&d&&(clearTimeout(e),d(a))},done:()=>new Promise((a,g)=>{if(f)return a(f);e=setTimeout(()=>{let a=Error(b);f=Promise.reject(a),g(a)},h),c=a,d=g})}}function M(a,b,c){return new Promise(async(d,e)=>{let f=setTimeout(()=>e(Error(c)),b);try{let b=await a;d(b)}catch(a){e(a)}clearTimeout(f)})}function N(a,b){if("string"==typeof b&&b.startsWith(`${a}:`))return b;if("topic"===a.toLowerCase()){if("string"!=typeof b)throw Error('Value must be "string" for expirer target type: topic');return`topic:${b}`}if("id"===a.toLowerCase()){if("number"!=typeof b)throw Error('Value must be "number" for expirer target type: id');return`id:${b}`}throw Error(`Unknown expirer target type: ${a}`)}function O(a){let[b,c]=a.split(":"),d={id:void 0,topic:void 0};if("topic"===b&&"string"==typeof c)d.topic=c;else if("id"===b&&Number.isInteger(Number(c)))d.id=Number(c);else throw Error(`Invalid target, expected id:number or topic:string, got ${b}:${c}`);return d}function P(a,b){return(0,g.fromMiliseconds)((b||Date.now())+(0,g.toMiliseconds)(a))}function Q(a){return Date.now()>=(0,g.toMiliseconds)(a)}function R(a,b){return`${a}${b?`:${b}`:""}`}function S(a=[],b=[]){return[...new Set([...a,...b])]}async function T({id:a,topic:b,wcDeepLink:c}){var d,e;try{if(!c)return;let f="string"==typeof c?JSON.parse(c):c,g=f?.href;if("string"!=typeof g)return;let i=function(a,b,c){let d=`requestId=${b}&sessionTopic=${c}`;a.endsWith("/")&&(a=a.slice(0,-1));let e=`${a}`;if(a.startsWith("https://t.me")){let b=a.includes("?")?"&startapp=":"?startapp=";e=`${e}${b}${function(a,b=!1){let c=Buffer.from(a).toString("base64");return b?c.replace(/[=]/g,""):c}(d,!0)}`}else e=`${e}/wc?${d}`;return e}(g,a,b),j=E();if(j===A.browser){let a;if(!(null!=(d=(0,h.getDocument)())&&d.hasFocus()))return void console.warn("Document does not have focus, skipping deeplink.");e=i,a="_self",!function(){try{return window.self!==window.top}catch{return!1}}()?("u">typeof window&&(window.TelegramWebviewProxy||window.Telegram||window.TelegramWebviewProxyProto)||e.startsWith("https://")||e.startsWith("http://"))&&(a="_blank"):a="_top",window.open(e,a,"noreferrer noopener")}else j===A.reactNative&&"u">typeof(null==global?void 0:global.Linking)&&await global.Linking.openURL(i)}catch(a){console.error(a)}}async function U(a,b){let c="";try{if(D()&&(c=localStorage.getItem(b)))return c;c=await a.getItem(b)}catch(a){console.error(a)}return c}function V(a,b){if(!a.includes(b))return null;let c=a.split(/([&,?,=])/),d=c.indexOf(b);return c[d+2]}function W(){return"u">typeof crypto&&null!=crypto&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,a=>{let b=16*Math.random()|0;return("x"===a?b:3&b|8).toString(16)})}function X(){return"u">typeof process&&"true"===process.env.IS_VITEST}function Y(a){return Buffer.from(a,"base64").toString("utf-8")}function Z(a){if(!Number.isSafeInteger(a)||a<0)throw Error("positive integer expected, got "+a)}function $(a,...b){if(!(a instanceof Uint8Array||ArrayBuffer.isView(a)&&"Uint8Array"===a.constructor.name))throw Error("Uint8Array expected");if(b.length>0&&!b.includes(a.length))throw Error("Uint8Array expected of length "+b+", got length="+a.length)}function _(a){if("function"!=typeof a||"function"!=typeof a.create)throw Error("Hash should be wrapped by utils.wrapConstructor");Z(a.outputLen),Z(a.blockLen)}function aa(a,b=!0){if(a.destroyed)throw Error("Hash instance has been destroyed");if(b&&a.finished)throw Error("Hash#digest() has already been called")}function ab(a,b){$(a);let c=b.outputLen;if(a.length<c)throw Error("digestInto() expects output buffer of length at least "+c)}let ac=BigInt(0x100000000-1),ad=BigInt(32),ae="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;function af(a){return new DataView(a.buffer,a.byteOffset,a.byteLength)}function ag(a,b){return a<<32-b|a>>>b}let ah=68===new Uint8Array(new Uint32Array([0x11223344]).buffer)[0];function ai(a){for(let c=0;c<a.length;c++){var b;a[c]=(b=a[c])<<24&0xff000000|b<<8&0xff0000|b>>>8&65280|b>>>24&255}}function aj(a){return"string"==typeof a&&(a=function(a){if("string"!=typeof a)throw Error("utf8ToBytes expected string, got "+typeof a);return new Uint8Array(new TextEncoder().encode(a))}(a)),$(a),a}class ak{clone(){return this._cloneInto()}}function al(a){let b=b=>a().update(aj(b)).digest(),c=a();return b.outputLen=c.outputLen,b.blockLen=c.blockLen,b.create=()=>a(),b}function am(a=32){if(ae&&"function"==typeof ae.getRandomValues)return ae.getRandomValues(new Uint8Array(a));if(ae&&"function"==typeof ae.randomBytes)return ae.randomBytes(a);throw Error("crypto.getRandomValues must be defined")}let an=[],ao=[],ap=[],aq=BigInt(0),ar=BigInt(1),as=BigInt(2),at=BigInt(7),au=BigInt(256),av=BigInt(113);for(let a=0,b=ar,c=1,d=0;a<24;a++){[c,d]=[d,(2*c+3*d)%5],an.push(2*(5*d+c)),ao.push((a+1)*(a+2)/2%64);let e=aq;for(let a=0;a<7;a++)(b=(b<<ar^(b>>at)*av)%au)&as&&(e^=ar<<(ar<<BigInt(a))-ar);ap.push(e)}let[aw,ax]=function(a,b=!1){let c=new Uint32Array(a.length),d=new Uint32Array(a.length);for(let e=0;e<a.length;e++){let{h:f,l:g}=function(a,b=!1){return b?{h:Number(a&ac),l:Number(a>>ad&ac)}:{h:0|Number(a>>ad&ac),l:0|Number(a&ac)}}(a[e],b);[c[e],d[e]]=[f,g]}return[c,d]}(ap,!0),ay=(a,b,c)=>c>32?((a,b,c)=>b<<c-32|a>>>64-c)(a,b,c):((a,b,c)=>a<<c|b>>>32-c)(a,b,c),az=(a,b,c)=>c>32?((a,b,c)=>a<<c-32|b>>>64-c)(a,b,c):((a,b,c)=>b<<c|a>>>32-c)(a,b,c);class aA extends ak{constructor(a,b,c,d=!1,e=24){if(super(),this.blockLen=a,this.suffix=b,this.outputLen=c,this.enableXOF=d,this.rounds=e,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,Z(c),0>=this.blockLen||this.blockLen>=200)throw Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=function(a){return new Uint32Array(a.buffer,a.byteOffset,Math.floor(a.byteLength/4))}(this.state)}keccak(){ah||ai(this.state32),function(a,b=24){let c=new Uint32Array(10);for(let d=24-b;d<24;d++){for(let b=0;b<10;b++)c[b]=a[b]^a[b+10]^a[b+20]^a[b+30]^a[b+40];for(let b=0;b<10;b+=2){let d=(b+8)%10,e=(b+2)%10,f=c[e],g=c[e+1],h=ay(f,g,1)^c[d],i=az(f,g,1)^c[d+1];for(let c=0;c<50;c+=10)a[b+c]^=h,a[b+c+1]^=i}let b=a[2],e=a[3];for(let c=0;c<24;c++){let d=ao[c],f=ay(b,e,d),g=az(b,e,d),h=an[c];b=a[h],e=a[h+1],a[h]=f,a[h+1]=g}for(let b=0;b<50;b+=10){for(let d=0;d<10;d++)c[d]=a[b+d];for(let d=0;d<10;d++)a[b+d]^=~c[(d+2)%10]&c[(d+4)%10]}a[0]^=aw[d],a[1]^=ax[d]}c.fill(0)}(this.state32,this.rounds),ah||ai(this.state32),this.posOut=0,this.pos=0}update(a){aa(this);let{blockLen:b,state:c}=this,d=(a=aj(a)).length;for(let e=0;e<d;){let f=Math.min(b-this.pos,d-e);for(let b=0;b<f;b++)c[this.pos++]^=a[e++];this.pos===b&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:a,suffix:b,pos:c,blockLen:d}=this;a[c]^=b,(128&b)!=0&&c===d-1&&this.keccak(),a[d-1]^=128,this.keccak()}writeInto(a){aa(this,!1),$(a),this.finish();let b=this.state,{blockLen:c}=this;for(let d=0,e=a.length;d<e;){this.posOut>=c&&this.keccak();let f=Math.min(c-this.posOut,e-d);a.set(b.subarray(this.posOut,this.posOut+f),d),this.posOut+=f,d+=f}return a}xofInto(a){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(a)}xof(a){return Z(a),this.xofInto(new Uint8Array(a))}digestInto(a){if(ab(a,this),this.finished)throw Error("digest() was already called");return this.writeInto(a),this.destroy(),a}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(a){let{blockLen:b,suffix:c,outputLen:d,rounds:e,enableXOF:f}=this;return a||(a=new aA(b,c,d,f,e)),a.state32.set(this.state32),a.pos=this.pos,a.posOut=this.posOut,a.finished=this.finished,a.rounds=e,a.suffix=c,a.outputLen=d,a.enableXOF=f,a.destroyed=this.destroyed,a}}let aB=al(()=>new aA(136,1,32));function aC(a){let b=`Ethereum Signed Message:
${a.length}`,c=new TextEncoder().encode(b+a);return"0x"+Buffer.from(aB(c)).toString("hex")}async function aD(a,b,c,d,e,f){switch(c.t){case"eip191":return await aE(a,b,c.s);case"eip1271":return await aF(a,b,c.s,d,e,f);default:throw Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${c.t}`)}}async function aE(a,b,c){return(await (0,j.x)({hash:aC(b),signature:c})).toLowerCase()===a.toLowerCase()}async function aF(a,b,c,d,e,f){let g=p(d);if(!g.namespace||!g.reference)throw Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${d}`);try{let g="0x1626ba7e",h=c.substring(2),i=aC(b).substring(2),j=g+i+"00000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000041"+h,k=await fetch(`${f||"https://rpc.walletconnect.org/v1"}/?chainId=${d}&projectId=${e}`,{method:"POST",body:JSON.stringify({id:Date.now()+Math.floor(1e3*Math.random()),jsonrpc:"2.0",method:"eth_call",params:[{to:a,data:j},"latest"]})}),{result:l}=await k.json();return!!l&&l.slice(0,g.length).toLowerCase()===g.toLowerCase()}catch(a){return console.error("isValidEip1271Signature: ",a),!1}}var aG=Object.defineProperty,aH=Object.defineProperties,aI=Object.getOwnPropertyDescriptors,aJ=Object.getOwnPropertySymbols,aK=Object.prototype.hasOwnProperty,aL=Object.prototype.propertyIsEnumerable,aM=(a,b,c)=>b in a?aG(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c;let aN=a=>a?.split(":"),aO=a=>{let b=a&&aN(a);if(b)return b[2]+":"+b[3]},aP=a=>{let b=a&&aN(a);if(b)return b.pop()};async function aQ(a){let{cacao:b,projectId:c}=a,{s:d,p:e}=b,f=aR(e,e.iss),g=aP(e.iss);return await aD(g,f,d,aO(e.iss),c)}let aR=(a,b)=>{let c=`${a.domain} wants you to sign in with your Ethereum account:`,d=aP(b);if(!a.aud&&!a.uri)throw Error("Either `aud` or `uri` is required to construct the message");let e=a.statement||void 0,f=`URI: ${a.aud||a.uri}`,g=`Version: ${a.version}`,h=`Chain ID: ${(a=>{let b=a&&aN(a);if(b)return a.includes("did:pkh:")?b[3]:b[1]})(b)}`,i=`Nonce: ${a.nonce}`,j=`Issued At: ${a.iat}`,k=a.exp?`Expiration Time: ${a.exp}`:void 0,l=a.nbf?`Not Before: ${a.nbf}`:void 0,m=a.requestId?`Request ID: ${a.requestId}`:void 0,o=a.resources?`Resources:${a.resources.map(a=>`
- ${a}`).join("")}`:void 0,p=aX(a.resources);return p&&(e=function(a="",b){aS(b);let c="I further authorize the stated URI to perform the following actions on my behalf: ";if(a.includes(c))return a;let d=[],e=0;Object.keys(b.att).forEach(a=>{let c=Object.keys(b.att[a]).map(a=>({ability:a.split("/")[0],action:a.split("/")[1]}));c.sort((a,b)=>a.action.localeCompare(b.action));let f={};c.forEach(a=>{f[a.ability]||(f[a.ability]=[]),f[a.ability].push(a.action)});let g=Object.keys(f).map(b=>(e++,`(${e}) '${b}': '${f[b].join("', '")}' for '${a}'.`));d.push(g.join(", ").replace(".,","."))});let f=d.join(" "),g=`${c}${f}`;return`${a?a+" ":""}${g}`}(e,aU(p))),[c,d,"",e,"",f,g,h,i,j,k,l,m,o].filter(a=>null!=a).join(`
`)};function aS(a){if(!a)throw Error("No recap provided, value is undefined");if(!a.att)throw Error("No `att` property found");let b=Object.keys(a.att);if(!(null!=b&&b.length))throw Error("No resources found in `att` property");b.forEach(b=>{let c=a.att[b];if(Array.isArray(c)||"object"!=typeof c)throw Error(`Resource must be an object: ${b}`);if(!Object.keys(c).length)throw Error(`Resource object is empty: ${b}`);Object.keys(c).forEach(a=>{let b=c[a];if(!Array.isArray(b))throw Error(`Ability limits ${a} must be an array of objects, found: ${b}`);if(!b.length)throw Error(`Value of ${a} is empty array, must be an array with objects`);b.forEach(b=>{if("object"!=typeof b)throw Error(`Ability limits (${a}) must be an array of objects, found: ${b}`)})})})}function aT(a){return aS(a),`urn:recap:${Buffer.from(JSON.stringify(a)).toString("base64").replace(/=/g,"")}`}function aU(a){var b;let c=(b=a.replace("urn:recap:",""),JSON.parse(Buffer.from(b,"base64").toString("utf-8")));return aS(c),c}function aV(a){var b;let c=aU(a);aS(c);let d=null==(b=c.att)?void 0:b.eip155;return d?Object.keys(d).map(a=>a.split("/")[1]):[]}function aW(a){let b=aU(a);aS(b);let c=[];return Object.values(b.att).forEach(a=>{Object.values(a).forEach(a=>{var b;null!=(b=a?.[0])&&b.chains&&c.push(a[0].chains)})}),[...new Set(c.flat())]}function aX(a){if(!a)return;let b=a?.[a.length-1];return b&&b.includes("urn:recap:")?b:void 0}function aY(a){if(!Number.isSafeInteger(a)||a<0)throw Error("positive integer expected, got "+a)}function aZ(a){return a instanceof Uint8Array||ArrayBuffer.isView(a)&&"Uint8Array"===a.constructor.name}function a$(a,...b){if(!aZ(a))throw Error("Uint8Array expected");if(b.length>0&&!b.includes(a.length))throw Error("Uint8Array expected of length "+b+", got length="+a.length)}function a_(a,b=!0){if(a.destroyed)throw Error("Hash instance has been destroyed");if(b&&a.finished)throw Error("Hash#digest() has already been called")}function a0(a){if("boolean"!=typeof a)throw Error(`boolean expected, not ${a}`)}let a1=a=>new Uint32Array(a.buffer,a.byteOffset,Math.floor(a.byteLength/4));if(68!==new Uint8Array(new Uint32Array([0x11223344]).buffer)[0])throw Error("Non little-endian hardware is not supported");function a2(a){if("string"==typeof a)a=function(a){if("string"!=typeof a)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(a))}(a);else if(aZ(a))a=a5(a);else throw Error("Uint8Array expected, got "+typeof a);return a}function a3(a,b,c=!0){if(void 0===b)return new Uint8Array(a);if(b.length!==a)throw Error("invalid output length, expected "+a+", got: "+b.length);if(c&&b.byteOffset%4!=0)throw Error("invalid output, must be aligned");return b}function a4(a,b,c,d){if("function"==typeof a.setBigUint64)return a.setBigUint64(b,c,d);let e=BigInt(32),f=BigInt(0xffffffff),g=Number(c>>e&f),h=Number(c&f),i=4*!!d,j=4*!d;a.setUint32(b+i,g,d),a.setUint32(b+j,h,d)}function a5(a){return Uint8Array.from(a)}function a6(...a){for(let b=0;b<a.length;b++)a[b].fill(0)}let a7=a=>Uint8Array.from(a.split("").map(a=>a.charCodeAt(0))),a8=a7("expand 16-byte k"),a9=a7("expand 32-byte k"),ba=a1(a8),bb=a1(a9);function bc(a,b){return a<<b|a>>>32-b}function bd(a){return a.byteOffset%4==0}let be=0x100000000-1,bf=new Uint32Array,bg=(a,b)=>255&a[b++]|(255&a[b++])<<8;class bh{constructor(a){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,a$(a=a2(a),32);let b=bg(a,0),c=bg(a,2),d=bg(a,4),e=bg(a,6),f=bg(a,8),g=bg(a,10),h=bg(a,12),i=bg(a,14);this.r[0]=8191&b,this.r[1]=(b>>>13|c<<3)&8191,this.r[2]=(c>>>10|d<<6)&7939,this.r[3]=(d>>>7|e<<9)&8191,this.r[4]=(e>>>4|f<<12)&255,this.r[5]=f>>>1&8190,this.r[6]=(f>>>14|g<<2)&8191,this.r[7]=(g>>>11|h<<5)&8065,this.r[8]=(h>>>8|i<<8)&8191,this.r[9]=i>>>5&127;for(let b=0;b<8;b++)this.pad[b]=bg(a,16+2*b)}process(a,b,c=!1){let{h:d,r:e}=this,f=e[0],g=e[1],h=e[2],i=e[3],j=e[4],k=e[5],l=e[6],m=e[7],o=e[8],p=e[9],q=bg(a,b+0),r=bg(a,b+2),s=bg(a,b+4),t=bg(a,b+6),u=bg(a,b+8),v=bg(a,b+10),w=bg(a,b+12),x=bg(a,b+14),y=d[0]+(8191&q),z=d[1]+((q>>>13|r<<3)&8191),A=d[2]+((r>>>10|s<<6)&8191),B=d[3]+((s>>>7|t<<9)&8191),C=d[4]+((t>>>4|u<<12)&8191),D=d[5]+(u>>>1&8191),E=d[6]+((u>>>14|v<<2)&8191),F=d[7]+((v>>>11|w<<5)&8191),G=d[8]+((w>>>8|x<<8)&8191),H=d[9]+(x>>>5|2048*!c),I=0,J=0+y*f+5*p*z+5*o*A+5*m*B+5*l*C;I=J>>>13,J&=8191,J+=5*k*D+5*j*E+5*i*F+5*h*G+5*g*H,I+=J>>>13,J&=8191;let K=I+y*g+z*f+5*p*A+5*o*B+5*m*C;I=K>>>13,K&=8191,K+=5*l*D+5*k*E+5*j*F+5*i*G+5*h*H,I+=K>>>13,K&=8191;let L=I+y*h+z*g+A*f+5*p*B+5*o*C;I=L>>>13,L&=8191,L+=5*m*D+5*l*E+5*k*F+5*j*G+5*i*H,I+=L>>>13,L&=8191;let M=I+y*i+z*h+A*g+B*f+5*p*C;I=M>>>13,M&=8191,M+=5*o*D+5*m*E+5*l*F+5*k*G+5*j*H,I+=M>>>13,M&=8191;let N=I+y*j+z*i+A*h+B*g+C*f;I=N>>>13,N&=8191,N+=5*p*D+5*o*E+5*m*F+5*l*G+5*k*H,I+=N>>>13,N&=8191;let O=I+y*k+z*j+A*i+B*h+C*g;I=O>>>13,O&=8191,O+=D*f+5*p*E+5*o*F+5*m*G+5*l*H,I+=O>>>13,O&=8191;let P=I+y*l+z*k+A*j+B*i+C*h;I=P>>>13,P&=8191,P+=D*g+E*f+5*p*F+5*o*G+5*m*H,I+=P>>>13,P&=8191;let Q=I+y*m+z*l+A*k+B*j+C*i;I=Q>>>13,Q&=8191,Q+=D*h+E*g+F*f+5*p*G+5*o*H,I+=Q>>>13,Q&=8191;let R=I+y*o+z*m+A*l+B*k+C*j;I=R>>>13,R&=8191,R+=D*i+E*h+F*g+G*f+5*p*H,I+=R>>>13,R&=8191;let S=I+y*p+z*o+A*m+B*l+C*k;I=S>>>13,S&=8191,S+=D*j+E*i+F*h+G*g+H*f,I+=S>>>13,S&=8191,J=8191&(I=(I=(I<<2)+I|0)+J|0),I>>>=13,K+=I,d[0]=J,d[1]=K,d[2]=L,d[3]=M,d[4]=N,d[5]=O,d[6]=P,d[7]=Q,d[8]=R,d[9]=S}finalize(){let{h:a,pad:b}=this,c=new Uint16Array(10),d=a[1]>>>13;a[1]&=8191;for(let b=2;b<10;b++)a[b]+=d,d=a[b]>>>13,a[b]&=8191;a[0]+=5*d,d=a[0]>>>13,a[0]&=8191,a[1]+=d,d=a[1]>>>13,a[1]&=8191,a[2]+=d,c[0]=a[0]+5,d=c[0]>>>13,c[0]&=8191;for(let b=1;b<10;b++)c[b]=a[b]+d,d=c[b]>>>13,c[b]&=8191;c[9]-=8192;let e=(1^d)-1;for(let a=0;a<10;a++)c[a]&=e;e=~e;for(let b=0;b<10;b++)a[b]=a[b]&e|c[b];a[0]=(a[0]|a[1]<<13)&65535,a[1]=(a[1]>>>3|a[2]<<10)&65535,a[2]=(a[2]>>>6|a[3]<<7)&65535,a[3]=(a[3]>>>9|a[4]<<4)&65535,a[4]=(a[4]>>>12|a[5]<<1|a[6]<<14)&65535,a[5]=(a[6]>>>2|a[7]<<11)&65535,a[6]=(a[7]>>>5|a[8]<<8)&65535,a[7]=(a[8]>>>8|a[9]<<5)&65535;let f=a[0]+b[0];a[0]=65535&f;for(let c=1;c<8;c++)f=(a[c]+b[c]|0)+(f>>>16)|0,a[c]=65535&f;a6(c)}update(a){a_(this);let{buffer:b,blockLen:c}=this,d=(a=a2(a)).length;for(let e=0;e<d;){let f=Math.min(c-this.pos,d-e);if(f===c){for(;c<=d-e;e+=c)this.process(a,e);continue}b.set(a.subarray(e,e+f),this.pos),this.pos+=f,e+=f,this.pos===c&&(this.process(b,0,!1),this.pos=0)}return this}destroy(){a6(this.h,this.r,this.buffer,this.pad)}digestInto(a){a_(this),function(a,b){a$(a);let c=b.outputLen;if(a.length<c)throw Error("digestInto() expects output buffer of length at least "+c)}(a,this),this.finished=!0;let{buffer:b,h:c}=this,{pos:d}=this;if(d){for(b[d++]=1;d<16;d++)b[d]=0;this.process(b,0,!0)}this.finalize();let e=0;for(let b=0;b<8;b++)a[e++]=c[b]>>>0,a[e++]=c[b]>>>8;return a}digest(){let{buffer:a,outputLen:b}=this;this.digestInto(a);let c=a.slice(0,b);return this.destroy(),c}}let bi=function(a){let b=(b,c)=>a(c).update(a2(b)).digest(),c=a(new Uint8Array(32));return b.outputLen=c.outputLen,b.blockLen=c.blockLen,b.create=b=>a(b),b}(a=>new bh(a)),bj=function(a,b){let{allowShortKeys:c,extendNonceFn:d,counterLength:e,counterRight:f,rounds:g}=function(a,b){if(null==b||"object"!=typeof b)throw Error("options must be defined");return Object.assign(a,b)}({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},b);if("function"!=typeof a)throw Error("core must be a function");return aY(e),aY(g),a0(f),a0(c),(b,h,i,j,k=0)=>{a$(b),a$(h),a$(i);let l=i.length;if(void 0===j&&(j=new Uint8Array(l)),a$(j),aY(k),k<0||k>=be)throw Error("arx: counter overflow");if(j.length<l)throw Error(`arx: output (${j.length}) is shorter than data (${l})`);let m=[],o=b.length,p,q;if(32===o)m.push(p=a5(b)),q=bb;else if(16===o&&c)(p=new Uint8Array(32)).set(b),p.set(b,16),q=ba,m.push(p);else throw Error(`arx: invalid 32-byte key, got length=${o}`);bd(h)||m.push(h=a5(h));let r=a1(p);if(d){if(24!==h.length)throw Error("arx: extended nonce must be 24 bytes");d(q,r,a1(h.subarray(0,16)),r),h=h.subarray(16)}let s=16-e;if(s!==h.length)throw Error(`arx: nonce must be ${s} or 16 bytes`);if(12!==s){let a=new Uint8Array(12);a.set(h,f?0:12-h.length),h=a,m.push(h)}return function(a,b,c,d,e,f,g,h){let i=e.length,j=new Uint8Array(64),k=a1(j),l=bd(e)&&bd(f),m=l?a1(e):bf,o=l?a1(f):bf;for(let p=0;p<i;g++){if(a(b,c,d,k,g,h),g>=be)throw Error("arx: counter overflow");let q=Math.min(64,i-p);if(l&&64===q){let a=p/4;if(p%4!=0)throw Error("arx: invalid block position");for(let b=0,c;b<16;b++)o[c=a+b]=m[c]^k[b];p+=64;continue}for(let a=0,b;a<q;a++)f[b=p+a]=e[b]^j[a];p+=q}}(a,q,r,a1(h),i,j,k,g),a6(...m),j}}(function(a,b,c,d,e,f=20){let g=a[0],h=a[1],i=a[2],j=a[3],k=b[0],l=b[1],m=b[2],o=b[3],p=b[4],q=b[5],r=b[6],s=b[7],t=c[0],u=c[1],v=c[2],w=g,x=h,y=i,z=j,A=k,B=l,C=m,D=o,E=p,F=q,G=r,H=s,I=e,J=t,K=u,L=v;for(let a=0;a<f;a+=2)E=E+(I=bc(I^(w=w+A|0),16))|0,w=w+(A=bc(A^E,12))|0,E=E+(I=bc(I^w,8))|0,A=bc(A^E,7),F=F+(J=bc(J^(x=x+B|0),16))|0,x=x+(B=bc(B^F,12))|0,F=F+(J=bc(J^x,8))|0,B=bc(B^F,7),G=G+(K=bc(K^(y=y+C|0),16))|0,y=y+(C=bc(C^G,12))|0,G=G+(K=bc(K^y,8))|0,C=bc(C^G,7),H=H+(L=bc(L^(z=z+D|0),16))|0,z=z+(D=bc(D^H,12))|0,H=H+(L=bc(L^z,8))|0,D=bc(D^H,7),G=G+(L=bc(L^(w=w+B|0),16))|0,w=w+(B=bc(B^G,12))|0,G=G+(L=bc(L^w,8))|0,B=bc(B^G,7),H=H+(I=bc(I^(x=x+C|0),16))|0,x=x+(C=bc(C^H,12))|0,H=H+(I=bc(I^x,8))|0,C=bc(C^H,7),E=E+(J=bc(J^(y=y+D|0),16))|0,y=y+(D=bc(D^E,12))|0,E=E+(J=bc(J^y,8))|0,D=bc(D^E,7),F=F+(K=bc(K^(z=z+A|0),16))|0,z=z+(A=bc(A^F,12))|0,F=F+(K=bc(K^z,8))|0,A=bc(A^F,7);let M=0;d[M++]=g+w|0,d[M++]=h+x|0,d[M++]=i+y|0,d[M++]=j+z|0,d[M++]=k+A|0,d[M++]=l+B|0,d[M++]=m+C|0,d[M++]=o+D|0,d[M++]=p+E|0,d[M++]=q+F|0,d[M++]=r+G|0,d[M++]=s+H|0,d[M++]=e+I|0,d[M++]=t+J|0,d[M++]=u+K|0,d[M++]=v+L|0},{counterRight:!1,counterLength:4,allowShortKeys:!1}),bk=new Uint8Array(16),bl=(a,b)=>{a.update(b);let c=b.length%16;c&&a.update(bk.subarray(c))},bm=new Uint8Array(32);function bn(a,b,c,d,e){let f=a(b,c,bm),g=bi.create(f);e&&bl(g,e),bl(g,d);let h=new Uint8Array(16),i=new DataView(h.buffer,h.byteOffset,h.byteLength);a4(i,0,BigInt(e?e.length:0),!0),a4(i,8,BigInt(d.length),!0),g.update(h);let j=g.digest();return a6(f,h),j}let bo=((a,b)=>{function c(d,...e){if(a$(d),void 0!==a.nonceLength){let b=e[0];if(!b)throw Error("nonce / iv required");a.varSizeNonce?a$(b):a$(b,a.nonceLength)}let f=a.tagLength;f&&void 0!==e[1]&&a$(e[1]);let g=b(d,...e),h=(a,b)=>{if(void 0!==b){if(2!==a)throw Error("cipher output not supported");a$(b)}},i=!1;return{encrypt(a,b){if(i)throw Error("cannot encrypt() twice with same key + nonce");return i=!0,a$(a),h(g.encrypt.length,b),g.encrypt(a,b)},decrypt(a,b){if(a$(a),f&&a.length<f)throw Error("invalid ciphertext length: smaller than tagLength="+f);return h(g.decrypt.length,b),g.decrypt(a,b)}}}return Object.assign(c,a),c})({blockSize:64,nonceLength:12,tagLength:16},(a=>(b,c,d)=>({encrypt(e,f){let g=e.length;(f=a3(g+16,f,!1)).set(e);let h=f.subarray(0,-16);a(b,c,h,h,1);let i=bn(a,b,c,h,d);return f.set(i,g),a6(i),f},decrypt(e,f){f=a3(e.length-16,f,!1);let g=e.subarray(0,-16),h=e.subarray(-16),i=bn(a,b,c,g,d);if(!function(a,b){if(a.length!==b.length)return!1;let c=0;for(let d=0;d<a.length;d++)c|=a[d]^b[d];return 0===c}(h,i))throw Error("invalid tag");return f.set(e.subarray(0,-16)),a(b,c,f,f,1),a6(i),f}}))(bj));class bp extends ak{constructor(a,b){super(),this.finished=!1,this.destroyed=!1,_(a);let c=aj(b);if(this.iHash=a.create(),"function"!=typeof this.iHash.update)throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let d=this.blockLen,e=new Uint8Array(d);e.set(c.length>d?a.create().update(c).digest():c);for(let a=0;a<e.length;a++)e[a]^=54;this.iHash.update(e),this.oHash=a.create();for(let a=0;a<e.length;a++)e[a]^=106;this.oHash.update(e),e.fill(0)}update(a){return aa(this),this.iHash.update(a),this}digestInto(a){aa(this),$(a,this.outputLen),this.finished=!0,this.iHash.digestInto(a),this.oHash.update(a),this.oHash.digestInto(a),this.destroy()}digest(){let a=new Uint8Array(this.oHash.outputLen);return this.digestInto(a),a}_cloneInto(a){a||(a=Object.create(Object.getPrototypeOf(this),{}));let{oHash:b,iHash:c,finished:d,destroyed:e,blockLen:f,outputLen:g}=this;return a.finished=d,a.destroyed=e,a.blockLen=f,a.outputLen=g,a.oHash=b._cloneInto(a.oHash),a.iHash=c._cloneInto(a.iHash),a}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}let bq=(a,b,c)=>new bp(a,b).update(c).digest();bq.create=(a,b)=>new bp(a,b);let br=new Uint8Array([0]),bs=new Uint8Array;class bt extends ak{constructor(a,b,c,d){super(),this.blockLen=a,this.outputLen=b,this.padOffset=c,this.isLE=d,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(a),this.view=af(this.buffer)}update(a){aa(this);let{view:b,buffer:c,blockLen:d}=this,e=(a=aj(a)).length;for(let f=0;f<e;){let g=Math.min(d-this.pos,e-f);if(g===d){let b=af(a);for(;d<=e-f;f+=d)this.process(b,f);continue}c.set(a.subarray(f,f+g),this.pos),this.pos+=g,f+=g,this.pos===d&&(this.process(b,0),this.pos=0)}return this.length+=a.length,this.roundClean(),this}digestInto(a){aa(this),ab(a,this),this.finished=!0;let{buffer:b,view:c,blockLen:d,isLE:e}=this,{pos:f}=this;b[f++]=128,this.buffer.subarray(f).fill(0),this.padOffset>d-f&&(this.process(c,0),f=0);for(let a=f;a<d;a++)b[a]=0;(function(a,b,c,d){if("function"==typeof a.setBigUint64)return a.setBigUint64(b,c,d);let e=BigInt(32),f=BigInt(0xffffffff),g=Number(c>>e&f),h=Number(c&f),i=4*!!d,j=4*!d;a.setUint32(b+i,g,d),a.setUint32(b+j,h,d)})(c,d-8,BigInt(8*this.length),e),this.process(c,0);let g=af(a),h=this.outputLen;if(h%4)throw Error("_sha2: outputLen should be aligned to 32bit");let i=h/4,j=this.get();if(i>j.length)throw Error("_sha2: outputLen bigger than state");for(let a=0;a<i;a++)g.setUint32(4*a,j[a],e)}digest(){let{buffer:a,outputLen:b}=this;this.digestInto(a);let c=a.slice(0,b);return this.destroy(),c}_cloneInto(a){a||(a=new this.constructor),a.set(...this.get());let{blockLen:b,buffer:c,length:d,finished:e,destroyed:f,pos:g}=this;return a.length=d,a.pos=g,a.finished=e,a.destroyed=f,d%b&&a.buffer.set(c),a}}let bu=new Uint32Array([0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,0xe49b69c1,0xefbe4786,0xfc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x6ca6351,0x14292967,0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2]),bv=new Uint32Array([0x6a09e667,0xbb67ae85,0x3c6ef372,0xa54ff53a,0x510e527f,0x9b05688c,0x1f83d9ab,0x5be0cd19]),bw=new Uint32Array(64);class bx extends bt{constructor(){super(64,32,8,!1),this.A=0|bv[0],this.B=0|bv[1],this.C=0|bv[2],this.D=0|bv[3],this.E=0|bv[4],this.F=0|bv[5],this.G=0|bv[6],this.H=0|bv[7]}get(){let{A:a,B:b,C:c,D:d,E:e,F:f,G:g,H:h}=this;return[a,b,c,d,e,f,g,h]}set(a,b,c,d,e,f,g,h){this.A=0|a,this.B=0|b,this.C=0|c,this.D=0|d,this.E=0|e,this.F=0|f,this.G=0|g,this.H=0|h}process(a,b){for(let c=0;c<16;c++,b+=4)bw[c]=a.getUint32(b,!1);for(let a=16;a<64;a++){let b=bw[a-15],c=bw[a-2],d=ag(b,7)^ag(b,18)^b>>>3,e=ag(c,17)^ag(c,19)^c>>>10;bw[a]=e+bw[a-7]+d+bw[a-16]|0}let{A:c,B:d,C:e,D:f,E:g,F:h,G:i,H:j}=this;for(let a=0;a<64;a++){var k,l,m,o;let b=j+(ag(g,6)^ag(g,11)^ag(g,25))+((k=g)&h^~k&i)+bu[a]+bw[a]|0,p=(ag(c,2)^ag(c,13)^ag(c,22))+((l=c)&(m=d)^l&(o=e)^m&o)|0;j=i,i=h,h=g,g=f+b|0,f=e,e=d,d=c,c=b+p|0}c=c+this.A|0,d=d+this.B|0,e=e+this.C|0,f=f+this.D|0,g=g+this.E|0,h=h+this.F|0,i=i+this.G|0,j=j+this.H|0,this.set(c,d,e,f,g,h,i,j)}roundClean(){bw.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}let by=al(()=>new bx),bz=BigInt(0),bA=BigInt(1),bB=BigInt(2);function bC(a){return a instanceof Uint8Array||ArrayBuffer.isView(a)&&"Uint8Array"===a.constructor.name}function bD(a){if(!bC(a))throw Error("Uint8Array expected")}function bE(a,b){if("boolean"!=typeof b)throw Error(a+" boolean expected, got "+b)}let bF=Array.from({length:256},(a,b)=>b.toString(16).padStart(2,"0"));function bG(a){bD(a);let b="";for(let c=0;c<a.length;c++)b+=bF[a[c]];return b}function bH(a){let b=a.toString(16);return 1&b.length?"0"+b:b}function bI(a){if("string"!=typeof a)throw Error("hex string expected, got "+typeof a);return""===a?bz:BigInt("0x"+a)}let bJ={_0:48,_9:57,A:65,F:70,a:97,f:102};function bK(a){return a>=bJ._0&&a<=bJ._9?a-bJ._0:a>=bJ.A&&a<=bJ.F?a-(bJ.A-10):a>=bJ.a&&a<=bJ.f?a-(bJ.a-10):void 0}function bL(a){if("string"!=typeof a)throw Error("hex string expected, got "+typeof a);let b=a.length,c=b/2;if(b%2)throw Error("hex string expected, got unpadded hex of length "+b);let d=new Uint8Array(c);for(let b=0,e=0;b<c;b++,e+=2){let c=bK(a.charCodeAt(e)),f=bK(a.charCodeAt(e+1));if(void 0===c||void 0===f)throw Error('hex string expected, got non-hex character "'+(a[e]+a[e+1])+'" at index '+e);d[b]=16*c+f}return d}function bM(a){return bI(bG(a))}function bN(a){return bD(a),bI(bG(Uint8Array.from(a).reverse()))}function bO(a,b){return bL(a.toString(16).padStart(2*b,"0"))}function bP(a,b){return bO(a,b).reverse()}function bQ(a,b,c){let d;if("string"==typeof b)try{d=bL(b)}catch(b){throw Error(a+" must be hex string or Uint8Array, cause: "+b)}else if(bC(b))d=Uint8Array.from(b);else throw Error(a+" must be hex string or Uint8Array");let e=d.length;if("number"==typeof c&&e!==c)throw Error(a+" of length "+c+" expected, got "+e);return d}function bR(...a){let b=0;for(let c=0;c<a.length;c++){let d=a[c];bD(d),b+=d.length}let c=new Uint8Array(b);for(let b=0,d=0;b<a.length;b++){let e=a[b];c.set(e,d),d+=e.length}return c}let bS=a=>"bigint"==typeof a&&bz<=a;function bT(a,b,c){return bS(a)&&bS(b)&&bS(c)&&b<=a&&a<c}function bU(a,b,c,d){if(!bT(b,c,d))throw Error("expected valid "+a+": "+c+" <= n < "+d+", got "+b)}function bV(a){let b;for(b=0;a>bz;a>>=bA,b+=1);return b}let bW=a=>(bB<<BigInt(a-1))-bA,bX=a=>new Uint8Array(a),bY=a=>Uint8Array.from(a);function bZ(a,b,c){if("number"!=typeof a||a<2)throw Error("hashLen must be a number");if("number"!=typeof b||b<2)throw Error("qByteLen must be a number");if("function"!=typeof c)throw Error("hmacFn must be a function");let d=bX(a),e=bX(a),f=0,g=()=>{d.fill(1),e.fill(0),f=0},h=(...a)=>c(e,d,...a),i=(a=bX())=>{e=h(bY([0]),a),d=h(),0!==a.length&&(e=h(bY([1]),a),d=h())},j=()=>{if(f++>=1e3)throw Error("drbg: tried 1000 values");let a=0,c=[];for(;a<b;){let b=(d=h()).slice();c.push(b),a+=d.length}return bR(...c)};return(a,b)=>{let c;for(g(),i(a);!(c=b(j()));)i();return g(),c}}let b$={bigint:a=>"bigint"==typeof a,function:a=>"function"==typeof a,boolean:a=>"boolean"==typeof a,string:a=>"string"==typeof a,stringOrUint8Array:a=>"string"==typeof a||bC(a),isSafeInteger:a=>Number.isSafeInteger(a),array:a=>Array.isArray(a),field:(a,b)=>b.Fp.isValid(a),hash:a=>"function"==typeof a&&Number.isSafeInteger(a.outputLen)};function b_(a,b,c={}){let d=(b,c,d)=>{let e=b$[c];if("function"!=typeof e)throw Error("invalid validator function");let f=a[b];if(!(d&&void 0===f)&&!e(f,a))throw Error("param "+String(b)+" is invalid. Expected "+c+", got "+f)};for(let[a,c]of Object.entries(b))d(a,c,!1);for(let[a,b]of Object.entries(c))d(a,b,!0);return a}function b0(a){let b=new WeakMap;return(c,...d)=>{let e=b.get(c);if(void 0!==e)return e;let f=a(c,...d);return b.set(c,f),f}}var b1=Object.freeze({__proto__:null,isBytes:bC,abytes:bD,abool:bE,bytesToHex:bG,numberToHexUnpadded:bH,hexToNumber:bI,hexToBytes:bL,bytesToNumberBE:bM,bytesToNumberLE:bN,numberToBytesBE:bO,numberToBytesLE:bP,numberToVarBytesBE:function(a){return bL(bH(a))},ensureBytes:bQ,concatBytes:bR,equalBytes:function(a,b){if(a.length!==b.length)return!1;let c=0;for(let d=0;d<a.length;d++)c|=a[d]^b[d];return 0===c},utf8ToBytes:function(a){if("string"!=typeof a)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(a))},inRange:bT,aInRange:bU,bitLen:bV,bitGet:function(a,b){return a>>BigInt(b)&bA},bitSet:function(a,b,c){return a|(c?bA:bz)<<BigInt(b)},bitMask:bW,createHmacDrbg:bZ,validateObject:b_,notImplemented:()=>{throw Error("not implemented")},memoized:b0});let b2=BigInt(0),b3=BigInt(1),b4=BigInt(2),b5=BigInt(3),b6=BigInt(4),b7=BigInt(5),b8=BigInt(8);function b9(a,b){let c=a%b;return c>=b2?c:b+c}function ca(a,b,c){if(b<b2)throw Error("invalid exponent, negatives unsupported");if(c<=b2)throw Error("invalid modulus");if(c===b3)return b2;let d=b3;for(;b>b2;)b&b3&&(d=d*a%c),a=a*a%c,b>>=b3;return d}function cb(a,b,c){let d=a;for(;b-- >b2;)d*=d,d%=c;return d}function cc(a,b){if(a===b2)throw Error("invert: expected non-zero number");if(b<=b2)throw Error("invert: expected positive modulus, got "+b);let c=b9(a,b),d=b,e=b2,f=b3;for(;c!==b2;){let a=d/c,b=d%c,g=e-f*a;d=c,c=b,e=f,f=g}if(d!==b3)throw Error("invert: does not exist");return b9(e,b)}let cd=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function ce(a,b){let c=void 0!==b?b:a.toString(2).length,d=Math.ceil(c/8);return{nBitLength:c,nByteLength:d}}function cf(a,b,c=!1,d={}){let e;if(a<=b2)throw Error("invalid field: expected ORDER > 0, got "+a);let{nBitLength:f,nByteLength:g}=ce(a,b);if(g>2048)throw Error("invalid field: expected ORDER of <= 2048 bytes");let h=Object.freeze({ORDER:a,isLE:c,BITS:f,BYTES:g,MASK:bW(f),ZERO:b2,ONE:b3,create:b=>b9(b,a),isValid:b=>{if("bigint"!=typeof b)throw Error("invalid field element: expected bigint, got "+typeof b);return b2<=b&&b<a},is0:a=>a===b2,isOdd:a=>(a&b3)===b3,neg:b=>b9(-b,a),eql:(a,b)=>a===b,sqr:b=>b9(b*b,a),add:(b,c)=>b9(b+c,a),sub:(b,c)=>b9(b-c,a),mul:(b,c)=>b9(b*c,a),pow:(a,b)=>(function(a,b,c){if(c<b2)throw Error("invalid exponent, negatives unsupported");if(c===b2)return a.ONE;if(c===b3)return b;let d=a.ONE,e=b;for(;c>b2;)c&b3&&(d=a.mul(d,e)),e=a.sqr(e),c>>=b3;return d})(h,a,b),div:(b,c)=>b9(b*cc(c,a),a),sqrN:a=>a*a,addN:(a,b)=>a+b,subN:(a,b)=>a-b,mulN:(a,b)=>a*b,inv:b=>cc(b,a),sqrt:d.sqrt||(b=>(e||(e=function(a){if(a%b6===b5){let b=(a+b3)/b6;return function(a,c){let d=a.pow(c,b);if(!a.eql(a.sqr(d),c))throw Error("Cannot find square root");return d}}if(a%b8===b7){let b=(a-b7)/b8;return function(a,c){let d=a.mul(c,b4),e=a.pow(d,b),f=a.mul(c,e),g=a.mul(a.mul(f,b4),e),h=a.mul(f,a.sub(g,a.ONE));if(!a.eql(a.sqr(h),c))throw Error("Cannot find square root");return h}}return function(a){let b,c,d,e=(a-b3)/b4;for(b=a-b3,c=0;b%b4===b2;b/=b4,c++);for(d=b4;d<a&&ca(d,e,a)!==a-b3;d++)if(d>1e3)throw Error("Cannot find square root: likely non-prime P");if(1===c){let b=(a+b3)/b6;return function(a,c){let d=a.pow(c,b);if(!a.eql(a.sqr(d),c))throw Error("Cannot find square root");return d}}let f=(b+b3)/b4;return function(a,g){if(a.pow(g,e)===a.neg(a.ONE))throw Error("Cannot find square root");let h=c,i=a.pow(a.mul(a.ONE,d),b),j=a.pow(g,f),k=a.pow(g,b);for(;!a.eql(k,a.ONE);){if(a.eql(k,a.ZERO))return a.ZERO;let b=1;for(let c=a.sqr(k);b<h&&!a.eql(c,a.ONE);b++)c=a.sqr(c);let c=a.pow(i,b3<<BigInt(h-b-1));i=a.sqr(c),j=a.mul(j,c),k=a.mul(k,i),h=b}return j}}(a)}(a)),e(h,b))),invertBatch:a=>(function(a,b){let c=Array(b.length),d=b.reduce((b,d,e)=>a.is0(d)?b:(c[e]=b,a.mul(b,d)),a.ONE),e=a.inv(d);return b.reduceRight((b,d,e)=>a.is0(d)?b:(c[e]=a.mul(b,c[e]),a.mul(b,d)),e),c})(h,a),cmov:(a,b,c)=>c?b:a,toBytes:a=>c?bP(a,g):bO(a,g),fromBytes:a=>{if(a.length!==g)throw Error("Field.fromBytes: expected "+g+" bytes, got "+a.length);return c?bN(a):bM(a)}});return Object.freeze(h)}function cg(a){if("bigint"!=typeof a)throw Error("field order must be bigint");return Math.ceil(a.toString(2).length/8)}function ch(a){let b=cg(a);return b+Math.ceil(b/2)}let ci=BigInt(0),cj=BigInt(1);function ck(a,b){let c=b.negate();return a?c:b}function cl(a,b){if(!Number.isSafeInteger(a)||a<=0||a>b)throw Error("invalid window size, expected [1.."+b+"], got W="+a)}function cm(a,b){return cl(a,b),{windows:Math.ceil(b/a)+1,windowSize:2**(a-1)}}let cn=new WeakMap,co=new WeakMap;function cp(a){return co.get(a)||1}function cq(a){return b_(a.Fp,cd.reduce((a,b)=>(a[b]="function",a),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"})),b_(a,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...ce(a.n,a.nBitLength),...a,p:a.Fp.ORDER})}BigInt(0),BigInt(1),BigInt(2),BigInt(8);let cr=BigInt(0),cs=BigInt(1),ct=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949");BigInt(0);let cu=BigInt(1),cv=BigInt(2),cw=BigInt(3),cx=BigInt(5);BigInt(8);let cy=function(a){let b=(b_(a,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...a})),{P:c}=b,d=a=>b9(a,c),e=b.montgomeryBits,f=Math.ceil(e/8),g=b.nByteLength,h=b.adjustScalarBytes||(a=>a),i=b.powPminus2||(a=>ca(a,c-BigInt(2),c));function j(a,b,c){let e=d(a*(b-c));return[b=d(b-e),c=d(c+e)]}let k=(b.a-BigInt(2))/BigInt(4);function l(a,b){let l=function(a,b){bU("u",a,cr,c),bU("scalar",b,cr,c);let f=cs,g=cr,h=a,l=cs,m=cr,o;for(let c=BigInt(e-1);c>=cr;c--){let e=b>>c&cs;m^=e,f=(o=j(m,f,h))[0],h=o[1],g=(o=j(m,g,l))[0],l=o[1],m=e;let i=f+g,p=d(i*i),q=f-g,r=d(q*q),s=p-r,t=h+l,u=d((h-l)*i),v=d(t*q),w=u+v,x=u-v;h=d(w*w),l=d(a*d(x*x)),f=d(p*r),g=d(s*(p+d(k*s)))}return f=(o=j(m,f,h))[0],h=o[1],g=(o=j(m,g,l))[0],l=o[1],d(f*i(g))}(function(a){let b=bQ("u coordinate",a,f);return 32===g&&(b[31]&=127),bN(b)}(b),function(a){let b=bQ("scalar",a),c=b.length;if(c!==f&&c!==g)throw Error("invalid scalar, expected "+(""+f+" or ")+g+" bytes, got "+c);return bN(h(b))}(a));if(l===cr)throw Error("invalid private or public key received");return bP(d(l),f)}let m=bP(d(b.Gu),f);function o(a){return l(a,m)}return{scalarMult:l,scalarMultBase:o,getSharedSecret:(a,b)=>l(a,b),getPublicKey:a=>o(a),utils:{randomPrivateKey:()=>b.randomBytes(b.nByteLength)},GuBytes:m}}({P:ct,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:a=>{let{pow_p_5_8:b,b2:c}=function(a){let b=BigInt(10),c=BigInt(20),d=BigInt(40),e=BigInt(80),f=a*a%ct*a%ct,g=cb(f,cv,ct)*f%ct,h=cb(g,cu,ct)*a%ct,i=cb(h,cx,ct)*h%ct,j=cb(i,b,ct)*i%ct,k=cb(j,c,ct)*j%ct,l=cb(k,d,ct)*k%ct,m=cb(l,e,ct)*l%ct,o=cb(m,e,ct)*l%ct,p=cb(o,b,ct)*i%ct;return{pow_p_5_8:cb(p,cv,ct)*a%ct,b2:f}}(a);return b9(cb(b,cw,ct)*c,ct)},adjustScalarBytes:function(a){return a[0]&=248,a[31]&=127,a[31]|=64,a},randomBytes:am});function cz(a){void 0!==a.lowS&&bE("lowS",a.lowS),void 0!==a.prehash&&bE("prehash",a.prehash)}let{bytesToNumberBE:cA,hexToBytes:cB}=b1;class cC extends Error{constructor(a=""){super(a)}}let cD={Err:cC,_tlv:{encode:(a,b)=>{let{Err:c}=cD;if(a<0||a>256)throw new c("tlv.encode: wrong tag");if(1&b.length)throw new c("tlv.encode: unpadded data");let d=b.length/2,e=bH(d);if(e.length/2&128)throw new c("tlv.encode: long form length too big");let f=d>127?bH(e.length/2|128):"";return bH(a)+f+e+b},decode(a,b){let{Err:c}=cD,d=0;if(a<0||a>256)throw new c("tlv.encode: wrong tag");if(b.length<2||b[d++]!==a)throw new c("tlv.decode: wrong tlv");let e=b[d++],f=0;if(128&e){let a=127&e;if(!a)throw new c("tlv.decode(long): indefinite length not supported");if(a>4)throw new c("tlv.decode(long): byte length is too big");let g=b.subarray(d,d+a);if(g.length!==a)throw new c("tlv.decode: length bytes not complete");if(0===g[0])throw new c("tlv.decode(long): zero leftmost byte");for(let a of g)f=f<<8|a;if(d+=a,f<128)throw new c("tlv.decode(long): not minimal encoding")}else f=e;let g=b.subarray(d,d+f);if(g.length!==f)throw new c("tlv.decode: wrong value length");return{v:g,l:b.subarray(d+f)}}},_int:{encode(a){let{Err:b}=cD;if(a<cE)throw new b("integer: negative integers are not allowed");let c=bH(a);if(8&Number.parseInt(c[0],16)&&(c="00"+c),1&c.length)throw new b("unexpected DER parsing assertion: unpadded hex");return c},decode(a){let{Err:b}=cD;if(128&a[0])throw new b("invalid signature integer: negative");if(0===a[0]&&!(128&a[1]))throw new b("invalid signature integer: unnecessary leading zero");return cA(a)}},toSig(a){let{Err:b,_int:c,_tlv:d}=cD,e="string"==typeof a?cB(a):a;bD(e);let{v:f,l:g}=d.decode(48,e);if(g.length)throw new b("invalid signature: left bytes after parsing");let{v:h,l:i}=d.decode(2,f),{v:j,l:k}=d.decode(2,i);if(k.length)throw new b("invalid signature: left bytes after parsing");return{r:c.decode(h),s:c.decode(j)}},hexFromSig(a){let{_tlv:b,_int:c}=cD,d=b.encode(2,c.encode(a.r)),e=b.encode(2,c.encode(a.s));return b.encode(48,d+e)}},cE=BigInt(0),cF=BigInt(1);BigInt(2);let cG=BigInt(3);BigInt(4);let cH=cf(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),cI=function(a,b){let c=b=>(function(a){let b=function(a){let b=cq(a);return b_(b,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...b})}(a),{Fp:c,n:d}=b,e=c.BYTES+1,f=2*c.BYTES+1;function g(a){return b9(a,d)}let{ProjectivePoint:h,normPrivateKeyToScalar:i,weierstrassEquation:j,isWithinCurveOrder:k}=function(a){var b;let c=function(a){let b=cq(a);b_(b,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:c,Fp:d,a:e}=b;if(c){if(!d.eql(e,d.ZERO))throw Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if("object"!=typeof c||"bigint"!=typeof c.beta||"function"!=typeof c.splitScalar)throw Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...b})}(a),{Fp:d}=c,e=cf(c.n,c.nBitLength),f=c.toBytes||((a,b,c)=>{let e=b.toAffine();return bR(Uint8Array.from([4]),d.toBytes(e.x),d.toBytes(e.y))}),g=c.fromBytes||(a=>{let b=a.subarray(1);return{x:d.fromBytes(b.subarray(0,d.BYTES)),y:d.fromBytes(b.subarray(d.BYTES,2*d.BYTES))}});function h(a){let{a:b,b:e}=c,f=d.sqr(a),g=d.mul(f,a);return d.add(d.add(g,d.mul(a,b)),e)}if(!d.eql(d.sqr(c.Gy),h(c.Gx)))throw Error("bad generator point: equation left != right");function i(a){let b,{allowedPrivateKeyLengths:d,nByteLength:e,wrapPrivateKey:f,n:g}=c;if(d&&"bigint"!=typeof a){if(bC(a)&&(a=bG(a)),"string"!=typeof a||!d.includes(a.length))throw Error("invalid private key");a=a.padStart(2*e,"0")}try{b="bigint"==typeof a?a:bM(bQ("private key",a,e))}catch{throw Error("invalid private key, expected hex or "+e+" bytes, got "+typeof a)}return f&&(b=b9(b,g)),bU("private key",b,cF,g),b}function j(a){if(!(a instanceof m))throw Error("ProjectivePoint expected")}let k=b0((a,b)=>{let{px:c,py:e,pz:f}=a;if(d.eql(f,d.ONE))return{x:c,y:e};let g=a.is0();null==b&&(b=g?d.ONE:d.inv(f));let h=d.mul(c,b),i=d.mul(e,b),j=d.mul(f,b);if(g)return{x:d.ZERO,y:d.ZERO};if(!d.eql(j,d.ONE))throw Error("invZ was invalid");return{x:h,y:i}}),l=b0(a=>{if(a.is0()){if(c.allowInfinityPoint&&!d.is0(a.py))return;throw Error("bad point: ZERO")}let{x:b,y:e}=a.toAffine();if(!d.isValid(b)||!d.isValid(e))throw Error("bad point: x or y not FE");let f=d.sqr(e),g=h(b);if(!d.eql(f,g))throw Error("bad point: equation left != right");if(!a.isTorsionFree())throw Error("bad point: not in prime-order subgroup");return!0});class m{constructor(a,b,c){if(this.px=a,this.py=b,this.pz=c,null==a||!d.isValid(a))throw Error("x required");if(null==b||!d.isValid(b))throw Error("y required");if(null==c||!d.isValid(c))throw Error("z required");Object.freeze(this)}static fromAffine(a){let{x:b,y:c}=a||{};if(!a||!d.isValid(b)||!d.isValid(c))throw Error("invalid affine point");if(a instanceof m)throw Error("projective point not allowed");let e=a=>d.eql(a,d.ZERO);return e(b)&&e(c)?m.ZERO:new m(b,c,d.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(a){let b=d.invertBatch(a.map(a=>a.pz));return a.map((a,c)=>a.toAffine(b[c])).map(m.fromAffine)}static fromHex(a){let b=m.fromAffine(g(bQ("pointHex",a)));return b.assertValidity(),b}static fromPrivateKey(a){return m.BASE.multiply(i(a))}static msm(a,b){return function(a,b,c,d){if(function(a,b){if(!Array.isArray(a))throw Error("array expected");a.forEach((a,c)=>{if(!(a instanceof b))throw Error("invalid point at index "+c)})}(c,a),function(a,b){if(!Array.isArray(a))throw Error("array of scalars expected");a.forEach((a,c)=>{if(!b.isValid(a))throw Error("invalid scalar at index "+c)})}(d,b),c.length!==d.length)throw Error("arrays of points and scalars must have equal length");let e=a.ZERO,f=bV(BigInt(c.length)),g=f>12?f-3:f>4?f-2:f?2:1,h=(1<<g)-1,i=Array(h+1).fill(e),j=Math.floor((b.BITS-1)/g)*g,k=e;for(let a=j;a>=0;a-=g){i.fill(e);for(let b=0;b<d.length;b++){let e=Number(d[b]>>BigInt(a)&BigInt(h));i[e]=i[e].add(c[b])}let b=e;for(let a=i.length-1,c=e;a>0;a--)c=c.add(i[a]),b=b.add(c);if(k=k.add(b),0!==a)for(let a=0;a<g;a++)k=k.double()}return k}(m,e,a,b)}_setWindowSize(a){p.setWindowSize(this,a)}assertValidity(){l(this)}hasEvenY(){let{y:a}=this.toAffine();if(d.isOdd)return!d.isOdd(a);throw Error("Field doesn't support isOdd")}equals(a){j(a);let{px:b,py:c,pz:e}=this,{px:f,py:g,pz:h}=a,i=d.eql(d.mul(b,h),d.mul(f,e)),k=d.eql(d.mul(c,h),d.mul(g,e));return i&&k}negate(){return new m(this.px,d.neg(this.py),this.pz)}double(){let{a:a,b:b}=c,e=d.mul(b,cG),{px:f,py:g,pz:h}=this,i=d.ZERO,j=d.ZERO,k=d.ZERO,l=d.mul(f,f),o=d.mul(g,g),p=d.mul(h,h),q=d.mul(f,g);return q=d.add(q,q),k=d.mul(f,h),k=d.add(k,k),i=d.mul(a,k),j=d.mul(e,p),j=d.add(i,j),i=d.sub(o,j),j=d.add(o,j),j=d.mul(i,j),i=d.mul(q,i),k=d.mul(e,k),p=d.mul(a,p),q=d.sub(l,p),q=d.mul(a,q),q=d.add(q,k),k=d.add(l,l),l=d.add(k,l),l=d.add(l,p),l=d.mul(l,q),j=d.add(j,l),p=d.mul(g,h),p=d.add(p,p),l=d.mul(p,q),i=d.sub(i,l),k=d.mul(p,o),k=d.add(k,k),new m(i,j,k=d.add(k,k))}add(a){j(a);let{px:b,py:e,pz:f}=this,{px:g,py:h,pz:i}=a,k=d.ZERO,l=d.ZERO,o=d.ZERO,p=c.a,q=d.mul(c.b,cG),r=d.mul(b,g),s=d.mul(e,h),t=d.mul(f,i),u=d.add(b,e),v=d.add(g,h);u=d.mul(u,v),v=d.add(r,s),u=d.sub(u,v),v=d.add(b,f);let w=d.add(g,i);return v=d.mul(v,w),w=d.add(r,t),v=d.sub(v,w),w=d.add(e,f),k=d.add(h,i),w=d.mul(w,k),k=d.add(s,t),w=d.sub(w,k),o=d.mul(p,v),k=d.mul(q,t),o=d.add(k,o),k=d.sub(s,o),o=d.add(s,o),l=d.mul(k,o),s=d.add(r,r),s=d.add(s,r),t=d.mul(p,t),v=d.mul(q,v),s=d.add(s,t),t=d.sub(r,t),t=d.mul(p,t),v=d.add(v,t),r=d.mul(s,v),l=d.add(l,r),r=d.mul(w,v),k=d.mul(u,k),k=d.sub(k,r),r=d.mul(u,s),o=d.mul(w,o),new m(k,l,o=d.add(o,r))}subtract(a){return this.add(a.negate())}is0(){return this.equals(m.ZERO)}wNAF(a){return p.wNAFCached(this,a,m.normalizeZ)}multiplyUnsafe(a){let{endo:b,n:e}=c;bU("scalar",a,cE,e);let f=m.ZERO;if(a===cE)return f;if(this.is0()||a===cF)return this;if(!b||p.hasPrecomputes(this))return p.wNAFCachedUnsafe(this,a,m.normalizeZ);let{k1neg:g,k1:h,k2neg:i,k2:j}=b.splitScalar(a),k=f,l=f,o=this;for(;h>cE||j>cE;)h&cF&&(k=k.add(o)),j&cF&&(l=l.add(o)),o=o.double(),h>>=cF,j>>=cF;return g&&(k=k.negate()),i&&(l=l.negate()),l=new m(d.mul(l.px,b.beta),l.py,l.pz),k.add(l)}multiply(a){let b,e,{endo:f,n:g}=c;if(bU("scalar",a,cF,g),f){let{k1neg:c,k1:g,k2neg:h,k2:i}=f.splitScalar(a),{p:j,f:k}=this.wNAF(g),{p:l,f:o}=this.wNAF(i);j=p.constTimeNegate(c,j),l=p.constTimeNegate(h,l),l=new m(d.mul(l.px,f.beta),l.py,l.pz),b=j.add(l),e=k.add(o)}else{let{p:c,f:d}=this.wNAF(a);b=c,e=d}return m.normalizeZ([b,e])[0]}multiplyAndAddUnsafe(a,b,c){let d=m.BASE,e=(a,b)=>b!==cE&&b!==cF&&a.equals(d)?a.multiply(b):a.multiplyUnsafe(b),f=e(this,b).add(e(a,c));return f.is0()?void 0:f}toAffine(a){return k(this,a)}isTorsionFree(){let{h:a,isTorsionFree:b}=c;if(a===cF)return!0;if(b)return b(m,this);throw Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:a,clearCofactor:b}=c;return a===cF?this:b?b(m,this):this.multiplyUnsafe(c.h)}toRawBytes(a=!0){return bE("isCompressed",a),this.assertValidity(),f(m,this,a)}toHex(a=!0){return bE("isCompressed",a),bG(this.toRawBytes(a))}}m.BASE=new m(c.Gx,c.Gy,d.ONE),m.ZERO=new m(d.ZERO,d.ONE,d.ZERO);let o=c.nBitLength,p=(b=c.endo?Math.ceil(o/2):o,{constTimeNegate:ck,hasPrecomputes:a=>1!==cp(a),unsafeLadder(a,b,c=m.ZERO){let d=a;for(;b>ci;)b&cj&&(c=c.add(d)),d=d.double(),b>>=cj;return c},precomputeWindow(a,c){let{windows:d,windowSize:e}=cm(c,b),f=[],g=a,h=g;for(let a=0;a<d;a++){h=g,f.push(h);for(let a=1;a<e;a++)h=h.add(g),f.push(h);g=h.double()}return f},wNAF(a,c,d){let{windows:e,windowSize:f}=cm(a,b),g=m.ZERO,h=m.BASE,i=BigInt(2**a-1),j=2**a,k=BigInt(a);for(let a=0;a<e;a++){let b=a*f,e=Number(d&i);d>>=k,e>f&&(e-=j,d+=cj);let l=b+Math.abs(e)-1,m=a%2!=0,o=e<0;0===e?h=h.add(ck(m,c[b])):g=g.add(ck(o,c[l]))}return{p:g,f:h}},wNAFUnsafe(a,c,d,e=m.ZERO){let{windows:f,windowSize:g}=cm(a,b),h=BigInt(2**a-1),i=2**a,j=BigInt(a);for(let a=0;a<f;a++){let b=a*g;if(d===ci)break;let f=Number(d&h);if(d>>=j,f>g&&(f-=i,d+=cj),0===f)continue;let k=c[b+Math.abs(f)-1];f<0&&(k=k.negate()),e=e.add(k)}return e},getPrecomputes(a,b,c){let d=cn.get(b);return d||(d=this.precomputeWindow(b,a),1!==a&&cn.set(b,c(d))),d},wNAFCached(a,b,c){let d=cp(a);return this.wNAF(d,this.getPrecomputes(d,a,c),b)},wNAFCachedUnsafe(a,b,c,d){let e=cp(a);return 1===e?this.unsafeLadder(a,b,d):this.wNAFUnsafe(e,this.getPrecomputes(e,a,c),b,d)},setWindowSize(a,c){cl(c,b),co.set(a,c),cn.delete(a)}});return{CURVE:c,ProjectivePoint:m,normPrivateKeyToScalar:i,weierstrassEquation:h,isWithinCurveOrder:function(a){return bT(a,cF,c.n)}}}({...b,toBytes(a,b,d){let e=b.toAffine(),f=c.toBytes(e.x);return bE("isCompressed",d),d?bR(Uint8Array.from([b.hasEvenY()?2:3]),f):bR(Uint8Array.from([4]),f,c.toBytes(e.y))},fromBytes(a){let b=a.length,d=a[0],g=a.subarray(1);if(b===e&&(2===d||3===d)){let a,b=bM(g);if(!bT(b,cF,c.ORDER))throw Error("Point is not on curve");let e=j(b);try{a=c.sqrt(e)}catch(a){throw Error("Point is not on curve"+(a instanceof Error?": "+a.message:""))}return(1&d)==1!=((a&cF)===cF)&&(a=c.neg(a)),{x:b,y:a}}if(b===f&&4===d)return{x:c.fromBytes(g.subarray(0,c.BYTES)),y:c.fromBytes(g.subarray(c.BYTES,2*c.BYTES))};throw Error("invalid Point, expected length of "+e+", or uncompressed "+f+", got "+b)}}),l=a=>bG(bO(a,b.nByteLength)),m=(a,b,c)=>bM(a.slice(b,c));class o{constructor(a,b,c){this.r=a,this.s=b,this.recovery=c,this.assertValidity()}static fromCompact(a){let c=b.nByteLength;return new o(m(a=bQ("compactSignature",a,2*c),0,c),m(a,c,2*c))}static fromDER(a){let{r:b,s:c}=cD.toSig(bQ("DER",a));return new o(b,c)}assertValidity(){bU("r",this.r,cF,d),bU("s",this.s,cF,d)}addRecoveryBit(a){return new o(this.r,this.s,a)}recoverPublicKey(a){let{r:e,s:f,recovery:i}=this,j=r(bQ("msgHash",a));if(null==i||![0,1,2,3].includes(i))throw Error("recovery id invalid");let k=2===i||3===i?e+b.n:e;if(k>=c.ORDER)throw Error("recovery id 2 or 3 invalid");let m=(1&i)==0?"02":"03",o=h.fromHex(m+l(k)),p=cc(k,d),q=g(-j*p),s=g(f*p),t=h.BASE.multiplyAndAddUnsafe(o,q,s);if(!t)throw Error("point at infinify");return t.assertValidity(),t}hasHighS(){return this.s>d>>cF}normalizeS(){return this.hasHighS()?new o(this.r,g(-this.s),this.recovery):this}toDERRawBytes(){return bL(this.toDERHex())}toDERHex(){return cD.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return bL(this.toCompactHex())}toCompactHex(){return l(this.r)+l(this.s)}}function p(a){let b=bC(a),c="string"==typeof a,d=(b||c)&&a.length;return b?d===e||d===f:c?d===2*e||d===2*f:a instanceof h}let q=b.bits2int||function(a){if(a.length>8192)throw Error("input is too large");let c=bM(a),d=8*a.length-b.nBitLength;return d>0?c>>BigInt(d):c},r=b.bits2int_modN||function(a){return g(q(a))},s=bW(b.nBitLength);function t(a){return bU("num < 2^"+b.nBitLength,a,cE,s),bO(a,b.nByteLength)}let u={lowS:b.lowS,prehash:!1},v={lowS:b.lowS,prehash:!1};return h.BASE._setWindowSize(8),{CURVE:b,getPublicKey:function(a,b=!0){return h.fromPrivateKey(a).toRawBytes(b)},getSharedSecret:function(a,b,c=!0){if(p(a))throw Error("first arg must be private key");if(!p(b))throw Error("second arg must be public key");return h.fromHex(b).multiply(i(a)).toRawBytes(c)},sign:function(a,e,f=u){let{seed:j,k2sig:l}=function(a,e,f=u){if(["recovered","canonical"].some(a=>a in f))throw Error("sign() legacy options not supported");let{hash:j,randomBytes:l}=b,{lowS:m,prehash:p,extraEntropy:s}=f;null==m&&(m=!0),a=bQ("msgHash",a),cz(f),p&&(a=bQ("prehashed msgHash",j(a)));let v=r(a),w=i(e),x=[t(w),t(v)];if(null!=s&&!1!==s){let a=!0===s?l(c.BYTES):s;x.push(bQ("extraEntropy",a))}return{seed:bR(...x),k2sig:function(a){var b;let c=q(a);if(!k(c))return;let e=cc(c,d),f=h.BASE.multiply(c).toAffine(),i=g(f.x);if(i===cE)return;let j=g(e*g(v+i*w));if(j===cE)return;let l=2*(f.x!==i)|Number(f.y&cF),p=j;return m&&j>d>>cF&&(p=(b=j)>d>>cF?g(-b):b,l^=1),new o(i,p,l)}}}(a,e,f);return bZ(b.hash.outputLen,b.nByteLength,b.hmac)(j,l)},verify:function(a,c,e,f=v){let i,j;c=bQ("msgHash",c),e=bQ("publicKey",e);let{lowS:k,prehash:l,format:m}=f;if(cz(f),"strict"in f)throw Error("options.strict was renamed to lowS");if(void 0!==m&&"compact"!==m&&"der"!==m)throw Error("format must be compact or der");let p="string"==typeof a||bC(a),q=!p&&!m&&"object"==typeof a&&null!==a&&"bigint"==typeof a.r&&"bigint"==typeof a.s;if(!p&&!q)throw Error("invalid signature, expected Uint8Array, hex string or Signature instance");try{if(q&&(i=new o(a.r,a.s)),p){try{"compact"!==m&&(i=o.fromDER(a))}catch(a){if(!(a instanceof cD.Err))throw a}i||"der"===m||(i=o.fromCompact(a))}j=h.fromHex(e)}catch{return!1}if(!i||k&&i.hasHighS())return!1;l&&(c=b.hash(c));let{r:s,s:t}=i,u=r(c),w=cc(t,d),x=g(u*w),y=g(s*w),z=h.BASE.multiplyAndAddUnsafe(j,x,y)?.toAffine();return!!z&&g(z.x)===s},ProjectivePoint:h,Signature:o,utils:{isValidPrivateKey(a){try{return i(a),!0}catch{return!1}},normPrivateKeyToScalar:i,randomPrivateKey:()=>{let a=ch(b.n);return function(a,b,c=!1){let d=a.length,e=cg(b),f=ch(b);if(d<16||d<f||d>1024)throw Error("expected "+f+"-1024 bytes of input, got "+d);let g=b9(c?bN(a):bM(a),b-b3)+b3;return c?bP(g,e):bO(g,e)}(b.randomBytes(a),b.n)},precompute:(a=8,b=h.BASE)=>(b._setWindowSize(a),b.multiply(BigInt(3)),b)}}})({...a,hash:b,hmac:(a,...c)=>bq(b,a,function(...a){let b=0;for(let c=0;c<a.length;c++){let d=a[c];$(d),b+=d.length}let c=new Uint8Array(b);for(let b=0,d=0;b<a.length;b++){let e=a[b];c.set(e,d),d+=e.length}return c}(...c)),randomBytes:am});return{...c(b),create:c}}({a:cH.create(BigInt("-3")),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Fp:cH,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},by),cJ="base10",cK="base16",cL="base64pad",cM="base64url",cN="utf8";function cO(){let a=am(32);return(0,m.dI)(a,cK)}function cP(a){let b=by((0,m.sH)(a,cK));return(0,m.dI)(b,cK)}function cQ(a){let b=by((0,m.sH)(a,cN));return(0,m.dI)(b,cK)}function cR(a){return(0,m.sH)(`${a}`,cJ)}function cS(a){return Number((0,m.dI)(a,cJ))}function cT(a){return a.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function cU(a){let b=a.replace(/-/g,"+").replace(/_/g,"/"),c=(4-b.length%4)%4;return b+"=".repeat(c)}function cV(a){if(2===cS(a.type))return(0,m.dI)((0,m.xW)([a.type,a.sealed]),cL);if(1===cS(a.type)){if(typeof a.senderPublicKey>"u")throw Error("Missing sender public key for type 1 envelope");return(0,m.dI)((0,m.xW)([a.type,a.senderPublicKey,a.iv,a.sealed]),cL)}return(0,m.dI)((0,m.xW)([a.type,a.iv,a.sealed]),cL)}function cW(a){let b=(a.encoding||cL)===cM?cU(a.encoded):a.encoded,c=(0,m.sH)(b,cL),d=c.slice(0,1);if(1===cS(d)){let a=c.slice(1,33),b=c.slice(33,45);return{type:d,sealed:c.slice(45),iv:b,senderPublicKey:a}}if(2===cS(d))return{type:d,sealed:c.slice(1),iv:am(12)};let e=c.slice(1,13);return{type:d,sealed:c.slice(13),iv:e}}function cX(a){let b=a?.type||0;if(1===b){if(typeof a?.senderPublicKey>"u")throw Error("missing sender public key");if(typeof a?.receiverPublicKey>"u")throw Error("missing receiver public key")}return{type:b,senderPublicKey:a?.senderPublicKey,receiverPublicKey:a?.receiverPublicKey}}function cY(a){return 1===a.type&&"string"==typeof a.senderPublicKey&&"string"==typeof a.receiverPublicKey}function cZ(a){return a?.relay||{protocol:"irn"}}function c$(a){let b=o.CG[a];if(typeof b>"u")throw Error(`Relay Protocol not supported: ${a}`);return b}function c_(a){var b;if(!a.includes("wc:")){let b=Y(a);null!=b&&b.includes("wc:")&&(a=b)}let c=(a=(a=a.includes("wc://")?a.replace("wc://",""):a).includes("wc:")?a.replace("wc:",""):a).indexOf(":"),d=-1!==a.indexOf("?")?a.indexOf("?"):void 0,e=a.substring(0,c),f=a.substring(c+1,d).split("@"),g=new URLSearchParams("u">typeof d?a.substring(d):""),h={};g.forEach((a,b)=>{h[b]=a});let i="string"==typeof h.methods?h.methods.split(","):void 0;return{protocol:e,topic:(b=f[0]).startsWith("//")?b.substring(2):b,version:parseInt(f[1],10),symKey:h.symKey,relay:function(a,b="-"){let c={},d="relay"+b;return Object.keys(a).forEach(b=>{if(b.startsWith(d)){let e=b.replace(d,""),f=a[b];c[e]=f}}),c}(h),methods:i,expiryTimestamp:h.expiryTimestamp?parseInt(h.expiryTimestamp,10):void 0}}function c0(a){let b=new URLSearchParams,c=function(a,b="-"){let c={};return Object.keys(a).forEach(d=>{a[d]&&(c["relay"+b+d]=a[d])}),c}(a.relay);Object.keys(c).sort().forEach(a=>{b.set(a,c[a])}),b.set("symKey",a.symKey),a.expiryTimestamp&&b.set("expiryTimestamp",a.expiryTimestamp.toString()),a.methods&&b.set("methods",a.methods.join(","));let d=b.toString();return`${a.protocol}:${a.topic}@${a.version}?${d}`}function c1(a,b,c){return`${a}?wc_ev=${c}&topic=${b}`}var c2=Object.defineProperty,c3=Object.defineProperties,c4=Object.getOwnPropertyDescriptors,c5=Object.getOwnPropertySymbols,c6=Object.prototype.hasOwnProperty,c7=Object.prototype.propertyIsEnumerable,c8=(a,b,c)=>b in a?c2(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,c9=(a,b)=>{for(var c in b||(b={}))c6.call(b,c)&&c8(a,c,b[c]);if(c5)for(var c of c5(b))c7.call(b,c)&&c8(a,c,b[c]);return a},da=(a,b)=>c3(a,c4(b));function db(a){let b=[];return a.forEach(a=>{let[c,d]=a.split(":");b.push(`${c}:${d}`)}),b}function dc(a){return a.includes(":")}function dd(a){return dc(a)?a.split(":")[0]:a}function de(a){var b,c,d;let e={};if(!dl(a))return e;for(let[f,g]of Object.entries(a)){let a=dc(f)?[f]:g.chains,h=g.methods||[],i=g.events||[],j=dd(f);e[j]=da(c9({},e[j]),{chains:S(a,null==(b=e[j])?void 0:b.chains),methods:S(h,null==(c=e[j])?void 0:c.methods),events:S(i,null==(d=e[j])?void 0:d.events)})}return e}function df(a,b){let c=function(a){let b={};return a?.forEach(a=>{var c;let[d,e]=a.split(":");b[d]||(b[d]={accounts:[],chains:[],events:[],methods:[]}),b[d].accounts.push(a),null==(c=b[d].chains)||c.push(`${d}:${e}`)}),b}(b=b.map(a=>a.replace("did:pkh:","")));for(let[b,d]of Object.entries(c))d.methods?d.methods=S(d.methods,a):d.methods=a,d.events=["chainChanged","accountsChanged"];return c}let dg={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},dh={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function di(a,b){let{message:c,code:d}=dh[a];return{message:b?`${c} ${b}`:c,code:d}}function dj(a,b){let{message:c,code:d}=dg[a];return{message:b?`${c} ${b}`:c,code:d}}function dk(a,b){return!!Array.isArray(a)&&(!("u">typeof b)||!a.length||a.every(b))}function dl(a){return Object.getPrototypeOf(a)===Object.prototype&&Object.keys(a).length}function dm(a){return typeof a>"u"}function dn(a,b){return!!(b&&dm(a))||"string"==typeof a&&!!a.trim().length}function dp(a,b){return!!(b&&dm(a))||"number"==typeof a&&!isNaN(a)}function dq(a){return!!(dn(a,!1)&&a.includes(":"))&&2===a.split(":").length}function dr(a){let b=!0;return dk(a)?a.length&&(b=a.every(a=>dn(a,!1))):b=!1,b}function ds(a,b){let c=null;return Object.values(a).forEach(a=>{var d;let e;if(c)return;let f=(d=`${b}, namespace`,e=null,dr(a?.methods)?dr(a?.events)||(e=dj("UNSUPPORTED_EVENTS",`${d}, events should be an array of strings or empty array for no events`)):e=dj("UNSUPPORTED_METHODS",`${d}, methods should be an array of strings or empty array for no methods`),e);f&&(c=f)}),c}function dt(a,b){let c=null;if(a&&dl(a)){let d,e=ds(a,b);e&&(c=e);let f=(d=null,Object.values(a).forEach(a=>{var c,e;let f;if(d)return;let g=(c=a?.accounts,e=`${b} namespace`,f=null,dk(c)?c.forEach(a=>{f||function(a){if(dn(a,!1)&&a.includes(":")){let b=a.split(":");if(3===b.length){let a=b[0]+":"+b[1];return!!b[2]&&dq(a)}}return!1}(a)||(f=dj("UNSUPPORTED_ACCOUNTS",`${e}, account ${a} should be a string and conform to "namespace:chainId:address" format`))}):f=dj("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),f);g&&(d=g)}),d);f&&(c=f)}else c=di("MISSING_OR_INVALID",`${b}, namespaces should be an object with data`);return c}function du(a){return dn(a.protocol,!0)}function dv(a){return"u">typeof a}function dw(a,b){return!(!dq(b)||!(function(a){let b=[];return Object.values(a).forEach(a=>{b.push(...db(a.accounts))}),b})(a).includes(b))}function dx(a,b,c){let d=null,e=function(a){let b={};return Object.keys(a).forEach(c=>{var d;c.includes(":")?b[c]=a[c]:null==(d=a[c].chains)||d.forEach(d=>{b[d]={methods:a[c].methods,events:a[c].events}})}),b}(a),f=function(a){let b={};return Object.keys(a).forEach(c=>{if(c.includes(":"))b[c]=a[c];else{let d=db(a[c].accounts);d?.forEach(d=>{b[d]={accounts:a[c].accounts.filter(a=>a.includes(`${d}:`)),methods:a[c].methods,events:a[c].events}})}}),b}(b),g=Object.keys(e),h=Object.keys(f),i=dy(Object.keys(a)),j=dy(Object.keys(b)),k=i.filter(a=>!j.includes(a));return k.length&&(d=di("NON_CONFORMING_NAMESPACES",`${c} namespaces keys don't satisfy requiredNamespaces.
      Required: ${k.toString()}
      Received: ${Object.keys(b).toString()}`)),I(g,h)||(d=di("NON_CONFORMING_NAMESPACES",`${c} namespaces chains don't satisfy required namespaces.
      Required: ${g.toString()}
      Approved: ${h.toString()}`)),Object.keys(b).forEach(a=>{if(!a.includes(":")||d)return;let e=db(b[a].accounts);e.includes(a)||(d=di("NON_CONFORMING_NAMESPACES",`${c} namespaces accounts don't satisfy namespace accounts for ${a}
        Required: ${a}
        Approved: ${e.toString()}`))}),g.forEach(a=>{d||(I(e[a].methods,f[a].methods)?I(e[a].events,f[a].events)||(d=di("NON_CONFORMING_NAMESPACES",`${c} namespaces events don't satisfy namespace events for ${a}`)):d=di("NON_CONFORMING_NAMESPACES",`${c} namespaces methods don't satisfy namespace methods for ${a}`))}),d}function dy(a){return[...new Set(a.map(a=>a.includes(":")?a.split(":")[0]:a))]}function dz(){let a=E();return new Promise(b=>{switch(a){case A.browser:b(D()&&navigator?.onLine);break;case A.reactNative:b(dA());break;case A.node:default:b(!0)}})}async function dA(){if(C()&&"u">typeof global&&null!=global&&global.NetInfo){let a=await (null==global?void 0:global.NetInfo.fetch());return a?.isConnected}return!0}let dB={};class dC{static get(a){return dB[a]}static set(a,b){dB[a]=b}static delete(a){delete dB[a]}}var dD=c(27710),dE=c(46590),dF=c(10576),dG=c(44660),dH=Object.defineProperty,dI=(a,b,c)=>((a,b,c)=>b in a?dH(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c)(a,"symbol"!=typeof b?b+"":b,c);class dJ extends dG.H{constructor(a){super(),this.opts=a,dI(this,"protocol","wc"),dI(this,"version",2)}}var dK=Object.defineProperty;class dL extends dG.H{constructor(a,b){super(),this.core=a,this.logger=b,((a,b,c)=>((a,b,c)=>b in a?dK(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c)(a,"symbol"!=typeof b?b+"":b,c))(this,"records",new Map)}}class dM{constructor(a,b){this.logger=a,this.core=b}}class dN extends dG.H{constructor(a,b){super(),this.relayer=a,this.logger=b}}class dO extends dG.H{constructor(a){super()}}class dP{constructor(a,b,c,d){this.core=a,this.logger=b,this.name=c}}class dQ extends dG.H{constructor(a,b){super(),this.relayer=a,this.logger=b}}class dR extends dG.H{constructor(a,b){super(),this.core=a,this.logger=b}}class dS{constructor(a,b,c){this.core=a,this.logger=b,this.store=c}}class dT{constructor(a,b){this.projectId=a,this.logger=b}}class dU{constructor(a,b,c){this.core=a,this.logger=b,this.telemetryEnabled=c}}var dV=Object.defineProperty,dW=(a,b,c)=>((a,b,c)=>b in a?dV(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c)(a,"symbol"!=typeof b?b+"":b,c);e();class dX{constructor(a){this.opts=a,dW(this,"protocol","wc"),dW(this,"version",2)}}d.EventEmitter;class dY{constructor(a){this.client=a}}var dZ=c(25080),d$=c(95649),d_=c(44566),d0=c(68879);let d1="core",d2=`wc@2:${d1}:`,d3={logger:"error"},d4={database:":memory:"},d5="client_ed25519_seed",d6=g.ONE_DAY,d7=g.SIX_HOURS,d8="wss://relay.walletconnect.org",d9={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",publish:"relayer_publish"},ea={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},eb="2.21.1",ec={link_mode:"link_mode",relay:"relay"},ed={inbound:"inbound",outbound:"outbound"},ee="WALLETCONNECT_LINK_MODE_APPS",ef={created:"subscription_created",deleted:"subscription_deleted",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},eg=(g.FIVE_SECONDS,{wc_pairingDelete:{req:{ttl:g.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:g.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:g.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:g.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:g.ONE_DAY,prompt:!1,tag:0},res:{ttl:g.ONE_DAY,prompt:!1,tag:0}}}),eh={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},ei={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},ej={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},ek="https://verify.walletconnect.org",el=`${ek}/v3`,em=["https://verify.walletconnect.com",ek],en={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal"},eo={no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_listener_not_found:"proposal_listener_not_found"},ep={session_approve_started:"session_approve_started",session_namespaces_validation_success:"session_namespaces_validation_success",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success"},eq={no_internet_connection:"no_internet_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found"},er={authenticated_session_approve_started:"authenticated_session_approve_started",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve"},es={no_internet_connection:"no_internet_connection",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"};var et=function(a,b){if(a.length>=255)throw TypeError("Alphabet too long");for(var c=new Uint8Array(256),d=0;d<c.length;d++)c[d]=255;for(var e=0;e<a.length;e++){var f=a.charAt(e),g=f.charCodeAt(0);if(255!==c[g])throw TypeError(f+" is ambiguous");c[g]=e}var h=a.length,i=a.charAt(0),j=Math.log(h)/Math.log(256),k=Math.log(256)/Math.log(h);function l(a){if("string"!=typeof a)throw TypeError("Expected String");if(0===a.length)return new Uint8Array;var b=0;if(" "!==a[0]){for(var d=0,e=0;a[b]===i;)d++,b++;for(var f=(a.length-b)*j+1>>>0,g=new Uint8Array(f);a[b];){var k=c[a.charCodeAt(b)];if(255===k)return;for(var l=0,m=f-1;(0!==k||l<e)&&-1!==m;m--,l++)k+=h*g[m]>>>0,g[m]=k%256>>>0,k=k/256>>>0;if(0!==k)throw Error("Non-zero carry");e=l,b++}if(" "!==a[b]){for(var o=f-e;o!==f&&0===g[o];)o++;for(var p=new Uint8Array(d+(f-o)),q=d;o!==f;)p[q++]=g[o++];return p}}}return{encode:function(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw TypeError("Expected Uint8Array");if(0===b.length)return"";for(var c=0,d=0,e=0,f=b.length;e!==f&&0===b[e];)e++,c++;for(var g=(f-e)*k+1>>>0,j=new Uint8Array(g);e!==f;){for(var l=b[e],m=0,o=g-1;(0!==l||m<d)&&-1!==o;o--,m++)l+=256*j[o]>>>0,j[o]=l%h>>>0,l=l/h>>>0;if(0!==l)throw Error("Non-zero carry");d=m,e++}for(var p=g-d;p!==g&&0===j[p];)p++;for(var q=i.repeat(c);p<g;++p)q+=a.charAt(j[p]);return q},decodeUnsafe:l,decode:function(a){var c=l(a);if(c)return c;throw Error(`Non-${b} character`)}}};let eu=a=>{if(a instanceof Uint8Array&&"Uint8Array"===a.constructor.name)return a;if(a instanceof ArrayBuffer)return new Uint8Array(a);if(ArrayBuffer.isView(a))return new Uint8Array(a.buffer,a.byteOffset,a.byteLength);throw Error("Unknown type, must be binary type")};class ev{constructor(a,b,c){this.name=a,this.prefix=b,this.baseEncode=c}encode(a){if(a instanceof Uint8Array)return`${this.prefix}${this.baseEncode(a)}`;throw Error("Unknown type, must be binary type")}}class ew{constructor(a,b,c){if(this.name=a,this.prefix=b,void 0===b.codePointAt(0))throw Error("Invalid prefix character");this.prefixCodePoint=b.codePointAt(0),this.baseDecode=c}decode(a){if("string"==typeof a){if(a.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(a)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(a.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(a){return ey(this,a)}}class ex{constructor(a){this.decoders=a}or(a){return ey(this,a)}decode(a){let b=a[0],c=this.decoders[b];if(c)return c.decode(a);throw RangeError(`Unable to decode multibase string ${JSON.stringify(a)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}let ey=(a,b)=>new ex({...a.decoders||{[a.prefix]:a},...b.decoders||{[b.prefix]:b}});class ez{constructor(a,b,c,d){this.name=a,this.prefix=b,this.baseEncode=c,this.baseDecode=d,this.encoder=new ev(a,b,c),this.decoder=new ew(a,b,d)}encode(a){return this.encoder.encode(a)}decode(a){return this.decoder.decode(a)}}let eA=({name:a,prefix:b,encode:c,decode:d})=>new ez(a,b,c,d),eB=({prefix:a,name:b,alphabet:c})=>{let{encode:d,decode:e}=et(c,b);return eA({prefix:a,name:b,encode:d,decode:a=>eu(e(a))})},eC=({name:a,prefix:b,bitsPerChar:c,alphabet:d})=>eA({prefix:b,name:a,encode:a=>((a,b,c)=>{let d="="===b[b.length-1],e=(1<<c)-1,f="",g=0,h=0;for(let d=0;d<a.length;++d)for(h=h<<8|a[d],g+=8;g>c;)g-=c,f+=b[e&h>>g];if(g&&(f+=b[e&h<<c-g]),d)for(;f.length*c&7;)f+="=";return f})(a,d,c),decode:b=>((a,b,c,d)=>{let e={};for(let a=0;a<b.length;++a)e[b[a]]=a;let f=a.length;for(;"="===a[f-1];)--f;let g=new Uint8Array(f*c/8|0),h=0,i=0,j=0;for(let b=0;b<f;++b){let f=e[a[b]];if(void 0===f)throw SyntaxError(`Non-${d} character`);i=i<<c|f,(h+=c)>=8&&(h-=8,g[j++]=255&i>>h)}if(h>=c||255&i<<8-h)throw SyntaxError("Unexpected end of data");return g})(b,d,c,a)});var eD=Object.freeze({__proto__:null,identity:eA({prefix:"\0",name:"identity",encode:a=>new TextDecoder().decode(a),decode:a=>new TextEncoder().encode(a)})}),eE=Object.freeze({__proto__:null,base2:eC({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1})}),eF=Object.freeze({__proto__:null,base8:eC({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3})}),eG=Object.freeze({__proto__:null,base10:eB({prefix:"9",name:"base10",alphabet:"0123456789"})}),eH=Object.freeze({__proto__:null,base16:eC({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),base16upper:eC({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4})});let eI=eC({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),eJ=eC({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),eK=eC({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),eL=eC({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),eM=eC({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),eN=eC({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),eO=eC({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5});var eP=Object.freeze({__proto__:null,base32:eI,base32upper:eJ,base32pad:eK,base32padupper:eL,base32hex:eM,base32hexupper:eN,base32hexpad:eO,base32hexpadupper:eC({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),base32z:eC({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})}),eQ=Object.freeze({__proto__:null,base36:eB({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),base36upper:eB({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})}),eR=Object.freeze({__proto__:null,base58btc:eB({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),base58flickr:eB({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})});let eS=eC({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),eT=eC({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6});var eU=Object.freeze({__proto__:null,base64:eS,base64pad:eT,base64url:eC({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),base64urlpad:eC({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})});let eV=Array.from("\uD83D\uDE80\uD83E\uDE90☄\uD83D\uDEF0\uD83C\uDF0C\uD83C\uDF11\uD83C\uDF12\uD83C\uDF13\uD83C\uDF14\uD83C\uDF15\uD83C\uDF16\uD83C\uDF17\uD83C\uDF18\uD83C\uDF0D\uD83C\uDF0F\uD83C\uDF0E\uD83D\uDC09☀\uD83D\uDCBB\uD83D\uDDA5\uD83D\uDCBE\uD83D\uDCBF\uD83D\uDE02❤\uD83D\uDE0D\uD83E\uDD23\uD83D\uDE0A\uD83D\uDE4F\uD83D\uDC95\uD83D\uDE2D\uD83D\uDE18\uD83D\uDC4D\uD83D\uDE05\uD83D\uDC4F\uD83D\uDE01\uD83D\uDD25\uD83E\uDD70\uD83D\uDC94\uD83D\uDC96\uD83D\uDC99\uD83D\uDE22\uD83E\uDD14\uD83D\uDE06\uD83D\uDE44\uD83D\uDCAA\uD83D\uDE09☺\uD83D\uDC4C\uD83E\uDD17\uD83D\uDC9C\uD83D\uDE14\uD83D\uDE0E\uD83D\uDE07\uD83C\uDF39\uD83E\uDD26\uD83C\uDF89\uD83D\uDC9E✌✨\uD83E\uDD37\uD83D\uDE31\uD83D\uDE0C\uD83C\uDF38\uD83D\uDE4C\uD83D\uDE0B\uD83D\uDC97\uD83D\uDC9A\uD83D\uDE0F\uD83D\uDC9B\uD83D\uDE42\uD83D\uDC93\uD83E\uDD29\uD83D\uDE04\uD83D\uDE00\uD83D\uDDA4\uD83D\uDE03\uD83D\uDCAF\uD83D\uDE48\uD83D\uDC47\uD83C\uDFB6\uD83D\uDE12\uD83E\uDD2D❣\uD83D\uDE1C\uD83D\uDC8B\uD83D\uDC40\uD83D\uDE2A\uD83D\uDE11\uD83D\uDCA5\uD83D\uDE4B\uD83D\uDE1E\uD83D\uDE29\uD83D\uDE21\uD83E\uDD2A\uD83D\uDC4A\uD83E\uDD73\uD83D\uDE25\uD83E\uDD24\uD83D\uDC49\uD83D\uDC83\uD83D\uDE33✋\uD83D\uDE1A\uD83D\uDE1D\uD83D\uDE34\uD83C\uDF1F\uD83D\uDE2C\uD83D\uDE43\uD83C\uDF40\uD83C\uDF37\uD83D\uDE3B\uD83D\uDE13⭐✅\uD83E\uDD7A\uD83C\uDF08\uD83D\uDE08\uD83E\uDD18\uD83D\uDCA6✔\uD83D\uDE23\uD83C\uDFC3\uD83D\uDC90☹\uD83C\uDF8A\uD83D\uDC98\uD83D\uDE20☝\uD83D\uDE15\uD83C\uDF3A\uD83C\uDF82\uD83C\uDF3B\uD83D\uDE10\uD83D\uDD95\uD83D\uDC9D\uD83D\uDE4A\uD83D\uDE39\uD83D\uDDE3\uD83D\uDCAB\uD83D\uDC80\uD83D\uDC51\uD83C\uDFB5\uD83E\uDD1E\uD83D\uDE1B\uD83D\uDD34\uD83D\uDE24\uD83C\uDF3C\uD83D\uDE2B⚽\uD83E\uDD19☕\uD83C\uDFC6\uD83E\uDD2B\uD83D\uDC48\uD83D\uDE2E\uD83D\uDE46\uD83C\uDF7B\uD83C\uDF43\uD83D\uDC36\uD83D\uDC81\uD83D\uDE32\uD83C\uDF3F\uD83E\uDDE1\uD83C\uDF81⚡\uD83C\uDF1E\uD83C\uDF88❌✊\uD83D\uDC4B\uD83D\uDE30\uD83E\uDD28\uD83D\uDE36\uD83E\uDD1D\uD83D\uDEB6\uD83D\uDCB0\uD83C\uDF53\uD83D\uDCA2\uD83E\uDD1F\uD83D\uDE41\uD83D\uDEA8\uD83D\uDCA8\uD83E\uDD2C✈\uD83C\uDF80\uD83C\uDF7A\uD83E\uDD13\uD83D\uDE19\uD83D\uDC9F\uD83C\uDF31\uD83D\uDE16\uD83D\uDC76\uD83E\uDD74▶➡❓\uD83D\uDC8E\uD83D\uDCB8⬇\uD83D\uDE28\uD83C\uDF1A\uD83E\uDD8B\uD83D\uDE37\uD83D\uDD7A⚠\uD83D\uDE45\uD83D\uDE1F\uD83D\uDE35\uD83D\uDC4E\uD83E\uDD32\uD83E\uDD20\uD83E\uDD27\uD83D\uDCCC\uD83D\uDD35\uD83D\uDC85\uD83E\uDDD0\uD83D\uDC3E\uD83C\uDF52\uD83D\uDE17\uD83E\uDD11\uD83C\uDF0A\uD83E\uDD2F\uD83D\uDC37☎\uD83D\uDCA7\uD83D\uDE2F\uD83D\uDC86\uD83D\uDC46\uD83C\uDFA4\uD83D\uDE47\uD83C\uDF51❄\uD83C\uDF34\uD83D\uDCA3\uD83D\uDC38\uD83D\uDC8C\uD83D\uDCCD\uD83E\uDD40\uD83E\uDD22\uD83D\uDC45\uD83D\uDCA1\uD83D\uDCA9\uD83D\uDC50\uD83D\uDCF8\uD83D\uDC7B\uD83E\uDD10\uD83E\uDD2E\uD83C\uDFBC\uD83E\uDD75\uD83D\uDEA9\uD83C\uDF4E\uD83C\uDF4A\uD83D\uDC7C\uD83D\uDC8D\uD83D\uDCE3\uD83E\uDD42"),eW=eV.reduce((a,b,c)=>(a[c]=b,a),[]),eX=eV.reduce((a,b,c)=>(a[b.codePointAt(0)]=c,a),[]);var eY=Object.freeze({__proto__:null,base256emoji:eA({prefix:"\uD83D\uDE80",name:"base256emoji",encode:function(a){return a.reduce((a,b)=>a+=eW[b],"")},decode:function(a){let b=[];for(let c of a){let a=eX[c.codePointAt(0)];if(void 0===a)throw Error(`Non-base256emoji character: ${c}`);b.push(a)}return new Uint8Array(b)}})});function eZ(a,b,c){b=b||[],c=c||0;for(var d=c;a>=0x80000000;)b[c++]=255&a|128,a/=128;for(;-128&a;)b[c++]=255&a|128,a>>>=7;return b[c]=0|a,eZ.bytes=c-d+1,b}var e$={encode:eZ,encodingLength:function(a){return a<128?1:a<16384?2:a<2097152?3:a<0x10000000?4:a<0x800000000?5:a<0x40000000000?6:a<0x2000000000000?7:a<0x100000000000000?8:a<0x8000000000000000?9:10}};let e_=(a,b,c=0)=>(e$.encode(a,b,c),b),e0=a=>e$.encodingLength(a),e1=(a,b)=>{let c=b.byteLength,d=e0(a),e=d+e0(c),f=new Uint8Array(e+c);return e_(a,f,0),e_(c,f,d),f.set(b,e),new e2(a,c,b,f)};class e2{constructor(a,b,c,d){this.code=a,this.size=b,this.digest=c,this.bytes=d}}let e3=({name:a,code:b,encode:c})=>new e4(a,b,c);class e4{constructor(a,b,c){this.name=a,this.code=b,this.encode=c}digest(a){if(a instanceof Uint8Array){let b=this.encode(a);return b instanceof Uint8Array?e1(this.code,b):b.then(a=>e1(this.code,a))}throw Error("Unknown type, must be binary type")}}let e5=a=>async b=>new Uint8Array(await crypto.subtle.digest(a,b));var e6=Object.freeze({__proto__:null,sha256:e3({name:"sha2-256",code:18,encode:e5("SHA-256")}),sha512:e3({name:"sha2-512",code:19,encode:e5("SHA-512")})}),e7=Object.freeze({__proto__:null,identity:{code:0,name:"identity",encode:eu,digest:a=>e1(0,eu(a))}});new TextEncoder,new TextDecoder;let e8={...eD,...eE,...eF,...eG,...eH,...eP,...eQ,...eR,...eU,...eY};function e9(a,b,c,d){return{name:a,prefix:b,encoder:{name:a,prefix:b,encode:c},decoder:{decode:d}}}({...e6,...e7});let fa=e9("utf8","u",a=>"u"+new TextDecoder("utf8").decode(a),a=>new TextEncoder().encode(a.substring(1))),fb=e9("ascii","a",a=>{let b="a";for(let c=0;c<a.length;c++)b+=String.fromCharCode(a[c]);return b},a=>{let b=function(a=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?globalThis.Buffer.allocUnsafe(a):new Uint8Array(a)}((a=a.substring(1)).length);for(let c=0;c<a.length;c++)b[c]=a.charCodeAt(c);return b}),fc={utf8:fa,"utf-8":fa,hex:e8.base16,latin1:fb,ascii:fb,binary:fb,...e8};var fd=Object.defineProperty,fe=(a,b,c)=>((a,b,c)=>b in a?fd(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c)(a,"symbol"!=typeof b?b+"":b,c);class ff{constructor(a,b){this.core=a,this.logger=b,fe(this,"keychain",new Map),fe(this,"name","keychain"),fe(this,"version","0.3"),fe(this,"initialized",!1),fe(this,"storagePrefix",d2),fe(this,"init",async()=>{if(!this.initialized){let a=await this.getKeyChain();"u">typeof a&&(this.keychain=a),this.initialized=!0}}),fe(this,"has",a=>(this.isInitialized(),this.keychain.has(a))),fe(this,"set",async(a,b)=>{this.isInitialized(),this.keychain.set(a,b),await this.persist()}),fe(this,"get",a=>{this.isInitialized();let b=this.keychain.get(a);if(typeof b>"u"){let{message:b}=di("NO_MATCHING_KEY",`${this.name}: ${a}`);throw Error(b)}return b}),fe(this,"del",async a=>{this.isInitialized(),this.keychain.delete(a),await this.persist()}),this.core=a,this.logger=(0,dF.U5)(b,this.name)}get context(){return(0,dF.oI)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(a){await this.core.storage.setItem(this.storageKey,J(a))}async getKeyChain(){let a=await this.core.storage.getItem(this.storageKey);return"u">typeof a?K(a):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){let{message:a}=di("NOT_INITIALIZED",this.name);throw Error(a)}}}var fg=Object.defineProperty,fh=(a,b,c)=>((a,b,c)=>b in a?fg(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c)(a,"symbol"!=typeof b?b+"":b,c);class fi{constructor(a,b,c){this.core=a,this.logger=b,fh(this,"name","crypto"),fh(this,"keychain"),fh(this,"randomSessionIdentifier",cO()),fh(this,"initialized",!1),fh(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),fh(this,"hasKeys",a=>(this.isInitialized(),this.keychain.has(a))),fh(this,"getClientId",async()=>{this.isInitialized();let a=await this.getClientSeed(),b=l.TZ(a);return l.UF(b.publicKey)}),fh(this,"generateKeyPair",()=>{this.isInitialized();let a=function(){let a=cy.utils.randomPrivateKey(),b=cy.getPublicKey(a);return{privateKey:(0,m.dI)(a,cK),publicKey:(0,m.dI)(b,cK)}}();return this.setPrivateKey(a.publicKey,a.privateKey)}),fh(this,"signJWT",async a=>{this.isInitialized();let b=await this.getClientSeed(),c=l.TZ(b),d=this.randomSessionIdentifier;return await l.FA(d,a,d6,c)}),fh(this,"generateSharedKey",(a,b,c)=>{this.isInitialized();let d=function(a,b){var c;let d,e=cy.getSharedSecret((0,m.sH)(a,cK),(0,m.sH)(b,cK)),f=(d=void 0,function(a,b,c,d=32){if(_(a),Z(d),d>255*a.outputLen)throw Error("Length should be <= 255*HashLen");let e=Math.ceil(d/a.outputLen);void 0===c&&(c=bs);let f=new Uint8Array(e*a.outputLen),g=bq.create(a,b),h=g._cloneInto(),i=new Uint8Array(g.outputLen);for(let b=0;b<e;b++)br[0]=b+1,h.update(0===b?bs:i).update(c).update(br).digestInto(i),f.set(i,a.outputLen*b),g._cloneInto(h);return g.destroy(),h.destroy(),i.fill(0),br.fill(0),f.slice(0,d)}(by,(c=void 0,_(by),void 0===c&&(c=new Uint8Array(by.outputLen)),bq(by,aj(c),aj(e))),d,32));return(0,m.dI)(f,cK)}(this.getPrivateKey(a),b);return this.setSymKey(d,c)}),fh(this,"setSymKey",async(a,b)=>{this.isInitialized();let c=b||cP(a);return await this.keychain.set(c,a),c}),fh(this,"deleteKeyPair",async a=>{this.isInitialized(),await this.keychain.del(a)}),fh(this,"deleteSymKey",async a=>{this.isInitialized(),await this.keychain.del(a)}),fh(this,"encode",async(a,b,c)=>{this.isInitialized();let d=cX(c),e=(0,dZ.h)(b);if(2===d.type)return function(a,b){let c=cR(2),d=am(12),e=cV({type:c,sealed:(0,m.sH)(a,cN),iv:d});return b===cM?cT(e):e}(e,c?.encoding);if(cY(d)){let b=d.senderPublicKey,c=d.receiverPublicKey;a=await this.generateSharedKey(b,c)}let f=this.getSymKey(a),{type:g,senderPublicKey:h}=d;return function(a){let b=cR("u">typeof a.type?a.type:0);if(1===cS(b)&&typeof a.senderPublicKey>"u")throw Error("Missing sender public key for type 1 envelope");let c="u">typeof a.senderPublicKey?(0,m.sH)(a.senderPublicKey,cK):void 0,d="u">typeof a.iv?(0,m.sH)(a.iv,cK):am(12),e=cV({type:b,sealed:bo((0,m.sH)(a.symKey,cK),d).encrypt((0,m.sH)(a.message,cN)),iv:d,senderPublicKey:c});return a.encoding===cM?cT(e):e}({type:g,symKey:f,message:e,senderPublicKey:h,encoding:c?.encoding})}),fh(this,"decode",async(a,b,c)=>{this.isInitialized();let d=function(a,b){let c=cW({encoded:a,encoding:b?.encoding});return cX({type:cS(c.type),senderPublicKey:"u">typeof c.senderPublicKey?(0,m.dI)(c.senderPublicKey,cK):void 0,receiverPublicKey:b?.receiverPublicKey})}(b,c);if(2===d.type){let a=function(a,b){let{sealed:c}=cW({encoded:a,encoding:b});return(0,m.dI)(c,cN)}(b,c?.encoding);return(0,dZ.j)(a)}if(cY(d)){let b=d.receiverPublicKey,c=d.senderPublicKey;a=await this.generateSharedKey(b,c)}try{let d=this.getSymKey(a),e=function(a){let b=(0,m.sH)(a.symKey,cK),{sealed:c,iv:d}=cW({encoded:a.encoded,encoding:a.encoding}),e=bo(b,d).decrypt(c);if(null===e)throw Error("Failed to decrypt");return(0,m.dI)(e,cN)}({symKey:d,encoded:b,encoding:c?.encoding});return(0,dZ.j)(e)}catch(b){this.logger.error(`Failed to decode message from topic: '${a}', clientId: '${await this.getClientId()}'`),this.logger.error(b)}}),fh(this,"getPayloadType",(a,b=cL)=>cS(cW({encoded:a,encoding:b}).type)),fh(this,"getPayloadSenderPublicKey",(a,b=cL)=>{let c=cW({encoded:a,encoding:b});return c.senderPublicKey?(0,m.dI)(c.senderPublicKey,cK):void 0}),this.core=a,this.logger=(0,dF.U5)(b,this.name),this.keychain=c||new ff(this.core,this.logger)}get context(){return(0,dF.oI)(this.logger)}async setPrivateKey(a,b){return await this.keychain.set(a,b),a}getPrivateKey(a){return this.keychain.get(a)}async getClientSeed(){let a="";try{a=this.keychain.get(d5)}catch{a=cO(),await this.keychain.set(d5,a)}return function(a,b="utf8"){let c=fc[b];if(!c)throw Error(`Unsupported encoding "${b}"`);return("utf8"===b||"utf-8"===b)&&null!=globalThis.Buffer&&null!=globalThis.Buffer.from?globalThis.Buffer.from(a,"utf8"):c.decoder.decode(`${c.prefix}${a}`)}(a,"base16")}getSymKey(a){return this.keychain.get(a)}isInitialized(){if(!this.initialized){let{message:a}=di("NOT_INITIALIZED",this.name);throw Error(a)}}}var fj=Object.defineProperty,fk=Object.defineProperties,fl=Object.getOwnPropertyDescriptors,fm=Object.getOwnPropertySymbols,fn=Object.prototype.hasOwnProperty,fo=Object.prototype.propertyIsEnumerable,fp=(a,b,c)=>b in a?fj(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,fq=(a,b,c)=>fp(a,"symbol"!=typeof b?b+"":b,c);class fr extends dM{constructor(a,b){super(a,b),this.logger=a,this.core=b,fq(this,"messages",new Map),fq(this,"messagesWithoutClientAck",new Map),fq(this,"name","messages"),fq(this,"version","0.3"),fq(this,"initialized",!1),fq(this,"storagePrefix",d2),fq(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{let a=await this.getRelayerMessages();"u">typeof a&&(this.messages=a);let b=await this.getRelayerMessagesWithoutClientAck();"u">typeof b&&(this.messagesWithoutClientAck=b),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(a){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(a)}finally{this.initialized=!0}}}),fq(this,"set",async(a,b,c)=>{this.isInitialized();let d=cQ(b),e=this.messages.get(a);if(typeof e>"u"&&(e={}),"u">typeof e[d])return d;if(e[d]=b,this.messages.set(a,e),c===ed.inbound){let c=this.messagesWithoutClientAck.get(a)||{};this.messagesWithoutClientAck.set(a,fk(((a,b)=>{for(var c in b||(b={}))fn.call(b,c)&&fp(a,c,b[c]);if(fm)for(var c of fm(b))fo.call(b,c)&&fp(a,c,b[c]);return a})({},c),fl({[d]:b})))}return await this.persist(),d}),fq(this,"get",a=>{this.isInitialized();let b=this.messages.get(a);return typeof b>"u"&&(b={}),b}),fq(this,"getWithoutAck",a=>{this.isInitialized();let b={};for(let c of a){let a=this.messagesWithoutClientAck.get(c)||{};b[c]=Object.values(a)}return b}),fq(this,"has",(a,b)=>(this.isInitialized(),"u">typeof this.get(a)[cQ(b)])),fq(this,"ack",async(a,b)=>{this.isInitialized();let c=this.messagesWithoutClientAck.get(a);if(typeof c>"u")return;let d=cQ(b);delete c[d],0===Object.keys(c).length?this.messagesWithoutClientAck.delete(a):this.messagesWithoutClientAck.set(a,c),await this.persist()}),fq(this,"del",async a=>{this.isInitialized(),this.messages.delete(a),this.messagesWithoutClientAck.delete(a),await this.persist()}),this.logger=(0,dF.U5)(a,this.name),this.core=b}get context(){return(0,dF.oI)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(a){await this.core.storage.setItem(this.storageKey,J(a))}async setRelayerMessagesWithoutClientAck(a){await this.core.storage.setItem(this.storageKeyWithoutClientAck,J(a))}async getRelayerMessages(){let a=await this.core.storage.getItem(this.storageKey);return"u">typeof a?K(a):void 0}async getRelayerMessagesWithoutClientAck(){let a=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return"u">typeof a?K(a):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){let{message:a}=di("NOT_INITIALIZED",this.name);throw Error(a)}}}var fs=Object.defineProperty,ft=Object.defineProperties,fu=Object.getOwnPropertyDescriptors,fv=Object.getOwnPropertySymbols,fw=Object.prototype.hasOwnProperty,fx=Object.prototype.propertyIsEnumerable,fy=(a,b,c)=>b in a?fs(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,fz=(a,b)=>{for(var c in b||(b={}))fw.call(b,c)&&fy(a,c,b[c]);if(fv)for(var c of fv(b))fx.call(b,c)&&fy(a,c,b[c]);return a},fA=(a,b)=>ft(a,fu(b)),fB=(a,b,c)=>fy(a,"symbol"!=typeof b?b+"":b,c);class fC extends dN{constructor(a,b){super(a,b),this.relayer=a,this.logger=b,fB(this,"events",new d.EventEmitter),fB(this,"name","publisher"),fB(this,"queue",new Map),fB(this,"publishTimeout",(0,g.toMiliseconds)(g.ONE_MINUTE)),fB(this,"initialPublishTimeout",(0,g.toMiliseconds)(15*g.ONE_SECOND)),fB(this,"needsTransportRestart",!1),fB(this,"publish",async(a,b,c)=>{var d;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:a,message:b,opts:c}});let e=c?.ttl||d7,f=cZ(c),g=c?.prompt||!1,h=c?.tag||0,i=c?.id||(0,d_.getBigIntRpcId)().toString(),j={topic:a,message:b,opts:{ttl:e,relay:f,prompt:g,tag:h,id:i,attestation:c?.attestation,tvf:c?.tvf}},k=`Failed to publish payload, please try again. id:${i} tag:${h}`;try{let d=new Promise(async d=>{let f=({id:a})=>{j.opts.id===a&&(this.removeRequestFromQueue(a),this.relayer.events.removeListener(d9.publish,f),d(j))};this.relayer.events.on(d9.publish,f);let k=M(new Promise((d,f)=>{this.rpcPublish({topic:a,message:b,ttl:e,prompt:g,tag:h,id:i,attestation:c?.attestation,tvf:c?.tvf}).then(d).catch(a=>{this.logger.warn(a,a?.message),f(a)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${i} tag:${h}`);try{await k,this.events.removeListener(d9.publish,f)}catch(a){this.queue.set(i,fA(fz({},j),{attempt:1})),this.logger.warn(a,a?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:i,topic:a,message:b,opts:c}}),await M(d,this.publishTimeout,k)}catch(a){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(a),null!=(d=c?.internal)&&d.throwOnFailedPublish)throw a}finally{this.queue.delete(i)}}),fB(this,"on",(a,b)=>{this.events.on(a,b)}),fB(this,"once",(a,b)=>{this.events.once(a,b)}),fB(this,"off",(a,b)=>{this.events.off(a,b)}),fB(this,"removeListener",(a,b)=>{this.events.removeListener(a,b)}),this.relayer=a,this.logger=(0,dF.U5)(b,this.name),this.registerEventListeners()}get context(){return(0,dF.oI)(this.logger)}async rpcPublish(a){var b,c,d,e;let{topic:f,message:g,ttl:h=d7,prompt:i,tag:j,id:k,attestation:l,tvf:m}=a,o={method:c$(cZ().protocol).publish,params:fz({topic:f,message:g,ttl:h,prompt:i,tag:j,attestation:l},m),id:k};dm(null==(b=o.params)?void 0:b.prompt)&&(null==(c=o.params)||delete c.prompt),dm(null==(d=o.params)?void 0:d.tag)&&(null==(e=o.params)||delete e.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:o});let p=await this.relayer.request(o);return this.relayer.events.emit(d9.publish,a),this.logger.debug("Successfully Published Payload"),p}removeRequestFromQueue(a){this.queue.delete(a)}checkQueue(){this.queue.forEach(async(a,b)=>{let c=a.attempt+1;this.queue.set(b,fA(fz({},a),{attempt:c}));let{topic:d,message:e,opts:f,attestation:g}=a;this.logger.warn({},`Publisher: queue->publishing: ${a.opts.id}, tag: ${a.opts.tag}, attempt: ${c}`),await this.rpcPublish(fA(fz({},a),{topic:d,message:e,ttl:f.ttl,prompt:f.prompt,tag:f.tag,id:f.id,attestation:g,tvf:f.tvf})),this.logger.warn({},`Publisher: queue->published: ${a.opts.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(dD.li.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(d9.connection_stalled);return}this.checkQueue()}),this.relayer.on(d9.message_ack,a=>{this.removeRequestFromQueue(a.id.toString())})}}var fD=Object.defineProperty,fE=(a,b,c)=>((a,b,c)=>b in a?fD(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c)(a,"symbol"!=typeof b?b+"":b,c);class fF{constructor(){fE(this,"map",new Map),fE(this,"set",(a,b)=>{let c=this.get(a);this.exists(a,b)||this.map.set(a,[...c,b])}),fE(this,"get",a=>this.map.get(a)||[]),fE(this,"exists",(a,b)=>this.get(a).includes(b)),fE(this,"delete",(a,b)=>{if(typeof b>"u")return void this.map.delete(a);if(!this.map.has(a))return;let c=this.get(a);if(!this.exists(a,b))return;let d=c.filter(a=>a!==b);if(!d.length)return void this.map.delete(a);this.map.set(a,d)}),fE(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var fG=Object.defineProperty,fH=Object.defineProperties,fI=Object.getOwnPropertyDescriptors,fJ=Object.getOwnPropertySymbols,fK=Object.prototype.hasOwnProperty,fL=Object.prototype.propertyIsEnumerable,fM=(a,b,c)=>b in a?fG(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,fN=(a,b)=>{for(var c in b||(b={}))fK.call(b,c)&&fM(a,c,b[c]);if(fJ)for(var c of fJ(b))fL.call(b,c)&&fM(a,c,b[c]);return a},fO=(a,b)=>fH(a,fI(b)),fP=(a,b,c)=>fM(a,"symbol"!=typeof b?b+"":b,c);class fQ extends dQ{constructor(a,b){super(a,b),this.relayer=a,this.logger=b,fP(this,"subscriptions",new Map),fP(this,"topicMap",new fF),fP(this,"events",new d.EventEmitter),fP(this,"name","subscription"),fP(this,"version","0.3"),fP(this,"pending",new Map),fP(this,"cached",[]),fP(this,"initialized",!1),fP(this,"storagePrefix",d2),fP(this,"subscribeTimeout",(0,g.toMiliseconds)(g.ONE_MINUTE)),fP(this,"initialSubscribeTimeout",(0,g.toMiliseconds)(15*g.ONE_SECOND)),fP(this,"clientId"),fP(this,"batchSubscribeTopicsLimit",500),fP(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),fP(this,"subscribe",async(a,b)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:a,opts:b}});try{let c=cZ(b),d={topic:a,relay:c,transportType:b?.transportType};this.pending.set(a,d);let e=await this.rpcSubscribe(a,c,b);return"string"==typeof e&&(this.onSubscribe(e,d),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:a,opts:b}})),e}catch(a){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(a),a}}),fP(this,"unsubscribe",async(a,b)=>{this.isInitialized(),"u">typeof b?.id?await this.unsubscribeById(a,b.id,b):await this.unsubscribeByTopic(a,b)}),fP(this,"isSubscribed",a=>new Promise(b=>{b(this.topicMap.topics.includes(a))})),fP(this,"isKnownTopic",a=>new Promise(b=>{b(this.topicMap.topics.includes(a)||this.pending.has(a)||this.cached.some(b=>b.topic===a))})),fP(this,"on",(a,b)=>{this.events.on(a,b)}),fP(this,"once",(a,b)=>{this.events.once(a,b)}),fP(this,"off",(a,b)=>{this.events.off(a,b)}),fP(this,"removeListener",(a,b)=>{this.events.removeListener(a,b)}),fP(this,"start",async()=>{await this.onConnect()}),fP(this,"stop",async()=>{await this.onDisconnect()}),fP(this,"restart",async()=>{await this.restore(),await this.onRestart()}),fP(this,"checkPending",async()=>{if(0===this.pending.size&&(!this.initialized||!this.relayer.connected))return;let a=[];this.pending.forEach(b=>{a.push(b)}),await this.batchSubscribe(a)}),fP(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(dD.li.pulse,async()=>{await this.checkPending()}),this.events.on(ef.created,async a=>{let b=ef.created;this.logger.info(`Emitting ${b}`),this.logger.debug({type:"event",event:b,data:a}),await this.persist()}),this.events.on(ef.deleted,async a=>{let b=ef.deleted;this.logger.info(`Emitting ${b}`),this.logger.debug({type:"event",event:b,data:a}),await this.persist()})}),this.relayer=a,this.logger=(0,dF.U5)(b,this.name),this.clientId=""}get context(){return(0,dF.oI)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(a,b){let c=!1;try{c=this.getSubscription(a).topic===b}catch{}return c}reset(){this.cached=[],this.initialized=!0}onDisable(){this.values.length>0&&(this.cached=this.values),this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(a,b){let c=this.topicMap.get(a);await Promise.all(c.map(async c=>await this.unsubscribeById(a,c,b)))}async unsubscribeById(a,b,c){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:a,id:b,opts:c}});try{let d=cZ(c);await this.restartToComplete({topic:a,id:b,relay:d}),await this.rpcUnsubscribe(a,b,d);let e=dj("USER_DISCONNECTED",`${this.name}, ${a}`);await this.onUnsubscribe(a,b,e),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:a,id:b,opts:c}})}catch(a){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(a),a}}async rpcSubscribe(a,b,c){var d;c&&c?.transportType!==ec.relay||await this.restartToComplete({topic:a,id:a,relay:b});let e={method:c$(b.protocol).subscribe,params:{topic:a}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:e});let f=null==(d=c?.internal)?void 0:d.throwOnFailedPublish;try{let b=await this.getSubscriptionId(a);if(c?.transportType===ec.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(e).catch(a=>this.logger.warn(a))},(0,g.toMiliseconds)(g.ONE_SECOND)),b;let d=new Promise(async b=>{let c=d=>{d.topic===a&&(this.events.removeListener(ef.created,c),b(d.id))};this.events.on(ef.created,c);try{let d=await M(new Promise((a,b)=>{this.relayer.request(e).catch(a=>{this.logger.warn(a,a?.message),b(a)}).then(a)}),this.initialSubscribeTimeout,`Subscribing to ${a} failed, please try again`);this.events.removeListener(ef.created,c),b(d)}catch{}}),h=await M(d,this.subscribeTimeout,`Subscribing to ${a} failed, please try again`);if(!h&&f)throw Error(`Subscribing to ${a} failed, please try again`);return h?b:null}catch(a){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(d9.connection_stalled),f)throw a}return null}async rpcBatchSubscribe(a){if(!a.length)return;let b={method:c$(a[0].relay.protocol).batchSubscribe,params:{topics:a.map(a=>a.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:b});try{await await M(new Promise(a=>{this.relayer.request(b).catch(a=>this.logger.warn(a)).then(a)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(d9.connection_stalled)}}async rpcBatchFetchMessages(a){let b;if(!a.length)return;let c={method:c$(a[0].relay.protocol).batchFetchMessages,params:{topics:a.map(a=>a.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:c});try{b=await await M(new Promise((a,b)=>{this.relayer.request(c).catch(a=>{this.logger.warn(a),b(a)}).then(a)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(d9.connection_stalled)}return b}rpcUnsubscribe(a,b,c){let d={method:c$(c.protocol).unsubscribe,params:{topic:a,id:b}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:d}),this.relayer.request(d)}onSubscribe(a,b){this.setSubscription(a,fO(fN({},b),{id:a})),this.pending.delete(b.topic)}onBatchSubscribe(a){a.length&&a.forEach(a=>{this.setSubscription(a.id,fN({},a)),this.pending.delete(a.topic)})}async onUnsubscribe(a,b,c){this.events.removeAllListeners(b),this.hasSubscription(b,a)&&this.deleteSubscription(b,c),await this.relayer.messages.del(a)}async setRelayerSubscriptions(a){await this.relayer.core.storage.setItem(this.storageKey,a)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(a,b){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:a,subscription:b}),this.addSubscription(a,b)}addSubscription(a,b){this.subscriptions.set(a,fN({},b)),this.topicMap.set(b.topic,a),this.events.emit(ef.created,b)}getSubscription(a){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:a});let b=this.subscriptions.get(a);if(!b){let{message:b}=di("NO_MATCHING_KEY",`${this.name}: ${a}`);throw Error(b)}return b}deleteSubscription(a,b){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:a,reason:b});let c=this.getSubscription(a);this.subscriptions.delete(a),this.topicMap.delete(c.topic,a),this.events.emit(ef.deleted,fO(fN({},c),{reason:b}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(ef.sync)}async onRestart(){if(this.cached.length){let a=[...this.cached],b=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let c=0;c<b;c++){let b=a.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(b)}}this.events.emit(ef.resubscribed)}async restore(){try{let a=await this.getRelayerSubscriptions();if(typeof a>"u"||!a.length)return;if(this.subscriptions.size){let{message:a}=di("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(a),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),Error(a)}this.cached=a,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(a){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(a)}}async batchSubscribe(a){a.length&&(await this.rpcBatchSubscribe(a),this.onBatchSubscribe(await Promise.all(a.map(async a=>fO(fN({},a),{id:await this.getSubscriptionId(a.topic)})))))}async batchFetchMessages(a){var b;if(!a.length)return;this.logger.trace(`Fetching batch messages for ${a.length} subscriptions`);let c=await this.rpcBatchFetchMessages(a);c&&c.messages&&(await (b=(0,g.toMiliseconds)(g.ONE_SECOND),new Promise(a=>setTimeout(a,b))),await this.relayer.handleBatchMessageEvents(c.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){let{message:a}=di("NOT_INITIALIZED",this.name);throw Error(a)}}async restartToComplete(a){this.relayer.connected||this.relayer.connecting||(this.cached.push(a),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(a){return cQ(a+await this.getClientId())}}var fR=Object.defineProperty,fS=Object.getOwnPropertySymbols,fT=Object.prototype.hasOwnProperty,fU=Object.prototype.propertyIsEnumerable,fV=(a,b,c)=>b in a?fR(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,fW=(a,b)=>{for(var c in b||(b={}))fT.call(b,c)&&fV(a,c,b[c]);if(fS)for(var c of fS(b))fU.call(b,c)&&fV(a,c,b[c]);return a},fX=(a,b,c)=>fV(a,"symbol"!=typeof b?b+"":b,c);class fY extends dO{constructor(a){super(a),fX(this,"protocol","wc"),fX(this,"version",2),fX(this,"core"),fX(this,"logger"),fX(this,"events",new d.EventEmitter),fX(this,"provider"),fX(this,"messages"),fX(this,"subscriber"),fX(this,"publisher"),fX(this,"name","relayer"),fX(this,"transportExplicitlyClosed",!1),fX(this,"initialized",!1),fX(this,"connectionAttemptInProgress",!1),fX(this,"relayUrl"),fX(this,"projectId"),fX(this,"packageName"),fX(this,"bundleId"),fX(this,"hasExperiencedNetworkDisruption",!1),fX(this,"pingTimeout"),fX(this,"heartBeatTimeout",(0,g.toMiliseconds)(g.THIRTY_SECONDS+g.FIVE_SECONDS)),fX(this,"reconnectTimeout"),fX(this,"connectPromise"),fX(this,"reconnectInProgress",!1),fX(this,"requestsInFlight",[]),fX(this,"connectTimeout",(0,g.toMiliseconds)(15*g.ONE_SECOND)),fX(this,"request",async a=>{var b,c;this.logger.debug("Publishing Request Payload");let d=a.id||(0,d_.getBigIntRpcId)().toString();await this.toEstablishConnection();try{this.logger.trace({id:d,method:a.method,topic:null==(b=a.params)?void 0:b.topic},"relayer.request - publishing...");let e=`${d}:${(null==(c=a.params)?void 0:c.tag)||""}`;this.requestsInFlight.push(e);let f=await this.provider.request(a);return this.requestsInFlight=this.requestsInFlight.filter(a=>a!==e),f}catch(a){throw this.logger.debug(`Failed to Publish Request: ${d}`),a}}),fX(this,"resetPingTimeout",()=>{B()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var a,b,c,d;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),null==(d=null==(c=null==(b=null==(a=this.provider)?void 0:a.connection)?void 0:b.socket)?void 0:c.terminate)||d.call(c)}catch(a){this.logger.warn(a,a?.message)}},this.heartBeatTimeout))}),fX(this,"onPayloadHandler",a=>{this.onProviderPayload(a),this.resetPingTimeout()}),fX(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected \uD83D\uDEDC"),this.startPingTimeout(),this.events.emit(d9.connect)}),fX(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected \uD83D\uDED1"),this.requestsInFlight=[],this.onProviderDisconnect()}),fX(this,"onProviderErrorHandler",a=>{this.logger.fatal(`Fatal socket error: ${a.message}`),this.events.emit(d9.error,a),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),fX(this,"registerProviderListeners",()=>{this.provider.on(ea.payload,this.onPayloadHandler),this.provider.on(ea.connect,this.onConnectHandler),this.provider.on(ea.disconnect,this.onDisconnectHandler),this.provider.on(ea.error,this.onProviderErrorHandler)}),this.core=a.core,this.logger="u">typeof a.logger&&"string"!=typeof a.logger?(0,dF.U5)(a.logger,this.name):(0,dF.h6)((0,dF.iP)({level:a.logger||"error"})),this.messages=new fr(this.logger,a.core),this.subscriber=new fQ(this,this.logger),this.publisher=new fC(this,this.logger),this.relayUrl=a?.relayUrl||d8,this.projectId=a.projectId,C()&&"u">typeof global&&"u">typeof(null==global?void 0:global.Platform)&&(null==global?void 0:global.Platform.OS)==="android"?this.packageName=F():C()&&"u">typeof global&&"u">typeof(null==global?void 0:global.Platform)&&(null==global?void 0:global.Platform.OS)==="ios"&&(this.bundleId=F()),this.provider={}}async init(){if(this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.subscriber.hasAnyTopics)try{await this.transportOpen()}catch(a){this.logger.warn(a,a?.message)}}get context(){return(0,dF.oI)(this.logger)}get connected(){var a,b,c;return(null==(c=null==(b=null==(a=this.provider)?void 0:a.connection)?void 0:b.socket)?void 0:c.readyState)===1}get connecting(){var a,b,c;return(null==(c=null==(b=null==(a=this.provider)?void 0:a.connection)?void 0:b.socket)?void 0:c.readyState)===0||void 0!==this.connectPromise}async publish(a,b,c){this.isInitialized(),await this.publisher.publish(a,b,c),await this.recordMessageEvent({topic:a,message:b,publishedAt:Date.now(),transportType:ec.relay},ed.outbound)}async subscribe(a,b){var c,d,e;this.isInitialized(),null!=b&&b.transportType&&b?.transportType!=="relay"||await this.toEstablishConnection();let f=typeof(null==(c=b?.internal)?void 0:c.throwOnFailedPublish)>"u"||(null==(d=b?.internal)?void 0:d.throwOnFailedPublish),g=(null==(e=this.subscriber.topicMap.get(a))?void 0:e[0])||"",h,i=b=>{b.topic===a&&(this.subscriber.off(ef.created,i),h())};return await Promise.all([new Promise(a=>{h=a,this.subscriber.on(ef.created,i)}),new Promise(async(c,d)=>{g=await this.subscriber.subscribe(a,fW({internal:{throwOnFailedPublish:f}},b)).catch(a=>{f&&d(a)})||g,c()})]),g}async unsubscribe(a,b){this.isInitialized(),await this.subscriber.unsubscribe(a,b)}on(a,b){this.events.on(a,b)}once(a,b){this.events.once(a,b)}off(a,b){this.events.off(a,b)}removeListener(a,b){this.events.removeListener(a,b)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await M(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(a){if(!this.subscriber.hasAnyTopics)return void this.logger.warn("Starting WS connection skipped because the client has no topics to work with.");if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(b,c)=>{await this.connect(a).then(b).catch(c).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(a){this.logger.debug({},"Restarting transport..."),this.connectionAttemptInProgress||(this.relayUrl=a||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await dz())throw Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(a){if(a?.length===0)return void this.logger.trace("Batch message events is empty. Ignoring...");let b=a.sort((a,b)=>a.publishedAt-b.publishedAt);for(let a of(this.logger.debug(`Batch of ${b.length} message events sorted`),b))try{await this.onMessageEvent(a)}catch(a){this.logger.warn(a,"Error while processing batch message event: "+a?.message)}this.logger.trace(`Batch of ${b.length} message events processed`)}async onLinkMessageEvent(a,b){let{topic:c}=a;if(!b.sessionExists){let a=P(g.FIVE_MINUTES);await this.core.pairing.pairings.set(c,{topic:c,expiry:a,relay:{protocol:"irn"},active:!1})}this.events.emit(d9.message,a),await this.recordMessageEvent(a,ed.inbound)}async connect(a){await this.confirmOnlineStateOrThrow(),a&&a!==this.relayUrl&&(this.relayUrl=a,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let b=1;for(;b<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${b}...`),await this.createProvider(),await new Promise(async(a,b)=>{let c=()=>{b(Error("Connection interrupted while trying to subscribe"))};this.provider.once(ea.disconnect,c),await M(new Promise((a,b)=>{this.provider.connect().then(a).catch(b)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(a=>{b(a)}).finally(()=>{this.provider.off(ea.disconnect,c),clearTimeout(this.reconnectTimeout)}),await new Promise(async(a,b)=>{let c=()=>{b(Error("Connection interrupted while trying to subscribe"))};this.provider.once(ea.disconnect,c),await this.subscriber.start().then(a).catch(b).finally(()=>{this.provider.off(ea.disconnect,c)})}),this.hasExperiencedNetworkDisruption=!1,a()})}catch(a){await this.subscriber.stop(),this.logger.warn({},a.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${b}`);break}await new Promise(a=>setTimeout(a,(0,g.toMiliseconds)(+b))),b++}}startPingTimeout(){var a,b,c,d,e;if(B())try{null!=(b=null==(a=this.provider)?void 0:a.connection)&&b.socket&&(null==(e=null==(d=null==(c=this.provider)?void 0:c.connection)?void 0:d.socket)||e.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(a){this.logger.warn(a,a?.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();let a=await this.core.crypto.signJWT(this.relayUrl);this.provider=new d$.F(new d0.A(function({protocol:a,version:b,relayUrl:c,sdkVersion:d,auth:e,projectId:f,useOnCloseEvent:g,bundleId:h,packageName:i}){let j=c.split("?"),k=H(a,b,d),l=function(a,b){let c=new URLSearchParams(a);for(let a of Object.keys(b).sort())if(b.hasOwnProperty(a)){let d=b[a];void 0!==d&&c.set(a,d)}return c.toString()}(j[1]||"",{auth:e,ua:k,projectId:f,useOnCloseEvent:g||void 0,packageName:i||void 0,bundleId:h||void 0});return j[0]+"?"+l}({sdkVersion:eb,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:a,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(a,b){let{topic:c,message:d}=a;await this.messages.set(c,d,b)}async shouldIgnoreMessageEvent(a){let{topic:b,message:c}=a;if(!c||0===c.length)return this.logger.warn(`Ignoring invalid/empty message: ${c}`),!0;if(!await this.subscriber.isKnownTopic(b))return this.logger.warn(`Ignoring message for unknown topic ${b}`),!0;let d=this.messages.has(b,c);return d&&this.logger.warn(`Ignoring duplicate message: ${c}`),d}async onProviderPayload(a){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:a}),(0,d_.isJsonRpcRequest)(a)){if(!a.method.endsWith("_subscription"))return;let b=a.params,{topic:c,message:d,publishedAt:e,attestation:f}=b.data,g={topic:c,message:d,publishedAt:e,transportType:ec.relay,attestation:f};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(fW({type:"event",event:b.id},g)),this.events.emit(b.id,g),await this.acknowledgePayload(a),await this.onMessageEvent(g)}else(0,d_.isJsonRpcResponse)(a)&&this.events.emit(d9.message_ack,a)}async onMessageEvent(a){await this.shouldIgnoreMessageEvent(a)||(await this.recordMessageEvent(a,ed.inbound),this.events.emit(d9.message,a))}async acknowledgePayload(a){let b=(0,d_.formatJsonRpcResult)(a.id,!0);await this.provider.connection.send(b)}unregisterProviderListeners(){this.provider.off(ea.payload,this.onPayloadHandler),this.provider.off(ea.connect,this.onConnectHandler),this.provider.off(ea.disconnect,this.onDisconnectHandler),this.provider.off(ea.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let a=await dz();(function(a){var b,c;switch(E()){case A.browser:b=a,!C()&&D()&&(window.addEventListener("online",()=>b(!0)),window.addEventListener("offline",()=>b(!1)));break;case A.reactNative:c=a,C()&&"u">typeof global&&null!=global&&global.NetInfo&&global?.NetInfo.addEventListener(a=>c(a?.isConnected));case A.node:}})(async b=>{a!==b&&(a=b,b?await this.transportOpen().catch(a=>this.logger.error(a,a?.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))}),this.core.heartbeat.on(dD.li.pulse,async()=>{var a;if(!this.transportExplicitlyClosed&&!this.connected&&(!(D()&&(0,h.getDocument)())||(null==(a=(0,h.getDocument)())?void 0:a.visibilityState)==="visible"))try{await this.confirmOnlineStateOrThrow(),await this.transportOpen()}catch(a){this.logger.warn(a,a?.message)}})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(d9.disconnect),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(a=>this.logger.error(a,a?.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},(0,g.toMiliseconds)(.1)))))}isInitialized(){if(!this.initialized){let{message:a}=di("NOT_INITIALIZED",this.name);throw Error(a)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectPromise)return void await this.connectPromise;await this.connect()}}}function fZ(){}function f$(a){if(!a||"object"!=typeof a)return!1;let b=Object.getPrototypeOf(a);return(null===b||b===Object.prototype||null===Object.getPrototypeOf(b))&&"[object Object]"===Object.prototype.toString.call(a)}function f_(a){return Object.getOwnPropertySymbols(a).filter(b=>Object.prototype.propertyIsEnumerable.call(a,b))}function f0(a){return null==a?void 0===a?"[object Undefined]":"[object Null]":Object.prototype.toString.call(a)}let f1="[object Arguments]",f2="[object Object]";var f3=Object.defineProperty,f4=Object.getOwnPropertySymbols,f5=Object.prototype.hasOwnProperty,f6=Object.prototype.propertyIsEnumerable,f7=(a,b,c)=>b in a?f3(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,f8=(a,b)=>{for(var c in b||(b={}))f5.call(b,c)&&f7(a,c,b[c]);if(f4)for(var c of f4(b))f6.call(b,c)&&f7(a,c,b[c]);return a},f9=(a,b,c)=>f7(a,"symbol"!=typeof b?b+"":b,c);class ga extends dP{constructor(a,b,c,d=d2,e){super(a,b,c,d),this.core=a,this.logger=b,this.name=c,f9(this,"map",new Map),f9(this,"version","0.3"),f9(this,"cached",[]),f9(this,"initialized",!1),f9(this,"getKey"),f9(this,"storagePrefix",d2),f9(this,"recentlyDeleted",[]),f9(this,"recentlyDeletedLimit",200),f9(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(a=>{this.getKey&&null!==a&&!dm(a)?this.map.set(this.getKey(a),a):function(a){var b;return null==(b=a?.proposer)?void 0:b.publicKey}(a)?this.map.set(a.id,a):a?.topic&&this.map.set(a.topic,a)}),this.cached=[],this.initialized=!0)}),f9(this,"set",async(a,b)=>{this.isInitialized(),this.map.has(a)?await this.update(a,b):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:a,value:b}),this.map.set(a,b),await this.persist())}),f9(this,"get",a=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:a}),this.getData(a))),f9(this,"getAll",a=>(this.isInitialized(),a?this.values.filter(b=>Object.keys(a).every(c=>{var d;return d=b[c],function a(b,c,d,e,f,g,h){let i=h(b,c,d,e,f,g);if(void 0!==i)return i;if(typeof b==typeof c)switch(typeof b){case"bigint":case"string":case"boolean":case"symbol":case"undefined":case"function":return b===c;case"number":return b===c||Object.is(b,c)}return function b(c,d,e,f){if(Object.is(c,d))return!0;let g=f0(c),h=f0(d);if(g===f1&&(g=f2),h===f1&&(h=f2),g!==h)return!1;switch(g){case"[object String]":return c.toString()===d.toString();case"[object Number]":{let a=c.valueOf(),b=d.valueOf();return a===b||Number.isNaN(a)&&Number.isNaN(b)}case"[object Boolean]":case"[object Date]":case"[object Symbol]":return Object.is(c.valueOf(),d.valueOf());case"[object RegExp]":return c.source===d.source&&c.flags===d.flags;case"[object Function]":return c===d}let i=(e=e??new Map).get(c),j=e.get(d);if(null!=i&&null!=j)return i===d;e.set(c,d),e.set(d,c);try{switch(g){case"[object Map]":if(c.size!==d.size)return!1;for(let[b,g]of c.entries())if(!d.has(b)||!a(g,d.get(b),b,c,d,e,f))return!1;return!0;case"[object Set]":{if(c.size!==d.size)return!1;let b=Array.from(c.values()),g=Array.from(d.values());for(let h=0;h<b.length;h++){let i=b[h],j=g.findIndex(b=>a(i,b,void 0,c,d,e,f));if(-1===j)return!1;g.splice(j,1)}return!0}case"[object Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":case"[object BigUint64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object BigInt64Array]":case"[object Float32Array]":case"[object Float64Array]":if("u">typeof Buffer&&Buffer.isBuffer(c)!==Buffer.isBuffer(d)||c.length!==d.length)return!1;for(let b=0;b<c.length;b++)if(!a(c[b],d[b],b,c,d,e,f))return!1;return!0;case"[object ArrayBuffer]":return c.byteLength===d.byteLength&&b(new Uint8Array(c),new Uint8Array(d),e,f);case"[object DataView]":return c.byteLength===d.byteLength&&c.byteOffset===d.byteOffset&&b(new Uint8Array(c),new Uint8Array(d),e,f);case"[object Error]":return c.name===d.name&&c.message===d.message;case f2:{if(!(b(c.constructor,d.constructor,e,f)||f$(c)&&f$(d)))return!1;let g=[...Object.keys(c),...f_(c)],h=[...Object.keys(d),...f_(d)];if(g.length!==h.length)return!1;for(let b=0;b<g.length;b++){let h=g[b],i=c[h];if(!Object.hasOwn(d,h))return!1;let j=d[h];if(!a(i,j,h,c,d,e,f))return!1}return!0}default:return!1}}finally{e.delete(c),e.delete(d)}}(b,c,g,h)}(d,a[c],void 0,void 0,void 0,void 0,fZ)})):this.values)),f9(this,"update",async(a,b)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:a,update:b});let c=f8(f8({},this.getData(a)),b);this.map.set(a,c),await this.persist()}),f9(this,"delete",async(a,b)=>{this.isInitialized(),this.map.has(a)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:a,reason:b}),this.map.delete(a),this.addToRecentlyDeleted(a),await this.persist())}),this.logger=(0,dF.U5)(b,this.name),this.storagePrefix=d,this.getKey=e}get context(){return(0,dF.oI)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(a){this.recentlyDeleted.push(a),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(a){await this.core.storage.setItem(this.storageKey,a)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(a){let b=this.map.get(a);if(!b){if(this.recentlyDeleted.includes(a)){let{message:b}=di("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${a}`);throw this.logger.error(b),Error(b)}let{message:b}=di("NO_MATCHING_KEY",`${this.name}: ${a}`);throw this.logger.error(b),Error(b)}return b}async persist(){await this.setDataStore(this.values)}async restore(){try{let a=await this.getDataStore();if(typeof a>"u"||!a.length)return;if(this.map.size){let{message:a}=di("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(a),Error(a)}this.cached=a,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(a){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(a)}}isInitialized(){if(!this.initialized){let{message:a}=di("NOT_INITIALIZED",this.name);throw Error(a)}}}var gb=Object.defineProperty,gc=(a,b,c)=>((a,b,c)=>b in a?gb(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c)(a,"symbol"!=typeof b?b+"":b,c);class gd{constructor(a,b){this.core=a,this.logger=b,gc(this,"name","pairing"),gc(this,"version","0.3"),gc(this,"events",new(e())),gc(this,"pairings"),gc(this,"initialized",!1),gc(this,"storagePrefix",d2),gc(this,"ignoredPayloadTypes",[1]),gc(this,"registeredMethods",[]),gc(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),gc(this,"register",({methods:a})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...a])]}),gc(this,"create",async a=>{this.isInitialized();let b=cO(),c=await this.core.crypto.setSymKey(b),d=P(g.FIVE_MINUTES),e={protocol:"irn"},f={topic:c,expiry:d,relay:e,active:!1,methods:a?.methods},h=c0({protocol:this.core.protocol,version:this.core.version,topic:c,symKey:b,relay:e,expiryTimestamp:d,methods:a?.methods});return this.events.emit(eh.create,f),this.core.expirer.set(c,d),await this.pairings.set(c,f),await this.core.relayer.subscribe(c,{transportType:a?.transportType}),{topic:c,uri:h}}),gc(this,"pair",async a=>{let b;this.isInitialized();let c=this.core.eventClient.createEvent({properties:{topic:a?.uri,trace:[en.pairing_started]}});this.isValidPair(a,c);let{topic:d,symKey:e,relay:f,expiryTimestamp:h,methods:i}=c_(a.uri);if(c.props.properties.topic=d,c.addTrace(en.pairing_uri_validation_success),c.addTrace(en.pairing_uri_not_expired),this.pairings.keys.includes(d)){if(b=this.pairings.get(d),c.addTrace(en.existing_pairing),b.active)throw c.setError(eo.active_pairing_already_exists),Error(`Pairing already exists: ${d}. Please try again with a new connection URI.`);c.addTrace(en.pairing_not_expired)}let j=h||P(g.FIVE_MINUTES),k={topic:d,relay:f,expiry:j,active:!1,methods:i};this.core.expirer.set(d,j),await this.pairings.set(d,k),c.addTrace(en.store_new_pairing),a.activatePairing&&await this.activate({topic:d}),this.events.emit(eh.create,k),c.addTrace(en.emit_inactive_pairing),this.core.crypto.keychain.has(d)||await this.core.crypto.setSymKey(e,d),c.addTrace(en.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{c.setError(eo.no_internet_connection)}try{await this.core.relayer.subscribe(d,{relay:f})}catch(a){throw c.setError(eo.subscribe_pairing_topic_failure),a}return c.addTrace(en.subscribe_pairing_topic_success),k}),gc(this,"activate",async({topic:a})=>{this.isInitialized();let b=P(g.FIVE_MINUTES);this.core.expirer.set(a,b),await this.pairings.update(a,{active:!0,expiry:b})}),gc(this,"ping",async a=>{this.isInitialized(),await this.isValidPing(a),this.logger.warn("ping() is deprecated and will be removed in the next major release.");let{topic:b}=a;if(this.pairings.keys.includes(b)){let a=await this.sendRequest(b,"wc_pairingPing",{}),{done:c,resolve:d,reject:e}=L();this.events.once(R("pairing_ping",a),({error:a})=>{a?e(a):d()}),await c()}}),gc(this,"updateExpiry",async({topic:a,expiry:b})=>{this.isInitialized(),await this.pairings.update(a,{expiry:b})}),gc(this,"updateMetadata",async({topic:a,metadata:b})=>{this.isInitialized(),await this.pairings.update(a,{peerMetadata:b})}),gc(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),gc(this,"disconnect",async a=>{this.isInitialized(),await this.isValidDisconnect(a);let{topic:b}=a;this.pairings.keys.includes(b)&&(await this.sendRequest(b,"wc_pairingDelete",dj("USER_DISCONNECTED")),await this.deletePairing(b))}),gc(this,"formatUriFromPairing",a=>{this.isInitialized();let{topic:b,relay:c,expiry:d,methods:e}=a,f=this.core.crypto.keychain.get(b);return c0({protocol:this.core.protocol,version:this.core.version,topic:b,symKey:f,relay:c,expiryTimestamp:d,methods:e})}),gc(this,"sendRequest",async(a,b,c)=>{let d=(0,d_.formatJsonRpcRequest)(b,c),e=await this.core.crypto.encode(a,d),f=eg[b].req;return this.core.history.set(a,d),this.core.relayer.publish(a,e,f),d.id}),gc(this,"sendResult",async(a,b,c)=>{let d=(0,d_.formatJsonRpcResult)(a,c),e=await this.core.crypto.encode(b,d),f=eg[(await this.core.history.get(b,a)).request.method].res;await this.core.relayer.publish(b,e,f),await this.core.history.resolve(d)}),gc(this,"sendError",async(a,b,c)=>{let d=(0,d_.formatJsonRpcError)(a,c),e=await this.core.crypto.encode(b,d),f=(await this.core.history.get(b,a)).request.method,g=eg[f]?eg[f].res:eg.unregistered_method.res;await this.core.relayer.publish(b,e,g),await this.core.history.resolve(d)}),gc(this,"deletePairing",async(a,b)=>{await this.core.relayer.unsubscribe(a),await Promise.all([this.pairings.delete(a,dj("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(a),b?Promise.resolve():this.core.expirer.del(a)])}),gc(this,"cleanup",async()=>{let a=this.pairings.getAll().filter(a=>Q(a.expiry));await Promise.all(a.map(a=>this.deletePairing(a.topic)))}),gc(this,"onRelayEventRequest",async a=>{let{topic:b,payload:c}=a;switch(c.method){case"wc_pairingPing":return await this.onPairingPingRequest(b,c);case"wc_pairingDelete":return await this.onPairingDeleteRequest(b,c);default:return await this.onUnknownRpcMethodRequest(b,c)}}),gc(this,"onRelayEventResponse",async a=>{let{topic:b,payload:c}=a,d=(await this.core.history.get(b,c.id)).request.method;return"wc_pairingPing"===d?this.onPairingPingResponse(b,c):this.onUnknownRpcMethodResponse(d)}),gc(this,"onPairingPingRequest",async(a,b)=>{let{id:c}=b;try{this.isValidPing({topic:a}),await this.sendResult(c,a,!0),this.events.emit(eh.ping,{id:c,topic:a})}catch(b){await this.sendError(c,a,b),this.logger.error(b)}}),gc(this,"onPairingPingResponse",(a,b)=>{let{id:c}=b;setTimeout(()=>{(0,d_.isJsonRpcResult)(b)?this.events.emit(R("pairing_ping",c),{}):(0,d_.isJsonRpcError)(b)&&this.events.emit(R("pairing_ping",c),{error:b.error})},500)}),gc(this,"onPairingDeleteRequest",async(a,b)=>{let{id:c}=b;try{this.isValidDisconnect({topic:a}),await this.deletePairing(a),this.events.emit(eh.delete,{id:c,topic:a})}catch(b){await this.sendError(c,a,b),this.logger.error(b)}}),gc(this,"onUnknownRpcMethodRequest",async(a,b)=>{let{id:c,method:d}=b;try{if(this.registeredMethods.includes(d))return;let b=dj("WC_METHOD_UNSUPPORTED",d);await this.sendError(c,a,b),this.logger.error(b)}catch(b){await this.sendError(c,a,b),this.logger.error(b)}}),gc(this,"onUnknownRpcMethodResponse",a=>{this.registeredMethods.includes(a)||this.logger.error(dj("WC_METHOD_UNSUPPORTED",a))}),gc(this,"isValidPair",(a,b)=>{var c;if(!dv(a)){let{message:c}=di("MISSING_OR_INVALID",`pair() params: ${a}`);throw b.setError(eo.malformed_pairing_uri),Error(c)}if(!function(a){function b(a){try{return"u">typeof new URL(a)}catch{return!1}}try{if(dn(a,!1)){if(b(a))return!0;let c=Y(a);return b(c)}}catch{}return!1}(a.uri)){let{message:c}=di("MISSING_OR_INVALID",`pair() uri: ${a.uri}`);throw b.setError(eo.malformed_pairing_uri),Error(c)}let d=c_(a?.uri);if(!(null!=(c=d?.relay)&&c.protocol)){let{message:a}=di("MISSING_OR_INVALID","pair() uri#relay-protocol");throw b.setError(eo.malformed_pairing_uri),Error(a)}if(!(null!=d&&d.symKey)){let{message:a}=di("MISSING_OR_INVALID","pair() uri#symKey");throw b.setError(eo.malformed_pairing_uri),Error(a)}if(null!=d&&d.expiryTimestamp&&(0,g.toMiliseconds)(d?.expiryTimestamp)<Date.now()){b.setError(eo.pairing_expired);let{message:a}=di("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw Error(a)}}),gc(this,"isValidPing",async a=>{if(!dv(a)){let{message:b}=di("MISSING_OR_INVALID",`ping() params: ${a}`);throw Error(b)}let{topic:b}=a;await this.isValidPairingTopic(b)}),gc(this,"isValidDisconnect",async a=>{if(!dv(a)){let{message:b}=di("MISSING_OR_INVALID",`disconnect() params: ${a}`);throw Error(b)}let{topic:b}=a;await this.isValidPairingTopic(b)}),gc(this,"isValidPairingTopic",async a=>{if(!dn(a,!1)){let{message:b}=di("MISSING_OR_INVALID",`pairing topic should be a string: ${a}`);throw Error(b)}if(!this.pairings.keys.includes(a)){let{message:b}=di("NO_MATCHING_KEY",`pairing topic doesn't exist: ${a}`);throw Error(b)}if(Q(this.pairings.get(a).expiry)){await this.deletePairing(a);let{message:b}=di("EXPIRED",`pairing topic: ${a}`);throw Error(b)}}),this.core=a,this.logger=(0,dF.U5)(b,this.name),this.pairings=new ga(this.core,this.logger,this.name,this.storagePrefix)}get context(){return(0,dF.oI)(this.logger)}isInitialized(){if(!this.initialized){let{message:a}=di("NOT_INITIALIZED",this.name);throw Error(a)}}registerRelayerEvents(){this.core.relayer.on(d9.message,async a=>{let{topic:b,message:c,transportType:d}=a;if(this.pairings.keys.includes(b)&&d!==ec.link_mode&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(c)))try{let a=await this.core.crypto.decode(b,c);(0,d_.isJsonRpcRequest)(a)?(this.core.history.set(b,a),await this.onRelayEventRequest({topic:b,payload:a})):(0,d_.isJsonRpcResponse)(a)&&(await this.core.history.resolve(a),await this.onRelayEventResponse({topic:b,payload:a}),this.core.history.delete(b,a.id)),await this.core.relayer.messages.ack(b,c)}catch(a){this.logger.error(a)}})}registerExpirerEvents(){this.core.expirer.on(ej.expired,async a=>{let{topic:b}=O(a.target);b&&this.pairings.keys.includes(b)&&(await this.deletePairing(b,!0),this.events.emit(eh.expire,{topic:b}))})}}var ge=Object.defineProperty,gf=(a,b,c)=>((a,b,c)=>b in a?ge(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c)(a,"symbol"!=typeof b?b+"":b,c);class gg extends dL{constructor(a,b){super(a,b),this.core=a,this.logger=b,gf(this,"records",new Map),gf(this,"events",new d.EventEmitter),gf(this,"name","history"),gf(this,"version","0.3"),gf(this,"cached",[]),gf(this,"initialized",!1),gf(this,"storagePrefix",d2),gf(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(a=>this.records.set(a.id,a)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),gf(this,"set",(a,b,c)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:a,request:b,chainId:c}),this.records.has(b.id))return;let d={id:b.id,topic:a,request:{method:b.method,params:b.params||null},chainId:c,expiry:P(g.THIRTY_DAYS)};this.records.set(d.id,d),this.persist(),this.events.emit(ei.created,d)}),gf(this,"resolve",async a=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:a}),!this.records.has(a.id))return;let b=await this.getRecord(a.id);typeof b.response>"u"&&(b.response=(0,d_.isJsonRpcError)(a)?{error:a.error}:{result:a.result},this.records.set(b.id,b),this.persist(),this.events.emit(ei.updated,b))}),gf(this,"get",async(a,b)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:a,id:b}),await this.getRecord(b))),gf(this,"delete",(a,b)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:b}),this.values.forEach(c=>{c.topic===a&&("u">typeof b&&c.id!==b||(this.records.delete(c.id),this.events.emit(ei.deleted,c)))}),this.persist()}),gf(this,"exists",async(a,b)=>(this.isInitialized(),!!this.records.has(b)&&(await this.getRecord(b)).topic===a)),gf(this,"on",(a,b)=>{this.events.on(a,b)}),gf(this,"once",(a,b)=>{this.events.once(a,b)}),gf(this,"off",(a,b)=>{this.events.off(a,b)}),gf(this,"removeListener",(a,b)=>{this.events.removeListener(a,b)}),this.logger=(0,dF.U5)(b,this.name)}get context(){return(0,dF.oI)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){let a=[];return this.values.forEach(b=>{if("u">typeof b.response)return;let c={topic:b.topic,request:(0,d_.formatJsonRpcRequest)(b.request.method,b.request.params,b.id),chainId:b.chainId};return a.push(c)}),a}async setJsonRpcRecords(a){await this.core.storage.setItem(this.storageKey,a)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(a){this.isInitialized();let b=this.records.get(a);if(!b){let{message:b}=di("NO_MATCHING_KEY",`${this.name}: ${a}`);throw Error(b)}return b}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(ei.sync)}async restore(){try{let a=await this.getJsonRpcRecords();if(typeof a>"u"||!a.length)return;if(this.records.size){let{message:a}=di("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(a),Error(a)}this.cached=a,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(a){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(a)}}registerEventListeners(){this.events.on(ei.created,a=>{let b=ei.created;this.logger.info(`Emitting ${b}`),this.logger.debug({type:"event",event:b,record:a})}),this.events.on(ei.updated,a=>{let b=ei.updated;this.logger.info(`Emitting ${b}`),this.logger.debug({type:"event",event:b,record:a})}),this.events.on(ei.deleted,a=>{let b=ei.deleted;this.logger.info(`Emitting ${b}`),this.logger.debug({type:"event",event:b,record:a})}),this.core.heartbeat.on(dD.li.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let a=!1;this.records.forEach(b=>{(0,g.toMiliseconds)(b.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${b.id}`),this.records.delete(b.id),this.events.emit(ei.deleted,b,!1),a=!0)}),a&&this.persist()}catch(a){this.logger.warn(a)}}isInitialized(){if(!this.initialized){let{message:a}=di("NOT_INITIALIZED",this.name);throw Error(a)}}}var gh=Object.defineProperty,gi=(a,b,c)=>((a,b,c)=>b in a?gh(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c)(a,"symbol"!=typeof b?b+"":b,c);class gj extends dR{constructor(a,b){super(a,b),this.core=a,this.logger=b,gi(this,"expirations",new Map),gi(this,"events",new d.EventEmitter),gi(this,"name","expirer"),gi(this,"version","0.3"),gi(this,"cached",[]),gi(this,"initialized",!1),gi(this,"storagePrefix",d2),gi(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(a=>this.expirations.set(a.target,a)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),gi(this,"has",a=>{try{let b=this.formatTarget(a);return"u">typeof this.getExpiration(b)}catch{return!1}}),gi(this,"set",(a,b)=>{this.isInitialized();let c=this.formatTarget(a),d={target:c,expiry:b};this.expirations.set(c,d),this.checkExpiry(c,d),this.events.emit(ej.created,{target:c,expiration:d})}),gi(this,"get",a=>{this.isInitialized();let b=this.formatTarget(a);return this.getExpiration(b)}),gi(this,"del",a=>{if(this.isInitialized(),this.has(a)){let b=this.formatTarget(a),c=this.getExpiration(b);this.expirations.delete(b),this.events.emit(ej.deleted,{target:b,expiration:c})}}),gi(this,"on",(a,b)=>{this.events.on(a,b)}),gi(this,"once",(a,b)=>{this.events.once(a,b)}),gi(this,"off",(a,b)=>{this.events.off(a,b)}),gi(this,"removeListener",(a,b)=>{this.events.removeListener(a,b)}),this.logger=(0,dF.U5)(b,this.name)}get context(){return(0,dF.oI)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(a){if("string"==typeof a)return N("topic",a);if("number"==typeof a)return N("id",a);let{message:b}=di("UNKNOWN_TYPE",`Target type: ${typeof a}`);throw Error(b)}async setExpirations(a){await this.core.storage.setItem(this.storageKey,a)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(ej.sync)}async restore(){try{let a=await this.getExpirations();if(typeof a>"u"||!a.length)return;if(this.expirations.size){let{message:a}=di("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(a),Error(a)}this.cached=a,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(a){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(a)}}getExpiration(a){let b=this.expirations.get(a);if(!b){let{message:b}=di("NO_MATCHING_KEY",`${this.name}: ${a}`);throw this.logger.warn(b),Error(b)}return b}checkExpiry(a,b){let{expiry:c}=b;(0,g.toMiliseconds)(c)-Date.now()<=0&&this.expire(a,b)}expire(a,b){this.expirations.delete(a),this.events.emit(ej.expired,{target:a,expiration:b})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((a,b)=>this.checkExpiry(b,a))}registerEventListeners(){this.core.heartbeat.on(dD.li.pulse,()=>this.checkExpirations()),this.events.on(ej.created,a=>{let b=ej.created;this.logger.info(`Emitting ${b}`),this.logger.debug({type:"event",event:b,data:a}),this.persist()}),this.events.on(ej.expired,a=>{let b=ej.expired;this.logger.info(`Emitting ${b}`),this.logger.debug({type:"event",event:b,data:a}),this.persist()}),this.events.on(ej.deleted,a=>{let b=ej.deleted;this.logger.info(`Emitting ${b}`),this.logger.debug({type:"event",event:b,data:a}),this.persist()})}isInitialized(){if(!this.initialized){let{message:a}=di("NOT_INITIALIZED",this.name);throw Error(a)}}}var gk=Object.defineProperty,gl=(a,b,c)=>((a,b,c)=>b in a?gk(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c)(a,"symbol"!=typeof b?b+"":b,c);class gm extends dS{constructor(a,b,c){super(a,b,c),this.core=a,this.logger=b,this.store=c,gl(this,"name","verify-api"),gl(this,"abortController"),gl(this,"isDevEnv"),gl(this,"verifyUrlV3",el),gl(this,"storagePrefix",d2),gl(this,"version",2),gl(this,"publicKey"),gl(this,"fetchPromise"),gl(this,"init",async()=>{var a;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&(0,g.toMiliseconds)(null==(a=this.publicKey)?void 0:a.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),gl(this,"register",async a=>{if(!D()||this.isDevEnv)return;let b=window.location.origin,{id:c,decryptedId:d}=a,e=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${b}&id=${c}&decryptedId=${d}`;try{let a=(0,h.getDocument)(),b=this.startAbortTimer(5*g.ONE_SECOND),d=await new Promise((d,f)=>{let g=()=>{window.removeEventListener("message",i),a.body.removeChild(h),f("attestation aborted")};this.abortController.signal.addEventListener("abort",g);let h=a.createElement("iframe");h.src=e,h.style.display="none",h.addEventListener("error",g,{signal:this.abortController.signal});let i=e=>{if(e.data&&"string"==typeof e.data)try{let f=JSON.parse(e.data);if("verify_attestation"===f.type){if((0,l.Cq)(f.attestation).payload.id!==c)return;clearInterval(b),a.body.removeChild(h),this.abortController.signal.removeEventListener("abort",g),window.removeEventListener("message",i),d(null===f.attestation?"":f.attestation)}}catch(a){this.logger.warn(a)}};a.body.appendChild(h),window.addEventListener("message",i,{signal:this.abortController.signal})});return this.logger.debug("jwt attestation",d),d}catch(a){this.logger.warn(a)}return""}),gl(this,"resolve",async a=>{if(this.isDevEnv)return"";let{attestationId:b,hash:c,encryptedId:d}=a;if(""===b)return void this.logger.debug("resolve: attestationId is empty, skipping");if(b){if((0,l.Cq)(b).payload.id!==d)return;let a=await this.isValidJwtAttestation(b);if(a)return a.isVerified?a:void this.logger.warn("resolve: jwt attestation: origin url not verified")}if(!c)return;let e=this.getVerifyUrl(a?.verifyUrl);return this.fetchAttestation(c,e)}),gl(this,"fetchAttestation",async(a,b)=>{this.logger.debug(`resolving attestation: ${a} from url: ${b}`);let c=this.startAbortTimer(5*g.ONE_SECOND),d=await fetch(`${b}/attestation/${a}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(c),200===d.status?await d.json():void 0}),gl(this,"getVerifyUrl",a=>{let b=a||ek;return em.includes(b)||(this.logger.info(`verify url: ${b}, not included in trusted list, assigning default: ${ek}`),b=ek),b}),gl(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);let a=this.startAbortTimer(g.FIVE_SECONDS),b=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(a),await b.json()}catch(a){this.logger.warn(a)}}),gl(this,"persistPublicKey",async a=>{this.logger.debug("persisting public key to local storage",a),await this.store.setItem(this.storeKey,a),this.publicKey=a}),gl(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),gl(this,"isValidJwtAttestation",async a=>{let b=await this.getPublicKey();try{if(b)return this.validateAttestation(a,b)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}let c=await this.fetchAndPersistPublicKey();try{if(c)return this.validateAttestation(a,c)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}}),gl(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),gl(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async a=>{let b=await this.fetchPublicKey();b&&(await this.persistPublicKey(b),a(b))});let a=await this.fetchPromise;return this.fetchPromise=void 0,a}),gl(this,"validateAttestation",(a,b)=>{let c=function(a,b){let[c,d,e]=a.split("."),f=Buffer.from(cU(e),"base64");if(64!==f.length)throw Error("Invalid signature length");let g=f.slice(0,32),h=f.slice(32,64),i=by(`${c}.${d}`),j=function(a){let b=Buffer.from(a.x,"base64"),c=Buffer.from(a.y,"base64");return(0,m.xW)([new Uint8Array([4]),b,c])}(b);if(!cI.verify((0,m.xW)([g,h]),i,j))throw Error("Invalid signature");return(0,l.Cq)(a).payload}(a,b.publicKey),d={hasExpired:(0,g.toMiliseconds)(c.exp)<Date.now(),payload:c};if(d.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),Error("JWT attestation expired");return{origin:d.payload.origin,isScam:d.payload.isScam,isVerified:d.payload.isVerified}}),this.logger=(0,dF.U5)(b,this.name),this.abortController=new AbortController,this.isDevEnv=X(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return(0,dF.oI)(this.logger)}startAbortTimer(a){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),(0,g.toMiliseconds)(a))}}var gn=Object.defineProperty,go=(a,b,c)=>((a,b,c)=>b in a?gn(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c)(a,"symbol"!=typeof b?b+"":b,c);class gp extends dT{constructor(a,b){super(a,b),this.projectId=a,this.logger=b,go(this,"context","echo"),go(this,"registerDeviceToken",async a=>{let{clientId:b,token:c,notificationType:d,enableEncrypted:e=!1}=a,f=`https://echo.walletconnect.com/${this.projectId}/clients`;await fetch(f,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:b,type:d,token:c,always_raw:e})})}),this.logger=(0,dF.U5)(b,this.context)}}var gq=Object.defineProperty,gr=Object.getOwnPropertySymbols,gs=Object.prototype.hasOwnProperty,gt=Object.prototype.propertyIsEnumerable,gu=(a,b,c)=>b in a?gq(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,gv=(a,b)=>{for(var c in b||(b={}))gs.call(b,c)&&gu(a,c,b[c]);if(gr)for(var c of gr(b))gt.call(b,c)&&gu(a,c,b[c]);return a},gw=(a,b,c)=>gu(a,"symbol"!=typeof b?b+"":b,c);class gx extends dU{constructor(a,b,c=!0){super(a,b,c),this.core=a,this.logger=b,gw(this,"context","event-client"),gw(this,"storagePrefix",d2),gw(this,"storageVersion",.1),gw(this,"events",new Map),gw(this,"shouldPersist",!1),gw(this,"init",async()=>{if(!X())try{let a={eventId:W(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:H(this.core.relayer.protocol,this.core.relayer.version,eb)}}};await this.sendEvent([a])}catch(a){this.logger.warn(a)}}),gw(this,"createEvent",a=>{let{event:b="ERROR",type:c="",properties:{topic:d,trace:e}}=a,f=W(),g=this.core.projectId||"",h=gv({eventId:f,timestamp:Date.now(),props:{event:b,type:c,properties:{topic:d,trace:e}},bundleId:g,domain:this.getAppDomain()},this.setMethods(f));return this.telemetryEnabled&&(this.events.set(f,h),this.shouldPersist=!0),h}),gw(this,"getEvent",a=>{let{eventId:b,topic:c}=a;if(b)return this.events.get(b);let d=Array.from(this.events.values()).find(a=>a.props.properties.topic===c);if(d)return gv(gv({},d),this.setMethods(d.eventId))}),gw(this,"deleteEvent",a=>{let{eventId:b}=a;this.events.delete(b),this.shouldPersist=!0}),gw(this,"setEventListeners",()=>{this.core.heartbeat.on(dD.li.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(a=>{(0,g.fromMiliseconds)(Date.now())-(0,g.fromMiliseconds)(a.timestamp)>86400&&(this.events.delete(a.eventId),this.shouldPersist=!0)})})}),gw(this,"setMethods",a=>({addTrace:b=>this.addTrace(a,b),setError:b=>this.setError(a,b)})),gw(this,"addTrace",(a,b)=>{let c=this.events.get(a);c&&(c.props.properties.trace.push(b),this.events.set(a,c),this.shouldPersist=!0)}),gw(this,"setError",(a,b)=>{let c=this.events.get(a);c&&(c.props.type=b,c.timestamp=Date.now(),this.events.set(a,c),this.shouldPersist=!0)}),gw(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),gw(this,"restore",async()=>{try{let a=await this.core.storage.getItem(this.storageKey)||[];if(!a.length)return;a.forEach(a=>{this.events.set(a.eventId,gv(gv({},a),this.setMethods(a.eventId)))})}catch(a){this.logger.warn(a)}}),gw(this,"submit",async()=>{if(!this.telemetryEnabled||0===this.events.size)return;let a=[];for(let[b,c]of this.events)c.props.type&&a.push(c);if(0!==a.length)try{if((await this.sendEvent(a)).ok)for(let b of a)this.events.delete(b.eventId),this.shouldPersist=!0}catch(a){this.logger.warn(a)}}),gw(this,"sendEvent",async a=>{let b=this.getAppDomain()?"":"&sp=desktop";return await fetch(`https://pulse.walletconnect.org/batch?projectId=${this.core.projectId}&st=events_sdk&sv=js-${eb}${b}`,{method:"POST",body:JSON.stringify(a)})}),gw(this,"getAppDomain",()=>G().url),this.logger=(0,dF.U5)(b,this.context),this.telemetryEnabled=c,c?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var gy=Object.defineProperty,gz=Object.getOwnPropertySymbols,gA=Object.prototype.hasOwnProperty,gB=Object.prototype.propertyIsEnumerable,gC=(a,b,c)=>b in a?gy(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,gD=(a,b)=>{for(var c in b||(b={}))gA.call(b,c)&&gC(a,c,b[c]);if(gz)for(var c of gz(b))gB.call(b,c)&&gC(a,c,b[c]);return a},gE=(a,b,c)=>gC(a,"symbol"!=typeof b?b+"":b,c);class gF extends dJ{constructor(a){var b;super(a),gE(this,"protocol","wc"),gE(this,"version",2),gE(this,"name",d1),gE(this,"relayUrl"),gE(this,"projectId"),gE(this,"customStoragePrefix"),gE(this,"events",new d.EventEmitter),gE(this,"logger"),gE(this,"heartbeat"),gE(this,"relayer"),gE(this,"crypto"),gE(this,"storage"),gE(this,"history"),gE(this,"expirer"),gE(this,"pairing"),gE(this,"verify"),gE(this,"echoClient"),gE(this,"linkModeSupportedApps"),gE(this,"eventClient"),gE(this,"initialized",!1),gE(this,"logChunkController"),gE(this,"on",(a,b)=>this.events.on(a,b)),gE(this,"once",(a,b)=>this.events.once(a,b)),gE(this,"off",(a,b)=>this.events.off(a,b)),gE(this,"removeListener",(a,b)=>this.events.removeListener(a,b)),gE(this,"dispatchEnvelope",({topic:a,message:b,sessionExists:c})=>{if(!a||!b)return;let d={topic:a,message:b,publishedAt:Date.now(),transportType:ec.link_mode};this.relayer.onLinkMessageEvent(d,{sessionExists:c})});let c=this.getGlobalCore(a?.customStoragePrefix);if(c)try{return this.customStoragePrefix=c.customStoragePrefix,this.logger=c.logger,this.heartbeat=c.heartbeat,this.crypto=c.crypto,this.history=c.history,this.expirer=c.expirer,this.storage=c.storage,this.relayer=c.relayer,this.pairing=c.pairing,this.verify=c.verify,this.echoClient=c.echoClient,this.linkModeSupportedApps=c.linkModeSupportedApps,this.eventClient=c.eventClient,this.initialized=c.initialized,this.logChunkController=c.logChunkController,c}catch(a){console.warn("Failed to copy global core",a)}this.projectId=a?.projectId,this.relayUrl=a?.relayUrl||d8,this.customStoragePrefix=null!=a&&a.customStoragePrefix?`:${a.customStoragePrefix}`:"";let e=(0,dF.iP)({level:"string"==typeof a?.logger&&a.logger?a.logger:d3.logger,name:d1}),{logger:f,chunkLoggerController:g}=(0,dF.D5)({opts:e,maxSizeInBytes:a?.maxLogBlobSizeInBytes,loggerOverride:a?.logger});this.logChunkController=g,null!=(b=this.logChunkController)&&b.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var a,b;null!=(a=this.logChunkController)&&a.downloadLogsBlobInBrowser&&(null==(b=this.logChunkController)||b.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=(0,dF.U5)(f,this.name),this.heartbeat=new dD.VH,this.crypto=new fi(this,this.logger,a?.keychain),this.history=new gg(this,this.logger),this.expirer=new gj(this,this.logger),this.storage=null!=a&&a.storage?a.storage:new dE.A(gD(gD({},d4),a?.storageOptions)),this.relayer=new fY({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new gd(this,this.logger),this.verify=new gm(this,this.logger,this.storage),this.echoClient=new gp(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new gx(this,this.logger,a?.telemetryEnabled),this.setGlobalCore(this)}static async init(a){let b=new gF(a);await b.initialize();let c=await b.crypto.getClientId();return await b.storage.setItem("WALLETCONNECT_CLIENT_ID",c),b}get context(){return(0,dF.oI)(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var a;return null==(a=this.logChunkController)?void 0:a.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(a){this.linkModeSupportedApps.includes(a)||(this.linkModeSupportedApps.push(a),await this.storage.setItem(ee,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(ee)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(a){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,a),this.logger.error(a.message),a}}getGlobalCore(a=""){try{if(this.isGlobalCoreDisabled())return;let b=`_walletConnectCore_${a}`,c=`${b}_count`;return globalThis[c]=(globalThis[c]||0)+1,globalThis[c]>1&&console.warn(`WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ${globalThis[c]} times.`),globalThis[b]}catch(a){console.warn("Failed to get global WalletConnect core",a);return}}setGlobalCore(a){var b;try{if(this.isGlobalCoreDisabled())return;let c=`_walletConnectCore_${(null==(b=a.opts)?void 0:b.customStoragePrefix)||""}`;globalThis[c]=a}catch(a){console.warn("Failed to set global WalletConnect core",a)}}isGlobalCoreDisabled(){try{return"u">typeof process&&"true"===process.env.DISABLE_GLOBAL_CORE}catch{return!0}}}let gG="client",gH=`wc@2:${gG}:`,gI={name:gG,logger:"error"},gJ="WALLETCONNECT_DEEPLINK_CHOICE",gK="Proposal expired",gL=g.SEVEN_DAYS,gM={wc_sessionPropose:{req:{ttl:g.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:g.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:g.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:g.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:g.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:g.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:g.ONE_DAY,prompt:!1,tag:1104},res:{ttl:g.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:g.ONE_DAY,prompt:!1,tag:1106},res:{ttl:g.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:g.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:g.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:g.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:g.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:g.ONE_DAY,prompt:!1,tag:1112},res:{ttl:g.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:g.ONE_DAY,prompt:!1,tag:1114},res:{ttl:g.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:g.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:g.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:g.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:g.FIVE_MINUTES,prompt:!1,tag:1119}}},gN={min:g.FIVE_MINUTES,max:g.SEVEN_DAYS},gO={idle:"IDLE",active:"ACTIVE"},gP={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"}},gQ=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],gR="wc@1.5:auth:",gS=`${gR}:PUB_KEY`;var gT=Object.defineProperty,gU=Object.defineProperties,gV=Object.getOwnPropertyDescriptors,gW=Object.getOwnPropertySymbols,gX=Object.prototype.hasOwnProperty,gY=Object.prototype.propertyIsEnumerable,gZ=(a,b,c)=>b in a?gT(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,g$=(a,b)=>{for(var c in b||(b={}))gX.call(b,c)&&gZ(a,c,b[c]);if(gW)for(var c of gW(b))gY.call(b,c)&&gZ(a,c,b[c]);return a},g_=(a,b)=>gU(a,gV(b)),g0=(a,b,c)=>gZ(a,"symbol"!=typeof b?b+"":b,c);class g1 extends dY{constructor(a){super(a),g0(this,"name","engine"),g0(this,"events",new(e())),g0(this,"initialized",!1),g0(this,"requestQueue",{state:gO.idle,queue:[]}),g0(this,"sessionRequestQueue",{state:gO.idle,queue:[]}),g0(this,"requestQueueDelay",g.ONE_SECOND),g0(this,"expectedPairingMethodMap",new Map),g0(this,"recentlyDeletedMap",new Map),g0(this,"recentlyDeletedLimit",200),g0(this,"relayMessageCache",[]),g0(this,"pendingSessions",new Map),g0(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(gM)}),this.initialized=!0,setTimeout(async()=>{await this.processPendingMessageEvents(),this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},(0,g.toMiliseconds)(this.requestQueueDelay)))}),g0(this,"connect",async a=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();let b=g_(g$({},a),{requiredNamespaces:a.requiredNamespaces||{},optionalNamespaces:a.optionalNamespaces||{}});await this.isValidConnect(b),b.optionalNamespaces=function(a,b){var c,d,e,f,g,h;let i=de(a),j=de(b),k={};for(let a of Object.keys(i).concat(Object.keys(j)))k[a]={chains:S(null==(c=i[a])?void 0:c.chains,null==(d=j[a])?void 0:d.chains),methods:S(null==(e=i[a])?void 0:e.methods,null==(f=j[a])?void 0:f.methods),events:S(null==(g=i[a])?void 0:g.events,null==(h=j[a])?void 0:h.events)};return k}(b.requiredNamespaces,b.optionalNamespaces),b.requiredNamespaces={};let{pairingTopic:c,requiredNamespaces:d,optionalNamespaces:e,sessionProperties:f,scopedProperties:h,relays:i}=b,j=c,k,l=!1;try{if(j){let a=this.client.core.pairing.pairings.get(j);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),l=a.active}}catch(a){throw this.client.logger.error(`connect() -> pairing.get(${j}) failed`),a}if(!j||!l){let{topic:a,uri:b}=await this.client.core.pairing.create();j=a,k=b}if(!j){let{message:a}=di("NO_MATCHING_KEY",`connect() pairing topic: ${j}`);throw Error(a)}let m=await this.client.core.crypto.generateKeyPair(),o=gM.wc_sessionPropose.req.ttl||g.FIVE_MINUTES,p=P(o),q=g_(g$(g$({requiredNamespaces:d,optionalNamespaces:e,relays:i??[{protocol:"irn"}],proposer:{publicKey:m,metadata:this.client.metadata},expiryTimestamp:p,pairingTopic:j},f&&{sessionProperties:f}),h&&{scopedProperties:h}),{id:(0,d_.payloadId)()}),r=R("session_connect",q.id),{reject:s,resolve:t,done:u}=L(o,gK),v=({id:a})=>{a===q.id&&(this.client.events.off("proposal_expire",v),this.pendingSessions.delete(q.id),this.events.emit(r,{error:{message:gK,code:0}}))};return this.client.events.on("proposal_expire",v),this.events.once(r,({error:a,session:b})=>{this.client.events.off("proposal_expire",v),a?s(a):b&&t(b)}),await this.sendRequest({topic:j,method:"wc_sessionPropose",params:q,throwOnFailedPublish:!0,clientRpcId:q.id}),await this.setProposal(q.id,q),{uri:k,approval:u}}),g0(this,"pair",async a=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(a)}catch(a){throw this.client.logger.error("pair() failed"),a}}),g0(this,"approve",async a=>{var b,c,d;let e=this.client.core.eventClient.createEvent({properties:{topic:null==(b=a?.id)?void 0:b.toString(),trace:[ep.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(a){throw e.setError(eq.no_internet_connection),a}try{await this.isValidProposalId(a?.id)}catch(b){throw this.client.logger.error(`approve() -> proposal.get(${a?.id}) failed`),e.setError(eq.proposal_not_found),b}try{await this.isValidApprove(a)}catch(a){throw this.client.logger.error("approve() -> isValidApprove() failed"),e.setError(eq.session_approve_namespace_validation_failure),a}let{id:f,relayProtocol:g,namespaces:h,sessionProperties:i,scopedProperties:j,sessionConfig:k}=a,l=this.client.proposal.get(f);this.client.core.eventClient.deleteEvent({eventId:e.eventId});let{pairingTopic:m,proposer:o,requiredNamespaces:p,optionalNamespaces:q}=l,r=null==(c=this.client.core.eventClient)?void 0:c.getEvent({topic:m});r||(r=null==(d=this.client.core.eventClient)?void 0:d.createEvent({type:ep.session_approve_started,properties:{topic:m,trace:[ep.session_approve_started,ep.session_namespaces_validation_success]}}));let s=await this.client.core.crypto.generateKeyPair(),t=o.publicKey,u=await this.client.core.crypto.generateSharedKey(s,t),v=g$(g$(g$({relay:{protocol:g??"irn"},namespaces:h,controller:{publicKey:s,metadata:this.client.metadata},expiry:P(gL)},i&&{sessionProperties:i}),j&&{scopedProperties:j}),k&&{sessionConfig:k}),w=ec.relay;r.addTrace(ep.subscribing_session_topic);try{await this.client.core.relayer.subscribe(u,{transportType:w})}catch(a){throw r.setError(eq.subscribe_session_topic_failure),a}r.addTrace(ep.subscribe_session_topic_success);let x=g_(g$({},v),{topic:u,requiredNamespaces:p,optionalNamespaces:q,pairingTopic:m,acknowledged:!1,self:v.controller,peer:{publicKey:o.publicKey,metadata:o.metadata},controller:s,transportType:ec.relay});await this.client.session.set(u,x),r.addTrace(ep.store_session);try{r.addTrace(ep.publishing_session_settle),await this.sendRequest({topic:u,method:"wc_sessionSettle",params:v,throwOnFailedPublish:!0}).catch(a=>{throw r?.setError(eq.session_settle_publish_failure),a}),r.addTrace(ep.session_settle_publish_success),r.addTrace(ep.publishing_session_approve),await this.sendResult({id:f,topic:m,result:{relay:{protocol:g??"irn"},responderPublicKey:s},throwOnFailedPublish:!0}).catch(a=>{throw r?.setError(eq.session_approve_publish_failure),a}),r.addTrace(ep.session_approve_publish_success)}catch(a){throw this.client.logger.error(a),this.client.session.delete(u,dj("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(u),a}return this.client.core.eventClient.deleteEvent({eventId:r.eventId}),await this.client.core.pairing.updateMetadata({topic:m,metadata:o.metadata}),await this.client.proposal.delete(f,dj("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:m}),await this.setExpiry(u,P(gL)),{topic:u,acknowledged:()=>Promise.resolve(this.client.session.get(u))}}),g0(this,"reject",async a=>{let b;this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(a)}catch(a){throw this.client.logger.error("reject() -> isValidReject() failed"),a}let{id:c,reason:d}=a;try{b=this.client.proposal.get(c).pairingTopic}catch(a){throw this.client.logger.error(`reject() -> proposal.get(${c}) failed`),a}b&&(await this.sendError({id:c,topic:b,error:d,rpcOpts:gM.wc_sessionPropose.reject}),await this.client.proposal.delete(c,dj("USER_DISCONNECTED")))}),g0(this,"update",async a=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(a)}catch(a){throw this.client.logger.error("update() -> isValidUpdate() failed"),a}let{topic:b,namespaces:c}=a,{done:d,resolve:e,reject:f}=L(),g=(0,d_.payloadId)(),h=(0,d_.getBigIntRpcId)().toString(),i=this.client.session.get(b).namespaces;return this.events.once(R("session_update",g),({error:a})=>{a?f(a):e()}),await this.client.session.update(b,{namespaces:c}),await this.sendRequest({topic:b,method:"wc_sessionUpdate",params:{namespaces:c},throwOnFailedPublish:!0,clientRpcId:g,relayRpcId:h}).catch(a=>{this.client.logger.error(a),this.client.session.update(b,{namespaces:i}),f(a)}),{acknowledged:d}}),g0(this,"extend",async a=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(a)}catch(a){throw this.client.logger.error("extend() -> isValidExtend() failed"),a}let{topic:b}=a,c=(0,d_.payloadId)(),{done:d,resolve:e,reject:f}=L();return this.events.once(R("session_extend",c),({error:a})=>{a?f(a):e()}),await this.setExpiry(b,P(gL)),this.sendRequest({topic:b,method:"wc_sessionExtend",params:{},clientRpcId:c,throwOnFailedPublish:!0}).catch(a=>{f(a)}),{acknowledged:d}}),g0(this,"request",async a=>{this.isInitialized();try{await this.isValidRequest(a)}catch(a){throw this.client.logger.error("request() -> isValidRequest() failed"),a}let{chainId:b,request:c,topic:d,expiry:e=gM.wc_sessionRequest.req.ttl}=a,f=this.client.session.get(d);f?.transportType===ec.relay&&await this.confirmOnlineStateOrThrow();let g=(0,d_.payloadId)(),h=(0,d_.getBigIntRpcId)().toString(),{done:i,resolve:j,reject:k}=L(e,"Request expired. Please try again.");this.events.once(R("session_request",g),({error:a,result:b})=>{a?k(a):j(b)});let l="wc_sessionRequest",m=this.getAppLinkIfEnabled(f.peer.metadata,f.transportType);if(m)return await this.sendRequest({clientRpcId:g,relayRpcId:h,topic:d,method:l,params:{request:g_(g$({},c),{expiryTimestamp:P(e)}),chainId:b},expiry:e,throwOnFailedPublish:!0,appLink:m}).catch(a=>k(a)),this.client.events.emit("session_request_sent",{topic:d,request:c,chainId:b,id:g}),await i();let o={request:g_(g$({},c),{expiryTimestamp:P(e)}),chainId:b},p=this.shouldSetTVF(l,o);return await Promise.all([new Promise(async a=>{await this.sendRequest(g$({clientRpcId:g,relayRpcId:h,topic:d,method:l,params:o,expiry:e,throwOnFailedPublish:!0},p&&{tvf:this.getTVFParams(g,o)})).catch(a=>k(a)),this.client.events.emit("session_request_sent",{topic:d,request:c,chainId:b,id:g}),a()}),new Promise(async a=>{var b;if(!(null!=(b=f.sessionConfig)&&b.disableDeepLink)){let a=await U(this.client.core.storage,gJ);await T({id:g,topic:d,wcDeepLink:a})}a()}),i()]).then(a=>a[2])}),g0(this,"respond",async a=>{this.isInitialized(),await this.isValidRespond(a);let{topic:b,response:c}=a,{id:d}=c,e=this.client.session.get(b);e.transportType===ec.relay&&await this.confirmOnlineStateOrThrow();let f=this.getAppLinkIfEnabled(e.peer.metadata,e.transportType);(0,d_.isJsonRpcResult)(c)?await this.sendResult({id:d,topic:b,result:c.result,throwOnFailedPublish:!0,appLink:f}):(0,d_.isJsonRpcError)(c)&&await this.sendError({id:d,topic:b,error:c.error,appLink:f}),this.cleanupAfterResponse(a)}),g0(this,"ping",async a=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(a)}catch(a){throw this.client.logger.error("ping() -> isValidPing() failed"),a}let{topic:b}=a;if(this.client.session.keys.includes(b)){let a=(0,d_.payloadId)(),c=(0,d_.getBigIntRpcId)().toString(),{done:d,resolve:e,reject:f}=L();this.events.once(R("session_ping",a),({error:a})=>{a?f(a):e()}),await Promise.all([this.sendRequest({topic:b,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:a,relayRpcId:c}),d()])}else this.client.core.pairing.pairings.keys.includes(b)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:b}))}),g0(this,"emit",async a=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(a);let{topic:b,event:c,chainId:d}=a,e=(0,d_.getBigIntRpcId)().toString(),f=(0,d_.payloadId)();await this.sendRequest({topic:b,method:"wc_sessionEvent",params:{event:c,chainId:d},throwOnFailedPublish:!0,relayRpcId:e,clientRpcId:f})}),g0(this,"disconnect",async a=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(a);let{topic:b}=a;if(this.client.session.keys.includes(b))await this.sendRequest({topic:b,method:"wc_sessionDelete",params:dj("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:b,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(b))await this.client.core.pairing.disconnect({topic:b});else{let{message:a}=di("MISMATCHED_TOPIC",`Session or pairing topic not found: ${b}`);throw Error(a)}}),g0(this,"find",a=>(this.isInitialized(),this.client.session.getAll().filter(b=>(function(a,b){let{requiredNamespaces:c}=b,d=Object.keys(a.namespaces),e=Object.keys(c),f=!0;return!!I(e,d)&&(d.forEach(b=>{let{accounts:d,methods:e,events:g}=a.namespaces[b],h=db(d),i=c[b];I(r(b,i),h)&&I(i.methods,e)&&I(i.events,g)||(f=!1)}),f)})(b,a)))),g0(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),g0(this,"authenticate",async(a,b)=>{var c,d,e;let f;this.isInitialized(),this.isValidAuthenticate(a);let g=b&&this.client.core.linkModeSupportedApps.includes(b)&&(null==(c=this.client.metadata.redirect)?void 0:c.linkMode),h=g?ec.link_mode:ec.relay;h===ec.relay&&await this.confirmOnlineStateOrThrow();let{chains:i,statement:j="",uri:k,domain:l,nonce:m,type:o,exp:q,nbf:r,methods:s=[],expiry:t}=a,u=[...a.resources||[]],{topic:v,uri:w}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:h});this.client.logger.info({message:"Generated new pairing",pairing:{topic:v,uri:w}});let x=await this.client.core.crypto.generateKeyPair(),y=cP(x);if(await Promise.all([this.client.auth.authKeys.set(gS,{responseTopic:y,publicKey:x}),this.client.auth.pairingTopics.set(y,{topic:y,pairingTopic:v})]),await this.client.core.relayer.subscribe(y,{transportType:h}),this.client.logger.info(`sending request to new pairing topic: ${v}`),s.length>0){let{namespace:a}=p(i[0]),b=aT(function(a,b,c,d={}){return c?.sort((a,b)=>a.localeCompare(b)),{att:{[a]:function(a,b,c={}){return Object.assign({},...(b=b?.sort((a,b)=>a.localeCompare(b))).map(b=>({[`${a}/${b}`]:[c]})))}(b,c,d)}}}(a,"request",s));aX(u)&&(d=b,e=u.pop(),b=aT(function(a,b){aS(a),aS(b);let c=Object.keys(a.att).concat(Object.keys(b.att)).sort((a,b)=>a.localeCompare(b)),d={att:{}};return c.forEach(c=>{var e,f;Object.keys((null==(e=a.att)?void 0:e[c])||{}).concat(Object.keys((null==(f=b.att)?void 0:f[c])||{})).sort((a,b)=>a.localeCompare(b)).forEach(e=>{var f,g;d.att[c]=aH(((a,b)=>{for(var c in b||(b={}))aK.call(b,c)&&aM(a,c,b[c]);if(aJ)for(var c of aJ(b))aL.call(b,c)&&aM(a,c,b[c]);return a})({},d.att[c]),aI({[e]:(null==(f=a.att[c])?void 0:f[e])||(null==(g=b.att[c])?void 0:g[e])}))})}),d}(aU(d),aU(e)))),u.push(b)}let z=t&&t>gM.wc_sessionAuthenticate.req.ttl?t:gM.wc_sessionAuthenticate.req.ttl,A={authPayload:{type:o??"caip122",chains:i,statement:j,aud:k,domain:l,version:"1",nonce:m,iat:new Date().toISOString(),exp:q,nbf:r,resources:u},requester:{publicKey:x,metadata:this.client.metadata},expiryTimestamp:P(z)},B={requiredNamespaces:{},optionalNamespaces:{eip155:{chains:i,methods:[...new Set(["personal_sign",...s])],events:["chainChanged","accountsChanged"]}},relays:[{protocol:"irn"}],pairingTopic:v,proposer:{publicKey:x,metadata:this.client.metadata},expiryTimestamp:P(gM.wc_sessionPropose.req.ttl),id:(0,d_.payloadId)()},{done:C,resolve:D,reject:E}=L(z,"Request expired"),F=(0,d_.payloadId)(),G=R("session_connect",B.id),H=R("session_request",F),I=async({error:a,session:b})=>{this.events.off(H,J),a?E(a):b&&D({session:b})},J=async a=>{var c,d,e;let f;if(await this.deletePendingAuthRequest(F,{message:"fulfilled",code:0}),a.error){let b=dj("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return a.error.code===b.code?void 0:(this.events.off(G,I),E(a.error.message))}await this.deleteProposal(B.id),this.events.off(G,I);let{cacaos:g,responder:i}=a.result,j=[],k=[];for(let a of g){await aQ({cacao:a,projectId:this.client.core.projectId})||(this.client.logger.error(a,"Signature verification failed"),E(dj("SESSION_SETTLEMENT_FAILED","Signature verification failed")));let{p:b}=a,c=aX(b.resources),d=[aO(b.iss)],e=aP(b.iss);if(c){let a=aV(c),b=aW(c);j.push(...a),d.push(...b)}for(let a of d)k.push(`${a}:${e}`)}let l=await this.client.core.crypto.generateSharedKey(x,i.publicKey);j.length>0&&(f={topic:l,acknowledged:!0,self:{publicKey:x,metadata:this.client.metadata},peer:i,controller:i.publicKey,expiry:P(gL),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:v,namespaces:df([...new Set(j)],[...new Set(k)]),transportType:h},await this.client.core.relayer.subscribe(l,{transportType:h}),await this.client.session.set(l,f),v&&await this.client.core.pairing.updateMetadata({topic:v,metadata:i.metadata}),f=this.client.session.get(l)),null!=(c=this.client.metadata.redirect)&&c.linkMode&&null!=(d=i.metadata.redirect)&&d.linkMode&&null!=(e=i.metadata.redirect)&&e.universal&&b&&(this.client.core.addLinkModeSupportedApp(i.metadata.redirect.universal),this.client.session.update(l,{transportType:ec.link_mode})),D({auths:g,session:f})};this.events.once(G,I),this.events.once(H,J);try{if(g){let a=(0,d_.formatJsonRpcRequest)("wc_sessionAuthenticate",A,F);this.client.core.history.set(v,a);let c=await this.client.core.crypto.encode("",a,{type:2,encoding:cM});f=c1(b,v,c)}else await Promise.all([this.sendRequest({topic:v,method:"wc_sessionAuthenticate",params:A,expiry:a.expiry,throwOnFailedPublish:!0,clientRpcId:F}),this.sendRequest({topic:v,method:"wc_sessionPropose",params:B,expiry:gM.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:B.id})])}catch(a){throw this.events.off(G,I),this.events.off(H,J),a}return await this.setProposal(B.id,B),await this.setAuthRequest(F,{request:g_(g$({},A),{verifyContext:{}}),pairingTopic:v,transportType:h}),{uri:f??w,response:C}}),g0(this,"approveSessionAuthenticate",async a=>{let b,{id:c,auths:d}=a,e=this.client.core.eventClient.createEvent({properties:{topic:c.toString(),trace:[er.authenticated_session_approve_started]}});try{this.isInitialized()}catch(a){throw e.setError(es.no_internet_connection),a}let f=this.getPendingAuthRequest(c);if(!f)throw e.setError(es.authenticated_session_pending_request_not_found),Error(`Could not find pending auth request with id ${c}`);let g=f.transportType||ec.relay;g===ec.relay&&await this.confirmOnlineStateOrThrow();let h=f.requester.publicKey,i=await this.client.core.crypto.generateKeyPair(),j=cP(h),k={type:1,receiverPublicKey:h,senderPublicKey:i},l=[],m=[];for(let a of d){if(!await aQ({cacao:a,projectId:this.client.core.projectId})){e.setError(es.invalid_cacao);let a=dj("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:c,topic:j,error:a,encodeOpts:k}),Error(a.message)}e.addTrace(er.cacaos_verified);let{p:b}=a,d=aX(b.resources),f=[aO(b.iss)],g=aP(b.iss);if(d){let a=aV(d),b=aW(d);l.push(...a),f.push(...b)}for(let a of f)m.push(`${a}:${g}`)}let o=await this.client.core.crypto.generateSharedKey(i,h);if(e.addTrace(er.create_authenticated_session_topic),l?.length>0){b={topic:o,acknowledged:!0,self:{publicKey:i,metadata:this.client.metadata},peer:{publicKey:h,metadata:f.requester.metadata},controller:h,expiry:P(gL),authentication:d,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:f.pairingTopic,namespaces:df([...new Set(l)],[...new Set(m)]),transportType:g},e.addTrace(er.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(o,{transportType:g})}catch(a){throw e.setError(es.subscribe_authenticated_session_topic_failure),a}e.addTrace(er.subscribe_authenticated_session_topic_success),await this.client.session.set(o,b),e.addTrace(er.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:f.pairingTopic,metadata:f.requester.metadata})}e.addTrace(er.publishing_authenticated_session_approve);try{await this.sendResult({topic:j,id:c,result:{cacaos:d,responder:{publicKey:i,metadata:this.client.metadata}},encodeOpts:k,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(f.requester.metadata,g)})}catch(a){throw e.setError(es.authenticated_session_approve_publish_failure),a}return await this.client.auth.requests.delete(c,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:f.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:e.eventId}),{session:b}}),g0(this,"rejectSessionAuthenticate",async a=>{this.isInitialized();let{id:b,reason:c}=a,d=this.getPendingAuthRequest(b);if(!d)throw Error(`Could not find pending auth request with id ${b}`);d.transportType===ec.relay&&await this.confirmOnlineStateOrThrow();let e=d.requester.publicKey,f=await this.client.core.crypto.generateKeyPair(),g=cP(e);await this.sendError({id:b,topic:g,error:c,encodeOpts:{type:1,receiverPublicKey:e,senderPublicKey:f},rpcOpts:gM.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(d.requester.metadata,d.transportType)}),await this.client.auth.requests.delete(b,{message:"rejected",code:0}),await this.client.proposal.delete(b,dj("USER_DISCONNECTED"))}),g0(this,"formatAuthMessage",a=>{this.isInitialized();let{request:b,iss:c}=a;return aR(b,c)}),g0(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(0!==this.relayMessageCache.length)for(;this.relayMessageCache.length>0;)try{let a=this.relayMessageCache.shift();a&&await this.onRelayMessage(a)}catch(a){this.client.logger.error(a)}},50)}),g0(this,"cleanupDuplicatePairings",async a=>{if(a.pairingTopic)try{let b=this.client.core.pairing.pairings.get(a.pairingTopic),c=this.client.core.pairing.pairings.getAll().filter(c=>{var d,e;return(null==(d=c.peerMetadata)?void 0:d.url)&&(null==(e=c.peerMetadata)?void 0:e.url)===a.peer.metadata.url&&c.topic&&c.topic!==b.topic});if(0===c.length)return;this.client.logger.info(`Cleaning up ${c.length} duplicate pairing(s)`),await Promise.all(c.map(a=>this.client.core.pairing.disconnect({topic:a.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(a){this.client.logger.error(a)}}),g0(this,"deleteSession",async a=>{var b;let{topic:c,expirerHasDeleted:d=!1,emitEvent:e=!0,id:f=0}=a,{self:g}=this.client.session.get(c);await this.client.core.relayer.unsubscribe(c),await this.client.session.delete(c,dj("USER_DISCONNECTED")),this.addToRecentlyDeleted(c,"session"),this.client.core.crypto.keychain.has(g.publicKey)&&await this.client.core.crypto.deleteKeyPair(g.publicKey),this.client.core.crypto.keychain.has(c)&&await this.client.core.crypto.deleteSymKey(c),d||this.client.core.expirer.del(c),this.client.core.storage.removeItem(gJ).catch(a=>this.client.logger.warn(a)),this.getPendingSessionRequests().forEach(a=>{a.topic===c&&this.deletePendingSessionRequest(a.id,dj("USER_DISCONNECTED"))}),c===(null==(b=this.sessionRequestQueue.queue[0])?void 0:b.topic)&&(this.sessionRequestQueue.state=gO.idle),e&&this.client.events.emit("session_delete",{id:f,topic:c})}),g0(this,"deleteProposal",async(a,b)=>{if(b)try{let b=this.client.proposal.get(a),c=this.client.core.eventClient.getEvent({topic:b.pairingTopic});c?.setError(eq.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(a,dj("USER_DISCONNECTED")),b?Promise.resolve():this.client.core.expirer.del(a)]),this.addToRecentlyDeleted(a,"proposal")}),g0(this,"deletePendingSessionRequest",async(a,b,c=!1)=>{await Promise.all([this.client.pendingRequest.delete(a,b),c?Promise.resolve():this.client.core.expirer.del(a)]),this.addToRecentlyDeleted(a,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(b=>b.id!==a),c&&(this.sessionRequestQueue.state=gO.idle,this.client.events.emit("session_request_expire",{id:a}))}),g0(this,"deletePendingAuthRequest",async(a,b,c=!1)=>{await Promise.all([this.client.auth.requests.delete(a,b),c?Promise.resolve():this.client.core.expirer.del(a)])}),g0(this,"setExpiry",async(a,b)=>{this.client.session.keys.includes(a)&&(this.client.core.expirer.set(a,b),await this.client.session.update(a,{expiry:b}))}),g0(this,"setProposal",async(a,b)=>{this.client.core.expirer.set(a,P(gM.wc_sessionPropose.req.ttl)),await this.client.proposal.set(a,b)}),g0(this,"setAuthRequest",async(a,b)=>{let{request:c,pairingTopic:d,transportType:e=ec.relay}=b;this.client.core.expirer.set(a,c.expiryTimestamp),await this.client.auth.requests.set(a,{authPayload:c.authPayload,requester:c.requester,expiryTimestamp:c.expiryTimestamp,id:a,pairingTopic:d,verifyContext:c.verifyContext,transportType:e})}),g0(this,"setPendingSessionRequest",async a=>{let{id:b,topic:c,params:d,verifyContext:e}=a,f=d.request.expiryTimestamp||P(gM.wc_sessionRequest.req.ttl);this.client.core.expirer.set(b,f),await this.client.pendingRequest.set(b,{id:b,topic:c,params:d,verifyContext:e})}),g0(this,"sendRequest",async a=>{let b,c,{topic:d,method:e,params:f,expiry:g,relayRpcId:h,clientRpcId:i,throwOnFailedPublish:j,appLink:k,tvf:l}=a,m=(0,d_.formatJsonRpcRequest)(e,f,i),o=!!k;try{let a=o?cM:cL;b=await this.client.core.crypto.encode(d,m,{encoding:a})}catch(a){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${d} failed`),a}if(gQ.includes(e)){let a=cQ(JSON.stringify(m)),d=cQ(b);c=await this.client.core.verify.register({id:d,decryptedId:a})}let p=gM[e].req;if(p.attestation=c,g&&(p.ttl=g),h&&(p.id=h),this.client.core.history.set(d,m),o){let a=c1(k,d,b);await global.Linking.openURL(a,this.client.name)}else{let a=gM[e].req;g&&(a.ttl=g),h&&(a.id=h),a.tvf=g_(g$({},l),{correlationId:m.id}),j?(a.internal=g_(g$({},a.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(d,b,a)):this.client.core.relayer.publish(d,b,a).catch(a=>this.client.logger.error(a))}return m.id}),g0(this,"sendResult",async a=>{let b,c,d,{id:e,topic:f,result:g,throwOnFailedPublish:h,encodeOpts:i,appLink:j}=a,k=(0,d_.formatJsonRpcResult)(e,g),l=j&&"u">typeof(null==global?void 0:global.Linking);try{let a=l?cM:cL;b=await this.client.core.crypto.encode(f,k,g_(g$({},i||{}),{encoding:a}))}catch(a){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${f} failed`),a}try{let a=(c=await this.client.core.history.get(f,e)).request;try{this.shouldSetTVF(a.method,a.params)&&(d=this.getTVFParams(e,a.params,g))}catch(a){this.client.logger.warn("sendResult() -> getTVFParams() failed",a)}}catch(a){throw this.client.logger.error(`sendResult() -> history.get(${f}, ${e}) failed`),a}if(l){let a=c1(j,f,b);await global.Linking.openURL(a,this.client.name)}else{let a=gM[c.request.method].res;a.tvf=g_(g$({},d),{correlationId:e}),h?(a.internal=g_(g$({},a.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(f,b,a)):this.client.core.relayer.publish(f,b,a).catch(a=>this.client.logger.error(a))}await this.client.core.history.resolve(k)}),g0(this,"sendError",async a=>{let b,c,{id:d,topic:e,error:f,encodeOpts:g,rpcOpts:h,appLink:i}=a,j=(0,d_.formatJsonRpcError)(d,f),k=i&&"u">typeof(null==global?void 0:global.Linking);try{let a=k?cM:cL;b=await this.client.core.crypto.encode(e,j,g_(g$({},g||{}),{encoding:a}))}catch(a){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${e} failed`),a}try{c=await this.client.core.history.get(e,d)}catch(a){throw this.client.logger.error(`sendError() -> history.get(${e}, ${d}) failed`),a}if(k){let a=c1(i,e,b);await global.Linking.openURL(a,this.client.name)}else{let a=c.request.method,d=h||gM[a].res;this.client.core.relayer.publish(e,b,d)}await this.client.core.history.resolve(j)}),g0(this,"cleanup",async()=>{let a=[],b=[];this.client.session.getAll().forEach(b=>{let c=!1;Q(b.expiry)&&(c=!0),this.client.core.crypto.keychain.has(b.topic)||(c=!0),c&&a.push(b.topic)}),this.client.proposal.getAll().forEach(a=>{Q(a.expiryTimestamp)&&b.push(a.id)}),await Promise.all([...a.map(a=>this.deleteSession({topic:a})),...b.map(a=>this.deleteProposal(a))])}),g0(this,"onProviderMessageEvent",async a=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(a):await this.onRelayMessage(a)}),g0(this,"onRelayEventRequest",async a=>{this.requestQueue.queue.push(a),await this.processRequestsQueue()}),g0(this,"processRequestsQueue",async()=>{if(this.requestQueue.state===gO.active)return void this.client.logger.info("Request queue already active, skipping...");for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=gO.active;let a=this.requestQueue.queue.shift();if(a)try{await this.processRequest(a)}catch(a){this.client.logger.warn(a)}}this.requestQueue.state=gO.idle}),g0(this,"processRequest",async a=>{let{topic:b,payload:c,attestation:d,transportType:e,encryptedId:f}=a,g=c.method;if(!this.shouldIgnorePairingRequest({topic:b,requestMethod:g}))switch(g){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:b,payload:c,attestation:d,encryptedId:f});case"wc_sessionSettle":return await this.onSessionSettleRequest(b,c);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(b,c);case"wc_sessionExtend":return await this.onSessionExtendRequest(b,c);case"wc_sessionPing":return await this.onSessionPingRequest(b,c);case"wc_sessionDelete":return await this.onSessionDeleteRequest(b,c);case"wc_sessionRequest":return await this.onSessionRequest({topic:b,payload:c,attestation:d,encryptedId:f,transportType:e});case"wc_sessionEvent":return await this.onSessionEventRequest(b,c);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:b,payload:c,attestation:d,encryptedId:f,transportType:e});default:return this.client.logger.info(`Unsupported request method ${g}`)}}),g0(this,"onRelayEventResponse",async a=>{let{topic:b,payload:c,transportType:d}=a,e=(await this.client.core.history.get(b,c.id)).request.method;switch(e){case"wc_sessionPropose":return this.onSessionProposeResponse(b,c,d);case"wc_sessionSettle":return this.onSessionSettleResponse(b,c);case"wc_sessionUpdate":return this.onSessionUpdateResponse(b,c);case"wc_sessionExtend":return this.onSessionExtendResponse(b,c);case"wc_sessionPing":return this.onSessionPingResponse(b,c);case"wc_sessionRequest":return this.onSessionRequestResponse(b,c);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(b,c);default:return this.client.logger.info(`Unsupported response method ${e}`)}}),g0(this,"onRelayEventUnknownPayload",a=>{let{topic:b}=a,{message:c}=di("MISSING_OR_INVALID",`Decoded payload on topic ${b} is not identifiable as a JSON-RPC request or a response.`);throw Error(c)}),g0(this,"shouldIgnorePairingRequest",a=>{let{topic:b,requestMethod:c}=a,d=this.expectedPairingMethodMap.get(b);return!(!d||d.includes(c))&&!!(d.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),g0(this,"onSessionProposeRequest",async a=>{let{topic:b,payload:c,attestation:d,encryptedId:e}=a,{params:f,id:g}=c;try{let a=this.client.core.eventClient.getEvent({topic:b});0===this.client.events.listenerCount("session_proposal")&&(console.warn("No listener for session_proposal event"),a?.setError(eo.proposal_listener_not_found)),this.isValidConnect(g$({},c.params));let h=f.expiryTimestamp||P(gM.wc_sessionPropose.req.ttl),i=g$({id:g,pairingTopic:b,expiryTimestamp:h},f);await this.setProposal(g,i);let j=await this.getVerifyContext({attestationId:d,hash:cQ(JSON.stringify(c)),encryptedId:e,metadata:i.proposer.metadata});a?.addTrace(en.emit_session_proposal),this.client.events.emit("session_proposal",{id:g,params:i,verifyContext:j})}catch(a){await this.sendError({id:g,topic:b,error:a,rpcOpts:gM.wc_sessionPropose.autoReject}),this.client.logger.error(a)}}),g0(this,"onSessionProposeResponse",async(a,b,c)=>{let{id:d}=b;if((0,d_.isJsonRpcResult)(b)){let{result:e}=b;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:e});let f=this.client.proposal.get(d);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:f});let g=f.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:g});let h=e.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:h});let i=await this.client.core.crypto.generateSharedKey(g,h);this.pendingSessions.set(d,{sessionTopic:i,pairingTopic:a,proposalId:d,publicKey:g});let j=await this.client.core.relayer.subscribe(i,{transportType:c});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:j}),await this.client.core.pairing.activate({topic:a})}else if((0,d_.isJsonRpcError)(b)){await this.client.proposal.delete(d,dj("USER_DISCONNECTED"));let a=R("session_connect",d);if(0===this.events.listenerCount(a))throw Error(`emitting ${a} without any listeners, 954`);this.events.emit(a,{error:b.error})}}),g0(this,"onSessionSettleRequest",async(a,b)=>{let{id:c,params:d}=b;try{this.isValidSessionSettleRequest(d);let{relay:c,controller:e,expiry:f,namespaces:g,sessionProperties:h,scopedProperties:i,sessionConfig:j}=b.params,k=[...this.pendingSessions.values()].find(b=>b.sessionTopic===a);if(!k)return this.client.logger.error(`Pending session not found for topic ${a}`);let l=this.client.proposal.get(k.proposalId),m=g_(g$(g$(g$({topic:a,relay:c,expiry:f,namespaces:g,acknowledged:!0,pairingTopic:k.pairingTopic,requiredNamespaces:l.requiredNamespaces,optionalNamespaces:l.optionalNamespaces,controller:e.publicKey,self:{publicKey:k.publicKey,metadata:this.client.metadata},peer:{publicKey:e.publicKey,metadata:e.metadata}},h&&{sessionProperties:h}),i&&{scopedProperties:i}),j&&{sessionConfig:j}),{transportType:ec.relay});await this.client.session.set(m.topic,m),await this.setExpiry(m.topic,m.expiry),await this.client.core.pairing.updateMetadata({topic:k.pairingTopic,metadata:m.peer.metadata}),this.client.events.emit("session_connect",{session:m}),this.events.emit(R("session_connect",k.proposalId),{session:m}),this.pendingSessions.delete(k.proposalId),this.deleteProposal(k.proposalId,!1),this.cleanupDuplicatePairings(m),await this.sendResult({id:b.id,topic:a,result:!0,throwOnFailedPublish:!0})}catch(b){await this.sendError({id:c,topic:a,error:b}),this.client.logger.error(b)}}),g0(this,"onSessionSettleResponse",async(a,b)=>{let{id:c}=b;(0,d_.isJsonRpcResult)(b)?(await this.client.session.update(a,{acknowledged:!0}),this.events.emit(R("session_approve",c),{})):(0,d_.isJsonRpcError)(b)&&(await this.client.session.delete(a,dj("USER_DISCONNECTED")),this.events.emit(R("session_approve",c),{error:b.error}))}),g0(this,"onSessionUpdateRequest",async(a,b)=>{let{params:c,id:d}=b;try{let b=`${a}_session_update`,e=dC.get(b);if(e&&this.isRequestOutOfSync(e,d)){this.client.logger.warn(`Discarding out of sync request - ${d}`),this.sendError({id:d,topic:a,error:dj("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(g$({topic:a},c));try{dC.set(b,d),await this.client.session.update(a,{namespaces:c.namespaces}),await this.sendResult({id:d,topic:a,result:!0,throwOnFailedPublish:!0})}catch(a){throw dC.delete(b),a}this.client.events.emit("session_update",{id:d,topic:a,params:c})}catch(b){await this.sendError({id:d,topic:a,error:b}),this.client.logger.error(b)}}),g0(this,"isRequestOutOfSync",(a,b)=>b.toString().slice(0,-3)<a.toString().slice(0,-3)),g0(this,"onSessionUpdateResponse",(a,b)=>{let{id:c}=b,d=R("session_update",c);if(0===this.events.listenerCount(d))throw Error(`emitting ${d} without any listeners`);(0,d_.isJsonRpcResult)(b)?this.events.emit(R("session_update",c),{}):(0,d_.isJsonRpcError)(b)&&this.events.emit(R("session_update",c),{error:b.error})}),g0(this,"onSessionExtendRequest",async(a,b)=>{let{id:c}=b;try{this.isValidExtend({topic:a}),await this.setExpiry(a,P(gL)),await this.sendResult({id:c,topic:a,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_extend",{id:c,topic:a})}catch(b){await this.sendError({id:c,topic:a,error:b}),this.client.logger.error(b)}}),g0(this,"onSessionExtendResponse",(a,b)=>{let{id:c}=b,d=R("session_extend",c);if(0===this.events.listenerCount(d))throw Error(`emitting ${d} without any listeners`);(0,d_.isJsonRpcResult)(b)?this.events.emit(R("session_extend",c),{}):(0,d_.isJsonRpcError)(b)&&this.events.emit(R("session_extend",c),{error:b.error})}),g0(this,"onSessionPingRequest",async(a,b)=>{let{id:c}=b;try{this.isValidPing({topic:a}),await this.sendResult({id:c,topic:a,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:c,topic:a})}catch(b){await this.sendError({id:c,topic:a,error:b}),this.client.logger.error(b)}}),g0(this,"onSessionPingResponse",(a,b)=>{let{id:c}=b,d=R("session_ping",c);setTimeout(()=>{if(0===this.events.listenerCount(d))throw Error(`emitting ${d} without any listeners 2176`);(0,d_.isJsonRpcResult)(b)?this.events.emit(R("session_ping",c),{}):(0,d_.isJsonRpcError)(b)&&this.events.emit(R("session_ping",c),{error:b.error})},500)}),g0(this,"onSessionDeleteRequest",async(a,b)=>{let{id:c}=b;try{this.isValidDisconnect({topic:a,reason:b.params}),Promise.all([new Promise(b=>{this.client.core.relayer.once(d9.publish,async()=>{b(await this.deleteSession({topic:a,id:c}))})}),this.sendResult({id:c,topic:a,result:!0,throwOnFailedPublish:!0}),this.cleanupPendingSentRequestsForTopic({topic:a,error:dj("USER_DISCONNECTED")})]).catch(a=>this.client.logger.error(a))}catch(a){this.client.logger.error(a)}}),g0(this,"onSessionRequest",async a=>{var b,c,d;let{topic:e,payload:f,attestation:g,encryptedId:h,transportType:i}=a,{id:j,params:k}=f;try{await this.isValidRequest(g$({topic:e},k));let a=this.client.session.get(e),f=await this.getVerifyContext({attestationId:g,hash:cQ(JSON.stringify((0,d_.formatJsonRpcRequest)("wc_sessionRequest",k,j))),encryptedId:h,metadata:a.peer.metadata,transportType:i}),l={id:j,topic:e,params:k,verifyContext:f};await this.setPendingSessionRequest(l),i===ec.link_mode&&null!=(b=a.peer.metadata.redirect)&&b.universal&&this.client.core.addLinkModeSupportedApp(null==(c=a.peer.metadata.redirect)?void 0:c.universal),null!=(d=this.client.signConfig)&&d.disableRequestQueue?this.emitSessionRequest(l):(this.addSessionRequestToSessionRequestQueue(l),this.processSessionRequestQueue())}catch(a){await this.sendError({id:j,topic:e,error:a}),this.client.logger.error(a)}}),g0(this,"onSessionRequestResponse",(a,b)=>{let{id:c}=b,d=R("session_request",c);if(0===this.events.listenerCount(d))throw Error(`emitting ${d} without any listeners`);(0,d_.isJsonRpcResult)(b)?this.events.emit(R("session_request",c),{result:b.result}):(0,d_.isJsonRpcError)(b)&&this.events.emit(R("session_request",c),{error:b.error})}),g0(this,"onSessionEventRequest",async(a,b)=>{let{id:c,params:d}=b;try{let b=`${a}_session_event_${d.event.name}`,e=dC.get(b);if(e&&this.isRequestOutOfSync(e,c))return void this.client.logger.info(`Discarding out of sync request - ${c}`);this.isValidEmit(g$({topic:a},d)),this.client.events.emit("session_event",{id:c,topic:a,params:d}),dC.set(b,c)}catch(b){await this.sendError({id:c,topic:a,error:b}),this.client.logger.error(b)}}),g0(this,"onSessionAuthenticateResponse",(a,b)=>{let{id:c}=b;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:a,payload:b}),(0,d_.isJsonRpcResult)(b)?this.events.emit(R("session_request",c),{result:b.result}):(0,d_.isJsonRpcError)(b)&&this.events.emit(R("session_request",c),{error:b.error})}),g0(this,"onSessionAuthenticateRequest",async a=>{var b;let{topic:c,payload:d,attestation:e,encryptedId:f,transportType:g}=a;try{let{requester:a,authPayload:h,expiryTimestamp:i}=d.params,j=await this.getVerifyContext({attestationId:e,hash:cQ(JSON.stringify(d)),encryptedId:f,metadata:a.metadata,transportType:g}),k={requester:a,pairingTopic:c,id:d.id,authPayload:h,verifyContext:j,expiryTimestamp:i};await this.setAuthRequest(d.id,{request:k,pairingTopic:c,transportType:g}),g===ec.link_mode&&null!=(b=a.metadata.redirect)&&b.universal&&this.client.core.addLinkModeSupportedApp(a.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:c,params:d.params,id:d.id,verifyContext:j})}catch(f){this.client.logger.error(f);let a=d.params.requester.publicKey,b=await this.client.core.crypto.generateKeyPair(),e=this.getAppLinkIfEnabled(d.params.requester.metadata,g);await this.sendError({id:d.id,topic:c,error:f,encodeOpts:{type:1,receiverPublicKey:a,senderPublicKey:b},rpcOpts:gM.wc_sessionAuthenticate.autoReject,appLink:e})}}),g0(this,"addSessionRequestToSessionRequestQueue",a=>{this.sessionRequestQueue.queue.push(a)}),g0(this,"cleanupAfterResponse",a=>{this.deletePendingSessionRequest(a.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=gO.idle,this.processSessionRequestQueue()},(0,g.toMiliseconds)(this.requestQueueDelay))}),g0(this,"cleanupPendingSentRequestsForTopic",({topic:a,error:b})=>{let c=this.client.core.history.pending;c.length>0&&c.filter(b=>b.topic===a&&"wc_sessionRequest"===b.request.method).forEach(a=>{let c=R("session_request",a.request.id);if(0===this.events.listenerCount(c))throw Error(`emitting ${c} without any listeners`);this.events.emit(R("session_request",a.request.id),{error:b})})}),g0(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===gO.active)return void this.client.logger.info("session request queue is already active.");let a=this.sessionRequestQueue.queue[0];if(!a)return void this.client.logger.info("session request queue is empty.");try{this.sessionRequestQueue.state=gO.active,this.emitSessionRequest(a)}catch(a){this.client.logger.error(a)}}),g0(this,"emitSessionRequest",a=>{this.client.events.emit("session_request",a)}),g0(this,"onPairingCreated",a=>{if(a.methods&&this.expectedPairingMethodMap.set(a.topic,a.methods),a.active)return;let b=this.client.proposal.getAll().find(b=>b.pairingTopic===a.topic);b&&this.onSessionProposeRequest({topic:a.topic,payload:(0,d_.formatJsonRpcRequest)("wc_sessionPropose",g_(g$({},b),{requiredNamespaces:b.requiredNamespaces,optionalNamespaces:b.optionalNamespaces,relays:b.relays,proposer:b.proposer,sessionProperties:b.sessionProperties,scopedProperties:b.scopedProperties}),b.id)})}),g0(this,"isValidConnect",async a=>{if(!dv(a)){let{message:b}=di("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(a)}`);throw Error(b)}let{pairingTopic:b,requiredNamespaces:c,optionalNamespaces:d,sessionProperties:e,scopedProperties:f,relays:g}=a;if(dm(b)||await this.isValidPairingTopic(b),!function(a,b){let c=!1;return b&&!a?c=!0:a&&dk(a)&&a.length&&a.forEach(a=>{c=du(a)}),c}(g,!0)){let{message:a}=di("MISSING_OR_INVALID",`connect() relays: ${g}`);throw Error(a)}if(!dm(c)&&0!==dl(c)){let a="requiredNamespaces are deprecated and are automatically assigned to optionalNamespaces";["fatal","error","silent"].includes(this.client.logger.level)?console.warn(a):this.client.logger.warn(a),this.validateNamespaces(c,"requiredNamespaces")}if(dm(d)||0===dl(d)||this.validateNamespaces(d,"optionalNamespaces"),dm(e)||this.validateSessionProps(e,"sessionProperties"),!dm(f)){this.validateSessionProps(f,"scopedProperties");let a=Object.keys(c||{}).concat(Object.keys(d||{}));if(!Object.keys(f).every(b=>a.includes(b)))throw Error(`Scoped properties must be a subset of required/optional namespaces, received: ${JSON.stringify(f)}, required/optional namespaces: ${JSON.stringify(a)}`)}}),g0(this,"validateNamespaces",(a,b)=>{let c=function(a,b,c){let d=null;if(a&&dl(a)){let e,f=ds(a,b);f&&(d=f);let g=(e=null,Object.entries(a).forEach(([a,d])=>{var f,g;let h;if(e)return;let i=(f=r(a,d),g=`${b} ${c}`,h=null,dk(f)&&f.length?f.forEach(a=>{h||dq(a)||(h=dj("UNSUPPORTED_CHAINS",`${g}, chain ${a} should be a string and conform to "namespace:chainId" format`))}):dq(a)||(h=dj("UNSUPPORTED_CHAINS",`${g}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),h);i&&(e=i)}),e);g&&(d=g)}else d=di("MISSING_OR_INVALID",`${b}, ${c} should be an object with data`);return d}(a,"connect()",b);if(c)throw Error(c.message)}),g0(this,"isValidApprove",async a=>{if(!dv(a))throw Error(di("MISSING_OR_INVALID",`approve() params: ${a}`).message);let{id:b,namespaces:c,relayProtocol:d,sessionProperties:e,scopedProperties:f}=a;this.checkRecentlyDeleted(b),await this.isValidProposalId(b);let g=this.client.proposal.get(b),h=dt(c,"approve()");if(h)throw Error(h.message);let i=dx(g.requiredNamespaces,c,"approve()");if(i)throw Error(i.message);if(!dn(d,!0)){let{message:a}=di("MISSING_OR_INVALID",`approve() relayProtocol: ${d}`);throw Error(a)}if(dm(e)||this.validateSessionProps(e,"sessionProperties"),!dm(f)){this.validateSessionProps(f,"scopedProperties");let a=new Set(Object.keys(c));if(!Object.keys(f).every(b=>a.has(b)))throw Error(`Scoped properties must be a subset of approved namespaces, received: ${JSON.stringify(f)}, approved namespaces: ${Array.from(a).join(", ")}`)}}),g0(this,"isValidReject",async a=>{if(!dv(a)){let{message:b}=di("MISSING_OR_INVALID",`reject() params: ${a}`);throw Error(b)}let{id:b,reason:c}=a;if(this.checkRecentlyDeleted(b),await this.isValidProposalId(b),!function(a){return!(!a||"object"!=typeof a||!a.code||!dp(a.code,!1)||!a.message||!dn(a.message,!1))}(c)){let{message:a}=di("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(c)}`);throw Error(a)}}),g0(this,"isValidSessionSettleRequest",a=>{if(!dv(a)){let{message:b}=di("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${a}`);throw Error(b)}let{relay:b,controller:c,namespaces:d,expiry:e}=a;if(!du(b)){let{message:a}=di("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw Error(a)}let f=function(a,b){let c=null;return dn(a?.publicKey,!1)||(c=di("MISSING_OR_INVALID",`${b} controller public key should be a string`)),c}(c,"onSessionSettleRequest()");if(f)throw Error(f.message);let g=dt(d,"onSessionSettleRequest()");if(g)throw Error(g.message);if(Q(e)){let{message:a}=di("EXPIRED","onSessionSettleRequest()");throw Error(a)}}),g0(this,"isValidUpdate",async a=>{if(!dv(a)){let{message:b}=di("MISSING_OR_INVALID",`update() params: ${a}`);throw Error(b)}let{topic:b,namespaces:c}=a;this.checkRecentlyDeleted(b),await this.isValidSessionTopic(b);let d=this.client.session.get(b),e=dt(c,"update()");if(e)throw Error(e.message);let f=dx(d.requiredNamespaces,c,"update()");if(f)throw Error(f.message)}),g0(this,"isValidExtend",async a=>{if(!dv(a)){let{message:b}=di("MISSING_OR_INVALID",`extend() params: ${a}`);throw Error(b)}let{topic:b}=a;this.checkRecentlyDeleted(b),await this.isValidSessionTopic(b)}),g0(this,"isValidRequest",async a=>{if(!dv(a)){let{message:b}=di("MISSING_OR_INVALID",`request() params: ${a}`);throw Error(b)}let{topic:b,request:c,chainId:d,expiry:e}=a;this.checkRecentlyDeleted(b),await this.isValidSessionTopic(b);let{namespaces:f}=this.client.session.get(b);if(!dw(f,d)){let{message:a}=di("MISSING_OR_INVALID",`request() chainId: ${d}`);throw Error(a)}if(!function(a){return!(dm(a)||!dn(a.method,!1))}(c)){let{message:a}=di("MISSING_OR_INVALID",`request() ${JSON.stringify(c)}`);throw Error(a)}if(!function(a,b,c){return!!dn(c,!1)&&(function(a,b){let c=[];return Object.values(a).forEach(a=>{db(a.accounts).includes(b)&&c.push(...a.methods)}),c})(a,b).includes(c)}(f,d,c.method)){let{message:a}=di("MISSING_OR_INVALID",`request() method: ${c.method}`);throw Error(a)}if(e&&!function(a,b){return dp(a,!1)&&a<=b.max&&a>=b.min}(e,gN)){let{message:a}=di("MISSING_OR_INVALID",`request() expiry: ${e}. Expiry must be a number (in seconds) between ${gN.min} and ${gN.max}`);throw Error(a)}}),g0(this,"isValidRespond",async a=>{var b;if(!dv(a)){let{message:b}=di("MISSING_OR_INVALID",`respond() params: ${a}`);throw Error(b)}let{topic:c,response:d}=a;try{await this.isValidSessionTopic(c)}catch(c){throw null!=(b=a?.response)&&b.id&&this.cleanupAfterResponse(a),c}if(!function(a){return!(dm(a)||dm(a.result)&&dm(a.error)||!dp(a.id,!1)||!dn(a.jsonrpc,!1))}(d)){let{message:a}=di("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(d)}`);throw Error(a)}}),g0(this,"isValidPing",async a=>{if(!dv(a)){let{message:b}=di("MISSING_OR_INVALID",`ping() params: ${a}`);throw Error(b)}let{topic:b}=a;await this.isValidSessionOrPairingTopic(b)}),g0(this,"isValidEmit",async a=>{if(!dv(a)){let{message:b}=di("MISSING_OR_INVALID",`emit() params: ${a}`);throw Error(b)}let{topic:b,event:c,chainId:d}=a;await this.isValidSessionTopic(b);let{namespaces:e}=this.client.session.get(b);if(!dw(e,d)){let{message:a}=di("MISSING_OR_INVALID",`emit() chainId: ${d}`);throw Error(a)}if(!function(a){return!(dm(a)||!dn(a.name,!1))}(c)||!function(a,b,c){return!!dn(c,!1)&&(function(a,b){let c=[];return Object.values(a).forEach(a=>{db(a.accounts).includes(b)&&c.push(...a.events)}),c})(a,b).includes(c)}(e,d,c.name)){let{message:a}=di("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(c)}`);throw Error(a)}}),g0(this,"isValidDisconnect",async a=>{if(!dv(a)){let{message:b}=di("MISSING_OR_INVALID",`disconnect() params: ${a}`);throw Error(b)}let{topic:b}=a;await this.isValidSessionOrPairingTopic(b)}),g0(this,"isValidAuthenticate",a=>{let{chains:b,uri:c,domain:d,nonce:e}=a;if(!Array.isArray(b)||0===b.length)throw Error("chains is required and must be a non-empty array");if(!dn(c,!1))throw Error("uri is required parameter");if(!dn(d,!1))throw Error("domain is required parameter");if(!dn(e,!1))throw Error("nonce is required parameter");if([...new Set(b.map(a=>p(a).namespace))].length>1)throw Error("Multi-namespace requests are not supported. Please request single namespace only.");let{namespace:f}=p(b[0]);if("eip155"!==f)throw Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),g0(this,"getVerifyContext",async a=>{let{attestationId:b,hash:c,encryptedId:d,metadata:e,transportType:f}=a,g={verified:{verifyUrl:e.verifyUrl||ek,validation:"UNKNOWN",origin:e.url||""}};try{if(f===ec.link_mode){let a=this.getAppLinkIfEnabled(e,f);return g.verified.validation=a&&new URL(a).origin===new URL(e.url).origin?"VALID":"INVALID",g}let a=await this.client.core.verify.resolve({attestationId:b,hash:c,encryptedId:d,verifyUrl:e.verifyUrl});a&&(g.verified.origin=a.origin,g.verified.isScam=a.isScam,g.verified.validation=a.origin===new URL(e.url).origin?"VALID":"INVALID")}catch(a){this.client.logger.warn(a)}return this.client.logger.debug(`Verify context: ${JSON.stringify(g)}`),g}),g0(this,"validateSessionProps",(a,b)=>{Object.values(a).forEach((c,d)=>{if(null==c){let{message:e}=di("MISSING_OR_INVALID",`${b} must contain an existing value for each key. Received: ${c} for key ${Object.keys(a)[d]}`);throw Error(e)}})}),g0(this,"getPendingAuthRequest",a=>{let b=this.client.auth.requests.get(a);return"object"==typeof b?b:void 0}),g0(this,"addToRecentlyDeleted",(a,b)=>{if(this.recentlyDeletedMap.set(a,b),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let a=0,b=this.recentlyDeletedLimit/2;for(let c of this.recentlyDeletedMap.keys()){if(a++>=b)break;this.recentlyDeletedMap.delete(c)}}}),g0(this,"checkRecentlyDeleted",a=>{let b=this.recentlyDeletedMap.get(a);if(b){let{message:c}=di("MISSING_OR_INVALID",`Record was recently deleted - ${b}: ${a}`);throw Error(c)}}),g0(this,"isLinkModeEnabled",(a,b)=>{var c,d,e,f,g,h,i,j,k;return!!a&&b===ec.link_mode&&(null==(d=null==(c=this.client.metadata)?void 0:c.redirect)?void 0:d.linkMode)===!0&&(null==(f=null==(e=this.client.metadata)?void 0:e.redirect)?void 0:f.universal)!==void 0&&(null==(h=null==(g=this.client.metadata)?void 0:g.redirect)?void 0:h.universal)!==""&&(null==(i=a?.redirect)?void 0:i.universal)!==void 0&&(null==(j=a?.redirect)?void 0:j.universal)!==""&&(null==(k=a?.redirect)?void 0:k.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(a.redirect.universal)&&"u">typeof(null==global?void 0:global.Linking)}),g0(this,"getAppLinkIfEnabled",(a,b)=>{var c;return this.isLinkModeEnabled(a,b)?null==(c=a?.redirect)?void 0:c.universal:void 0}),g0(this,"handleLinkModeMessage",({url:a})=>{if(!a||!a.includes("wc_ev")||!a.includes("topic"))return;let b=V(a,"topic")||"",c=decodeURIComponent(V(a,"wc_ev")||""),d=this.client.session.keys.includes(b);d&&this.client.session.update(b,{transportType:ec.link_mode}),this.client.core.dispatchEnvelope({topic:b,message:c,sessionExists:d})}),g0(this,"registerLinkModeListeners",async()=>{var a;if(X()||C()&&null!=(a=this.client.metadata.redirect)&&a.linkMode){let a=null==global?void 0:global.Linking;if("u">typeof a){a.addEventListener("url",this.handleLinkModeMessage,this.client.name);let b=await a.getInitialURL();b&&setTimeout(()=>{this.handleLinkModeMessage({url:b})},50)}}}),g0(this,"shouldSetTVF",(a,b)=>{if(!b||"wc_sessionRequest"!==a)return!1;let{request:c}=b;return Object.keys(gP).includes(c.method)}),g0(this,"getTVFParams",(a,b,c)=>{var d,e;try{let f=b.request.method,g=this.extractTxHashesFromResult(f,c);return g_(g$({correlationId:a,rpcMethods:[f],chainId:b.chainId},this.isValidContractData(b.request.params)&&{contractAddresses:[null==(e=null==(d=b.request.params)?void 0:d[0])?void 0:e.to]}),{txHashes:g})}catch(a){this.client.logger.warn("Error getting TVF params",a)}return{}}),g0(this,"isValidContractData",a=>{var b;if(!a)return!1;try{let c=a?.data||(null==(b=a?.[0])?void 0:b.data);if(!c.startsWith("0x"))return!1;let d=c.slice(2);return!!/^[0-9a-fA-F]*$/.test(d)&&d.length%2==0}catch{}return!1}),g0(this,"extractTxHashesFromResult",(a,b)=>{try{let c=gP[a];if("string"==typeof b)return[b];let d=b[c.key];if(dk(d))return"solana_signAllTransactions"===a?d.map(a=>(function(a){let b=atob(a),c=new Uint8Array(b.length);for(let a=0;a<b.length;a++)c[a]=b.charCodeAt(a);let d=c[0];if(0===d)throw Error("No signatures found");if(c.length<1+64*d)throw Error("Transaction data too short for claimed signature count");if(c.length<100)throw Error("Transaction too short");let e=Buffer.from(a,"base64").slice(1,65);return k.A.encode(e)})(a)):d;if("string"==typeof d)return[d]}catch(a){this.client.logger.warn("Error extracting tx hashes from result",a)}return[]})}async processPendingMessageEvents(){try{let a=this.client.session.keys,b=this.client.core.relayer.messages.getWithoutAck(a);for(let[a,c]of Object.entries(b))for(let b of c)try{await this.onProviderMessageEvent({topic:a,message:b,publishedAt:Date.now()})}catch{this.client.logger.warn(`Error processing pending message event for topic: ${a}, message: ${b}`)}}catch(a){this.client.logger.warn("processPendingMessageEvents failed",a)}}isInitialized(){if(!this.initialized){let{message:a}=di("NOT_INITIALIZED",this.name);throw Error(a)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(d9.message,a=>{this.onProviderMessageEvent(a)})}async onRelayMessage(a){let{topic:b,message:c,attestation:d,transportType:e}=a,{publicKey:f}=this.client.auth.authKeys.keys.includes(gS)?this.client.auth.authKeys.get(gS):{responseTopic:void 0,publicKey:void 0};try{let a=await this.client.core.crypto.decode(b,c,{receiverPublicKey:f,encoding:e===ec.link_mode?cM:cL});(0,d_.isJsonRpcRequest)(a)?(this.client.core.history.set(b,a),await this.onRelayEventRequest({topic:b,payload:a,attestation:d,transportType:e,encryptedId:cQ(c)})):(0,d_.isJsonRpcResponse)(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:b,payload:a,transportType:e}),this.client.core.history.delete(b,a.id)):await this.onRelayEventUnknownPayload({topic:b,payload:a,transportType:e}),await this.client.core.relayer.messages.ack(b,c)}catch(a){this.client.logger.error(a)}}registerExpirerEvents(){this.client.core.expirer.on(ej.expired,async a=>{let{topic:b,id:c}=O(a.target);return c&&this.client.pendingRequest.keys.includes(c)?await this.deletePendingSessionRequest(c,di("EXPIRED"),!0):c&&this.client.auth.requests.keys.includes(c)?await this.deletePendingAuthRequest(c,di("EXPIRED"),!0):void(b?this.client.session.keys.includes(b)&&(await this.deleteSession({topic:b,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:b})):c&&(await this.deleteProposal(c,!0),this.client.events.emit("proposal_expire",{id:c})))})}registerPairingEvents(){this.client.core.pairing.events.on(eh.create,a=>this.onPairingCreated(a)),this.client.core.pairing.events.on(eh.delete,a=>{this.addToRecentlyDeleted(a.topic,"pairing")})}isValidPairingTopic(a){if(!dn(a,!1)){let{message:b}=di("MISSING_OR_INVALID",`pairing topic should be a string: ${a}`);throw Error(b)}if(!this.client.core.pairing.pairings.keys.includes(a)){let{message:b}=di("NO_MATCHING_KEY",`pairing topic doesn't exist: ${a}`);throw Error(b)}if(Q(this.client.core.pairing.pairings.get(a).expiry)){let{message:b}=di("EXPIRED",`pairing topic: ${a}`);throw Error(b)}}async isValidSessionTopic(a){if(!dn(a,!1)){let{message:b}=di("MISSING_OR_INVALID",`session topic should be a string: ${a}`);throw Error(b)}if(this.checkRecentlyDeleted(a),!this.client.session.keys.includes(a)){let{message:b}=di("NO_MATCHING_KEY",`session topic doesn't exist: ${a}`);throw Error(b)}if(Q(this.client.session.get(a).expiry)){await this.deleteSession({topic:a});let{message:b}=di("EXPIRED",`session topic: ${a}`);throw Error(b)}if(!this.client.core.crypto.keychain.has(a)){let{message:b}=di("MISSING_OR_INVALID",`session topic does not exist in keychain: ${a}`);throw await this.deleteSession({topic:a}),Error(b)}}async isValidSessionOrPairingTopic(a){if(this.checkRecentlyDeleted(a),this.client.session.keys.includes(a))await this.isValidSessionTopic(a);else if(this.client.core.pairing.pairings.keys.includes(a))this.isValidPairingTopic(a);else if(dn(a,!1)){let{message:b}=di("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${a}`);throw Error(b)}else{let{message:b}=di("MISSING_OR_INVALID",`session or pairing topic should be a string: ${a}`);throw Error(b)}}async isValidProposalId(a){if("number"!=typeof a){let{message:b}=di("MISSING_OR_INVALID",`proposal id should be a number: ${a}`);throw Error(b)}if(!this.client.proposal.keys.includes(a)){let{message:b}=di("NO_MATCHING_KEY",`proposal id doesn't exist: ${a}`);throw Error(b)}if(Q(this.client.proposal.get(a).expiryTimestamp)){await this.deleteProposal(a);let{message:b}=di("EXPIRED",`proposal id: ${a}`);throw Error(b)}}}class g2 extends ga{constructor(a,b){super(a,b,"proposal",gH),this.core=a,this.logger=b}}class g3 extends ga{constructor(a,b){super(a,b,"session",gH),this.core=a,this.logger=b}}class g4 extends ga{constructor(a,b){super(a,b,"request",gH,a=>a.id),this.core=a,this.logger=b}}class g5 extends ga{constructor(a,b){super(a,b,"authKeys",gR,()=>gS),this.core=a,this.logger=b}}class g6 extends ga{constructor(a,b){super(a,b,"pairingTopics",gR),this.core=a,this.logger=b}}class g7 extends ga{constructor(a,b){super(a,b,"requests",gR,a=>a.id),this.core=a,this.logger=b}}var g8=Object.defineProperty,g9=(a,b,c)=>((a,b,c)=>b in a?g8(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c)(a,"symbol"!=typeof b?b+"":b,c);class ha{constructor(a,b){this.core=a,this.logger=b,g9(this,"authKeys"),g9(this,"pairingTopics"),g9(this,"requests"),this.authKeys=new g5(this.core,this.logger),this.pairingTopics=new g6(this.core,this.logger),this.requests=new g7(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}var hb=Object.defineProperty,hc=(a,b,c)=>((a,b,c)=>b in a?hb(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c)(a,"symbol"!=typeof b?b+"":b,c);class hd extends dX{constructor(a){super(a),hc(this,"protocol","wc"),hc(this,"version",2),hc(this,"name",gI.name),hc(this,"metadata"),hc(this,"core"),hc(this,"logger"),hc(this,"events",new d.EventEmitter),hc(this,"engine"),hc(this,"session"),hc(this,"proposal"),hc(this,"pendingRequest"),hc(this,"auth"),hc(this,"signConfig"),hc(this,"on",(a,b)=>this.events.on(a,b)),hc(this,"once",(a,b)=>this.events.once(a,b)),hc(this,"off",(a,b)=>this.events.off(a,b)),hc(this,"removeListener",(a,b)=>this.events.removeListener(a,b)),hc(this,"removeAllListeners",a=>this.events.removeAllListeners(a)),hc(this,"connect",async a=>{try{return await this.engine.connect(a)}catch(a){throw this.logger.error(a.message),a}}),hc(this,"pair",async a=>{try{return await this.engine.pair(a)}catch(a){throw this.logger.error(a.message),a}}),hc(this,"approve",async a=>{try{return await this.engine.approve(a)}catch(a){throw this.logger.error(a.message),a}}),hc(this,"reject",async a=>{try{return await this.engine.reject(a)}catch(a){throw this.logger.error(a.message),a}}),hc(this,"update",async a=>{try{return await this.engine.update(a)}catch(a){throw this.logger.error(a.message),a}}),hc(this,"extend",async a=>{try{return await this.engine.extend(a)}catch(a){throw this.logger.error(a.message),a}}),hc(this,"request",async a=>{try{return await this.engine.request(a)}catch(a){throw this.logger.error(a.message),a}}),hc(this,"respond",async a=>{try{return await this.engine.respond(a)}catch(a){throw this.logger.error(a.message),a}}),hc(this,"ping",async a=>{try{return await this.engine.ping(a)}catch(a){throw this.logger.error(a.message),a}}),hc(this,"emit",async a=>{try{return await this.engine.emit(a)}catch(a){throw this.logger.error(a.message),a}}),hc(this,"disconnect",async a=>{try{return await this.engine.disconnect(a)}catch(a){throw this.logger.error(a.message),a}}),hc(this,"find",a=>{try{return this.engine.find(a)}catch(a){throw this.logger.error(a.message),a}}),hc(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(a){throw this.logger.error(a.message),a}}),hc(this,"authenticate",async(a,b)=>{try{return await this.engine.authenticate(a,b)}catch(a){throw this.logger.error(a.message),a}}),hc(this,"formatAuthMessage",a=>{try{return this.engine.formatAuthMessage(a)}catch(a){throw this.logger.error(a.message),a}}),hc(this,"approveSessionAuthenticate",async a=>{try{return await this.engine.approveSessionAuthenticate(a)}catch(a){throw this.logger.error(a.message),a}}),hc(this,"rejectSessionAuthenticate",async a=>{try{return await this.engine.rejectSessionAuthenticate(a)}catch(a){throw this.logger.error(a.message),a}}),this.name=a?.name||gI.name,this.metadata=function(a){var b,c;let d=G();try{let e,f;return null!=a&&a.url&&d.url&&new URL(a.url).host!==new URL(d.url).host&&(console.warn(`The configured WalletConnect 'metadata.url':${a.url} differs from the actual page url:${d.url}. This is probably unintended and can lead to issues.`),a.url=d.url),null!=(b=a?.icons)&&b.length&&a.icons.length>0&&(a.icons=a.icons.filter(a=>""!==a)),e=z(z({},d),a),f={url:a?.url||d.url,name:a?.name||d.name,description:a?.description||d.description,icons:null!=(c=a?.icons)&&c.length&&a.icons.length>0?a.icons:d.icons},t(e,u(f))}catch(b){return console.warn("Error populating app metadata",b),a||d}}(a?.metadata),this.signConfig=a?.signConfig;let b="u">typeof a?.logger&&"string"!=typeof a?.logger?a.logger:(0,dF.h6)((0,dF.iP)({level:a?.logger||gI.logger}));this.core=a?.core||new gF(a),this.logger=(0,dF.U5)(b,this.name),this.session=new g3(this.core,this.logger),this.proposal=new g2(this.core,this.logger),this.pendingRequest=new g4(this.core,this.logger),this.engine=new g1(this),this.auth=new ha(this.core,this.logger)}static async init(a){let b=new hd(a);return await b.initialize(),b}get context(){return(0,dF.oI)(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success"),setTimeout(()=>{this.engine.processRelayMessageCache()},(0,g.toMiliseconds)(g.ONE_SECOND))}catch(a){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(a.message),a}}}var he=c(44450);let hf="error",hg="wc@2:universal_provider:",hh="https://rpc.walletconnect.org/v1/",hi="generic",hj=`${hh}bundler`,hk={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};function hl(){}function hm(a){return null==a||"object"!=typeof a&&"function"!=typeof a}function hn(a){return ArrayBuffer.isView(a)&&!(a instanceof DataView)}function ho(a){return"object"==typeof a&&null!==a}function hp(a){return Object.getOwnPropertySymbols(a).filter(b=>Object.prototype.propertyIsEnumerable.call(a,b))}function hq(a){return null==a?void 0===a?"[object Undefined]":"[object Null]":Object.prototype.toString.call(a)}let hr="[object String]",hs="[object Number]",ht="[object Boolean]",hu="[object Arguments]";function hv(a,b,c,d=new Map,e){let f=e?.(a,b,c,d);if(null!=f)return f;if(hm(a))return a;if(d.has(a))return d.get(a);if(Array.isArray(a)){let b=Array(a.length);d.set(a,b);for(let f=0;f<a.length;f++)b[f]=hv(a[f],f,c,d,e);return Object.hasOwn(a,"index")&&(b.index=a.index),Object.hasOwn(a,"input")&&(b.input=a.input),b}if(a instanceof Date)return new Date(a.getTime());if(a instanceof RegExp){let b=new RegExp(a.source,a.flags);return b.lastIndex=a.lastIndex,b}if(a instanceof Map){let b=new Map;for(let[f,g]of(d.set(a,b),a))b.set(f,hv(g,f,c,d,e));return b}if(a instanceof Set){let b=new Set;for(let f of(d.set(a,b),a))b.add(hv(f,void 0,c,d,e));return b}if("u">typeof Buffer&&Buffer.isBuffer(a))return a.subarray();if(hn(a)){let b=new(Object.getPrototypeOf(a)).constructor(a.length);d.set(a,b);for(let f=0;f<a.length;f++)b[f]=hv(a[f],f,c,d,e);return b}if(a instanceof ArrayBuffer||"u">typeof SharedArrayBuffer&&a instanceof SharedArrayBuffer)return a.slice(0);if(a instanceof DataView){let b=new DataView(a.buffer.slice(0),a.byteOffset,a.byteLength);return d.set(a,b),hw(b,a,c,d,e),b}if("u">typeof File&&a instanceof File){let b=new File([a],a.name,{type:a.type});return d.set(a,b),hw(b,a,c,d,e),b}if(a instanceof Blob){let b=new Blob([a],{type:a.type});return d.set(a,b),hw(b,a,c,d,e),b}if(a instanceof Error){let b=new a.constructor;return d.set(a,b),b.message=a.message,b.name=a.name,b.stack=a.stack,b.cause=a.cause,hw(b,a,c,d,e),b}if("object"==typeof a&&function(a){switch(hq(a)){case hu:case"[object Array]":case"[object ArrayBuffer]":case"[object DataView]":case ht:case"[object Date]":case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Map]":case hs:case"[object Object]":case"[object RegExp]":case"[object Set]":case hr:case"[object Symbol]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return!0;default:return!1}}(a)){let b=Object.create(Object.getPrototypeOf(a));return d.set(a,b),hw(b,a,c,d,e),b}return a}function hw(a,b,c=a,d,e){let f=[...Object.keys(b),...hp(b)];for(let g=0;g<f.length;g++){let h=f[g],i=Object.getOwnPropertyDescriptor(a,h);(null==i||i.writable)&&(a[h]=hv(b[h],h,c,d,e))}}function hx(a){var b;return b=(b,c,d,e)=>{let f=void 0;if(null!=f)return f;if("object"==typeof a)switch(Object.prototype.toString.call(a)){case hs:case hr:case ht:{let b=new a.constructor(a?.valueOf());return hw(b,a),b}case hu:{let b={};return hw(b,a),b.length=a.length,b[Symbol.iterator]=a[Symbol.iterator],b}default:return}},hv(a,void 0,a,new Map,b)}function hy(a){return null!==a&&"object"==typeof a&&"[object Arguments]"===hq(a)}var hz=Object.defineProperty,hA=Object.defineProperties,hB=Object.getOwnPropertyDescriptors,hC=Object.getOwnPropertySymbols,hD=Object.prototype.hasOwnProperty,hE=Object.prototype.propertyIsEnumerable,hF=(a,b,c)=>b in a?hz(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,hG=(a,b)=>{for(var c in b||(b={}))hD.call(b,c)&&hF(a,c,b[c]);if(hC)for(var c of hC(b))hE.call(b,c)&&hF(a,c,b[c]);return a},hH=(a,b)=>hA(a,hB(b));function hI(a,b,c){var d;let e=p(a);return(null==(d=b.rpcMap)?void 0:d[e.reference])||`${hh}?chainId=${e.namespace}:${e.reference}&projectId=${c}`}function hJ(a){return a.includes(":")?a.split(":")[1]:a}function hK(a){return a.map(a=>`${a.split(":")[0]}:${a.split(":")[1]}`)}function hL(a={},b={}){return function(a,...b){return function(a,...b){let c=b.slice(0,-1),d=b[b.length-1],e=a;for(let a=0;a<c.length;a++)e=function a(b,c,d,e){if(hm(b)&&(b=Object(b)),null==c||"object"!=typeof c)return b;if(e.has(c))return function(a){if(hm(a))return a;if(Array.isArray(a)||hn(a)||a instanceof ArrayBuffer||"u">typeof SharedArrayBuffer&&a instanceof SharedArrayBuffer)return a.slice(0);let b=Object.getPrototypeOf(a),c=b.constructor;if(a instanceof Date||a instanceof Map||a instanceof Set)return new c(a);if(a instanceof RegExp){let b=new c(a);return b.lastIndex=a.lastIndex,b}if(a instanceof DataView)return new c(a.buffer.slice(0));if(a instanceof Error){let b=new c(a.message);return b.stack=a.stack,b.name=a.name,b.cause=a.cause,b}return"u">typeof File&&a instanceof File?new c([a],a.name,{type:a.type,lastModified:a.lastModified}):"object"==typeof a?Object.assign(Object.create(b),a):a}(e.get(c));if(e.set(c,b),Array.isArray(c)){c=c.slice();for(let a=0;a<c.length;a++)c[a]=c[a]??void 0}let f=[...Object.keys(c),...hp(c)];for(let g=0;g<f.length;g++){let h=f[g],i=c[h],j=b[h];if(hy(i)&&(i={...i}),hy(j)&&(j={...j}),"u">typeof Buffer&&Buffer.isBuffer(i)&&(i=hx(i)),Array.isArray(i))if("object"==typeof j&&null!=j){let a=[],b=Reflect.ownKeys(j);for(let c=0;c<b.length;c++){let d=b[c];a[d]=j[d]}j=a}else j=[];let k=d(j,i,h,b,c,e);null!=k?b[h]=k:Array.isArray(i)||ho(j)&&ho(i)?b[h]=a(j,i,d,e):null==j&&function(a){if("object"!=typeof a||null==a)return!1;if(null===Object.getPrototypeOf(a))return!0;if("[object Object]"!==Object.prototype.toString.call(a)){let b=a[Symbol.toStringTag];return null!=b&&!!Object.getOwnPropertyDescriptor(a,Symbol.toStringTag)?.writable&&a.toString()===`[object ${b}]`}let b=a;for(;null!==Object.getPrototypeOf(b);)b=Object.getPrototypeOf(b);return Object.getPrototypeOf(a)===b}(i)?b[h]=a({},i,d,e):null==j&&hn(i)?b[h]=hx(i):(void 0===j||void 0!==i)&&(b[h]=i)}return b}(e,c[a],d,new Map);return e}(a,...b,hl)}(hM(a),hM(b))}function hM(a){var b,c,d,e,f;let g={};if(!dl(a))return g;for(let[h,i]of Object.entries(a)){let a=dc(h)?[h]:i.chains,j=i.methods||[],k=i.events||[],l=i.rpcMap||{},m=dd(h);g[m]=hH(hG(hG({},g[m]),i),{chains:S(a,null==(b=g[m])?void 0:b.chains),methods:S(j,null==(c=g[m])?void 0:c.methods),events:S(k,null==(d=g[m])?void 0:d.events)}),(dl(l)||dl((null==(e=g[m])?void 0:e.rpcMap)||{}))&&(g[m].rpcMap=hG(hG({},l),null==(f=g[m])?void 0:f.rpcMap))}return g}function hN(a){return a.includes(":")?a.split(":")[2]:a}function hO(a){let b={};for(let[c,d]of Object.entries(a)){let a=d.methods||[],e=d.events||[],f=d.accounts||[],g=dc(c)?[c]:d.chains?d.chains:hK(d.accounts);b[c]={chains:g,methods:a,events:e,accounts:f}}return b}function hP(a){return"number"==typeof a?a:a.includes("0x")?parseInt(a,16):isNaN(Number(a=a.includes(":")?a.split(":")[1]:a))?a:Number(a)}let hQ={},hR=a=>hQ[a],hS=(a,b)=>{hQ[a]=b};var hT=Object.defineProperty,hU=(a,b,c)=>((a,b,c)=>b in a?hT(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c)(a,"symbol"!=typeof b?b+"":b,c);class hV{constructor(a){hU(this,"name","polkadot"),hU(this,"client"),hU(this,"httpProviders"),hU(this,"events"),hU(this,"namespace"),hU(this,"chainId"),this.namespace=a.namespace,this.events=hR("events"),this.client=hR("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(a){this.namespace=Object.assign(this.namespace,a)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let a=this.namespace.chains[0];if(!a)throw Error("ChainId not found");return a.split(":")[1]}request(a){return this.namespace.methods.includes(a.request.method)?this.client.request(a):this.getHttpProvider().request(a.request)}setDefaultChain(a,b){this.httpProviders[a]||this.setHttpProvider(a,b),this.chainId=a,this.events.emit(hk.DEFAULT_CHAIN_CHANGED,`${this.name}:${a}`)}getAccounts(){let a=this.namespace.accounts;return a&&a.filter(a=>a.split(":")[1]===this.chainId.toString()).map(a=>a.split(":")[2])||[]}createHttpProviders(){let a={};return this.namespace.chains.forEach(b=>{var c;let d=hJ(b);a[d]=this.createHttpProvider(d,null==(c=this.namespace.rpcMap)?void 0:c[b])}),a}getHttpProvider(){let a=`${this.name}:${this.chainId}`,b=this.httpProviders[a];if(typeof b>"u")throw Error(`JSON-RPC provider for ${a} not found`);return b}setHttpProvider(a,b){let c=this.createHttpProvider(a,b);c&&(this.httpProviders[a]=c)}createHttpProvider(a,b){let c=b||hI(a,this.namespace,this.client.core.projectId);if(!c)throw Error(`No RPC url provided for chainId: ${a}`);return new d$.F(new he.A(c,hR("disableProviderPing")))}}var hW=Object.defineProperty,hX=Object.defineProperties,hY=Object.getOwnPropertyDescriptors,hZ=Object.getOwnPropertySymbols,h$=Object.prototype.hasOwnProperty,h_=Object.prototype.propertyIsEnumerable,h0=(a,b,c)=>b in a?hW(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,h1=(a,b)=>{for(var c in b||(b={}))h$.call(b,c)&&h0(a,c,b[c]);if(hZ)for(var c of hZ(b))h_.call(b,c)&&h0(a,c,b[c]);return a},h2=(a,b)=>hX(a,hY(b)),h3=(a,b,c)=>h0(a,"symbol"!=typeof b?b+"":b,c);class h4{constructor(a){h3(this,"name","eip155"),h3(this,"client"),h3(this,"chainId"),h3(this,"namespace"),h3(this,"httpProviders"),h3(this,"events"),this.namespace=a.namespace,this.events=hR("events"),this.client=hR("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(a){switch(a.request.method){case"eth_requestAccounts":case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(a);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(a);case"wallet_getCallsStatus":return await this.getCallStatus(a)}return this.namespace.methods.includes(a.request.method)?await this.client.request(a):this.getHttpProvider().request(a.request)}updateNamespace(a){this.namespace=Object.assign(this.namespace,a)}setDefaultChain(a,b){this.httpProviders[a]||this.setHttpProvider(parseInt(a),b),this.chainId=parseInt(a),this.events.emit(hk.DEFAULT_CHAIN_CHANGED,`${this.name}:${a}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;let a=this.namespace.chains[0];if(!a)throw Error("ChainId not found");return a.split(":")[1]}createHttpProvider(a,b){let c=b||hI(`${this.name}:${a}`,this.namespace,this.client.core.projectId);if(!c)throw Error(`No RPC url provided for chainId: ${a}`);return new d$.F(new he.V(c,hR("disableProviderPing")))}setHttpProvider(a,b){let c=this.createHttpProvider(a,b);c&&(this.httpProviders[a]=c)}createHttpProviders(){let a={};return this.namespace.chains.forEach(b=>{var c;let d=parseInt(hJ(b));a[d]=this.createHttpProvider(d,null==(c=this.namespace.rpcMap)?void 0:c[b])}),a}getAccounts(){let a=this.namespace.accounts;return a?[...new Set(a.filter(a=>a.split(":")[1]===this.chainId.toString()).map(a=>a.split(":")[2]))]:[]}getHttpProvider(){let a=this.chainId,b=this.httpProviders[a];if(typeof b>"u")throw Error(`JSON-RPC provider for ${a} not found`);return b}async handleSwitchChain(a){var b,c;let d=a.request.params?null==(b=a.request.params[0])?void 0:b.chainId:"0x0",e=parseInt(d=d.startsWith("0x")?d:`0x${d}`,16);if(this.isChainApproved(e))this.setDefaultChain(`${e}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:a.topic,request:{method:a.request.method,params:[{chainId:d}]},chainId:null==(c=this.namespace.chains)?void 0:c[0]}),this.setDefaultChain(`${e}`);else throw Error(`Failed to switch to chain 'eip155:${e}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(a){return this.namespace.chains.includes(`${this.name}:${a}`)}async getCapabilities(a){var b,c,d,e,f;let g=null==(c=null==(b=a.request)?void 0:b.params)?void 0:c[0],h=(null==(e=null==(d=a.request)?void 0:d.params)?void 0:e[1])||[],i=`${g}${h.join(",")}`;if(!g)throw Error("Missing address parameter in `wallet_getCapabilities` request");let j=this.client.session.get(a.topic),k=(null==(f=j?.sessionProperties)?void 0:f.capabilities)||{};if(null!=k&&k[i])return k?.[i];let l=await this.client.request(a);try{await this.client.session.update(a.topic,{sessionProperties:h2(h1({},j.sessionProperties||{}),{capabilities:h2(h1({},k||{}),{[i]:l})})})}catch(a){console.warn("Failed to update session with capabilities",a)}return l}async getCallStatus(a){var b,c;let d=this.client.session.get(a.topic),e=null==(b=d.sessionProperties)?void 0:b.bundler_name;if(e){let b=this.getBundlerUrl(a.chainId,e);try{return await this.getUserOperationReceipt(b,a)}catch(a){console.warn("Failed to fetch call status from bundler",a,b)}}let f=null==(c=d.sessionProperties)?void 0:c.bundler_url;if(f)try{return await this.getUserOperationReceipt(f,a)}catch(a){console.warn("Failed to fetch call status from custom bundler",a,f)}if(this.namespace.methods.includes(a.request.method))return await this.client.request(a);throw Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(a,b){var c;let d=new URL(a),e=await fetch(d,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify((0,d_.formatJsonRpcRequest)("eth_getUserOperationReceipt",[null==(c=b.request.params)?void 0:c[0]]))});if(!e.ok)throw Error(`Failed to fetch user operation receipt - ${e.status}`);return await e.json()}getBundlerUrl(a,b){return`${hj}?projectId=${this.client.core.projectId}&chainId=${a}&bundler=${b}`}}var h5=Object.defineProperty,h6=(a,b,c)=>((a,b,c)=>b in a?h5(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c)(a,"symbol"!=typeof b?b+"":b,c);class h7{constructor(a){h6(this,"name","solana"),h6(this,"client"),h6(this,"httpProviders"),h6(this,"events"),h6(this,"namespace"),h6(this,"chainId"),this.namespace=a.namespace,this.events=hR("events"),this.client=hR("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(a){this.namespace=Object.assign(this.namespace,a)}requestAccounts(){return this.getAccounts()}request(a){return this.namespace.methods.includes(a.request.method)?this.client.request(a):this.getHttpProvider().request(a.request)}setDefaultChain(a,b){this.httpProviders[a]||this.setHttpProvider(a,b),this.chainId=a,this.events.emit(hk.DEFAULT_CHAIN_CHANGED,`${this.name}:${a}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let a=this.namespace.chains[0];if(!a)throw Error("ChainId not found");return a.split(":")[1]}getAccounts(){let a=this.namespace.accounts;return a?[...new Set(a.filter(a=>a.split(":")[1]===this.chainId.toString()).map(a=>a.split(":")[2]))]:[]}createHttpProviders(){let a={};return this.namespace.chains.forEach(b=>{var c;let d=hJ(b);a[d]=this.createHttpProvider(d,null==(c=this.namespace.rpcMap)?void 0:c[b])}),a}getHttpProvider(){let a=`${this.name}:${this.chainId}`,b=this.httpProviders[a];if(typeof b>"u")throw Error(`JSON-RPC provider for ${a} not found`);return b}setHttpProvider(a,b){let c=this.createHttpProvider(a,b);c&&(this.httpProviders[a]=c)}createHttpProvider(a,b){let c=b||hI(a,this.namespace,this.client.core.projectId);if(!c)throw Error(`No RPC url provided for chainId: ${a}`);return new d$.F(new he.A(c,hR("disableProviderPing")))}}var h8=Object.defineProperty,h9=(a,b,c)=>((a,b,c)=>b in a?h8(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c)(a,"symbol"!=typeof b?b+"":b,c);class ia{constructor(a){h9(this,"name","cosmos"),h9(this,"client"),h9(this,"httpProviders"),h9(this,"events"),h9(this,"namespace"),h9(this,"chainId"),this.namespace=a.namespace,this.events=hR("events"),this.client=hR("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(a){this.namespace=Object.assign(this.namespace,a)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let a=this.namespace.chains[0];if(!a)throw Error("ChainId not found");return a.split(":")[1]}request(a){return this.namespace.methods.includes(a.request.method)?this.client.request(a):this.getHttpProvider().request(a.request)}setDefaultChain(a,b){this.httpProviders[a]||this.setHttpProvider(a,b),this.chainId=a,this.events.emit(hk.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){let a=this.namespace.accounts;return a?[...new Set(a.filter(a=>a.split(":")[1]===this.chainId.toString()).map(a=>a.split(":")[2]))]:[]}createHttpProviders(){let a={};return this.namespace.chains.forEach(b=>{var c;let d=hJ(b);a[d]=this.createHttpProvider(d,null==(c=this.namespace.rpcMap)?void 0:c[b])}),a}getHttpProvider(){let a=`${this.name}:${this.chainId}`,b=this.httpProviders[a];if(typeof b>"u")throw Error(`JSON-RPC provider for ${a} not found`);return b}setHttpProvider(a,b){let c=this.createHttpProvider(a,b);c&&(this.httpProviders[a]=c)}createHttpProvider(a,b){let c=b||hI(a,this.namespace,this.client.core.projectId);if(!c)throw Error(`No RPC url provided for chainId: ${a}`);return new d$.F(new he.A(c,hR("disableProviderPing")))}}var ib=Object.defineProperty,ic=(a,b,c)=>((a,b,c)=>b in a?ib(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c)(a,"symbol"!=typeof b?b+"":b,c);class id{constructor(a){ic(this,"name","algorand"),ic(this,"client"),ic(this,"httpProviders"),ic(this,"events"),ic(this,"namespace"),ic(this,"chainId"),this.namespace=a.namespace,this.events=hR("events"),this.client=hR("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(a){this.namespace=Object.assign(this.namespace,a)}requestAccounts(){return this.getAccounts()}request(a){return this.namespace.methods.includes(a.request.method)?this.client.request(a):this.getHttpProvider().request(a.request)}setDefaultChain(a,b){if(!this.httpProviders[a]){let c=b||hI(`${this.name}:${a}`,this.namespace,this.client.core.projectId);if(!c)throw Error(`No RPC url provided for chainId: ${a}`);this.setHttpProvider(a,c)}this.chainId=a,this.events.emit(hk.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let a=this.namespace.chains[0];if(!a)throw Error("ChainId not found");return a.split(":")[1]}getAccounts(){let a=this.namespace.accounts;return a?[...new Set(a.filter(a=>a.split(":")[1]===this.chainId.toString()).map(a=>a.split(":")[2]))]:[]}createHttpProviders(){let a={};return this.namespace.chains.forEach(b=>{var c;a[b]=this.createHttpProvider(b,null==(c=this.namespace.rpcMap)?void 0:c[b])}),a}getHttpProvider(){let a=`${this.name}:${this.chainId}`,b=this.httpProviders[a];if(typeof b>"u")throw Error(`JSON-RPC provider for ${a} not found`);return b}setHttpProvider(a,b){let c=this.createHttpProvider(a,b);c&&(this.httpProviders[a]=c)}createHttpProvider(a,b){let c=b||hI(a,this.namespace,this.client.core.projectId);return typeof c>"u"?void 0:new d$.F(new he.A(c,hR("disableProviderPing")))}}var ie=Object.defineProperty,ig=(a,b,c)=>((a,b,c)=>b in a?ie(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c)(a,"symbol"!=typeof b?b+"":b,c);class ih{constructor(a){ig(this,"name","cip34"),ig(this,"client"),ig(this,"httpProviders"),ig(this,"events"),ig(this,"namespace"),ig(this,"chainId"),this.namespace=a.namespace,this.events=hR("events"),this.client=hR("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(a){this.namespace=Object.assign(this.namespace,a)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let a=this.namespace.chains[0];if(!a)throw Error("ChainId not found");return a.split(":")[1]}request(a){return this.namespace.methods.includes(a.request.method)?this.client.request(a):this.getHttpProvider().request(a.request)}setDefaultChain(a,b){this.httpProviders[a]||this.setHttpProvider(a,b),this.chainId=a,this.events.emit(hk.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){let a=this.namespace.accounts;return a?[...new Set(a.filter(a=>a.split(":")[1]===this.chainId.toString()).map(a=>a.split(":")[2]))]:[]}createHttpProviders(){let a={};return this.namespace.chains.forEach(b=>{let c=this.getCardanoRPCUrl(b),d=hJ(b);a[d]=this.createHttpProvider(d,c)}),a}getHttpProvider(){let a=`${this.name}:${this.chainId}`,b=this.httpProviders[a];if(typeof b>"u")throw Error(`JSON-RPC provider for ${a} not found`);return b}getCardanoRPCUrl(a){let b=this.namespace.rpcMap;if(b)return b[a]}setHttpProvider(a,b){let c=this.createHttpProvider(a,b);c&&(this.httpProviders[a]=c)}createHttpProvider(a,b){let c=b||this.getCardanoRPCUrl(a);if(!c)throw Error(`No RPC url provided for chainId: ${a}`);return new d$.F(new he.A(c,hR("disableProviderPing")))}}var ii=Object.defineProperty,ij=(a,b,c)=>((a,b,c)=>b in a?ii(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c)(a,"symbol"!=typeof b?b+"":b,c);class ik{constructor(a){ij(this,"name","elrond"),ij(this,"client"),ij(this,"httpProviders"),ij(this,"events"),ij(this,"namespace"),ij(this,"chainId"),this.namespace=a.namespace,this.events=hR("events"),this.client=hR("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(a){this.namespace=Object.assign(this.namespace,a)}requestAccounts(){return this.getAccounts()}request(a){return this.namespace.methods.includes(a.request.method)?this.client.request(a):this.getHttpProvider().request(a.request)}setDefaultChain(a,b){this.httpProviders[a]||this.setHttpProvider(a,b),this.chainId=a,this.events.emit(hk.DEFAULT_CHAIN_CHANGED,`${this.name}:${a}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let a=this.namespace.chains[0];if(!a)throw Error("ChainId not found");return a.split(":")[1]}getAccounts(){let a=this.namespace.accounts;return a?[...new Set(a.filter(a=>a.split(":")[1]===this.chainId.toString()).map(a=>a.split(":")[2]))]:[]}createHttpProviders(){let a={};return this.namespace.chains.forEach(b=>{var c;let d=hJ(b);a[d]=this.createHttpProvider(d,null==(c=this.namespace.rpcMap)?void 0:c[b])}),a}getHttpProvider(){let a=`${this.name}:${this.chainId}`,b=this.httpProviders[a];if(typeof b>"u")throw Error(`JSON-RPC provider for ${a} not found`);return b}setHttpProvider(a,b){let c=this.createHttpProvider(a,b);c&&(this.httpProviders[a]=c)}createHttpProvider(a,b){let c=b||hI(a,this.namespace,this.client.core.projectId);if(!c)throw Error(`No RPC url provided for chainId: ${a}`);return new d$.F(new he.A(c,hR("disableProviderPing")))}}var il=Object.defineProperty,im=(a,b,c)=>((a,b,c)=>b in a?il(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c)(a,"symbol"!=typeof b?b+"":b,c);class io{constructor(a){im(this,"name","multiversx"),im(this,"client"),im(this,"httpProviders"),im(this,"events"),im(this,"namespace"),im(this,"chainId"),this.namespace=a.namespace,this.events=hR("events"),this.client=hR("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(a){this.namespace=Object.assign(this.namespace,a)}requestAccounts(){return this.getAccounts()}request(a){return this.namespace.methods.includes(a.request.method)?this.client.request(a):this.getHttpProvider().request(a.request)}setDefaultChain(a,b){this.httpProviders[a]||this.setHttpProvider(a,b),this.chainId=a,this.events.emit(hk.DEFAULT_CHAIN_CHANGED,`${this.name}:${a}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let a=this.namespace.chains[0];if(!a)throw Error("ChainId not found");return a.split(":")[1]}getAccounts(){let a=this.namespace.accounts;return a?[...new Set(a.filter(a=>a.split(":")[1]===this.chainId.toString()).map(a=>a.split(":")[2]))]:[]}createHttpProviders(){let a={};return this.namespace.chains.forEach(b=>{var c;let d=hJ(b);a[d]=this.createHttpProvider(d,null==(c=this.namespace.rpcMap)?void 0:c[b])}),a}getHttpProvider(){let a=`${this.name}:${this.chainId}`,b=this.httpProviders[a];if(typeof b>"u")throw Error(`JSON-RPC provider for ${a} not found`);return b}setHttpProvider(a,b){let c=this.createHttpProvider(a,b);c&&(this.httpProviders[a]=c)}createHttpProvider(a,b){let c=b||hI(a,this.namespace,this.client.core.projectId);if(!c)throw Error(`No RPC url provided for chainId: ${a}`);return new d$.F(new he.A(c,hR("disableProviderPing")))}}var ip=Object.defineProperty,iq=(a,b,c)=>((a,b,c)=>b in a?ip(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c)(a,"symbol"!=typeof b?b+"":b,c);class ir{constructor(a){iq(this,"name","near"),iq(this,"client"),iq(this,"httpProviders"),iq(this,"events"),iq(this,"namespace"),iq(this,"chainId"),this.namespace=a.namespace,this.events=hR("events"),this.client=hR("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(a){this.namespace=Object.assign(this.namespace,a)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let a=this.namespace.chains[0];if(!a)throw Error("ChainId not found");return a.split(":")[1]}request(a){return this.namespace.methods.includes(a.request.method)?this.client.request(a):this.getHttpProvider().request(a.request)}setDefaultChain(a,b){if(this.chainId=a,!this.httpProviders[a]){let c=b||hI(`${this.name}:${a}`,this.namespace);if(!c)throw Error(`No RPC url provided for chainId: ${a}`);this.setHttpProvider(a,c)}this.events.emit(hk.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){let a=this.namespace.accounts;return a&&a.filter(a=>a.split(":")[1]===this.chainId.toString()).map(a=>a.split(":")[2])||[]}createHttpProviders(){let a={};return this.namespace.chains.forEach(b=>{var c;a[b]=this.createHttpProvider(b,null==(c=this.namespace.rpcMap)?void 0:c[b])}),a}getHttpProvider(){let a=`${this.name}:${this.chainId}`,b=this.httpProviders[a];if(typeof b>"u")throw Error(`JSON-RPC provider for ${a} not found`);return b}setHttpProvider(a,b){let c=this.createHttpProvider(a,b);c&&(this.httpProviders[a]=c)}createHttpProvider(a,b){let c=b||hI(a,this.namespace);return typeof c>"u"?void 0:new d$.F(new he.A(c,hR("disableProviderPing")))}}var is=Object.defineProperty,it=(a,b,c)=>((a,b,c)=>b in a?is(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c)(a,"symbol"!=typeof b?b+"":b,c);class iu{constructor(a){it(this,"name","tezos"),it(this,"client"),it(this,"httpProviders"),it(this,"events"),it(this,"namespace"),it(this,"chainId"),this.namespace=a.namespace,this.events=hR("events"),this.client=hR("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(a){this.namespace=Object.assign(this.namespace,a)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let a=this.namespace.chains[0];if(!a)throw Error("ChainId not found");return a.split(":")[1]}request(a){return this.namespace.methods.includes(a.request.method)?this.client.request(a):this.getHttpProvider().request(a.request)}setDefaultChain(a,b){if(this.chainId=a,!this.httpProviders[a]){let c=b||hI(`${this.name}:${a}`,this.namespace);if(!c)throw Error(`No RPC url provided for chainId: ${a}`);this.setHttpProvider(a,c)}this.events.emit(hk.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){let a=this.namespace.accounts;return a&&a.filter(a=>a.split(":")[1]===this.chainId.toString()).map(a=>a.split(":")[2])||[]}createHttpProviders(){let a={};return this.namespace.chains.forEach(b=>{a[b]=this.createHttpProvider(b)}),a}getHttpProvider(){let a=`${this.name}:${this.chainId}`,b=this.httpProviders[a];if(typeof b>"u")throw Error(`JSON-RPC provider for ${a} not found`);return b}setHttpProvider(a,b){let c=this.createHttpProvider(a,b);c&&(this.httpProviders[a]=c)}createHttpProvider(a,b){let c=b||hI(a,this.namespace);return typeof c>"u"?void 0:new d$.F(new he.A(c))}}var iv=Object.defineProperty,iw=(a,b,c)=>((a,b,c)=>b in a?iv(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c)(a,"symbol"!=typeof b?b+"":b,c);class ix{constructor(a){iw(this,"name",hi),iw(this,"client"),iw(this,"httpProviders"),iw(this,"events"),iw(this,"namespace"),iw(this,"chainId"),this.namespace=a.namespace,this.events=hR("events"),this.client=hR("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(a){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(a.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(a.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(a.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(a.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(a){return this.namespace.methods.includes(a.request.method)?this.client.request(a):this.getHttpProvider(a.chainId).request(a.request)}setDefaultChain(a,b){this.httpProviders[a]||this.setHttpProvider(a,b),this.chainId=a,this.events.emit(hk.DEFAULT_CHAIN_CHANGED,`${this.name}:${a}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let a=this.namespace.chains[0];if(!a)throw Error("ChainId not found");return a.split(":")[1]}getAccounts(){let a=this.namespace.accounts;return a?[...new Set(a.filter(a=>a.split(":")[1]===this.chainId.toString()).map(a=>a.split(":")[2]))]:[]}createHttpProviders(){var a,b;let c={};return null==(b=null==(a=this.namespace)?void 0:a.accounts)||b.forEach(a=>{let b=p(a);c[`${b.namespace}:${b.reference}`]=this.createHttpProvider(a)}),c}getHttpProvider(a){let b=this.httpProviders[a];if(typeof b>"u")throw Error(`JSON-RPC provider for ${a} not found`);return b}setHttpProvider(a,b){let c=this.createHttpProvider(a,b);c&&(this.httpProviders[a]=c)}createHttpProvider(a,b){let c=b||hI(a,this.namespace,this.client.core.projectId);if(!c)throw Error(`No RPC url provided for chainId: ${a}`);return new d$.F(new he.A(c,hR("disableProviderPing")))}}var iy=Object.defineProperty,iz=Object.defineProperties,iA=Object.getOwnPropertyDescriptors,iB=Object.getOwnPropertySymbols,iC=Object.prototype.hasOwnProperty,iD=Object.prototype.propertyIsEnumerable,iE=(a,b,c)=>b in a?iy(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,iF=(a,b)=>{for(var c in b||(b={}))iC.call(b,c)&&iE(a,c,b[c]);if(iB)for(var c of iB(b))iD.call(b,c)&&iE(a,c,b[c]);return a},iG=(a,b)=>iz(a,iA(b)),iH=(a,b,c)=>iE(a,"symbol"!=typeof b?b+"":b,c);class iI{constructor(a){iH(this,"client"),iH(this,"namespaces"),iH(this,"optionalNamespaces"),iH(this,"sessionProperties"),iH(this,"scopedProperties"),iH(this,"events",new(e())),iH(this,"rpcProviders",{}),iH(this,"session"),iH(this,"providerOpts"),iH(this,"logger"),iH(this,"uri"),iH(this,"disableProviderPing",!1),this.providerOpts=a,this.logger="u">typeof a?.logger&&"string"!=typeof a?.logger?a.logger:(0,dF.h6)((0,dF.iP)({level:a?.logger||hf})),this.disableProviderPing=a?.disableProviderPing||!1}static async init(a){let b=new iI(a);return await b.initialize(),b}async request(a,b,c){let[d,e]=this.validateChain(b);if(!this.session)throw Error("Please call connect() before request()");return await this.getProvider(d).request({request:iF({},a),chainId:`${d}:${e}`,topic:this.session.topic,expiry:c})}sendAsync(a,b,c,d){let e=new Date().getTime();this.request(a,c,d).then(a=>b(null,(0,d_.formatJsonRpcResult)(e,a))).catch(a=>b(a,void 0))}async enable(){if(!this.client)throw Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties}),await this.requestAccounts()}async disconnect(){var a;if(!this.session)throw Error("Please call connect() before enable()");await this.client.disconnect({topic:null==(a=this.session)?void 0:a.topic,reason:dj("USER_DISCONNECTED")}),await this.cleanup()}async connect(a){if(!this.client)throw Error("Sign Client not initialized");if(this.setNamespaces(a),await this.cleanupPendingPairings(),!a.skipPairing)return await this.pair(a.pairingTopic)}async authenticate(a,b){if(!this.client)throw Error("Sign Client not initialized");this.setNamespaces(a),await this.cleanupPendingPairings();let{uri:c,response:d}=await this.client.authenticate(a,b);c&&(this.uri=c,this.events.emit("display_uri",c));let e=await d();if(this.session=e.session,this.session){let a=hO(this.session.namespaces);this.namespaces=hL(this.namespaces,a),await this.persist("namespaces",this.namespaces),this.onConnect()}return e}on(a,b){this.events.on(a,b)}once(a,b){this.events.once(a,b)}removeListener(a,b){this.events.removeListener(a,b)}off(a,b){this.events.off(a,b)}get isWalletConnect(){return!0}async pair(a){let{uri:b,approval:c}=await this.client.connect({pairingTopic:a,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties});b&&(this.uri=b,this.events.emit("display_uri",b));let d=await c();this.session=d;let e=hO(d.namespaces);return this.namespaces=hL(this.namespaces,e),await this.persist("namespaces",this.namespaces),await this.persist("optionalNamespaces",this.optionalNamespaces),this.onConnect(),this.session}setDefaultChain(a,b){try{if(!this.session)return;let[c,d]=this.validateChain(a),e=this.getProvider(c);e.name===hi?e.setDefaultChain(`${c}:${d}`,b):e.setDefaultChain(d,b)}catch(a){if(!/Please call connect/.test(a.message))throw a}}async cleanupPendingPairings(a={}){this.logger.info("Cleaning up inactive pairings...");let b=this.client.pairing.getAll();if(dk(b)){for(let c of b)a.deletePairings?this.client.core.expirer.set(c.topic,0):await this.client.core.relayer.subscriber.unsubscribe(c.topic);this.logger.info(`Inactive pairings cleared: ${b.length}`)}}abortPairingAttempt(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}async checkStorage(){this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.session&&this.createProviders()}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){var a,b;if(this.client=this.providerOpts.client||await hd.init({core:this.providerOpts.core,logger:this.providerOpts.logger||hf,relayUrl:this.providerOpts.relayUrl||"wss://relay.walletconnect.org",projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.providerOpts.session)try{this.session=this.client.session.get(this.providerOpts.session.topic)}catch(c){throw this.logger.error("Failed to get session",c),Error(`The provided session: ${null==(b=null==(a=this.providerOpts)?void 0:a.session)?void 0:b.topic} doesn't exist in the Sign client`)}else{let a=this.client.session.getAll();this.session=a[0]}this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw Error("Sign Client not initialized");if(!this.session)throw Error("Session not initialized. Please call connect() before enable()");let a=[...new Set(Object.keys(this.session.namespaces).map(a=>dd(a)))];hS("client",this.client),hS("events",this.events),hS("disableProviderPing",this.disableProviderPing),a.forEach(a=>{if(!this.session)return;let b=function(a,b){let c=Object.keys(b.namespaces).filter(b=>b.includes(a));if(!c.length)return[];let d=[];return c.forEach(a=>{let c=b.namespaces[a].accounts;d.push(...c)}),d}(a,this.session),c=hK(b),d=iG(iF({},hL(this.namespaces,this.optionalNamespaces)[a]),{accounts:b,chains:c});switch(a){case"eip155":this.rpcProviders[a]=new h4({namespace:d});break;case"algorand":this.rpcProviders[a]=new id({namespace:d});break;case"solana":this.rpcProviders[a]=new h7({namespace:d});break;case"cosmos":this.rpcProviders[a]=new ia({namespace:d});break;case"polkadot":this.rpcProviders[a]=new hV({namespace:d});break;case"cip34":this.rpcProviders[a]=new ih({namespace:d});break;case"elrond":this.rpcProviders[a]=new ik({namespace:d});break;case"multiversx":this.rpcProviders[a]=new io({namespace:d});break;case"near":this.rpcProviders[a]=new ir({namespace:d});break;case"tezos":this.rpcProviders[a]=new iu({namespace:d});break;default:this.rpcProviders[hi]?this.rpcProviders[hi].updateNamespace(d):this.rpcProviders[hi]=new ix({namespace:d})}})}registerEventListeners(){if(typeof this.client>"u")throw Error("Sign Client is not initialized");this.client.on("session_ping",a=>{var b;let{topic:c}=a;c===(null==(b=this.session)?void 0:b.topic)&&this.events.emit("session_ping",a)}),this.client.on("session_event",a=>{var b;let{params:c,topic:d}=a;if(d!==(null==(b=this.session)?void 0:b.topic))return;let{event:e}=c;if("accountsChanged"===e.name){let a=e.data;a&&dk(a)&&this.events.emit("accountsChanged",a.map(hN))}else if("chainChanged"===e.name){let a=c.chainId,b=c.event.data,d=dd(a),e=hP(a)!==hP(b)?`${d}:${hP(b)}`:a;this.onChainChanged(e)}else this.events.emit(e.name,e.data);this.events.emit("session_event",a)}),this.client.on("session_update",({topic:a,params:b})=>{var c,d;if(a!==(null==(c=this.session)?void 0:c.topic))return;let{namespaces:e}=b,f=null==(d=this.client)?void 0:d.session.get(a);this.session=iG(iF({},f),{namespaces:e}),this.onSessionUpdate(),this.events.emit("session_update",{topic:a,params:b})}),this.client.on("session_delete",async a=>{var b;a.topic===(null==(b=this.session)?void 0:b.topic)&&(await this.cleanup(),this.events.emit("session_delete",a),this.events.emit("disconnect",iG(iF({},dj("USER_DISCONNECTED")),{data:a.topic})))}),this.on(hk.DEFAULT_CHAIN_CHANGED,a=>{this.onChainChanged(a,!0)})}getProvider(a){return this.rpcProviders[a]||this.rpcProviders[hi]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(a=>{var b;this.getProvider(a).updateNamespace(null==(b=this.session)?void 0:b.namespaces[a])})}setNamespaces(a){let{namespaces:b={},optionalNamespaces:c={},sessionProperties:d,scopedProperties:e}=a;this.optionalNamespaces=hL(b,c),this.sessionProperties=d,this.scopedProperties=e}validateChain(a){let[b,c]=a?.split(":")||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[b,c];if(b&&!Object.keys(this.namespaces||{}).map(a=>dd(a)).includes(b))throw Error(`Namespace '${b}' is not configured. Please call connect() first with namespace config.`);if(b&&c)return[b,c];let d=dd(Object.keys(this.namespaces)[0]),e=this.rpcProviders[d].getDefaultChain();return[d,e]}async requestAccounts(){let[a]=this.validateChain();return await this.getProvider(a).requestAccounts()}async onChainChanged(a,b=!1){if(!this.namespaces)return;let[c,d]=this.validateChain(a);if(!d)return;this.updateNamespaceChain(c,d),this.events.emit("chainChanged",d);let e=this.getProvider(c).getDefaultChain();b||this.getProvider(c).setDefaultChain(d),this.emitAccountsChangedOnChainChange({namespace:c,previousChainId:e,newChainId:a}),await this.persist("namespaces",this.namespaces)}emitAccountsChangedOnChainChange({namespace:a,previousChainId:b,newChainId:c}){var d,e;try{if(b===c)return;let f=null==(e=null==(d=this.session)?void 0:d.namespaces[a])?void 0:e.accounts;if(!f)return;let g=f.filter(a=>a.includes(`${c}:`)).map(hN);if(!dk(g))return;this.events.emit("accountsChanged",g)}catch(a){this.logger.warn("Failed to emit accountsChanged on chain change",a)}}updateNamespaceChain(a,b){if(!this.namespaces)return;let c=this.namespaces[a]?a:`${a}:${b}`;this.namespaces[c]?this.namespaces[c]&&(this.namespaces[c].defaultChain=b):this.namespaces[c]={chains:[],methods:[],events:[],defaultChain:b}}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,await this.deleteFromStore("namespaces"),await this.deleteFromStore("optionalNamespaces"),await this.deleteFromStore("sessionProperties"),this.session=void 0,await this.cleanupPendingPairings({deletePairings:!0}),await this.cleanupStorage()}async persist(a,b){var c;let d=(null==(c=this.session)?void 0:c.topic)||"";await this.client.core.storage.setItem(`${hg}/${a}${d}`,b)}async getFromStore(a){var b;let c=(null==(b=this.session)?void 0:b.topic)||"";return await this.client.core.storage.getItem(`${hg}/${a}${c}`)}async deleteFromStore(a){var b;let c=(null==(b=this.session)?void 0:b.topic)||"";await this.client.core.storage.removeItem(`${hg}/${a}${c}`)}async cleanupStorage(){var a;try{if((null==(a=this.client)?void 0:a.session.length)>0)return;for(let a of(await this.client.core.storage.getKeys()))a.startsWith(hg)&&await this.client.core.storage.removeItem(a)}catch(a){this.logger.warn("Failed to cleanup storage",a)}}}let iJ=["eth_sendTransaction","personal_sign"],iK=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_sendCalls","wallet_getCapabilities","wallet_getCallsStatus","wallet_showCallsStatus"],iL=["chainChanged","accountsChanged"],iM=["chainChanged","accountsChanged","message","disconnect","connect"],iN=async()=>{let{createAppKit:a}=await c.e(7614).then(c.bind(c,87614));return a};var iO=Object.defineProperty,iP=Object.defineProperties,iQ=Object.getOwnPropertyDescriptors,iR=Object.getOwnPropertySymbols,iS=Object.prototype.hasOwnProperty,iT=Object.prototype.propertyIsEnumerable,iU=(a,b,c)=>b in a?iO(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,iV=(a,b)=>{for(var c in b||(b={}))iS.call(b,c)&&iU(a,c,b[c]);if(iR)for(var c of iR(b))iT.call(b,c)&&iU(a,c,b[c]);return a},iW=(a,b)=>iP(a,iQ(b)),iX=(a,b,c)=>iU(a,"symbol"!=typeof b?b+"":b,c);function iY(a){return Number(a[0].split(":")[1])}function iZ(a){return`0x${a.toString(16)}`}class i${constructor(){iX(this,"events",new d.EventEmitter),iX(this,"namespace","eip155"),iX(this,"accounts",[]),iX(this,"signer"),iX(this,"chainId",1),iX(this,"modal"),iX(this,"rpc"),iX(this,"STORAGE_KEY","wc@2:ethereum_provider:"),iX(this,"on",(a,b)=>(this.events.on(a,b),this)),iX(this,"once",(a,b)=>(this.events.once(a,b),this)),iX(this,"removeListener",(a,b)=>(this.events.removeListener(a,b),this)),iX(this,"off",(a,b)=>(this.events.off(a,b),this)),iX(this,"parseAccount",a=>this.isCompatibleChainId(a)?this.parseAccountId(a).address:a),this.signer={},this.rpc={}}static async init(a){let b=new i$;return await b.initialize(a),b}async request(a,b){return await this.signer.request(a,this.formatChainId(this.chainId),b)}sendAsync(a,b,c){this.signer.sendAsync(a,b,this.formatChainId(this.chainId),c)}get connected(){return!!this.signer.client&&this.signer.client.core.relayer.connected}get connecting(){return!!this.signer.client&&this.signer.client.core.relayer.connecting}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(a){var b;if(!this.signer.client)throw Error("Provider not initialized. Call init() first");this.loadConnectOpts(a);let{required:c,optional:d}=function(a){let{chains:b,optionalChains:c,methods:d,optionalMethods:e,events:f,optionalEvents:g,rpcMap:h}=a;if(!dk(b))throw Error("Invalid chains");let i={chains:b,methods:d||iJ,events:f||iL,rpcMap:iV({},b.length?{[iY(b)]:h[iY(b)]}:{})},j=f?.filter(a=>!iL.includes(a)),k=d?.filter(a=>!iJ.includes(a));if(!c&&!g&&!e&&!(null!=j&&j.length)&&!(null!=k&&k.length))return{required:b.length?i:void 0};let l={chains:[...new Set(j?.length&&k?.length||!c?i.chains.concat(c||[]):c)],methods:[...new Set(i.methods.concat(null!=e&&e.length?e:iK))],events:[...new Set(i.events.concat(null!=g&&g.length?g:iM))],rpcMap:h};return{required:b.length?i:void 0,optional:c.length?l:void 0}}(this.rpc);try{let b=await new Promise(async(b,e)=>{var f,g;this.rpc.showQrModal&&(null==(f=this.modal)||f.open(),null==(g=this.modal)||g.subscribeState(a=>{a.open||this.signer.session||(this.signer.abortPairingAttempt(),e(Error("Connection request reset. Please try again.")))}));let h=null!=a&&a.scopedProperties?{[this.namespace]:a.scopedProperties}:void 0;await this.signer.connect(iW(iV({namespaces:iV({},c&&{[this.namespace]:c})},d&&{optionalNamespaces:{[this.namespace]:d}}),{pairingTopic:a?.pairingTopic,scopedProperties:h})).then(a=>{b(a)}).catch(a=>{var b;null==(b=this.modal)||b.showErrorMessage("Unable to connect"),e(Error(a.message))})});if(!b)return;let e=q(b.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:e),this.setAccounts(e),this.events.emit("connect",{chainId:iZ(this.chainId)})}catch(a){throw this.signer.logger.error(a),a}finally{null==(b=this.modal)||b.close()}}async authenticate(a,b){var c;if(!this.signer.client)throw Error("Provider not initialized. Call init() first");this.loadConnectOpts({chains:a?.chains});try{let c=await new Promise(async(c,d)=>{var e,f;this.rpc.showQrModal&&(null==(e=this.modal)||e.open(),null==(f=this.modal)||f.subscribeState(a=>{a.open||this.signer.session||(this.signer.abortPairingAttempt(),d(Error("Connection request reset. Please try again.")))})),await this.signer.authenticate(iW(iV({},a),{chains:this.rpc.chains}),b).then(a=>{c(a)}).catch(a=>{var b;null==(b=this.modal)||b.showErrorMessage("Unable to connect"),d(Error(a.message))})}),d=c.session;if(d){let a=q(d.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:a),this.setAccounts(a),this.events.emit("connect",{chainId:iZ(this.chainId)})}return c}catch(a){throw this.signer.logger.error(a),a}finally{null==(c=this.modal)||c.close()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",a=>{let{params:b}=a,{event:c}=b;"accountsChanged"===c.name?(this.accounts=this.parseAccounts(c.data),this.events.emit("accountsChanged",this.accounts)):"chainChanged"===c.name?this.setChainId(this.formatChainId(c.data)):this.events.emit(c.name,c.data),this.events.emit("session_event",a)}),this.signer.on("accountsChanged",a=>{this.accounts=this.parseAccounts(a),this.events.emit("accountsChanged",this.accounts)}),this.signer.on("chainChanged",a=>{let b=parseInt(a);this.chainId=b,this.events.emit("chainChanged",iZ(this.chainId)),this.persist()}),this.signer.on("session_update",a=>{this.events.emit("session_update",a)}),this.signer.on("session_delete",a=>{this.reset(),this.events.emit("session_delete",a),this.events.emit("disconnect",iW(iV({},dj("USER_DISCONNECTED")),{data:a.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",a=>{this.events.emit("display_uri",a)})}switchEthereumChain(a){this.request({method:"wallet_switchEthereumChain",params:[{chainId:a.toString(16)}]})}isCompatibleChainId(a){return"string"==typeof a&&a.startsWith(`${this.namespace}:`)}formatChainId(a){return`${this.namespace}:${a}`}parseChainId(a){return Number(a.split(":")[1])}setChainIds(a){let b=a.filter(a=>this.isCompatibleChainId(a)).map(a=>this.parseChainId(a));b.length&&(this.chainId=b[0],this.events.emit("chainChanged",iZ(this.chainId)),this.persist())}setChainId(a){if(this.isCompatibleChainId(a)){let b=this.parseChainId(a);this.chainId=b,this.switchEthereumChain(b)}}parseAccountId(a){let[b,c,d]=a.split(":");return{chainId:`${b}:${c}`,address:d}}setAccounts(a){this.accounts=a.filter(a=>this.parseChainId(this.parseAccountId(a).chainId)===this.chainId).map(a=>this.parseAccountId(a).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(a){var b,c;let d=null!=(b=a?.chains)?b:[],e=null!=(c=a?.optionalChains)?c:[],f=d.concat(e);if(!f.length)throw Error("No chains specified in either `chains` or `optionalChains`");let g=d.length?a?.methods||iJ:[],h=d.length?a?.events||iL:[],i=a?.optionalMethods||[],j=a?.optionalEvents||[],k=a?.rpcMap||this.buildRpcMap(f,a.projectId),l=a?.qrModalOptions||void 0;return{chains:d?.map(a=>this.formatChainId(a)),optionalChains:e.map(a=>this.formatChainId(a)),methods:g,events:h,optionalMethods:i,optionalEvents:j,rpcMap:k,showQrModal:!!(null!=a&&a.showQrModal),qrModalOptions:l,projectId:a.projectId,metadata:a.metadata}}buildRpcMap(a,b){let c={};return a.forEach(a=>{c[a]=this.getRpcUrl(a,b)}),c}async initialize(a){if(this.rpc=this.getRpcConfig(a),this.chainId=this.rpc.chains.length?iY(this.rpc.chains):iY(this.rpc.optionalChains),this.signer=await iI.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:a.disableProviderPing,relayUrl:a.relayUrl,storage:a.storage,storageOptions:a.storageOptions,customStoragePrefix:a.customStoragePrefix,telemetryEnabled:a.telemetryEnabled,logger:a.logger}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let a;try{let b=await iN(),{convertWCMToAppKitOptions:c}=await Promise.resolve().then(function(){return ja}),d=c(iW(iV({},this.rpc.qrModalOptions),{chains:[...new Set([...this.rpc.chains,...this.rpc.optionalChains])],metadata:this.rpc.metadata,projectId:this.rpc.projectId}));if(!d.networks.length)throw Error("No networks found for WalletConnect\xb7");a=b(iW(iV({},d),{universalProvider:this.signer,manualWCControl:!0}))}catch(a){throw console.warn(a),Error("To use QR modal, please install @reown/appkit package")}if(a)try{this.modal=a}catch(a){throw this.signer.logger.error(a),Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(a){if(!a)return;let{chains:b,optionalChains:c,rpcMap:d}=a;b&&dk(b)&&(this.rpc.chains=b.map(a=>this.formatChainId(a)),b.forEach(a=>{this.rpc.rpcMap[a]=d?.[a]||this.getRpcUrl(a)})),c&&dk(c)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=c?.map(a=>this.formatChainId(a)),c.forEach(a=>{this.rpc.rpcMap[a]=d?.[a]||this.getRpcUrl(a)}))}getRpcUrl(a,b){var c;return(null==(c=this.rpc.rpcMap)?void 0:c[a])||`https://rpc.walletconnect.org/v1/?chainId=eip155:${a}&projectId=${b||this.rpc.projectId}`}async loadPersistedSession(){if(this.session)try{let a=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),b=this.session.namespaces[`${this.namespace}:${a}`]?this.session.namespaces[`${this.namespace}:${a}`]:this.session.namespaces[this.namespace];this.setChainIds(a?[this.formatChainId(a)]:b?.accounts),this.setAccounts(b?.accounts)}catch(a){this.signer.logger.error("Failed to load persisted session, clearing state..."),this.signer.logger.error(a),await this.disconnect().catch(a=>this.signer.logger.warn(a))}}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(a){return"string"==typeof a||a instanceof String?[this.parseAccount(a)]:a.map(a=>this.parseAccount(a))}}let i_=i$;var i0=Object.defineProperty,i1=Object.defineProperties,i2=Object.getOwnPropertyDescriptors,i3=Object.getOwnPropertySymbols,i4=Object.prototype.hasOwnProperty,i5=Object.prototype.propertyIsEnumerable,i6=(a,b,c)=>b in a?i0(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,i7=(a,b)=>{for(var c in b||(b={}))i4.call(b,c)&&i6(a,c,b[c]);if(i3)for(var c of i3(b))i5.call(b,c)&&i6(a,c,b[c]);return a};let i8=a=>{let[b,c]=a.split(":");return i9({id:c,caipNetworkId:a,chainNamespace:b,name:"",nativeCurrency:{name:"",symbol:"",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}}})};function i9(a){return i7({formatters:void 0,fees:void 0,serializers:void 0},a)}var ja=Object.freeze({__proto__:null,convertWCMToAppKitOptions:function(a){var b,c,d,e,f,g,h;let i=null==(b=a.chains)?void 0:b.map(i8).filter(Boolean);if(0===i.length)throw Error("At least one chain must be specified");let j=i.find(b=>{var c;return b.id===(null==(c=a.defaultChain)?void 0:c.id)}),k={projectId:a.projectId,networks:i,themeMode:a.themeMode,themeVariables:function(a){if(a)return{"--w3m-font-family":a["--wcm-font-family"],"--w3m-accent":a["--wcm-accent-color"],"--w3m-color-mix":a["--wcm-background-color"],"--w3m-z-index":a["--wcm-z-index"]?Number(a["--wcm-z-index"]):void 0,"--w3m-qr-color":a["--wcm-accent-color"],"--w3m-font-size-master":a["--wcm-text-medium-regular-size"],"--w3m-border-radius-master":a["--wcm-container-border-radius"],"--w3m-color-mix-strength":0}}(a.themeVariables),chainImages:a.chainImages,connectorImages:a.walletImages,defaultNetwork:j,metadata:i1(i7({},a.metadata),i2({name:(null==(c=a.metadata)?void 0:c.name)||"WalletConnect",description:(null==(d=a.metadata)?void 0:d.description)||"Connect to WalletConnect-compatible wallets",url:(null==(e=a.metadata)?void 0:e.url)||"https://walletconnect.org",icons:(null==(f=a.metadata)?void 0:f.icons)||["https://walletconnect.org/walletconnect-logo.png"]})),showWallets:!0,featuredWalletIds:"NONE"===a.explorerRecommendedWalletIds?[]:Array.isArray(a.explorerRecommendedWalletIds)?a.explorerRecommendedWalletIds:[],excludeWalletIds:"ALL"===a.explorerExcludedWalletIds?[]:Array.isArray(a.explorerExcludedWalletIds)?a.explorerExcludedWalletIds:[],enableEIP6963:!1,enableInjected:!1,enableCoinbase:!0,enableWalletConnect:!0,features:{email:!1,socials:!1}};if(null!=(g=a.mobileWallets)&&g.length||null!=(h=a.desktopWallets)&&h.length){let b=[...(a.mobileWallets||[]).map(a=>({id:a.id,name:a.name,links:a.links})),...(a.desktopWallets||[]).map(a=>({id:a.id,name:a.name,links:{native:a.links.native,universal:a.links.universal}}))],c=[...k.featuredWalletIds||[],...k.excludeWalletIds||[]],d=b.filter(a=>!c.includes(a.id));d.length&&(k.customWallets=d)}return k},defineChain:i9})},89158:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0});var c=Function.prototype.toString,d=Object.create,e=Object.prototype.toString,f=function(){function a(){this._keys=[],this._values=[]}return a.prototype.has=function(a){return!!~this._keys.indexOf(a)},a.prototype.get=function(a){return this._values[this._keys.indexOf(a)]},a.prototype.set=function(a,b){this._keys.push(a),this._values.push(b)},a}(),g="undefined"!=typeof WeakMap?function(){return new WeakMap}:function(){return new f};function h(a){if(!a)return d(null);var b=a.constructor;if(b===Object)return a===Object.prototype?{}:d(a);if(b&&~c.call(b).indexOf("[native code]"))try{return new b}catch(a){}return d(a)}var i="g"===/test/g.flags?function(a){return a.flags}:function(a){var b="";return a.global&&(b+="g"),a.ignoreCase&&(b+="i"),a.multiline&&(b+="m"),a.unicode&&(b+="u"),a.sticky&&(b+="y"),b};function j(a){var b=e.call(a);return b.substring(8,b.length-1)}var k="undefined"!=typeof Symbol?function(a){return a[Symbol.toStringTag]||j(a)}:j,l=Object.defineProperty,m=Object.getOwnPropertyDescriptor,o=Object.getOwnPropertyNames,p=Object.getOwnPropertySymbols,q=Object.prototype,r=q.hasOwnProperty,s=q.propertyIsEnumerable,t="function"==typeof p,u=t?function(a){return o(a).concat(p(a))}:o;function v(a,b,c){for(var d=u(a),e=0,f=d.length,g=void 0,h=void 0;e<f;++e)if("callee"!==(g=d[e])&&"caller"!==g){if(!(h=m(a,g))){b[g]=c.copier(a[g],c);continue}h.get||h.set||(h.value=c.copier(h.value,c));try{l(b,g,h)}catch(a){b[g]=h.value}}return b}function w(a,b){return a.slice(0)}function x(a,b){var c=new b.Constructor;return b.cache.set(a,c),a.forEach(function(a,d){c.set(d,b.copier(a,b))}),c}function y(a,b){return new b.Constructor(a.valueOf())}function z(a,b){return a}function A(a,b){var c=new b.Constructor;return b.cache.set(a,c),a.forEach(function(a){c.add(b.copier(a,b))}),c}var B=Array.isArray,C=Object.assign,D=Object.getPrototypeOf||function(a){return a.__proto__},E={array:function(a,b){var c=new b.Constructor;b.cache.set(a,c);for(var d=0,e=a.length;d<e;++d)c[d]=b.copier(a[d],b);return c},arrayBuffer:w,blob:function(a,b){return a.slice(0,a.size,a.type)},dataView:function(a,b){return new b.Constructor(w(a.buffer))},date:function(a,b){return new b.Constructor(a.getTime())},error:z,map:x,object:t?function(a,b){var c=h(b.prototype);for(var d in b.cache.set(a,c),a)r.call(a,d)&&(c[d]=b.copier(a[d],b));for(var e=p(a),f=0,g=e.length,i=void 0;f<g;++f)i=e[f],s.call(a,i)&&(c[i]=b.copier(a[i],b));return c}:function(a,b){var c=h(b.prototype);for(var d in b.cache.set(a,c),a)r.call(a,d)&&(c[d]=b.copier(a[d],b));return c},regExp:function(a,b){var c=new b.Constructor(a.source,i(a));return c.lastIndex=a.lastIndex,c},set:A},F=C({},E,{array:function(a,b){var c=new b.Constructor;return b.cache.set(a,c),v(a,c,b)},map:function(a,b){return v(a,x(a,b),b)},object:function(a,b){var c=h(b.prototype);return b.cache.set(a,c),v(a,c,b)},set:function(a,b){return v(a,A(a,b),b)}});function G(a){var b,c={Arguments:(b=C({},E,a)).object,Array:b.array,ArrayBuffer:b.arrayBuffer,Blob:b.blob,Boolean:y,DataView:b.dataView,Date:b.date,Error:b.error,Float32Array:b.arrayBuffer,Float64Array:b.arrayBuffer,Int8Array:b.arrayBuffer,Int16Array:b.arrayBuffer,Int32Array:b.arrayBuffer,Map:b.map,Number:y,Object:b.object,Promise:z,RegExp:b.regExp,Set:b.set,String:y,WeakMap:z,WeakSet:z,Uint8Array:b.arrayBuffer,Uint8ClampedArray:b.arrayBuffer,Uint16Array:b.arrayBuffer,Uint32Array:b.arrayBuffer,Uint64Array:b.arrayBuffer},d=c.Array,e=c.Object;function f(a,b){if(b.prototype=b.Constructor=void 0,!a||"object"!=typeof a)return a;if(b.cache.has(a))return b.cache.get(a);if(b.prototype=D(a),b.Constructor=b.prototype&&b.prototype.constructor,!b.Constructor||b.Constructor===Object)return e(a,b);if(B(a))return d(a,b);var f=c[k(a)];return f?f(a,b):"function"==typeof a.then?a:e(a,b)}return function(a){return f(a,{Constructor:void 0,cache:g(),copier:f,prototype:void 0})}}function H(a){return G(C({},F,a))}var I=H({}),J=G({});b.copyStrict=I,b.createCopier=G,b.createStrictCopier=H,b.default=J},89223:(a,b,c)=>{"use strict";let{Duplex:d}=c(27910);function e(a){a.emit("close")}function f(){!this.destroyed&&this._writableState.finished&&this.destroy()}function g(a){this.removeListener("error",g),this.destroy(),0===this.listenerCount("error")&&this.emit("error",a)}a.exports=function(a,b){let c=!0,h=!0;function i(){c&&a._socket.resume()}a.readyState===a.CONNECTING?a.once("open",function(){a._receiver.removeAllListeners("drain"),a._receiver.on("drain",i)}):(a._receiver.removeAllListeners("drain"),a._receiver.on("drain",i));let j=new d({...b,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return a.on("message",function(b){j.push(b)||(c=!1,a._socket.pause())}),a.once("error",function(a){j.destroyed||(h=!1,j.destroy(a))}),a.once("close",function(){j.destroyed||j.push(null)}),j._destroy=function(b,c){if(a.readyState===a.CLOSED){c(b),process.nextTick(e,j);return}let d=!1;a.once("error",function(a){d=!0,c(a)}),a.once("close",function(){d||c(b),process.nextTick(e,j)}),h&&a.terminate()},j._final=function(b){if(a.readyState===a.CONNECTING)return void a.once("open",function(){j._final(b)});null!==a._socket&&(a._socket._writableState.finished?(b(),j._readableState.endEmitted&&j.destroy()):(a._socket.once("finish",function(){b()}),a.close()))},j._read=function(){(a.readyState===a.OPEN||a.readyState===a.CLOSING)&&!c&&(c=!0,a._receiver._writableState.needDrain||a._socket.resume())},j._write=function(b,c,d){if(a.readyState===a.CONNECTING)return void a.once("open",function(){j._write(b,c,d)});a.send(b,d)},j.on("end",f),j.on("error",g),j}},91466:a=>{"use strict";function b(a,b){return null!=a&&("hasOwn"in Object?Object.hasOwn(a,b):Object.prototype.hasOwnProperty.call(a,b))}function c(a,b){for(var c=-1,d=b.length,e=a;null!=e&&++c<d;)e=e[b[c]];return e}function d(a,b,c){if(a.depth===c)return d(a.parent,b,c);var e={parent:a,key:b,depth:c,children:[]};return a.children.push(e),e}function e(a,b,c){let d=a,e=[];do e.push(d.key),d=d.parent;while(null!=d.parent);return{path:e,value:b,target:c}}a.exports={groupRedact:function(a,b,d,e,f){let g=c(a,b);if(null==g||"string"==typeof g)return{keys:null,values:null,target:g,flat:!0};let h=Object.keys(g),i=h.length,j=b.length,k=f?[...b]:void 0,l=Array(i);for(var m=0;m<i;m++){let a=h[m];l[m]=g[a],f?(k[j]=a,g[a]=d(g[a],k)):e?g[a]=d(g[a]):g[a]=d}return{keys:h,values:l,target:g,flat:!0}},groupRestore:function({keys:a,values:b,target:c}){if(null==c||"string"==typeof c)return;let d=a.length;for(var e=0;e<d;e++)c[a[e]]=b[e]},nestedRedact:function(a,f,g,h,i,j,k){let l=c(f,g);if(null==l)return;let m=Object.keys(l),o=m.length;for(var p=0;p<o;p++)!function(a,c,f,g,h,i,j,k){let l=h.length,m=l-1,o=f;var p,q,r,s,t,u=-1,v=null,w=!1,x=0,y={parent:null,key:null,children:[],depth:0};if(r=p=c[f],"object"==typeof p){for(;null!=p&&++u<l&&(x+=1,f=h[u],"*"===f||v||"object"==typeof p&&f in p);)if("*"!==f||("*"===v&&(w=!0),v=f,u===m)){if(v){let l=Object.keys(p);for(var z=0;z<l.length;z++){let v=l[z];if(t=p[v],s="*"===f,w)y=d(y,v,x),r=function a(c,f,g,h,i,j,k,l,m,o,p,q,r,s,t,u,v,w,x,y){if(0===f&&(r||"object"==typeof c&&null!==c&&g in c))if(q=r?c:c[g],p=t!==u?q:k?l?j(q,[...h,m,...i]):j(q):j,r){let a=e(v,q,x);w.push(a),o[s]=p}else if(c[g]===p);else if(void 0===p&&void 0!==j||b(c,g)&&p===q);else{let a=e(d(v,g,y+1),q,x);w.push(a),c[g]=p}for(let b in c)"object"==typeof c[b]&&(v=d(v,b,y),a(c[b],f-1,g,h,i,j,k,l,m,o,p,q,r,s,t,u,v,w,x,y+1))}(t,u-1,f,g,h,i,j,k,o,p,q,r,s,v,u,m,y,a,c[o],x+1);else if(s||"object"==typeof t&&null!==t&&f in t)if(r=s?t:t[f],q=u!==m?r:j?k?i(r,[...g,o,...h]):i(r):i,s){let b=e(d(y,v,x),r,c[o]);a.push(b),p[v]=q}else if(t[f]===q);else if(void 0===q&&void 0!==i||b(t,f)&&q===r)y=d(y,v,x);else{y=d(y,v,x);let b=e(d(y,f,x+1),r,c[o]);a.push(b),t[f]=q}}v=null}else{if(r=p[f],y=d(y,f,x),q=u!==m?r:j?k?i(r,[...g,o,...h]):i(r):i,b(p,f)&&q===r||void 0===q&&void 0!==i);else{let b=e(y,r,c[o]);a.push(b),p[f]=q}p=p[f]}if("object"!=typeof p)break}}}(a,l,m[p],g,h,i,j,k);return a},nestedRestore:function(a){for(let b=0;b<a.length;b++){let{target:c,path:d,value:e}=a[b],f=c;for(let a=d.length-1;a>0;a--)f=f[d[a]];f[d[0]]=e}}}},92166:(a,b,c)=>{"use strict";let d=c(61864);a.exports=function({secret:a,serialize:b,wcLen:c,strict:e,isCensorFct:f,censorFctTakesPath:g},h){var i,j,k,l,m,o,p,q;let r=Function("o",`
    if (typeof o !== 'object' || o == null) {
      ${(i=e,j=b,!0===i?"throw Error('fast-redact: primitives cannot be redacted')":!1===j?"return o":"return this.serialize(o)")}
    }
    const { censor, secret } = this
    const originalSecret = {}
    const secretKeys = Object.keys(secret)
    for (var i = 0; i < secretKeys.length; i++) {
      originalSecret[secretKeys[i]] = secret[secretKeys[i]]
    }

    ${(k=a,l=f,m=g,Object.keys(k).map(a=>{let{escPath:b,leadingBracket:c,path:e}=k[a],f=+!!c,g=c?"":".",h=[];for(;null!==(i=d.exec(a));){let[,a]=i,{index:b,input:c}=i;b>f&&h.push(c.substring(0,b-!a))}var i,j=h.map(a=>`o${g}${a}`).join(" && ");0===j.length?j+=`o${g}${a} != null`:j+=` && o${g}${a} != null`;let o=`
      switch (true) {
        ${h.reverse().map(a=>`
          case o${g}${a} === censor:
            secret[${b}].circle = ${JSON.stringify(a)}
            break
        `).join("\n")}
      }
    `,p=m?`val, ${JSON.stringify(e)}`:"val";return`
      if (${j}) {
        const val = o${g}${a}
        if (val === censor) {
          secret[${b}].precensored = true
        } else {
          secret[${b}].val = val
          o${g}${a} = ${l?`censor(${p})`:"censor"}
          ${o}
        }
      }
    `}).join("\n"))}
    this.compileRestore()
    ${(o=c>0,p=f,q=g,!0===o?`
    {
      const { wildcards, wcLen, groupRedact, nestedRedact } = this
      for (var i = 0; i < wcLen; i++) {
        const { before, beforeStr, after, nested } = wildcards[i]
        if (nested === true) {
          secret[beforeStr] = secret[beforeStr] || []
          nestedRedact(secret[beforeStr], o, before, after, censor, ${p}, ${q})
        } else secret[beforeStr] = groupRedact(o, before, censor, ${p}, ${q})
      }
    }
  `:"")}
    this.secret = originalSecret
    ${!1===b?"return o":`
    var s = this.serialize(o)
    this.restore(o)
    return s
  `}
  `).bind(h);return r.state=h,!1===b&&(r.restore=a=>h.restore(a)),r}},92887:(a,b,c)=>{"use strict";a.exports=function({log:a,context:b}){let{ignoreKeys:c,includeKeys:d}=b,g=e(a);if(d){let a={};return d.forEach(b=>{a[b]=g[b]}),a}return c.forEach(a=>{f(g,a)}),g};let{createCopier:d}=c(89158),e=d({}),f=c(69866)},93700:(a,b,c)=>{var d=c(68316);function e(a){var b=function(){return b.called?b.value:(b.called=!0,b.value=a.apply(this,arguments))};return b.called=!1,b}function f(a){var b=function(){if(b.called)throw Error(b.onceError);return b.called=!0,b.value=a.apply(this,arguments)};return b.onceError=(a.name||"Function wrapped with `once`")+" shouldn't be called more than once",b.called=!1,b}a.exports=d(e),a.exports.strict=d(f),e.proto=e(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return e(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return f(this)},configurable:!0})})},94965:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0});let d=c(40671);d.__exportStar(c(18947),b),d.__exportStar(c(15050),b),d.__exportStar(c(82839),b),d.__exportStar(c(15975),b)},95649:(a,b,c)=>{"use strict";c.d(b,{F:()=>f});var d=c(94735),e=c(44566);class f extends e.IJsonRpcProvider{constructor(a){super(a),this.events=new d.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(a),this.connection.connected&&this.registerEventListeners()}async connect(a=this.connection){await this.open(a)}async disconnect(){await this.close()}on(a,b){this.events.on(a,b)}once(a,b){this.events.once(a,b)}off(a,b){this.events.off(a,b)}removeListener(a,b){this.events.removeListener(a,b)}async request(a,b){return this.requestStrict((0,e.formatJsonRpcRequest)(a.method,a.params||[],a.id||(0,e.getBigIntRpcId)().toString()),b)}async requestStrict(a,b){return new Promise(async(c,d)=>{if(!this.connection.connected)try{await this.open()}catch(a){d(a)}this.events.on(`${a.id}`,a=>{(0,e.isJsonRpcError)(a)?d(a.error):c(a.result)});try{await this.connection.send(a,b)}catch(a){d(a)}})}setConnection(a=this.connection){return a}onPayload(a){this.events.emit("payload",a),(0,e.isJsonRpcResponse)(a)?this.events.emit(`${a.id}`,a):this.events.emit("message",{type:a.method,data:a.params})}onClose(a){a&&3e3===a.code&&this.events.emit("error",Error(`WebSocket connection closed abnormally with code: ${a.code} ${a.reason?`(${a.reason})`:""}`)),this.events.emit("disconnect")}async open(a=this.connection){this.connection===a&&this.connection.connected||(this.connection.connected&&this.close(),"string"==typeof a&&(await this.connection.open(a),a=this.connection),this.connection=this.setConnection(a),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",a=>this.onPayload(a)),this.connection.on("close",a=>this.onClose(a)),this.connection.on("error",a=>this.events.emit("error",a)),this.connection.on("register_error",a=>this.onClose()),this.hasRegisteredEventListeners=!0)}}},96921:(a,b,c)=>{"use strict";c.d(b,{x:()=>X});let d="2.23.2",e={getDocsUrl:({docsBaseUrl:a,docsPath:b="",docsSlug:c})=>b?`${a??"https://viem.sh"}${b}${c?`#${c}`:""}`:void 0,version:`viem@${d}`};class f extends Error{constructor(a,b={}){let c=b.cause instanceof f?b.cause.details:b.cause?.message?b.cause.message:b.details,g=b.cause instanceof f&&b.cause.docsPath||b.docsPath,h=e.getDocsUrl?.({...b,docsPath:g});super([a||"An error occurred.","",...b.metaMessages?[...b.metaMessages,""]:[],...h?[`Docs: ${h}`]:[],...c?[`Details: ${c}`]:[],...e.version?[`Version: ${e.version}`]:[]].join("\n"),b.cause?{cause:b.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=c,this.docsPath=g,this.metaMessages=b.metaMessages,this.name=b.name??this.name,this.shortMessage=a,this.version=d}walk(a){return function a(b,c){return c?.(b)?b:b&&"object"==typeof b&&"cause"in b&&void 0!==b.cause?a(b.cause,c):c?null:b}(this,a)}}function g(a,{strict:b=!0}={}){return!!a&&"string"==typeof a&&(b?/^0x[0-9a-fA-F]*$/.test(a):a.startsWith("0x"))}class h extends f{constructor({size:a,targetSize:b,type:c}){super(`${c.charAt(0).toUpperCase()}${c.slice(1).toLowerCase()} size (${a}) exceeds padding size (${b}).`,{name:"SizeExceedsPaddingSizeError"})}}function i(a,{dir:b,size:c=32}={}){return"string"==typeof a?function(a,{dir:b,size:c=32}={}){if(null===c)return a;let d=a.replace("0x","");if(d.length>2*c)throw new h({size:Math.ceil(d.length/2),targetSize:c,type:"hex"});return`0x${d["right"===b?"padEnd":"padStart"](2*c,"0")}`}(a,{dir:b,size:c}):function(a,{dir:b,size:c=32}={}){if(null===c)return a;if(a.length>c)throw new h({size:a.length,targetSize:c,type:"bytes"});let d=new Uint8Array(c);for(let e=0;e<c;e++){let f="right"===b;d[f?e:c-e-1]=a[f?e:a.length-e-1]}return d}(a,{dir:b,size:c})}class j extends f{constructor({max:a,min:b,signed:c,size:d,value:e}){super(`Number "${e}" is not in safe ${d?`${8*d}-bit ${c?"signed":"unsigned"} `:""}integer range ${a?`(${b} to ${a})`:`(above ${b})`}`,{name:"IntegerOutOfRangeError"})}}class k extends f{constructor({givenSize:a,maxSize:b}){super(`Size cannot exceed ${b} bytes. Given size: ${a} bytes.`,{name:"SizeOverflowError"})}}function l(a){return g(a,{strict:!1})?Math.ceil((a.length-2)/2):a.length}function m(a,{size:b}){if(l(a)>b)throw new k({givenSize:l(a),maxSize:b})}function o(a,b={}){let{signed:c}=b;b.size&&m(a,{size:b.size});let d=BigInt(a);if(!c)return d;let e=(a.length-2)/2;return d<=(1n<<8n*BigInt(e)-1n)-1n?d:d-BigInt(`0x${"f".padStart(2*e,"f")}`)-1n}let p=Array.from({length:256},(a,b)=>b.toString(16).padStart(2,"0"));function q(a,b={}){return"number"==typeof a||"bigint"==typeof a?s(a,b):"string"==typeof a?function(a,b={}){return r(t.encode(a),b)}(a,b):"boolean"==typeof a?function(a,b={}){let c=`0x${Number(a)}`;return"number"==typeof b.size?(m(c,{size:b.size}),i(c,{size:b.size})):c}(a,b):r(a,b)}function r(a,b={}){let c="";for(let b=0;b<a.length;b++)c+=p[a[b]];let d=`0x${c}`;return"number"==typeof b.size?(m(d,{size:b.size}),i(d,{dir:"right",size:b.size})):d}function s(a,b={}){let c,{signed:d,size:e}=b,f=BigInt(a);e?c=d?(1n<<8n*BigInt(e)-1n)-1n:2n**(8n*BigInt(e))-1n:"number"==typeof a&&(c=BigInt(Number.MAX_SAFE_INTEGER));let g="bigint"==typeof c&&d?-c-1n:0;if(c&&f>c||f<g){let b="bigint"==typeof a?"n":"";throw new j({max:c?`${c}${b}`:void 0,min:`${g}${b}`,signed:d,size:e,value:`${a}${b}`})}let h=`0x${(d&&f<0?(1n<<BigInt(8*e))+BigInt(f):f).toString(16)}`;return e?i(h,{size:e}):h}let t=new TextEncoder,u=new TextEncoder,v={zero:48,nine:57,A:65,F:70,a:97,f:102};function w(a){return a>=v.zero&&a<=v.nine?a-v.zero:a>=v.A&&a<=v.F?a-(v.A-10):a>=v.a&&a<=v.f?a-(v.a-10):void 0}function x(a,b={}){let c=a;b.size&&(m(c,{size:b.size}),c=i(c,{dir:"right",size:b.size}));let d=c.slice(2);d.length%2&&(d=`0${d}`);let e=d.length/2,g=new Uint8Array(e);for(let a=0,b=0;a<e;a++){let c=w(d.charCodeAt(b++)),e=w(d.charCodeAt(b++));if(void 0===c||void 0===e)throw new f(`Invalid byte sequence ("${d[b-2]}${d[b-1]}" in "${d}").`);g[a]=16*c+e}return g}function y(a,b={}){let c=u.encode(a);return"number"==typeof b.size?(m(c,{size:b.size}),i(c,{dir:"right",size:b.size})):c}var z=c(24858);let A=BigInt(0x100000000-1),B=BigInt(32);var C=c(72759);let D=[],E=[],F=[],G=BigInt(0),H=BigInt(1),I=BigInt(2),J=BigInt(7),K=BigInt(256),L=BigInt(113);for(let a=0,b=H,c=1,d=0;a<24;a++){[c,d]=[d,(2*c+3*d)%5],D.push(2*(5*d+c)),E.push((a+1)*(a+2)/2%64);let e=G;for(let a=0;a<7;a++)(b=(b<<H^(b>>J)*L)%K)&I&&(e^=H<<(H<<BigInt(a))-H);F.push(e)}let[M,N]=function(a,b=!1){let c=new Uint32Array(a.length),d=new Uint32Array(a.length);for(let e=0;e<a.length;e++){let{h:f,l:g}=function(a,b=!1){return b?{h:Number(a&A),l:Number(a>>B&A)}:{h:0|Number(a>>B&A),l:0|Number(a&A)}}(a[e],b);[c[e],d[e]]=[f,g]}return[c,d]}(F,!0),O=(a,b,c)=>c>32?((a,b,c)=>b<<c-32|a>>>64-c)(a,b,c):((a,b,c)=>a<<c|b>>>32-c)(a,b,c),P=(a,b,c)=>c>32?((a,b,c)=>a<<c-32|b>>>64-c)(a,b,c):((a,b,c)=>b<<c|a>>>32-c)(a,b,c);class Q extends C.Vw{constructor(a,b,c,d=!1,e=24){if(super(),this.blockLen=a,this.suffix=b,this.outputLen=c,this.enableXOF=d,this.rounds=e,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,(0,z.Fe)(c),0>=this.blockLen||this.blockLen>=200)throw Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=(0,C.DH)(this.state)}keccak(){C.qv||(0,C.Fc)(this.state32),function(a,b=24){let c=new Uint32Array(10);for(let d=24-b;d<24;d++){for(let b=0;b<10;b++)c[b]=a[b]^a[b+10]^a[b+20]^a[b+30]^a[b+40];for(let b=0;b<10;b+=2){let d=(b+8)%10,e=(b+2)%10,f=c[e],g=c[e+1],h=O(f,g,1)^c[d],i=P(f,g,1)^c[d+1];for(let c=0;c<50;c+=10)a[b+c]^=h,a[b+c+1]^=i}let b=a[2],e=a[3];for(let c=0;c<24;c++){let d=E[c],f=O(b,e,d),g=P(b,e,d),h=D[c];b=a[h],e=a[h+1],a[h]=f,a[h+1]=g}for(let b=0;b<50;b+=10){for(let d=0;d<10;d++)c[d]=a[b+d];for(let d=0;d<10;d++)a[b+d]^=~c[(d+2)%10]&c[(d+4)%10]}a[0]^=M[d],a[1]^=N[d]}c.fill(0)}(this.state32,this.rounds),C.qv||(0,C.Fc)(this.state32),this.posOut=0,this.pos=0}update(a){(0,z.CC)(this);let{blockLen:b,state:c}=this,d=(a=(0,C.ZJ)(a)).length;for(let e=0;e<d;){let f=Math.min(b-this.pos,d-e);for(let b=0;b<f;b++)c[this.pos++]^=a[e++];this.pos===b&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:a,suffix:b,pos:c,blockLen:d}=this;a[c]^=b,(128&b)!=0&&c===d-1&&this.keccak(),a[d-1]^=128,this.keccak()}writeInto(a){(0,z.CC)(this,!1),(0,z.DO)(a),this.finish();let b=this.state,{blockLen:c}=this;for(let d=0,e=a.length;d<e;){this.posOut>=c&&this.keccak();let f=Math.min(c-this.posOut,e-d);a.set(b.subarray(this.posOut,this.posOut+f),d),this.posOut+=f,d+=f}return a}xofInto(a){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(a)}xof(a){return(0,z.Fe)(a),this.xofInto(new Uint8Array(a))}digestInto(a){if((0,z.Ht)(a,this),this.finished)throw Error("digest() was already called");return this.writeInto(a),this.destroy(),a}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(a){let{blockLen:b,suffix:c,outputLen:d,rounds:e,enableXOF:f}=this;return a||(a=new Q(b,c,d,f,e)),a.state32.set(this.state32),a.pos=this.pos,a.posOut=this.posOut,a.finished=this.finished,a.rounds=e,a.suffix=c,a.outputLen=d,a.enableXOF=f,a.destroyed=this.destroyed,a}}let R=(0,C.ld)(()=>new Q(136,1,32));function S(a,b){let c=R(g(a,{strict:!1})?function(a,b={}){return"number"==typeof a||"bigint"==typeof a?x(s(a,b)):"boolean"==typeof a?function(a,b={}){let c=new Uint8Array(1);return(c[0]=Number(a),"number"==typeof b.size)?(m(c,{size:b.size}),i(c,{size:b.size})):c}(a,b):g(a)?x(a,b):y(a,b)}(a):a);return"bytes"===(b||"hex")?c:q(c)}class T extends Map{constructor(a){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=a}get(a){let b=super.get(a);return super.has(a)&&void 0!==b&&(this.delete(a),super.set(a,b)),b}set(a,b){if(super.set(a,b),this.maxSize&&this.size>this.maxSize){let a=this.keys().next().value;a&&this.delete(a)}return this}}let U=new T(8192);async function V({hash:a,signature:b}){let d=g(a)?a:q(a),{secp256k1:e}=await c.e(3070).then(c.bind(c,3070)),f=(()=>{if("object"==typeof b&&"r"in b&&"s"in b){let{r:a,s:c,v:d,yParity:f}=b,g=W(Number(f??d));return new e.Signature(o(a),o(c)).addRecoveryBit(g)}let a=g(b)?b:q(b),c=W(function(a,b={}){return Number(o(a,b))}(`0x${a.slice(130)}`));return e.Signature.fromCompact(a.substring(2,130)).addRecoveryBit(c)})().recoverPublicKey(d.substring(2)).toHex(!1);return`0x${f}`}function W(a){if(0===a||1===a)return a;if(27===a)return 0;if(28===a)return 1;throw Error("Invalid yParityOrV value")}async function X({hash:a,signature:b}){var c=await V({hash:a,signature:b});let d=S(`0x${c.substring(4)}`).substring(26);return function(a,b){if(U.has(`${a}.undefined`))return U.get(`${a}.${void 0}`);let c=b?`${b}${a.toLowerCase()}`:a.substring(2).toLowerCase(),d=S(y(c),"bytes"),e=(b?c.substring(`${b}0x`.length):c).split("");for(let a=0;a<40;a+=2)d[a>>1]>>4>=8&&e[a]&&(e[a]=e[a].toUpperCase()),(15&d[a>>1])>=8&&e[a+1]&&(e[a+1]=e[a+1].toUpperCase());let f=`0x${e.join("")}`;return U.set(`${a}.${b}`,f),f}(`0x${d}`)}},96988:(a,b,c)=>{"use strict";let d=c(25758),{mapHttpRequest:e,mapHttpResponse:f}=c(61226),g=c(10152),h=c(41064),{lsCacheSym:i,chindingsSym:j,parsedChindingsSym:k,writeSym:l,serializersSym:m,formatOptsSym:o,endSym:p,stringifiersSym:q,stringifySym:r,stringifySafeSym:s,wildcardFirstSym:t,needsMetadataGsym:u,redactFmtSym:v,streamSym:w,nestedKeySym:x,formattersSym:y,messageKeySym:z,nestedKeyStrSym:A}=c(49094),{isMainThread:B}=c(73566),C=c(69238);function D(){}function E(a){let b="",c=0,d=!1,e=255,f=a.length;if(f>100)return JSON.stringify(a);for(var g=0;g<f&&e>=32;g++)(34===(e=a.charCodeAt(g))||92===e)&&(b+=a.slice(c,g)+"\\",c=g,d=!0);return d?b+=a.slice(c):b=a,e<32?JSON.stringify(a):'"'+b+'"'}function F(a,b,d,e){if(b&&"function"==typeof b)return G((b=b.bind(e))(a),d,a);try{let b=c(48278).prettyFactory;return b.asMetaWrapper=G,G(b(a),d,a)}catch(a){if(a.message.startsWith("Cannot find module 'pino-pretty'"))throw Error("Missing `pino-pretty` module: `pino-pretty` must be installed separately");throw a}}function G(a,b,c){c=Object.assign({suppressFlushSyncWarning:!1},c);let d=!1;return{[u]:!0,lastLevel:0,lastMsg:null,lastObj:null,lastLogger:null,flushSync(){c.suppressFlushSyncWarning||d||(d=!0,J(b,this),b.write(a(Object.assign({level:40,msg:"pino.final with prettyPrint does not support flushing",time:Date.now()},this.chindings()))))},chindings(){let a=this.lastLogger,b=null;return a?(a.hasOwnProperty(k)?b=a[k]:(b=JSON.parse("{"+a[j].substr(1)+"}"),a[k]=b),b):null},write(c){let d=this.lastLogger,e=this.chindings(),f=this.lastTime;"number"==typeof f||(f=f.match(/^\d+/)?parseInt(f):f.slice(1,-1));let g=this.lastObj,h=this.lastMsg,i=d[y],j=i.log?i.log(g):g,k=d[z];h&&j&&!Object.prototype.hasOwnProperty.call(j,k)&&(j[k]=h);let l=Object.assign({level:this.lastLevel,time:f},j,null),o=d[m],p=Object.keys(o);for(var r=0;r<p.length;r++){let a=p[r];void 0!==l[a]&&(l[a]=o[a](l[a]))}for(let a in e)l.hasOwnProperty(a)||(l[a]=e[a]);let s=d[q][v],t=a("function"==typeof s?s(l):l);void 0!==t&&(J(b,this),b.write(t))}}}function H(a){let b=new g(a);return b.on("error",function a(c){if("EPIPE"===c.code){b.write=D,b.end=D,b.flushSync=D,b.destroy=D;return}b.removeListener("error",a),b.emit("error",c)}),!a.sync&&B&&function(a){if(global.WeakRef&&global.WeakMap&&global.FinalizationRegistry){let b=c(43902);b.register(a,I),a.on("close",function(){b.unregister(a)})}}(b),b}function I(a,b){a.destroyed||("beforeExit"===b?(a.flush(),a.on("drain",function(){a.end()})):a.flushSync())}function J(a,b){!0===a[u]&&(a.lastLevel=b.lastLevel,a.lastMsg=b.lastMsg,a.lastObj=b.lastObj,a.lastTime=b.lastTime,a.lastLogger=b.lastLogger)}a.exports={noop:D,buildSafeSonicBoom:H,getPrettyStream:F,asChindings:function(a,b){let c,d=a[j],e=a[r],f=a[s],g=a[q],h=g[t],i=a[m];for(let j in b=(0,a[y].bindings)(b))if(c=b[j],!0===("level"!==j&&"serializers"!==j&&"formatters"!==j&&"customLevels"!==j&&b.hasOwnProperty(j)&&void 0!==c)){if(c=i[j]?i[j](c):c,void 0===(c=(g[j]||h||e)(c,f)))continue;d+=',"'+j+'":'+c}return d},asJson:function(a,b,c,d){let e,f=this[r],g=this[s],h=this[q],k=this[p],l=this[j],o=this[m],u=this[y],v=this[z],w=this[i][c]+d;w+=l,u.log&&(a=u.log(a));let B=h[t],C="";for(let b in a)if(e=a[b],Object.prototype.hasOwnProperty.call(a,b)&&void 0!==e){e=o[b]?o[b](e):e;let a=h[b]||B;switch(typeof e){case"undefined":case"function":continue;case"number":!1===Number.isFinite(e)&&(e=null);case"boolean":a&&(e=a(e));break;case"string":e=(a||E)(e);break;default:e=(a||f)(e,g)}if(void 0===e)continue;C+=',"'+b+'":'+e}let D="";if(void 0!==b){e=o[v]?o[v](b):b;let a=h[v]||B;switch(typeof e){case"function":break;case"number":!1===Number.isFinite(e)&&(e=null);case"boolean":a&&(e=a(e)),D=',"'+v+'":'+e;break;case"string":D=',"'+v+'":'+(e=(a||E)(e));break;default:D=',"'+v+'":'+(e=(a||f)(e,g))}}return this[x]&&C?w+this[A]+C.slice(1)+"}"+D+k:w+C+D+k},genLog:function(a,b){if(!b)return c;return function(...d){b.call(this,d,c,a)};function c(b,...g){if("object"==typeof b){let c,h=b;null!==b&&(b.method&&b.headers&&b.socket?b=e(b):"function"==typeof b.setHeader&&(b=f(b))),null===h&&0===g.length?c=[null]:(h=g.shift(),c=g),this[l](b,d(h,c,this[o]),a)}else this[l](null,d(b,g,this[o]),a)}},createArgsNormalizer:function(a){return function(b,c,d={},e){var f;if("string"==typeof d)e=H({dest:d,sync:!0}),d={};else if("string"==typeof e){if(d&&d.transport)throw Error("only one of option.transport or stream can be specified");e=H({dest:e,sync:!0})}else if(d instanceof g||d.writable||d._writableState)e=d,d={};else if(d.transport){let a;if(d.transport instanceof g||d.transport.writable||d.transport._writableState)throw Error("option.transport do not allow stream, please pass to option directly. e.g. pino(transport)");if(d.transport.targets&&d.transport.targets.length&&d.formatters&&"function"==typeof d.formatters.level)throw Error("option.transport.targets do not allow custom level formatters");d.customLevels&&(a=d.useOnlyCustomLevels?d.customLevels:Object.assign({},d.levels,d.customLevels)),e=C({caller:c,...d.transport,levels:a})}if((d=Object.assign({},a,d)).serializers=Object.assign({},a.serializers,d.serializers),d.formatters=Object.assign({},a.formatters,d.formatters),"onTerminated"in d)throw Error("The onTerminated option has been removed, use pino.final instead");"changeLevelName"in d&&(process.emitWarning("The changeLevelName option is deprecated and will be removed in v7. Use levelKey instead.",{code:"changeLevelName_deprecation"}),d.levelKey=d.changeLevelName,delete d.changeLevelName);let{enabled:i,prettyPrint:j,prettifier:k,messageKey:l}=d;return!1===i&&(d.level="silent"),(e=e||process.stdout)===process.stdout&&e.fd>=0&&(f=e).write===f.constructor.prototype.write&&(e=H({fd:e.fd,sync:!0})),j&&(h.emit("PINODEP008"),e=F(Object.assign({messageKey:l},j),k,e,b)),{opts:d,stream:e}}},final:function(a,b){if(Number(process.versions.node.split(".")[0])>=14&&h.emit("PINODEP009"),void 0===a||"function"!=typeof a.child)throw Error("expected a pino logger instance");let c=void 0!==b;if(c&&"function"!=typeof b)throw Error("if supplied, the handler parameter should be a function");let d=a[w];if("function"!=typeof d.flushSync)throw Error("final requires a stream that has a flushSync method, such as pino.destination");let e=new Proxy(a,{get:(a,b)=>b in a.levels.values?(...c)=>{a[b](...c),d.flushSync()}:a[b]});if(!c){try{d.flushSync()}catch{}return e}return(a=null,...c)=>{try{d.flushSync()}catch(a){}return b(a,e,...c)}},stringify:function(a,b){try{return JSON.stringify(a)}catch(c){try{return(b||this[s])(a)}catch(a){return'"[unable to serialize, circular reference is too complex to analyze]"'}}},buildFormatters:function(a,b,c){return{level:a,bindings:b,log:c}},normalizeDestFileDescriptor:function(a){let b=Number(a);return"string"==typeof a&&Number.isFinite(b)?b:a}}},97947:a=>{"use strict";a.exports=function(a){return a?"string"==typeof a?a.split(",").reduce((a,b,c)=>{let[d,e=c]=b.split(":");return a[e]=d.toUpperCase(),a},{default:"USERLVL"}):"[object Object]"===Object.prototype.toString.call(a)?Object.keys(a).reduce((b,c)=>(b[a[c]]=c.toUpperCase(),b),{default:"USERLVL"}):{}:{}}},98459:a=>{"use strict";a.exports=function({input:a,ident:b="    ",eol:c="\n"}){let d=a.split(/\r?\n/);for(let a=1;a<d.length;a+=1)d[a]=b+d[a];return d.join(c)}}};