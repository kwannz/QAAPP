# QA投资平台 - 生产环境配置
# Production Environment Configuration for QA Investment Platform
# 创建时间: 2025-08-29
# 安全警告: 请在部署前修改所有密钥和密码

NODE_ENV=production

# =============================================================================
# API服务配置
# =============================================================================
API_PORT=3001
API_HOST=0.0.0.0
API_URL=https://api.qa-app.com

# Web前端配置
WEB_PORT=3000
WEB_HOST=0.0.0.0
WEB_URL=https://www.qa-app.com

# Next.js 生产配置
NEXT_PUBLIC_API_URL=https://api.qa-app.com
NEXT_PUBLIC_WEB_URL=https://www.qa-app.com
NEXT_PUBLIC_WS_URL=wss://api.qa-app.com
NEXT_PUBLIC_ENVIRONMENT=production
NEXT_PUBLIC_APP_NAME=QA Investment Platform
NEXT_PUBLIC_APP_ENV=production

# =============================================================================
# 数据库配置 (PostgreSQL)
# =============================================================================
DATABASE_URL="postgresql://postgres:CHANGE_THIS_POSTGRES_PASSWORD_IN_PRODUCTION@postgres:5432/qa_app_prod?schema=public&connection_limit=20&pool_timeout=20"
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_USER=postgres
POSTGRES_PASSWORD=CHANGE_THIS_POSTGRES_PASSWORD_IN_PRODUCTION
POSTGRES_DB=qa_app_prod

# 数据库连接池配置
DATABASE_POOL_SIZE=20
DATABASE_POOL_MIN=5
DATABASE_POOL_MAX=50
DATABASE_POOL_IDLE_TIMEOUT=30000
DATABASE_CONNECTION_TIMEOUT=10000
DATABASE_QUERY_TIMEOUT=30000

# 只读数据库用户 (用于监控和备份)
READONLY_PASSWORD=CHANGE_THIS_READONLY_PASSWORD
BACKUP_PASSWORD=CHANGE_THIS_BACKUP_PASSWORD

# =============================================================================
# Redis配置
# =============================================================================
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=CHANGE_THIS_REDIS_PASSWORD_IN_PRODUCTION
REDIS_DB=0
REDIS_URL="redis://:CHANGE_THIS_REDIS_PASSWORD_IN_PRODUCTION@redis:6379/0"

# Redis 连接池配置
REDIS_POOL_SIZE=10
REDIS_CONNECT_TIMEOUT=10000
REDIS_COMMAND_TIMEOUT=5000
REDIS_RETRY_ATTEMPTS=3

# =============================================================================
# JWT 和认证配置
# =============================================================================
JWT_SECRET=CHANGE_THIS_JWT_SECRET_TO_STRONG_RANDOM_STRING_IN_PRODUCTION_256_BITS
JWT_EXPIRATION=24h
JWT_REFRESH_SECRET=CHANGE_THIS_REFRESH_SECRET_TO_ANOTHER_STRONG_RANDOM_STRING_256_BITS
JWT_REFRESH_EXPIRATION=7d

# 认证安全配置
MAX_LOGIN_ATTEMPTS=5
LOGIN_LOCKOUT_TIME=1800000
PASSWORD_MIN_LENGTH=12
REQUIRE_2FA_FOR_ADMIN=true
SESSION_TIMEOUT=3600000

# =============================================================================
# Web3 和区块链配置
# =============================================================================
WEB3_RPC_URL=https://mainnet.infura.io/v3/YOUR_INFURA_PROJECT_ID
BLOCKCHAIN_RPC_URL=https://mainnet.infura.io/v3/YOUR_INFURA_PROJECT_ID
PRIVATE_KEY=CHANGE_THIS_TO_YOUR_PRODUCTION_PRIVATE_KEY
NEXT_PUBLIC_CHAIN_ID=1
NEXT_PUBLIC_RPC_URL=https://mainnet.infura.io/v3/YOUR_INFURA_PROJECT_ID

# 智能合约地址 (生产环境)
TREASURY_ADDRESS=0x1234567890123456789012345678901234567890
QACARD_ADDRESS=0x2345678901234567890123456789012345678901
USDT_ADDRESS=0x3456789012345678901234567890123456789012
NEXT_PUBLIC_TREASURY_ADDRESS=0x1234567890123456789012345678901234567890
NEXT_PUBLIC_QACARD_ADDRESS=0x2345678901234567890123456789012345678901
NEXT_PUBLIC_USDT_ADDRESS=0x3456789012345678901234567890123456789012
NEXT_PUBLIC_ENABLE_TESTNET=false

# =============================================================================
# 安全配置
# =============================================================================
CORS_ORIGIN=https://www.qa-app.com,https://admin.qa-app.com
CORS_CREDENTIALS=true
CORS_METHODS=GET,POST,PUT,DELETE,PATCH,OPTIONS
CORS_ALLOWED_HEADERS=Origin,X-Requested-With,Content-Type,Accept,Authorization

# 速率限制
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=1000
NEXT_PUBLIC_API_RATE_LIMIT=100
NEXT_PUBLIC_API_RATE_WINDOW=60000

# 安全中间件
ENABLE_HELMET=true
ENABLE_RATE_LIMITING=true
ENABLE_CORS=true
TRUST_PROXY=1
SECURE_COOKIES=true
NEXT_PUBLIC_ENABLE_HTTPS_REDIRECT=true

# =============================================================================
# 日志配置
# =============================================================================
LOG_LEVEL=info
LOG_TO_FILE=true
LOG_FILE_PATH=/app/logs
LOG_ROTATION=true
LOG_MAX_SIZE=100MB
LOG_MAX_FILES=30

# =============================================================================
# 监控配置
# =============================================================================
ENABLE_METRICS=true
METRICS_PORT=9090
HEALTH_CHECK_TIMEOUT=10000

# Grafana 配置
GRAFANA_USER=admin
GRAFANA_PASSWORD=CHANGE_THIS_GRAFANA_PASSWORD_IN_PRODUCTION

# =============================================================================
# 缓存配置
# =============================================================================
CACHE_TTL=3600
CACHE_MAX_ITEMS=10000
ENABLE_CACHE=true
NEXT_PUBLIC_CACHE_TTL=3600
NEXT_PUBLIC_ENABLE_CACHE=true

# =============================================================================
# 邮件配置
# =============================================================================
SMTP_HOST=smtp.mailgun.org
SMTP_PORT=587
SMTP_USER=postmaster@mg.qa-app.com
SMTP_PASS=CHANGE_THIS_SMTP_PASSWORD_IN_PRODUCTION
FROM_EMAIL=noreply@qa-app.com

# =============================================================================
# 文件存储配置
# =============================================================================
AWS_ACCESS_KEY_ID=AKIA_YOUR_AWS_ACCESS_KEY
AWS_SECRET_ACCESS_KEY=YOUR_AWS_SECRET_ACCESS_KEY
AWS_REGION=us-east-1
S3_BUCKET=qa-app-production-uploads

# 文件上传限制
UPLOAD_MAX_SIZE=52428800
UPLOAD_ALLOWED_TYPES=image/jpeg,image/png,image/webp,application/pdf
NEXT_PUBLIC_MAX_FILE_SIZE=10485760
NEXT_PUBLIC_ALLOWED_FILE_TYPES=image/jpeg,image/png,image/gif,application/pdf

# =============================================================================
# 特性标志
# =============================================================================
NEXT_PUBLIC_ENABLE_WEB3=true
NEXT_PUBLIC_ENABLE_MOCK_DATA=false
NEXT_PUBLIC_ENABLE_DEBUG=false
NEXT_PUBLIC_AUDIT_API_ENABLED=true
NEXT_PUBLIC_REALTIME_UPDATES_ENABLED=true
FEATURE_REGISTRATION=true
FEATURE_KYC_REQUIRED=true
FEATURE_2FA_ENFORCEMENT=true

# =============================================================================
# 管理员初始配置
# =============================================================================
ADMIN_EMAIL=admin@qa-app.com
ADMIN_PASSWORD=CHANGE_THIS_ADMIN_PASSWORD_MUST_BE_STRONG
SYSTEM_PASSWORD=CHANGE_THIS_SYSTEM_PASSWORD_MUST_BE_STRONG

# =============================================================================
# 测试配置 (仅用于生产环境测试)
# =============================================================================
TEST_MODE=false
TEST_DATABASE_URL="postgresql://postgres:CHANGE_THIS_POSTGRES_PASSWORD_IN_PRODUCTION@postgres:5432/qa_app_test?schema=public"
PLAYWRIGHT_BASE_URL=https://www.qa-app.com
PLAYWRIGHT_HEADLESS=true
PLAYWRIGHT_BROWSER_TIMEOUT=30000

# =============================================================================
# 维护模式
# =============================================================================
NEXT_PUBLIC_MAINTENANCE_MODE=false
NEXT_PUBLIC_MAINTENANCE_MESSAGE=System is under maintenance. Please check back later.

# =============================================================================
# 安全检查清单 (部署前必须完成)
# =============================================================================
# ⚠️ 生产部署前必须修改的配置项 (搜索 CHANGE_THIS):
# - [ ] POSTGRES_PASSWORD
# - [ ] REDIS_PASSWORD  
# - [ ] JWT_SECRET (256位随机字符串)
# - [ ] JWT_REFRESH_SECRET (256位随机字符串)
# - [ ] PRIVATE_KEY (区块链私钥)
# - [ ] TREASURY_ADDRESS, QACARD_ADDRESS, USDT_ADDRESS
# - [ ] AWS_ACCESS_KEY_ID, AWS_SECRET_ACCESS_KEY
# - [ ] SMTP_PASS
# - [ ] GRAFANA_PASSWORD
# - [ ] ADMIN_PASSWORD
# - [ ] SYSTEM_PASSWORD